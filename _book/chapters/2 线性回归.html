<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans" xml:lang="zh-Hans"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>2 线性回归 – 现代预测建模：从回归到机器学习</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/3 模型诊断.html" rel="next">
<link href="../chapters/1 预测模型与评估.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "没有结果",
    "search-matching-documents-text": "匹配的文档",
    "search-copy-link-title": "复制搜索链接",
    "search-hide-matches-text": "隐藏其它匹配结果",
    "search-more-match-text": "更多匹配结果",
    "search-more-matches-text": "更多匹配结果",
    "search-clear-button-title": "清除",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "提交",
    "search-label": "搜索"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="science-textbook.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="展开或折叠侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/part-1-introduction.html">I 基础-线性回归模型</a></li><li class="breadcrumb-item"><a href="../chapters/2 线性回归.html"><span class="chapter-title">2 线性回归</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="展开或折叠侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="搜索" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">现代预测建模：从回归到机器学习</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="搜索"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">index.html</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">I 基础-线性回归模型</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-1-introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">part-1-introduction.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/1 预测模型与评估.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1 预测模型与评估</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/2 线性回归.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">2 线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/3 模型诊断.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3 模型诊断</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/4 时间序列分析初步.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4 时间序列分析初步</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">II 扩展——线性分析方法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-2-introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">part-2-introduction.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/5 降维.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5 降维</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/6 正则化.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6 正则化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/7 广义线性模型.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7 广义线性模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/8 线性分类模型.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">8 线性分类模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/9 非线性回归与样条回归.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9 非线性回归与样条回归</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">III 进阶——超越线性的机器学习</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-3-introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">part-3-introduction.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10 决策树与集成学习.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10 决策树与集成学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11 支持向量机.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11 支持向量机</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12 神经网络与深度学习基础.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12 神经网络与深度学习基础</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">IV 实践——综合案例分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-4-introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">part-4-introduction.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/13 回归任务与基准测试.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">13 回归任务与基准测试</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14 分类任务.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">14 分类任务</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/15 案例综合分析.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">15 案例综合分析</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">目录</h2>
   
  <ul>
<li><a href="#%E6%9C%AC%E7%AB%A0%E5%AF%BC%E8%AF%BB" id="toc-本章导读" class="nav-link active" data-scroll-target="#%E6%9C%AC%E7%AB%A0%E5%AF%BC%E8%AF%BB">本章导读</a></li>
  <li>
<a href="#%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B" id="toc-线性回归模型" class="nav-link" data-scroll-target="#%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B">2.1 线性回归模型</a>
  <ul class="collapse">
<li><a href="#%E6%80%BB%E4%BD%93%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B" id="toc-总体回归模型" class="nav-link" data-scroll-target="#%E6%80%BB%E4%BD%93%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B">2.1.1 总体回归模型</a></li>
  <li><a href="#%E6%A0%B7%E6%9C%AC%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B" id="toc-样本回归模型" class="nav-link" data-scroll-target="#%E6%A0%B7%E6%9C%AC%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B">2.1.2 样本回归模型</a></li>
  <li><a href="#%E7%9F%A9%E9%98%B5%E5%BD%A2%E5%BC%8F%E7%9A%84%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B" id="toc-矩阵形式的回归模型" class="nav-link" data-scroll-target="#%E7%9F%A9%E9%98%B5%E5%BD%A2%E5%BC%8F%E7%9A%84%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B">2.1.3 矩阵形式的回归模型</a></li>
  <li><a href="#%E5%9F%BA%E6%9C%AC%E5%81%87%E8%AE%BE" id="toc-基本假设" class="nav-link" data-scroll-target="#%E5%9F%BA%E6%9C%AC%E5%81%87%E8%AE%BE">2.1.4 基本假设</a></li>
  </ul>
</li>
  <li>
<a href="#%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1%E6%96%B9%E6%B3%95" id="toc-参数估计方法" class="nav-link" data-scroll-target="#%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1%E6%96%B9%E6%B3%95">2.2 参数估计方法</a>
  <ul class="collapse">
<li><a href="#%E6%99%AE%E9%80%9A%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E4%BC%B0%E8%AE%A1" id="toc-普通最小二乘估计" class="nav-link" data-scroll-target="#%E6%99%AE%E9%80%9A%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E4%BC%B0%E8%AE%A1">2.2.1 普通最小二乘估计</a></li>
  <li><a href="#%E6%9E%81%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1" id="toc-极大似然估计" class="nav-link" data-scroll-target="#%E6%9E%81%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1">2.2.2 极大似然估计</a></li>
  <li><a href="#%E7%82%B9%E4%BC%B0%E8%AE%A1%E4%B8%8E%E5%8C%BA%E9%97%B4%E4%BC%B0%E8%AE%A1" id="toc-点估计与区间估计" class="nav-link" data-scroll-target="#%E7%82%B9%E4%BC%B0%E8%AE%A1%E4%B8%8E%E5%8C%BA%E9%97%B4%E4%BC%B0%E8%AE%A1">2.2.3 点估计与区间估计</a></li>
  </ul>
</li>
  <li>
<a href="#%E6%8B%9F%E5%90%88%E4%BC%98%E5%BA%A6" id="toc-拟合优度" class="nav-link" data-scroll-target="#%E6%8B%9F%E5%90%88%E4%BC%98%E5%BA%A6">2.3 拟合优度</a>
  <ul class="collapse">
<li><a href="#%E6%80%BB%E5%B9%B3%E6%96%B9%E5%92%8C%E5%88%86%E8%A7%A3" id="toc-总平方和分解" class="nav-link" data-scroll-target="#%E6%80%BB%E5%B9%B3%E6%96%B9%E5%92%8C%E5%88%86%E8%A7%A3">2.3.1 总平方和分解</a></li>
  <li><a href="#%E5%86%B3%E5%AE%9A%E7%B3%BB%E6%95%B0" id="toc-决定系数" class="nav-link" data-scroll-target="#%E5%86%B3%E5%AE%9A%E7%B3%BB%E6%95%B0">2.3.2 决定系数</a></li>
  <li><a href="#%E8%B0%83%E6%95%B4%E7%9A%84%E5%86%B3%E5%AE%9A%E7%B3%BB%E6%95%B0" id="toc-调整的决定系数" class="nav-link" data-scroll-target="#%E8%B0%83%E6%95%B4%E7%9A%84%E5%86%B3%E5%AE%9A%E7%B3%BB%E6%95%B0">2.3.3 调整的决定系数</a></li>
  </ul>
</li>
  <li>
<a href="#%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C" id="toc-假设检验" class="nav-link" data-scroll-target="#%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C">2.4 假设检验</a>
  <ul class="collapse">
<li><a href="#%E6%A8%A1%E5%9E%8B%E6%95%B4%E4%BD%93%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8Cf%E6%A3%80%E9%AA%8C" id="toc-模型整体显著性检验f检验" class="nav-link" data-scroll-target="#%E6%A8%A1%E5%9E%8B%E6%95%B4%E4%BD%93%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8Cf%E6%A3%80%E9%AA%8C">2.4.1 模型整体显著性检验（F检验）</a></li>
  <li><a href="#%E5%8D%95%E4%B8%AA%E7%B3%BB%E6%95%B0%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8Ct%E6%A3%80%E9%AA%8C" id="toc-单个系数显著性检验t检验" class="nav-link" data-scroll-target="#%E5%8D%95%E4%B8%AA%E7%B3%BB%E6%95%B0%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8Ct%E6%A3%80%E9%AA%8C">2.4.2 单个系数显著性检验（t检验）</a></li>
  <li><a href="#%E7%B3%BB%E6%95%B0%E7%BA%BF%E6%80%A7%E7%BB%84%E5%90%88%E7%9A%84%E6%A3%80%E9%AA%8C" id="toc-系数线性组合的检验" class="nav-link" data-scroll-target="#%E7%B3%BB%E6%95%B0%E7%BA%BF%E6%80%A7%E7%BB%84%E5%90%88%E7%9A%84%E6%A3%80%E9%AA%8C">2.4.3 系数线性组合的检验</a></li>
  </ul>
</li>
  <li>
<a href="#%E9%A2%84%E6%B5%8B" id="toc-预测" class="nav-link" data-scroll-target="#%E9%A2%84%E6%B5%8B">2.5 预测</a>
  <ul class="collapse">
<li><a href="#%E7%82%B9%E9%A2%84%E6%B5%8B" id="toc-点预测" class="nav-link" data-scroll-target="#%E7%82%B9%E9%A2%84%E6%B5%8B">2.5.1 点预测</a></li>
  <li><a href="#%E5%8C%BA%E9%97%B4%E9%A2%84%E6%B5%8B" id="toc-区间预测" class="nav-link" data-scroll-target="#%E5%8C%BA%E9%97%B4%E9%A2%84%E6%B5%8B">2.5.2 区间预测</a></li>
  <li><a href="#%E9%A2%84%E6%B5%8B%E7%B2%BE%E5%BA%A6%E7%9A%84%E5%BD%B1%E5%93%8D%E5%9B%A0%E7%B4%A0" id="toc-预测精度的影响因素" class="nav-link" data-scroll-target="#%E9%A2%84%E6%B5%8B%E7%B2%BE%E5%BA%A6%E7%9A%84%E5%BD%B1%E5%93%8D%E5%9B%A0%E7%B4%A0">2.5.3 预测精度的影响因素</a></li>
  </ul>
</li>
  <li><a href="#%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90" id="toc-案例分析" class="nav-link" data-scroll-target="#%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90">2.6 案例分析</a></li>
  <li><a href="#%E6%9C%AC%E7%AB%A0%E6%80%BB%E7%BB%93" id="toc-本章总结" class="nav-link" data-scroll-target="#%E6%9C%AC%E7%AB%A0%E6%80%BB%E7%BB%93">本章总结</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/part-1-introduction.html">I 基础-线性回归模型</a></li><li class="breadcrumb-item"><a href="../chapters/2 线性回归.html"><span class="chapter-title">2 线性回归</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span class="chapter-title">2 线性回归</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="本章导读" class="level2"><h2 class="anchored" data-anchor-id="本章导读">本章导读</h2>
<p>线性回归和线性分析是一个强大而又经久不衰的工具，其思想的简洁性、数学的优雅性、解释的直观性以及广泛的可扩展性让人赞叹。理解线性回归，不仅是掌握一个工具，更是理解现代定量科学如何从数据中提取信息、建立模型的基本范式，它是通往更复杂数据世界的一扇不可或缺的大门。下面我们从历史的角度回溯线性回归思想的历程：</p>
<p>（1）起源：从“平均主义”到“关系量化”（18-19世纪）</p>
<p>线性回归的萌芽并非源于复杂的数学理论，而是来自天文学和测量学中对“误差”处理的迫切需求。</p>
<p>a)核心问题： 在测量同一天文现象（如行星轨道）时，不同观测者或同一观测者的多次测量会得到略有差异的结果。哪一个是最可信的“真值”？</p>
<p>b)先驱与关键思想：</p>
<ul>
<li><p>高斯与勒让德：德国数学家高斯和法国数学家勒让德在18世纪末至19世纪初独立提出了最小二乘法。</p></li>
<li><p>核心思想：最有可能的“真值”或最佳拟合线，是能使所有观测值与预测值之差的平方和达到最小的那条线。误差平方（而非绝对差）在数学上更易处理，且能惩罚大的误差。</p></li>
<li><p>首次应用：勒让德在1805年明确发表了最小二乘法，用于分析彗星轨道；高斯声称更早使用它预测了谷神星的轨迹。</p></li>
</ul>
<p>此时，线性回归更多地被视为一种精妙的“数值计算技术”，而非一个统计模型。</p>
<p>（2）发展：奠定统计学基石（19世纪末 - 20世纪中叶）</p>
<p>随着生物学、经济学等社会科学对数据分析的需求增长，学者们开始探究这种“关系”背后的不确定性和统计意义。</p>
<p>a)弗朗西斯·高尔顿： 被誉为回归的“概念之父”。他在1886年研究遗传学（身高遗传）时发现，虽然高个子父母的孩子也倾向于高，但其身高会“回归”到一个平均趋势。 他引入了 “回归”（Regression） 一词，原意指“倒退、退回平均值”。这一现象揭示了相关但非完美的关系，是现代相关与回归分析的起点。</p>
<p>b)卡尔·皮尔逊： 高尔顿的学生，将回归与相关分析系统化、数学化。 他建立了皮尔逊相关系数，并发展了完整的双变量正态分布理论，为回归分析提供了坚实的概率分布基础。</p>
<p>c)罗纳德·费希尔： 20世纪统计学巨擘，完成了线性回归的现代统计框架。 他的关键贡献在于：方差分析、显著性检验、最大似然估计。 他将回归从描述性工具升级为推断性工具——我们不仅能拟合一条线，还能检验斜率是否显著不为零（即变量间是否存在统计显著的关系），并进行预测和置信区间估计。</p>
<p>至此，线性回归从一个“曲线拟合”方法，演变为一套完整的、基于概率论的统计推断体系。</p>
<p>（3）成熟与扩展：应对复杂现实（20世纪下半叶至今）</p>
<p>计算机的出现和科学研究的复杂化，推动了线性回归模型的极大丰富。</p>
<p>a)计算革命： 最小二乘法的求解涉及矩阵运算。计算机使快速处理海量数据和多个变量成为可能，催生了多元线性回归的广泛应用。</p>
<p>b)理论扩展与变体：</p>
<ul>
<li><p>广义线性模型： 由内尔德和韦德伯恩提出，允许因变量不限于连续正态分布（如二项分布的Logistic回归、泊松分布的计数数据回归）。</p></li>
<li><p>正则化方法： 为应对高维数据、多重共线性和过拟合问题，产生了岭回归、Lasso回归等，它们在损失函数中加入惩罚项，提升模型稳健性和可解释性。</p></li>
<li><p>稳健回归： 针对异常值敏感问题，发展出如Huber回归等方法。</p></li>
</ul>
<p>c)成为机器学习的基础：</p>
<ul>
<li><p>在机器学习领域，线性回归被视为最简单的监督学习算法，是理解参数学习、梯度下降优化等概念的理想起点。</p></li>
<li><p>它也是许多复杂模型（如神经网络中的单个神经元）的构成模块。</p></li>
</ul>
<p>（4）核心思想与局限</p>
<p>a)核心思想： 建模确定性关系： 假设因变量（Y）可以由自变量（X）的线性组合加上一个随机误差来完美解释。 目标： 通过数据估计线性方程的系数，以量化X变化时Y的平均变化量，并用于预测和解释。</p>
<p>b)主要局限：</p>
<ul>
<li><p>线性假设强： 无法直接捕捉变量间的非线性关系。</p></li>
<li><p>对假设敏感： 要求误差独立、同方差、正态分布等，现实数据常不严格满足。</p></li>
<li><p>易受异常值影响。</p></li>
<li><p>相关非因果： 这是最重要的一点。回归揭示的是关联性，而非因果性。忽视混淆变量会导致错误的因果解读。</p></li>
</ul>
<p>线性回归的发展脉络清晰可见：起源于天文学的误差处理（最小二乘法），概念化于生物学的遗传研究（高尔顿的“回归”），体系化于统计学的推断革命（皮尔逊、费希尔），扩展化于计算机时代的复杂数据分析（正则化、广义模型）， 基础化于人工智能/机器学习的模型基石。</p>
<p>线性回归是预测建模最基础、最重要的方法。本章将系统介绍线性回归模型的三种表述形式，详细推导参数估计的两种主要方法——最小二乘估计和极大似然估计，深入探讨模型拟合优度的评价指标，并建立完整的统计推断框架。最后，我们将讨论如何利用建立好的模型进行预测，为后续的模型诊断和扩展奠定坚实基础。</p>
</section><section id="线性回归模型" class="level2"><h2 class="anchored" data-anchor-id="线性回归模型">2.1 线性回归模型</h2>
<p>变量之间的关系：函数关系，统计关系，没有关系</p>
<p>回忆数理统计的内容，相关系数：</p>
<p><span class="math display">\[
\rho = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y}
\]</span> <span class="math display">\[
r = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^n (x_i - \bar{x})^2 \sum_{i=1}^n (y_i - \bar{y})^2}}
\]</span></p>
<p>取值范围： <span class="math inline">\(-1 ≤ ρ ≤ 1\)</span>。</p>
<ul>
<li><p><span class="math inline">\(ρ = 1\)</span>：完全正相关（所有点落在一条斜向上的直线上）。</p></li>
<li><p><span class="math inline">\(ρ = -1\)</span>：完全负相关（所有点落在一条斜向下的直线上）。</p></li>
<li><p><span class="math inline">\(ρ = 0\)</span>：总体中<strong>不存在线性相关</strong>。但这不意味着没有其他关系（如曲线关系）。</p></li>
</ul>
<p>我们几乎永远无法收集到整个总体的数据，因此 <span class="math inline">\(ρ\)</span> 对我们来说通常是未知的。</p>
<p>样本相关系数由英国统计学家卡尔·皮尔逊提出，故常称“皮尔逊积矩相关系数”。 公式本质是样本协方差除以各自样本标准差的乘积取值范围： <span class="math inline">\(-1 ≤ r ≤ 1\)</span>。 它是一个统计量，如果你从同一个总体中抽取不同的样本，计算出的 <span class="math inline">\(r\)</span> 值会不同。这种波动称为抽样变异。</p>
<section id="总体回归模型" class="level3"><h3 class="anchored" data-anchor-id="总体回归模型">2.1.1 总体回归模型</h3>
<p>总体回归模型： <span class="math display">\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_p X_p + \varepsilon
\]</span></p>
<p>其中：</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> 是截距项</p></li>
<li><p><span class="math inline">\(\beta_1, \beta_2, \cdots, \beta_p\)</span> 是回归系数</p></li>
<li>
<p><span class="math inline">\(\varepsilon\)</span> 是随机误差项，满足 <span class="math inline">\(E(\varepsilon|X) = 0\)</span></p>
<p>总体回归函数描述了因变量 <span class="math inline">\(Y\)</span> 与自变量 <span class="math inline">\(X_1, X_2, \cdots, X_p\)</span> 之间的真实关系：</p>
<p><span class="math display">\[
E(Y|X_1, \cdots, X_p) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_p X_p
\]</span></p>
</li>
</ul></section><section id="样本回归模型" class="level3"><h3 class="anchored" data-anchor-id="样本回归模型">2.1.2 样本回归模型</h3>
<p>基于 <span class="math inline">\(n\)</span> 个观测样本 <span class="math inline">\((x_{i1}, x_{i2}, \cdots, x_{ip}, y_i)\)</span>, <span class="math inline">\(i=1,2,\cdots,n\)</span>，样本回归模型为：</p>
<p><span class="math display">\[
y_i = \hat{\beta}_0 + \hat{\beta}_1 x_{i1} + \hat{\beta}_2 x_{i2} + \cdots + \hat{\beta}_p x_{ip} + e_i
\]</span></p>
<p>其中：</p>
<ul>
<li><p><span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1, \cdots, \hat{\beta}_p\)</span> 是总体参数的估计值</p></li>
<li><p><span class="math inline">\(e_i = y_i - \hat{y}_i\)</span> 是第 <span class="math inline">\(i\)</span> 个观测的残差</p></li>
<li><p><span class="math inline">\(\hat{y}_i\)</span> 是第 <span class="math inline">\(i\)</span> 个观测的拟合值</p></li>
</ul>
<p>样本回归函数：</p>
<p><span class="math display">\[
\hat{y_i} = \hat{\beta}_0 + \hat{\beta}_1 x_{i1} + \hat{\beta}_2 x_{i2} + \cdots + \hat{\beta}_p x_{ip}
\]</span></p>
</section><section id="矩阵形式的回归模型" class="level3"><h3 class="anchored" data-anchor-id="矩阵形式的回归模型">2.1.3 矩阵形式的回归模型</h3>
<p>令： <span class="math display">\[
\mathbf{y} = \begin{pmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{pmatrix},
\quad
\mathbf{X} = \begin{pmatrix}
1 &amp; x_{11} &amp; \cdots &amp; x_{1p} \\
1 &amp; x_{21} &amp; \cdots &amp; x_{2p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_{n1} &amp; \cdots &amp; x_{np}
\end{pmatrix},
\quad
\pmb{\beta} = \begin{pmatrix} \beta_0 \\ \beta_1 \\ \vdots \\ \beta_p \end{pmatrix},
\quad
\pmb{\varepsilon} = \begin{pmatrix} \varepsilon_1 \\ \varepsilon_2 \\ \vdots \\ \varepsilon_n \end{pmatrix}
\]</span></p>
<p>则线性回归模型的矩阵形式为： <span class="math display">\[
\mathbf{y} = \mathbf{X}\pmb{\beta} + \pmb{\varepsilon}
\]</span></p>
<p>其中：</p>
<ul>
<li><p><span class="math inline">\(\mathbf{y}\)</span> 是 <span class="math inline">\(n \times 1\)</span> 的因变量向量</p></li>
<li><p><span class="math inline">\(\mathbf{X}\)</span> 是 <span class="math inline">\(n \times (p+1)\)</span> 的设计矩阵</p></li>
<li><p><span class="math inline">\(\pmb{\beta}\)</span> 是 <span class="math inline">\((p+1) \times 1\)</span> 的参数向量</p></li>
<li><p><span class="math inline">\(\pmb{\varepsilon}\)</span> 是 <span class="math inline">\(n \times 1\)</span> 的误差项向量</p></li>
</ul></section><section id="基本假设" class="level3"><h3 class="anchored" data-anchor-id="基本假设">2.1.4 基本假设</h3>
<p>假设 1：线性关系</p>
<ul>
<li><p>内容：因变量 <span class="math inline">\(Y\)</span> 与自变量 <span class="math inline">\(X\)</span> 之间存在线性关系，且参数 <span class="math inline">\(β\)</span> 是线性的。误差项 <span class="math inline">\(ε\)</span> 以相加的形式进入模型。</p></li>
<li><p>含义：<span class="math inline">\(X\)</span> 变化一个单位，<span class="math inline">\(Y\)</span> 平均变化 <span class="math inline">\(β\)</span> 个单位，与 <span class="math inline">\(X\)</span> 本身的取值无关。</p></li>
<li><p>违反后果：模型无法捕捉真实关系，导致预测偏差。例如，真实关系是二次的，用线性模型会系统性地高估或低估。</p></li>
<li><p>检验与处理：绘制 <span class="math inline">\(Y\)</span> 与每个 <span class="math inline">\(X\)</span> 的散点图；检查残差与拟合值的图。若违反，可对 <span class="math inline">\(X\)</span> 或 <span class="math inline">\(Y\)</span> 进行变量变换（如取对数、平方），或使用多项式回归。</p></li>
</ul>
<p>假设 2：随机抽样</p>
<ul>
<li><p>内容：样本数据是从总体中随机抽样得到的。</p></li>
<li><p>含义：样本能代表总体，避免选择偏差。</p></li>
<li><p>违反后果：样本估计无法推广到总体（外部效度低）。例如，只用大学生数据研究全民收入。</p></li>
<li><p>检验与处理：无法从数据本身直接诊断，需了解抽样过程。处理方法是改进抽样设计。</p></li>
</ul>
<p>假设 3：严格外生性</p>
<ul>
<li><p>内容：给定所有自变量 <span class="math inline">\(X\)</span> 的值，误差项 <span class="math inline">\(ε\)</span> 的条件期望为零。即 <span class="math inline">\(E(ε|X) = 0\)</span>。</p></li>
<li><p>含义：模型中没有遗漏重要的解释变量，且所有包含的 <span class="math inline">\(X\)</span> 都与误差项 <span class="math inline">\(ε\)</span> 不相关。换句话说，<span class="math inline">\(X\)</span> 是“外生”的。</p></li>
<li><p>违反后果（最严重之一）：导致 “内生性” 问题，使参数估计 <span class="math inline">\(β\)</span> 有偏且不一致。无论样本多大，偏差都不会消失。</p></li>
<li><p>常见原因：遗漏变量、测量误差、互为因果（反向因果）。</p></li>
<li><p>检验与处理：难以直接检验。通常基于理论推理。处理需用工具变量法、面板数据模型、断点回归等高级方法。</p></li>
</ul>
<p>假设 4：无完全多重共线性</p>
<ul>
<li><p>内容：自变量之间不存在完全的线性关系。</p></li>
<li><p>含义：没有一个自变量可以精确地由其他自变量的线性组合表示。样本数据中，各 <span class="math inline">\(X\)</span> 提供独立信息。 * 违反后果：OLS 无法唯一求解参数估计值（矩阵不可逆）。</p></li>
<li><p>检验：查看相关系数矩阵；计算方差膨胀因子和条件数。</p></li>
<li><p>处理：删除高度相关的变量之一；使用主成分回归或岭回归等降维/正则化方法。</p></li>
</ul>
<p>假设 5：球形误差（同方差与无自相关） 这是两个子假设的合称：</p>
<p>5a) 同方差性：给定所有 <span class="math inline">\(X\)</span>，误差项 <span class="math inline">\(ε\)</span> 的条件方差为常数。即 <span class="math inline">\(Var(ε|X) = σ²\)</span>。</p>
<ul>
<li><p>违反后果：OLS估计量仍无偏，但不再是最有效的（方差不是最小）；标准误估计有偏，导致假设检验失效。</p></li>
<li><p>检验：绘制残差与拟合值的散点图，看是否呈漏斗形、扇形等。正式检验有Breusch-Pagan检验、White检验等。</p></li>
<li><p>处理：使用稳健标准误（最常见且简单）、加权最小二乘法、对变量进行变换。</p></li>
</ul>
<p>5b) 无自相关：对于不同观测 <span class="math inline">\(i\)</span> 和 <span class="math inline">\(j\)</span>，其误差项互不相关。即 <span class="math inline">\(Cov(εᵢ, εⱼ|X) = 0\)</span> (i ≠ j)。</p>
<ul>
<li><p>违反后果：与异方差类似，效率降低，标准误估计有偏（通常偏低），导致 <span class="math inline">\(t\)</span> 统计量虚高，易得出显著结论。</p></li>
<li><p>常见于：时间序列数据（本期误差受上期影响）、空间数据。</p></li>
<li><p>检验：绘制残差与时间/顺序的图；使用Durbin-Watson检验（针对一阶自相关）。</p></li>
<li><p>处理：时间序列模型（如ARIMA）、使用异方差自相关稳健标准误、广义最小二乘法。</p></li>
</ul>
<p>假设 6：误差项的正态性（可选但重要） * 内容：误差项 <span class="math inline">\(ε\)</span> 服从正态分布。即 <span class="math inline">\(ε|X ~ N(0, σ²I)\)</span>。</p>
<ul>
<li><p>含义：在样本量不大时，此假设是进行精确统计推断（如 <span class="math inline">\(t\)</span> 检验、<span class="math inline">\(F\)</span> 检验）的基础。</p></li>
<li><p>违反后果：在小样本下，<span class="math inline">\(β\)</span> 的分布不是精确的 <span class="math inline">\(t\)</span> 分布，检验和置信区间可能不准确。但在大样本下（中心极限定理），OLS估计量近似正态，此假设可放松。</p></li>
<li><p>检验：绘制残差的正态Q-Q图；使用Shapiro-Wilk、Kolmogorov-Smirnov等检验。</p></li>
<li><p>处理：增大样本量；使用自助法进行推断；考虑对 <span class="math inline">\(Y\)</span> 进行变换。</p></li>
</ul>
<p>这六个假设可以按目标归类：</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">目标</th>
<th style="text-align: left;">核心假设</th>
<th style="text-align: left;">关键点</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">估计无偏</td>
<td style="text-align: left;">1. 线性关系<br>3. 严格外生性</td>
<td style="text-align: left;">模型设定正确，无遗漏变量和反向因果。</td>
</tr>
<tr class="even">
<td style="text-align: left;">估计可算</td>
<td style="text-align: left;">4. 无完全多重共线性</td>
<td style="text-align: left;">自变量提供独立信息，矩阵可逆。</td>
</tr>
<tr class="odd">
<td style="text-align: left;">估计有效（BLUE）</td>
<td style="text-align: left;">5. 球形误差（同方差+无自相关）</td>
<td style="text-align: left;">OLS估计量的方差最小。</td>
</tr>
<tr class="even">
<td style="text-align: left;">推断可靠</td>
<td style="text-align: left;">6. 误差正态性（小样本）<br>+ 以上所有</td>
<td style="text-align: left;">可用于假设检验和置信区间。</td>
</tr>
</tbody>
</table></section></section><section id="参数估计方法" class="level2"><h2 class="anchored" data-anchor-id="参数估计方法">2.2 参数估计方法</h2>
<section id="普通最小二乘估计" class="level3"><h3 class="anchored" data-anchor-id="普通最小二乘估计">2.2.1 普通最小二乘估计</h3>
<p>基本原理：寻找参数估计值 <span class="math inline">\(\hat{\pmb{\beta}}\)</span>，使得残差平方和最小。</p>
<p>残差平方和： <span class="math display">\[
SSE = \sum_{i=1}^n e_i^2 = \sum_{i=1}^n (y_i - \hat{y}_i)^2 = (\mathbf{y} - \mathbf{X}\pmb{\beta})'(\mathbf{y} - \mathbf{X}\pmb{\beta})
\]</span></p>
<p>最小二乘估计量： 通过对 <span class="math inline">\(SSE\)</span> 关于 <span class="math inline">\(\pmb{\beta}\)</span> 求导并令导数为零，可得正规方程组： <span class="math display">\[
\mathbf{X}'\mathbf{X}\hat{\pmb{\beta}} = \mathbf{X}'\mathbf{y}
\]</span></p>
<p>当 <span class="math inline">\(\mathbf{X}'\mathbf{X}\)</span> 可逆时，OLS估计量为： <span class="math display">\[
\hat{\pmb{\beta}} = (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{y}
\]</span></p>
<p>OLS估计量的性质（在经典假设下）：</p>
<p>1. 无偏性：<span class="math inline">\(E(\hat{\pmb{\beta}}) = \pmb{\beta}\)</span></p>
<p>2. 方差-协方差矩阵：<span class="math inline">\(\text{Var}(\hat{\pmb{\beta}}) = \sigma^2(\mathbf{X}'\mathbf{X})^{-1}\)</span></p>
<p>3. 高斯-马尔可夫定理：OLS估计量是最佳线性无偏估计</p>
</section><section id="极大似然估计" class="level3"><h3 class="anchored" data-anchor-id="极大似然估计">2.2.2 极大似然估计</h3>
<p>基本思想：在正态误差的假设下，选择使样本观测值出现概率最大的参数值。</p>
<p>似然函数：假设 <span class="math inline">\(\varepsilon_i \sim N(0, \sigma^2)\)</span>，则 <span class="math inline">\(y_i \sim N(\mathbf{x}_i'\pmb{\beta}, \sigma^2)\)</span>，似然函数为： <span class="math display">\[
L(\pmb{\beta}, \sigma^2) = \prod_{i=1}^n \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(y_i - \mathbf{x}_i'\pmb{\beta})^2}{2\sigma^2}\right)
\]</span></p>
<p>对数似然函数： <span class="math display">\[
\ell(\pmb{\beta}, \sigma^2) = -\frac{n}{2} \ln(2\pi) - \frac{n}{2} \ln(\sigma^2) - \frac{1}{2\sigma^2} \sum_{i=1}^n (y_i - \mathbf{x}_i'\pmb{\beta})^2
\]</span></p>
<p>极大似然估计量： - 回归系数：<span class="math inline">\(\hat{\pmb{\beta}}_{MLE} = (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{y}\)</span>（与OLS相同） - 误差方差：<span class="math inline">\(\hat{\sigma}^2_{MLE} = \frac{1}{n} \sum_{i=1}^n (y_i - \mathbf{x}_i'\hat{\pmb{\beta}})^2\)</span></p>
<p>注意：<span class="math inline">\(\hat{\sigma}^2_{MLE}\)</span> 是有偏估计，通常使用无偏估计： <span class="math display">\[
s^2 = \frac{1}{n-p-1} \sum_{i=1}^n (y_i - \hat{y}_i)^2
\]</span></p>
</section><section id="点估计与区间估计" class="level3"><h3 class="anchored" data-anchor-id="点估计与区间估计">2.2.3 点估计与区间估计</h3>
<p>系数估计： - 点估计：<span class="math inline">\(\hat{\beta}_j\)</span>（OLS或MLE估计值） - 标准误：<span class="math inline">\(SE(\hat{\beta}_j) = s \sqrt{[(\mathbf{X}'\mathbf{X})^{-1}]_{jj}}\)</span></p>
<p>系数的置信区间（置信水平 <span class="math inline">\(1-\alpha\)</span>）： <span class="math display">\[
\hat{\beta}_j \pm t_{1-\alpha/2}(n-p-1) \cdot SE(\hat{\beta}_j)
\]</span></p>
<p>误差方差的置信区间： <span class="math display">\[
\left[ \frac{(n-p-1)s^2}{\chi^2_{1-\alpha/2}(n-p-1)}, \frac{(n-p-1)s^2}{\chi^2_{\alpha/2}(n-p-1)} \right]
\]</span></p>
<p><strong>最小二乘法实现</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb1-4"><a href="#cb1-4"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># 手动实现OLS</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>manual_ols <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb1-8"><a href="#cb1-8"></a>  x_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb1-9"><a href="#cb1-9"></a>  y_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb1-10"><a href="#cb1-10"></a>  slope <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> x_mean) <span class="sc">*</span> (y <span class="sc">-</span> y_mean)) <span class="sc">/</span> <span class="fu">sum</span>((x <span class="sc">-</span> x_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>  intercept <span class="ot">&lt;-</span> y_mean <span class="sc">-</span> slope <span class="sc">*</span> x_mean</span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope))</span>
<span id="cb1-13"><a href="#cb1-13"></a>}</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a>manual_coef <span class="ot">&lt;-</span> <span class="fu">manual_ols</span>(x, y)</span>
<span id="cb1-16"><a href="#cb1-16"></a>lm_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))</span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="fu">cat</span>(<span class="st">"参数估计比较:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>参数估计比较:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">print</span>(<span class="fu">data.frame</span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  方法 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"手动OLS"</span>, <span class="st">"lm函数"</span>),</span>
<span id="cb3-3"><a href="#cb3-3"></a>  截距 <span class="ot">=</span> <span class="fu">c</span>(manual_coef[<span class="dv">1</span>], lm_coef[<span class="dv">1</span>]),</span>
<span id="cb3-4"><a href="#cb3-4"></a>  斜率 <span class="ot">=</span> <span class="fu">c</span>(manual_coef[<span class="dv">2</span>], lm_coef[<span class="dv">2</span>])</span>
<span id="cb3-5"><a href="#cb3-5"></a>))</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>               方法     截距     斜率
intercept   手动OLS 1.907728 1.541433
(Intercept)  lm函数 1.907728 1.541433</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, Ridge, Lasso</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, cross_val_score</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_openml</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co"># 设置样式</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>plt.style.use(<span class="st">'default'</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a>sns.set_palette(<span class="st">"husl"</span>)</span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co"># 生成数据</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb5-16"><a href="#cb5-16"></a>n <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>x <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">10</span>, n)</span>
<span id="cb5-18"><a href="#cb5-18"></a>y <span class="op">=</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> x <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">1.5</span>, n)</span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="kw">def</span> manual_ols(x, y):</span>
<span id="cb5-21"><a href="#cb5-21"></a>    <span class="co">"""手动实现OLS"""</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>    x_mean, y_mean <span class="op">=</span> np.mean(x), np.mean(y)</span>
<span id="cb5-23"><a href="#cb5-23"></a>    slope <span class="op">=</span> np.<span class="bu">sum</span>((x <span class="op">-</span> x_mean) <span class="op">*</span> (y <span class="op">-</span> y_mean)) <span class="op">/</span> np.<span class="bu">sum</span>((x <span class="op">-</span> x_mean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb5-24"><a href="#cb5-24"></a>    intercept <span class="op">=</span> y_mean <span class="op">-</span> slope <span class="op">*</span> x_mean</span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="cf">return</span> intercept, slope</span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co"># 比较结果</span></span>
<span id="cb5-28"><a href="#cb5-28"></a>manual_intercept, manual_slope <span class="op">=</span> manual_ols(x, y)</span>
<span id="cb5-29"><a href="#cb5-29"></a>lr <span class="op">=</span> LinearRegression()</span>
<span id="cb5-30"><a href="#cb5-30"></a>lr.fit(x.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), y)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style>
<div id="sk-container-id-1" class="sk-top-container">
<div class="sk-text-repr-fallback">
<pre>LinearRegression()</pre>
<b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b>
</div>
<div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable">
<input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>LinearRegression</div></div>
<div>
<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.linear_model.LinearRegression.html">?<span>Documentation for LinearRegression</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span>
</div></label><div class="sk-toggleable__content fitted"><pre>LinearRegression()</pre></div> </div></div></div>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="bu">print</span>(<span class="st">"参数估计比较:"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>参数估计比较:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'方法'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'截距'</span><span class="sc">:&lt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'斜率'</span><span class="sc">:&lt;8}</span><span class="ss">"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>方法         截距       斜率      </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'手动OLS'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span>manual_intercept<span class="sc">:.4f}</span><span class="ss">  </span><span class="sc">{</span>manual_slope<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>手动OLS      2.0149  1.5047</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Sklearn'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span>lr<span class="sc">.</span>intercept_<span class="sc">:.4f}</span><span class="ss">  </span><span class="sc">{</span>lr<span class="sc">.</span>coef_[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sklearn    2.0149  1.5047</code></pre>
</div>
</div>
</section></section><section id="拟合优度" class="level2"><h2 class="anchored" data-anchor-id="拟合优度">2.3 拟合优度</h2>
<section id="总平方和分解" class="level3"><h3 class="anchored" data-anchor-id="总平方和分解">2.3.1 总平方和分解</h3>
<p>总平方和：<span class="math inline">\(SST = \sum_{i=1}^n (y_i - \bar{y})^2\)</span> 回归平方和：<span class="math inline">\(SSR = \sum_{i=1}^n (\hat{y}_i - \bar{y})^2\)</span> 残差平方和：<span class="math inline">\(SSE = \sum_{i=1}^n (y_i - \hat{y}_i)^2\)</span></p>
<p>平方和分解公式： <span class="math display">\[
SST = SSR + SSE
\]</span></p>
</section><section id="决定系数" class="level3"><h3 class="anchored" data-anchor-id="决定系数">2.3.2 决定系数</h3>
<p>定义： <span class="math display">\[
R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}
\]</span></p>
<p>性质： - <span class="math inline">\(0 \leq R^2 \leq 1\)</span> - <span class="math inline">\(R^2\)</span> 衡量模型对因变量变异的解释比例 - <span class="math inline">\(R^2\)</span> 随自变量增加而增加，可能过拟合</p>
</section><section id="调整的决定系数" class="level3"><h3 class="anchored" data-anchor-id="调整的决定系数">2.3.3 调整的决定系数</h3>
<p>定义： <span class="math display">\[
R^2_{adj} = 1 - \frac{SSE/(n-p-1)}{SST/(n-1)} = 1 - (1-R^2)\frac{n-1}{n-p-1}
\]</span></p>
<p>优点：对模型复杂度施加惩罚，更适合模型比较</p>
</section></section><section id="假设检验" class="level2"><h2 class="anchored" data-anchor-id="假设检验">2.4 假设检验</h2>
<section id="模型整体显著性检验f检验" class="level3"><h3 class="anchored" data-anchor-id="模型整体显著性检验f检验">2.4.1 模型整体显著性检验（F检验）</h3>
<p>原假设：<span class="math inline">\(H_0: \beta_1 = \beta_2 = \cdots = \beta_p = 0\)</span></p>
<p>F统计量： <span class="math display">\[
F = \frac{SSR/p}{SSE/(n-p-1)} = \frac{MSR}{MSE} \sim F(p, n-p-1)
\]</span></p>
<p>决策规则：如果 <span class="math inline">\(F &gt; F_{1-\alpha}(p, n-p-1)\)</span>，拒绝原假设，认为模型整体显著</p>
</section><section id="单个系数显著性检验t检验" class="level3"><h3 class="anchored" data-anchor-id="单个系数显著性检验t检验">2.4.2 单个系数显著性检验（t检验）</h3>
<p>原假设：<span class="math inline">\(H_0: \beta_j = 0\)</span></p>
<p>t统计量： <span class="math display">\[
t = \frac{\hat{\beta}_j}{SE(\hat{\beta}_j)} \sim t(n-p-1)
\]</span></p>
<p>决策规则：如果 <span class="math inline">\(|t| &gt; t_{1-\alpha/2}(n-p-1)\)</span>，拒绝原假设，认为该自变量对因变量有显著影响</p>
<p><strong>交互演示：t检验与p值</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># 2.3.2 交互式假设检验演示</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>interactive_hypothesis_test <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(manipulate)) {</span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="fu">stop</span>(<span class="st">"请安装manipulate包: install.packages('manipulate')"</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a>  }</span>
<span id="cb14-6"><a href="#cb14-6"></a>  </span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a>  </span>
<span id="cb14-9"><a href="#cb14-9"></a>  <span class="fu">manipulate</span>({</span>
<span id="cb14-10"><a href="#cb14-10"></a>    <span class="co"># 生成数据</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>    n <span class="ot">&lt;-</span> sample_size</span>
<span id="cb14-12"><a href="#cb14-12"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a>    true_slope <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 零假设为真</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>    y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> true_slope <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, noise_sd)</span>
<span id="cb14-15"><a href="#cb14-15"></a>    </span>
<span id="cb14-16"><a href="#cb14-16"></a>    data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb14-17"><a href="#cb14-17"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb14-18"><a href="#cb14-18"></a>    summary_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb14-19"><a href="#cb14-19"></a>    </span>
<span id="cb14-20"><a href="#cb14-20"></a>    <span class="co"># 提取t统计量和p值</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>    t_stat <span class="ot">&lt;-</span> summary_model<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="st">"t value"</span>]</span>
<span id="cb14-22"><a href="#cb14-22"></a>    p_value <span class="ot">&lt;-</span> summary_model<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb14-23"><a href="#cb14-23"></a>    </span>
<span id="cb14-24"><a href="#cb14-24"></a>    <span class="co"># 绘制数据点和回归线</span></span>
<span id="cb14-25"><a href="#cb14-25"></a>    <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb14-26"><a href="#cb14-26"></a>    </span>
<span id="cb14-27"><a href="#cb14-27"></a>    <span class="co"># 左图：散点图和回归线</span></span>
<span id="cb14-28"><a href="#cb14-28"></a>    <span class="fu">plot</span>(x, y, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>, </span>
<span id="cb14-29"><a href="#cb14-29"></a>         <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"数据与回归线</span><span class="sc">\n</span><span class="st">n ="</span>, n, <span class="st">"σ ="</span>, noise_sd),</span>
<span id="cb14-30"><a href="#cb14-30"></a>         <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>,</span>
<span id="cb14-31"><a href="#cb14-31"></a>         <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>noise_sd, <span class="dv">1</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>noise_sd))</span>
<span id="cb14-32"><a href="#cb14-32"></a>    <span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb14-33"><a href="#cb14-33"></a>    <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(y), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb14-34"><a href="#cb14-34"></a>    <span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb14-35"><a href="#cb14-35"></a>           <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"数据"</span>, <span class="st">"回归线"</span>, <span class="st">"Y均值"</span>),</span>
<span id="cb14-36"><a href="#cb14-36"></a>           <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>),</span>
<span id="cb14-37"><a href="#cb14-37"></a>           <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb14-38"><a href="#cb14-38"></a>           <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb14-39"><a href="#cb14-39"></a>    </span>
<span id="cb14-40"><a href="#cb14-40"></a>    <span class="co"># 右图：t分布和p值</span></span>
<span id="cb14-41"><a href="#cb14-41"></a>    x_t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb14-42"><a href="#cb14-42"></a>    y_t <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_t, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb14-43"><a href="#cb14-43"></a>    </span>
<span id="cb14-44"><a href="#cb14-44"></a>    <span class="fu">plot</span>(x_t, y_t, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb14-45"><a href="#cb14-45"></a>         <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"t检验: t ="</span>, <span class="fu">round</span>(t_stat, <span class="dv">3</span>), </span>
<span id="cb14-46"><a href="#cb14-46"></a>                     <span class="st">"p ="</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)),</span>
<span id="cb14-47"><a href="#cb14-47"></a>         <span class="at">xlab =</span> <span class="st">"t统计量"</span>, <span class="at">ylab =</span> <span class="st">"密度"</span>)</span>
<span id="cb14-48"><a href="#cb14-48"></a>    </span>
<span id="cb14-49"><a href="#cb14-49"></a>    <span class="co"># 着色拒绝域</span></span>
<span id="cb14-50"><a href="#cb14-50"></a>    alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb14-51"><a href="#cb14-51"></a>    critical_value <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb14-52"><a href="#cb14-52"></a>    </span>
<span id="cb14-53"><a href="#cb14-53"></a>    <span class="co"># 左侧拒绝域</span></span>
<span id="cb14-54"><a href="#cb14-54"></a>    x_left <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span>critical_value, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb14-55"><a href="#cb14-55"></a>    y_left <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_left, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb14-56"><a href="#cb14-56"></a>    <span class="fu">polygon</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, x_left, <span class="sc">-</span>critical_value), <span class="fu">c</span>(<span class="dv">0</span>, y_left, <span class="dv">0</span>), </span>
<span id="cb14-57"><a href="#cb14-57"></a>            <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">density =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">45</span>)</span>
<span id="cb14-58"><a href="#cb14-58"></a>    </span>
<span id="cb14-59"><a href="#cb14-59"></a>    <span class="co"># 右侧拒绝域  </span></span>
<span id="cb14-60"><a href="#cb14-60"></a>    x_right <span class="ot">&lt;-</span> <span class="fu">seq</span>(critical_value, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb14-61"><a href="#cb14-61"></a>    y_right <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_right, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb14-62"><a href="#cb14-62"></a>    <span class="fu">polygon</span>(<span class="fu">c</span>(critical_value, x_right, <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, y_right, <span class="dv">0</span>),</span>
<span id="cb14-63"><a href="#cb14-63"></a>            <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">density =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">45</span>)</span>
<span id="cb14-64"><a href="#cb14-64"></a>    </span>
<span id="cb14-65"><a href="#cb14-65"></a>    <span class="co"># 标记t统计量</span></span>
<span id="cb14-66"><a href="#cb14-66"></a>    <span class="fu">abline</span>(<span class="at">v =</span> t_stat, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb14-67"><a href="#cb14-67"></a>    <span class="fu">points</span>(t_stat, <span class="fu">dt</span>(t_stat, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb14-68"><a href="#cb14-68"></a>    <span class="fu">text</span>(t_stat, <span class="fu">dt</span>(t_stat, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.02</span>, </span>
<span id="cb14-69"><a href="#cb14-69"></a>         <span class="fu">paste</span>(<span class="st">"t ="</span>, <span class="fu">round</span>(t_stat, <span class="dv">3</span>)), <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb14-70"><a href="#cb14-70"></a>    </span>
<span id="cb14-71"><a href="#cb14-71"></a>    <span class="co"># 标记临界值</span></span>
<span id="cb14-72"><a href="#cb14-72"></a>    <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="sc">-</span>critical_value, critical_value), </span>
<span id="cb14-73"><a href="#cb14-73"></a>           <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb14-74"><a href="#cb14-74"></a>    <span class="fu">text</span>(critical_value, <span class="fl">0.3</span>, <span class="fu">paste</span>(<span class="st">"临界值 ="</span>, <span class="fu">round</span>(critical_value, <span class="dv">3</span>)), </span>
<span id="cb14-75"><a href="#cb14-75"></a>         <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb14-76"><a href="#cb14-76"></a>    </span>
<span id="cb14-77"><a href="#cb14-77"></a>    <span class="co"># 添加决策</span></span>
<span id="cb14-78"><a href="#cb14-78"></a>    decision <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> alpha, <span class="st">"拒绝H0"</span>, <span class="st">"不拒绝H0"</span>)</span>
<span id="cb14-79"><a href="#cb14-79"></a>    <span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb14-80"><a href="#cb14-80"></a>           <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"p值:"</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)),</span>
<span id="cb14-81"><a href="#cb14-81"></a>                     <span class="fu">paste</span>(<span class="st">"α:"</span>, alpha),</span>
<span id="cb14-82"><a href="#cb14-82"></a>                     <span class="fu">paste</span>(<span class="st">"决策:"</span>, decision)),</span>
<span id="cb14-83"><a href="#cb14-83"></a>           <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb14-84"><a href="#cb14-84"></a>    </span>
<span id="cb14-85"><a href="#cb14-85"></a>  },</span>
<span id="cb14-86"><a href="#cb14-86"></a>  <span class="at">sample_size =</span> <span class="fu">slider</span>(<span class="dv">10</span>, <span class="dv">200</span>, <span class="at">initial =</span> <span class="dv">30</span>, <span class="at">step =</span> <span class="dv">10</span>, <span class="at">label =</span> <span class="st">"样本量 n"</span>),</span>
<span id="cb14-87"><a href="#cb14-87"></a>  <span class="at">noise_sd =</span> <span class="fu">slider</span>(<span class="fl">0.5</span>, <span class="dv">5</span>, <span class="at">initial =</span> <span class="dv">2</span>, <span class="at">step =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">"噪声标准差 σ"</span>)</span>
<span id="cb14-88"><a href="#cb14-88"></a>  )</span>
<span id="cb14-89"><a href="#cb14-89"></a>}</span>
<span id="cb14-90"><a href="#cb14-90"></a></span>
<span id="cb14-91"><a href="#cb14-91"></a><span class="co"># 运行交互演示（需要RStudio）</span></span>
<span id="cb14-92"><a href="#cb14-92"></a><span class="co"># interactive_hypothesis_test()</span></span>
<span id="cb14-93"><a href="#cb14-93"></a></span>
<span id="cb14-94"><a href="#cb14-94"></a><span class="co"># 静态版本</span></span>
<span id="cb14-95"><a href="#cb14-95"></a>static_hypothesis_test <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">noise_sd =</span> <span class="dv">2</span>) {</span>
<span id="cb14-96"><a href="#cb14-96"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-97"><a href="#cb14-97"></a>  </span>
<span id="cb14-98"><a href="#cb14-98"></a>  <span class="co"># 生成数据</span></span>
<span id="cb14-99"><a href="#cb14-99"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb14-100"><a href="#cb14-100"></a>  true_slope <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 零假设为真</span></span>
<span id="cb14-101"><a href="#cb14-101"></a>  y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> true_slope <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, noise_sd)</span>
<span id="cb14-102"><a href="#cb14-102"></a>  </span>
<span id="cb14-103"><a href="#cb14-103"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb14-104"><a href="#cb14-104"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb14-105"><a href="#cb14-105"></a>  summary_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb14-106"><a href="#cb14-106"></a>  </span>
<span id="cb14-107"><a href="#cb14-107"></a>  <span class="co"># 提取统计量</span></span>
<span id="cb14-108"><a href="#cb14-108"></a>  t_stat <span class="ot">&lt;-</span> summary_model<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="st">"t value"</span>]</span>
<span id="cb14-109"><a href="#cb14-109"></a>  p_value <span class="ot">&lt;-</span> summary_model<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb14-110"><a href="#cb14-110"></a>  conf_int <span class="ot">&lt;-</span> <span class="fu">confint</span>(model)[<span class="dv">2</span>, ]</span>
<span id="cb14-111"><a href="#cb14-111"></a>  </span>
<span id="cb14-112"><a href="#cb14-112"></a>  <span class="co"># 绘制图形</span></span>
<span id="cb14-113"><a href="#cb14-113"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb14-114"><a href="#cb14-114"></a>  </span>
<span id="cb14-115"><a href="#cb14-115"></a>  <span class="co"># 左图：数据与回归线</span></span>
<span id="cb14-116"><a href="#cb14-116"></a>  <span class="fu">plot</span>(x, y, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>, </span>
<span id="cb14-117"><a href="#cb14-117"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"数据与回归线</span><span class="sc">\n</span><span class="st">n ="</span>, n, <span class="st">"σ ="</span>, noise_sd),</span>
<span id="cb14-118"><a href="#cb14-118"></a>       <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb14-119"><a href="#cb14-119"></a>  <span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb14-120"><a href="#cb14-120"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(y), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb14-121"><a href="#cb14-121"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb14-122"><a href="#cb14-122"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"数据"</span>, <span class="st">"回归线"</span>, <span class="st">"Y均值"</span>),</span>
<span id="cb14-123"><a href="#cb14-123"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>),</span>
<span id="cb14-124"><a href="#cb14-124"></a>         <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb14-125"><a href="#cb14-125"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb14-126"><a href="#cb14-126"></a>  </span>
<span id="cb14-127"><a href="#cb14-127"></a>  <span class="co"># 右图：t分布</span></span>
<span id="cb14-128"><a href="#cb14-128"></a>  x_t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb14-129"><a href="#cb14-129"></a>  y_t <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_t, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb14-130"><a href="#cb14-130"></a>  </span>
<span id="cb14-131"><a href="#cb14-131"></a>  <span class="fu">plot</span>(x_t, y_t, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb14-132"><a href="#cb14-132"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"t检验: t ="</span>, <span class="fu">round</span>(t_stat, <span class="dv">3</span>), </span>
<span id="cb14-133"><a href="#cb14-133"></a>                   <span class="st">"p ="</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)),</span>
<span id="cb14-134"><a href="#cb14-134"></a>       <span class="at">xlab =</span> <span class="st">"t统计量"</span>, <span class="at">ylab =</span> <span class="st">"密度"</span>)</span>
<span id="cb14-135"><a href="#cb14-135"></a>  </span>
<span id="cb14-136"><a href="#cb14-136"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb14-137"><a href="#cb14-137"></a>  critical_value <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb14-138"><a href="#cb14-138"></a>  </span>
<span id="cb14-139"><a href="#cb14-139"></a>  <span class="co"># 着色拒绝域</span></span>
<span id="cb14-140"><a href="#cb14-140"></a>  x_left <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span>critical_value, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb14-141"><a href="#cb14-141"></a>  y_left <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_left, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb14-142"><a href="#cb14-142"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, x_left, <span class="sc">-</span>critical_value), <span class="fu">c</span>(<span class="dv">0</span>, y_left, <span class="dv">0</span>), </span>
<span id="cb14-143"><a href="#cb14-143"></a>          <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span>
<span id="cb14-144"><a href="#cb14-144"></a>  </span>
<span id="cb14-145"><a href="#cb14-145"></a>  x_right <span class="ot">&lt;-</span> <span class="fu">seq</span>(critical_value, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb14-146"><a href="#cb14-146"></a>  y_right <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_right, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb14-147"><a href="#cb14-147"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(critical_value, x_right, <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">0</span>, y_right, <span class="dv">0</span>),</span>
<span id="cb14-148"><a href="#cb14-148"></a>          <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span>
<span id="cb14-149"><a href="#cb14-149"></a>  </span>
<span id="cb14-150"><a href="#cb14-150"></a>  <span class="co"># 标记统计量</span></span>
<span id="cb14-151"><a href="#cb14-151"></a>  <span class="fu">abline</span>(<span class="at">v =</span> t_stat, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb14-152"><a href="#cb14-152"></a>  <span class="fu">points</span>(t_stat, <span class="fu">dt</span>(t_stat, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb14-153"><a href="#cb14-153"></a>  </span>
<span id="cb14-154"><a href="#cb14-154"></a>  <span class="co"># 标记临界值</span></span>
<span id="cb14-155"><a href="#cb14-155"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="sc">-</span>critical_value, critical_value), </span>
<span id="cb14-156"><a href="#cb14-156"></a>         <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb14-157"><a href="#cb14-157"></a>  </span>
<span id="cb14-158"><a href="#cb14-158"></a>  <span class="co"># 决策</span></span>
<span id="cb14-159"><a href="#cb14-159"></a>  decision <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> alpha, <span class="st">"拒绝H0"</span>, <span class="st">"不拒绝H0"</span>)</span>
<span id="cb14-160"><a href="#cb14-160"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb14-161"><a href="#cb14-161"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"p值:"</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)),</span>
<span id="cb14-162"><a href="#cb14-162"></a>                   <span class="fu">paste</span>(<span class="st">"α:"</span>, alpha),</span>
<span id="cb14-163"><a href="#cb14-163"></a>                   <span class="fu">paste</span>(<span class="st">"决策:"</span>, decision)),</span>
<span id="cb14-164"><a href="#cb14-164"></a>         <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb14-165"><a href="#cb14-165"></a>  </span>
<span id="cb14-166"><a href="#cb14-166"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb14-167"><a href="#cb14-167"></a>  </span>
<span id="cb14-168"><a href="#cb14-168"></a>  <span class="fu">cat</span>(<span class="st">"假设检验结果:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-169"><a href="#cb14-169"></a>  <span class="fu">cat</span>(<span class="st">"t统计量:"</span>, <span class="fu">round</span>(t_stat, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-170"><a href="#cb14-170"></a>  <span class="fu">cat</span>(<span class="st">"p值:"</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-171"><a href="#cb14-171"></a>  <span class="fu">cat</span>(<span class="st">"95%置信区间: ["</span>, <span class="fu">round</span>(conf_int[<span class="dv">1</span>], <span class="dv">4</span>), <span class="st">","</span>, <span class="fu">round</span>(conf_int[<span class="dv">2</span>], <span class="dv">4</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-172"><a href="#cb14-172"></a>  <span class="fu">cat</span>(<span class="st">"决策:"</span>, decision, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-173"><a href="#cb14-173"></a>  </span>
<span id="cb14-174"><a href="#cb14-174"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb14-175"><a href="#cb14-175"></a>    <span class="at">model =</span> model,</span>
<span id="cb14-176"><a href="#cb14-176"></a>    <span class="at">t_stat =</span> t_stat,</span>
<span id="cb14-177"><a href="#cb14-177"></a>    <span class="at">p_value =</span> p_value,</span>
<span id="cb14-178"><a href="#cb14-178"></a>    <span class="at">decision =</span> decision</span>
<span id="cb14-179"><a href="#cb14-179"></a>  ))</span>
<span id="cb14-180"><a href="#cb14-180"></a>}</span>
<span id="cb14-181"><a href="#cb14-181"></a></span>
<span id="cb14-182"><a href="#cb14-182"></a><span class="co"># 运行静态检验演示</span></span>
<span id="cb14-183"><a href="#cb14-183"></a>static_test <span class="ot">&lt;-</span> <span class="fu">static_hypothesis_test</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">noise_sd =</span> <span class="fl">1.5</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="2-线性回归_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>假设检验结果:
t统计量: 0.8363 
p值: 0.4071 
95%置信区间: [ -0.0804 , 0.1949 ]
决策: 不拒绝H0 </code></pre>
</div>
</div>
</section><section id="系数线性组合的检验" class="level3"><h3 class="anchored" data-anchor-id="系数线性组合的检验">2.4.3 系数线性组合的检验</h3>
<p>原假设：</p>
<p><span class="math inline">\(H_0: \mathbf{C}\pmb{\beta} = \mathbf{d}\)</span></p>
<p>F统计量： <span class="math display">\[
F = \frac{(\mathbf{C}\hat{\pmb{\beta}} - \mathbf{d})'[\mathbf{C}(\mathbf{X}'\mathbf{X})^{-1}\mathbf{C}']^{-1}(\mathbf{C}\hat{\pmb{\beta}} - \mathbf{d})}{q \cdot MSE} \sim F(q, n-p-1)
\]</span></p>
<p>其中 <span class="math inline">\(\mathbf{C}\)</span> 是 <span class="math inline">\(q \times (p+1)\)</span> 的约束矩阵，<span class="math inline">\(\mathbf{d}\)</span> 是 <span class="math inline">\(q \times 1\)</span> 的常数向量</p>
<p><strong>模型显著性检验</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb16-2"><a href="#cb16-2"></a>summary_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="fu">cat</span>(<span class="st">"模型显著性检验:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>模型显著性检验:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">cat</span>(<span class="st">"F统计量:"</span>, <span class="fu">round</span>(summary_model<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>F统计量: 869.473 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">cat</span>(<span class="st">"p值:"</span>, <span class="fu">format.pval</span>(<span class="fu">pf</span>(summary_model<span class="sc">$</span>fstatistic[<span class="dv">1</span>], </span>
<span id="cb20-2"><a href="#cb20-2"></a>                          summary_model<span class="sc">$</span>fstatistic[<span class="dv">2</span>], </span>
<span id="cb20-3"><a href="#cb20-3"></a>                          summary_model<span class="sc">$</span>fstatistic[<span class="dv">3</span>], </span>
<span id="cb20-4"><a href="#cb20-4"></a>                          <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>p值: &lt; 2.22e-16 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">系数检验:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
系数检验:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">print</span>(<span class="fu">round</span>(summary_model<span class="sc">$</span>coefficients, <span class="dv">4</span>))</span></code></pre></div><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1.9077     0.3186  5.9885        0
x             1.5414     0.0523 29.4868        0</code></pre>
</div>
</div>
</section></section><section id="预测" class="level2"><h2 class="anchored" data-anchor-id="预测">2.5 预测</h2>
<section id="点预测" class="level3"><h3 class="anchored" data-anchor-id="点预测">2.5.1 点预测</h3>
<p>对于新的自变量观测 <span class="math inline">\(\mathbf{x}_0 = (1, x_{01}, x_{02}, \cdots, x_{0p})'\)</span>，因变量的点预测为： <span class="math display">\[
\hat{y}_0 = \mathbf{x}_0'\hat{\pmb{\beta}}
\]</span></p>
</section><section id="区间预测" class="level3"><h3 class="anchored" data-anchor-id="区间预测">2.5.2 区间预测</h3>
<p>均值的置信区间（估计条件均值的置信区间）： <span class="math display">\[
\hat{y}_0 \pm t_{1-\alpha/2}(n-p-1) \cdot s \sqrt{\mathbf{x}_0'(\mathbf{X}'\mathbf{X})^{-1}\mathbf{x}_0}
\]</span></p>
<p>个别值的预测区间（预测单个新观测值的区间）： <span class="math display">\[
\hat{y}_0 \pm t_{1-\alpha/2}(n-p-1) \cdot s \sqrt{1 + \mathbf{x}_0'(\mathbf{X}'\mathbf{X})^{-1}\mathbf{x}_0}
\]</span></p>
<p>重要区别： - 均值置信区间：估计的是 <span class="math inline">\(E(y|\mathbf{x}_0)\)</span> 的置信区间 - 个别值预测区间：预测的是单个 <span class="math inline">\(y_0\)</span> 的区间，包含额外的误差方差项</p>
</section><section id="预测精度的影响因素" class="level3"><h3 class="anchored" data-anchor-id="预测精度的影响因素">2.5.3 预测精度的影响因素</h3>
<ol type="1">
<li>样本量 <span class="math inline">\(n\)</span>：样本量越大，预测越精确</li>
<li>自变量变异：<span class="math inline">\(\mathbf{X}'\mathbf{X}\)</span> 的行列式值越大，预测越精确</li>
<li>杠杆值：<span class="math inline">\(\mathbf{x}_0\)</span> 与样本中心的距离影响预测方差</li>
<li>误差方差：<span class="math inline">\(\sigma^2\)</span> 越小，预测越精确</li>
</ol></section></section><section id="案例分析" class="level2"><h2 class="anchored" data-anchor-id="案例分析">2.6 案例分析</h2>
</section><section id="本章总结" class="level2"><h2 class="anchored" data-anchor-id="本章总结">本章总结</h2>
<p>核心公式回顾</p>
<ol type="1">
<li>OLS估计：<span class="math inline">\(\hat{\pmb{\beta}} = (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{y}\)</span>
</li>
<li>系数方差：<span class="math inline">\(\text{Var}(\hat{\pmb{\beta}}) = \sigma^2(\mathbf{X}'\mathbf{X})^{-1}\)</span>
</li>
<li>拟合优度：<span class="math inline">\(R^2 = 1 - \frac{SSE}{SST}\)</span>
</li>
<li>F检验：<span class="math inline">\(F = \frac{MSR}{MSE} \sim F(p, n-p-1)\)</span>
</li>
<li>t检验：<span class="math inline">\(t = \frac{\hat{\beta}_j}{SE(\hat{\beta}_j)} \sim t(n-p-1)\)</span>
</li>
<li>预测区间：<span class="math inline">\(\hat{y}_0 \pm t_{\alpha/2} \cdot s \sqrt{1 + \mathbf{x}_0'(\mathbf{X}'\mathbf{X})^{-1}\mathbf{x}_0}\)</span>
</li>
</ol>
<p>关键概念</p>
<table class="caption-top table">
<thead><tr class="header">
<th>概念</th>
<th>定义</th>
<th>应用</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>OLS估计</td>
<td>最小化残差平方和</td>
<td>参数估计的主要方法</td>
</tr>
<tr class="even">
<td>MLE估计</td>
<td>最大化似然函数</td>
<td>在正态假设下与OLS等价</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(R^2\)</span></td>
<td>模型解释的变异比例</td>
<td>拟合优度初步评价</td>
</tr>
<tr class="even">
<td>调整<span class="math inline">\(R^2\)</span>
</td>
<td>对复杂度惩罚的<span class="math inline">\(R^2\)</span>
</td>
<td>模型比较</td>
</tr>
<tr class="odd">
<td>F检验</td>
<td>模型整体显著性检验</td>
<td>判断模型是否有意义</td>
</tr>
<tr class="even">
<td>t检验</td>
<td>单个系数显著性检验</td>
<td>变量选择依据</td>
</tr>
<tr class="odd">
<td>预测区间</td>
<td>个别值的预测范围</td>
<td>实际预测应用</td>
</tr>
</tbody>
</table>
<p>线性回归为后续所有预测建模方法提供了理论基础和分析框架。理解本章内容对于掌握现代预测建模技术至关重要。</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "已复制");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "已复制");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/1 预测模型与评估.html" class="pagination-link" aria-label="1 预测模型与评估">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">1 预测模型与评估</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/3 模型诊断.html" class="pagination-link" aria-label="3 模型诊断">
        <span class="nav-page-text"><span class="chapter-title">3 模型诊断</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>