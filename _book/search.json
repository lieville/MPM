[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ç°ä»£é¢„æµ‹å»ºæ¨¡ï¼šä»å›å½’åˆ°æœºå™¨å­¦ä¹ ",
    "section": "",
    "text": "å›å½’ã€åˆ†ç±»æ¨¡å‹åŠRã€Pythonå®ç°,ä½œä¸ºå›å½’åˆ†æå’Œæœºå™¨å­¦ä¹ å…¥é—¨è¯¾ç¨‹è®²ä¹‰ã€å­¦ä¹ æ‰‹å†Œ",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>index.html</span>"
    ]
  },
  {
    "objectID": "introduction.html",
    "href": "introduction.html",
    "title": "å‰è¨€",
    "section": "",
    "text": "å†™è¿™æœ¬ä¹¦æ˜¯ä¸ºäº†æ›´å¥½çš„æœåŠ¡æ•™å­¦ï¼Œç°åœ¨çš„ã€Šå›å½’åˆ†æã€‹æ•™æï¼Œå†…å®¹è¿‡æ—¶ï¼Œå·¥å…·åªç”¨SPSSï¼Œå¹¶ä¸”å’Œã€Šè®¡é‡ç»æµå­¦ã€‹è¯¾ç¨‹å†…å®¹é‡å¤ã€‚æœ¬ä¹¦ç‰¹ç‚¹åœ¨äºï¼š\nAï¼šå¢åŠ äº†æœºå™¨å­¦ä¹ çš„æ€æƒ³å’Œå†…å®¹ï¼Œå¢åŠ æœºå™¨å­¦ä¹ å›å½’å’Œåˆ†ç±»,åŒæ—¶å¼±åŒ–åˆ é™¤äº†ä¸€éƒ¨åˆ†ä¸å†é‡è¦çš„å†…å®¹ï¼Œæ¯”å¦‚é€‚ç”¨äºè®¡ç®—èƒ½åŠ›å·®çš„æ—¶ä»£çš„é€æ­¥å›å½’ï¼Œå’Œè®¡é‡ç»æµå­¦é‡å¤çš„ç”¨äºå› æœåˆ†æçš„è‡ªç›¸å…³å’Œå¼‚æ–¹å·®éƒ¨åˆ†ï¼›\nB:å·¥å…·é€‰æ‹©ç”¨Rã€Pyhonï¼Œå’Œç§‘ç ”ç•Œã€å·¥ä¸šç•Œæ¥è½¨ï¼Œæ›´å®ç”¨ï¼Œæ›´å®¹æ˜“å’Œå·¥ä½œè¡”æ¥ã€‚\nCï¼šäº’åŠ¨æ€§æ•™å­¦ï¼ŒåŸºäºè½¯ä»¶çš„è¿›æ­¥ï¼Œå¯ä»¥ä½¿ç”¨shinyç­‰è¿›è¡Œäº’åŠ¨æ€§åˆ†æï¼Œè¯»è€…å¯ä»¥æ›´ç›´è§‚çš„çœ‹åˆ°å‚æ•°å˜åŒ–å¯¹åˆ†æç»“æœçš„å½±å“\nç‰ˆæœ¬ä¿¡æ¯ï¼š\nä½¿ç”¨Quartoå‡ºç‰ˆï¼Œç»“æœå¯ä»¥æ˜¯htmlã€docxã€PDFç­‰å½¢å¼ã€‚å†…å®¹å’Œä»£ç éƒ¨åˆ†ä¸»è¦æ˜¯markdownæ ¼å¼ï¼Œå¯ç§»æ¤æ€§ã€å¯ç¼–è¯‘æ€§éƒ½è¾ƒå¥½ã€‚quartoç‰ˆæœ¬ä¸º1.8.26ï¼ŒRç‰ˆæœ¬ä¸º4.5.2ï¼ŒPythonç‰ˆæœ¬ä¸º3.13.5ï¼Œä½¿ç”¨Positronæˆ–è€…Rstudioç¼–è¯‘ã€‚\nåœ¨ä¹¦çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œè½¯ä»¶å·¥å…·ä»¥Rä¸ºä¸»ï¼ŒåŒæ—¶å¼•å…¥Pythonã€‚Råœ¨åˆ†æä¼ ç»Ÿç»Ÿè®¡å­¦æ¨¡å‹ã€å› æœæ•ˆåº”åˆ†æçš„æ—¶å€™å…·æœ‰ä¼˜åŠ¿ï¼Œæ¯•ç«ŸRæ˜¯ç»Ÿè®¡å­¦å®¶å’Œæ•°æ®å­¦å®¶çš„è¯­è¨€ï¼Œç¬¬äºŒéƒ¨åˆ†ï¼ŒRã€Pythonå¹¶é‡ï¼Œè¯»è€…å¯ä»¥çœ‹åˆ°ä¸¤è€…é¢å¯¹åŒæ ·é—®é¢˜æ—¶çš„ä¸åŒè¡¨ç°ï¼Œåœ¨ç¬¬ä¸‰éƒ¨åˆ†éƒ¨åˆ†ï¼Œæœºå™¨å­¦ä¹ éƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯éçº¿æ€§åˆ†æï¼Œä»¥Pythonçš„sklearnåˆ†ææ¡†æ¶ä¸ºä¸»ï¼Œä¹Ÿæ˜¯äº‹å®ä¸Šçš„ä¸»æµæœºå™¨å­¦ä¹ å·¥å…·ï¼ŒåŒæ—¶ä¹ŸåŠ å…¥äº†Rçš„mlr3å·¥å…·åŒ…ï¼Œå…¶åŸºå‡†æµ‹è¯•å…·æœ‰å¿«é€Ÿè¯†åˆ«æ¨¡å‹ï¼Œæ‰¹é‡è¿ç®—å¯¹æ¯”çš„ä¼˜åŠ¿ã€‚å¯ä»¥è®¤ä¸ºRåœ¨å¤„ç†ä¼ ç»Ÿç»Ÿè®¡å­¦é—®é¢˜ã€çº¿æ€§åˆ†ææ¨¡å‹æ¯”å¦‚å› æœåˆ†æã€å‚æ•°ä¼°è®¡ã€å‡è®¾æ£€éªŒå’Œæ—¶é—´åºåˆ—æ•°æ®ä¸Šå…·æœ‰ä¼˜åŠ¿ï¼Œç»˜å›¾åŠŸèƒ½æ˜¯å…¶ç‰¹é•¿ï¼›Pythonåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸã€éçº¿æ€§åˆ†æä¼˜åŠ¿ä¸å¯æ›¿ä»£ï¼Œå…¶ç»Ÿä¸€çš„è¾“å…¥æ¥å£å’Œè¾“å‡ºæ ¼å¼ï¼Œå…·å¤‡å¼ºå¤§çš„ç”Ÿå‘½åŠ›ï¼Œè€Œä¸”åœ¨æ•°æ®æ¸…æ´—é¢†åŸŸä¼˜äºRã€‚æœ¬ä¹¦ç»¼åˆä½¿ç”¨ä¸¤è€…ä¼˜ç‚¹ï¼ŒåŒæ—¶æä¾›å•Ræˆ–è€…å•Pythonçš„è§£å†³æ–¹æ¡ˆï¼Œè¯»è€…æ ¹æ®è‡ªå·±çš„éœ€è¦ç»„åˆä½¿ç”¨æˆ–è€…å–èˆã€‚",
    "crumbs": [
      "å‰è¨€"
    ]
  },
  {
    "objectID": "chapters/part-1-introduction.html",
    "href": "chapters/part-1-introduction.html",
    "title": "ç°ä»£é¢„æµ‹å»ºæ¨¡ï¼šä»å›å½’åˆ°æœºå™¨å­¦ä¹ ",
    "section": "",
    "text": "ç¬¬ä¸€éƒ¨åˆ†æˆ‘ä»¬å°†ä»‹ç»çº¿æ€§å›å½’åˆ†æçš„åŸºæœ¬å‡è®¾å’Œæ–¹æ³•ã€‚éšåæˆ‘ä»¬å°†æ‰©å±•åˆ°æ›´å¤æ‚çš„ç»Ÿè®¡å»ºæ¨¡æŠ€æœ¯ï¼Œ åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š - åŸºæœ¬æ¦‚å¿µ - çº¿æ€§å›å½’æ¨¡å‹çš„å‡è®¾æ£€éªŒ - å‚æ•°ä¼°è®¡æ–¹æ³•å’Œå‡è®¾æ£€éªŒ - å¼‚æ–¹å·® - è‡ªç›¸å…³",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>part-1-introduction.html</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\né¢„æµ‹å»ºæ¨¡æ˜¯ç°ä»£æ•°æ®åˆ†æçš„æ ¸å¿ƒä»»åŠ¡ï¼Œæ— è®ºæ˜¯é¢„æµ‹è¿ç»­æ•°å€¼ï¼ˆå›å½’ï¼‰è¿˜æ˜¯é¢„æµ‹ç±»åˆ«æ ‡ç­¾ï¼ˆåˆ†ç±»ï¼‰ï¼Œéƒ½éœ€è¦å»ºç«‹ç³»ç»Ÿçš„åˆ†æå’Œè¯„ä¼°æ¡†æ¶ã€‚æœ¬ç« å°†ä»‹ç»é¢„æµ‹å»ºæ¨¡çš„åŸºæœ¬æ¦‚å¿µï¼Œé‡ç‚¹è®¨è®ºè¿‡æ‹Ÿåˆç°è±¡åŠå…¶å±å®³ï¼Œå¹¶å»ºç«‹å®Œæ•´çš„æ¨¡å‹è¯„ä¼°ä½“ç³»ï¼Œï¼Œè¡¥å……äº†å·¥å…·è½¯ä»¶Rã€Pythonçš„ç›¸å…³ä½¿ç”¨è¯´æ˜ï¼Œä¸ºåç»­å­¦ä¹ å„ç§é¢„æµ‹æ¨¡å‹å¥ å®šåŸºç¡€ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#é¢„æµ‹å»ºæ¨¡çš„åŸºæœ¬æ¦‚å¿µ",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#é¢„æµ‹å»ºæ¨¡çš„åŸºæœ¬æ¦‚å¿µ",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "1.1 é¢„æµ‹å»ºæ¨¡çš„åŸºæœ¬æ¦‚å¿µ",
    "text": "1.1 é¢„æµ‹å»ºæ¨¡çš„åŸºæœ¬æ¦‚å¿µ\n1.1.1 å›å½’ä¸åˆ†ç±»ä»»åŠ¡\nå›å½’åˆ†æï¼š å›å½’ä»»åŠ¡æ—¨åœ¨é¢„æµ‹è¿ç»­å‹æ•°å€¼å˜é‡ã€‚ä¾‹å¦‚ï¼š - é¢„æµ‹æˆ¿å±‹ä»·æ ¼ï¼ˆè¿ç»­é‡‘é¢ï¼‰ - é¢„æµ‹è‚¡ç¥¨æ”¶ç›Šç‡ï¼ˆè¿ç»­ç™¾åˆ†æ¯”ï¼‰ - é¢„æµ‹æ°”æ¸©å˜åŒ–ï¼ˆè¿ç»­æ¸©åº¦å€¼ï¼‰ - é¢„æµ‹é”€å”®é¢ï¼ˆè¿ç»­æ•°é‡ï¼‰\næ•°å­¦ä¸Šï¼Œå›å½’æ¨¡å‹è¯•å›¾å»ºç«‹ä»ç‰¹å¾å˜é‡ \\(X\\) åˆ°è¿ç»­å“åº”å˜é‡ \\(Y\\) çš„æ˜ å°„ï¼š \\[\nY = f(X) + \\varepsilon\n\\] å…¶ä¸­ \\(\\varepsilon\\) æ˜¯éšæœºè¯¯å·®é¡¹ï¼Œä»£è¡¨æ¨¡å‹æ— æ³•è§£é‡Šçš„éƒ¨åˆ†ã€‚\nåˆ†ç±»åˆ†æï¼š åˆ†ç±»ä»»åŠ¡æ—¨åœ¨é¢„æµ‹ç¦»æ•£å‹ç±»åˆ«å˜é‡ã€‚\nä¾‹å¦‚ï¼š\n\nåˆ¤æ–­é‚®ä»¶æ˜¯å¦ä¸ºåƒåœ¾é‚®ä»¶ï¼ˆäºŒåˆ†ç±»ï¼šæ˜¯/å¦ï¼‰\nè¯Šæ–­æ‚£è€…æ˜¯å¦æ‚£ç—…ï¼ˆäºŒåˆ†ç±»ï¼šå¥åº·/æ‚£ç—…ï¼‰\nè¯†åˆ«å›¾åƒä¸­çš„ç‰©ä½“ç±»åˆ«ï¼ˆå¤šåˆ†ç±»ï¼šçŒ«/ç‹—/è½¦ç­‰ï¼‰\nä¿¡ç”¨é£é™©è¯„ä¼°ï¼ˆå¤šåˆ†ç±»ï¼šä½é£é™©/ä¸­é£é™©/é«˜é£é™©ï¼‰\n\nåˆ†ç±»æ¨¡å‹å»ºç«‹ä»ç‰¹å¾å˜é‡ \\(X\\) åˆ°ç±»åˆ«æ ‡ç­¾ \\(Y\\) çš„æ˜ å°„ï¼š \\[\nY = g(X), \\quad Y \\in \\{C_1, C_2, \\ldots, C_K\\}\n\\]\n1.1.2 ç‰¹å¾å˜é‡ä¸å“åº”å˜é‡\nç‰¹å¾å˜é‡ï¼ˆè‡ªå˜é‡ï¼‰ï¼š ç”¨äºé¢„æµ‹çš„è¾“å…¥å˜é‡\n\nå¯ä»¥æ˜¯æ•°å€¼å‹ã€åˆ†ç±»å‹æˆ–é¡ºåºå‹\nè¡¨ç¤ºä¸º \\(X = (X_1, X_2, \\ldots, X_p)\\)\n\nç‰¹å¾å·¥ç¨‹ï¼šä»åŸå§‹æ•°æ®ä¸­æå–æœ‰æ„ä¹‰çš„ç‰¹å¾\nå“åº”å˜é‡ï¼ˆå› å˜é‡ï¼‰ï¼š\n\néœ€è¦é¢„æµ‹çš„ç›®æ ‡å˜é‡\nå›å½’é—®é¢˜ä¸­ä¸ºè¿ç»­æ•°å€¼\nåˆ†ç±»é—®é¢˜ä¸­ä¸ºç¦»æ•£ç±»åˆ«\nåº”è¯¥ä¸ä¸šåŠ¡ç›®æ ‡ç´§å¯†ç›¸å…³\n\nç¤ºä¾‹åˆ†æï¼š ä»¥æˆ¿ä»·é¢„æµ‹ä¸ºä¾‹ï¼š\n\nç‰¹å¾å˜é‡ï¼šæˆ¿å±‹é¢ç§¯ã€å§å®¤æ•°é‡ã€åœ°ç†ä½ç½®ã€æˆ¿é¾„ç­‰\nå“åº”å˜é‡ï¼šæˆ¿å±‹ä»·æ ¼ï¼ˆè¿ç»­å€¼ï¼‰\né—®é¢˜ç±»å‹ï¼šå›å½’é—®é¢˜\n\nä»¥åƒåœ¾é‚®ä»¶æ£€æµ‹ä¸ºä¾‹ï¼š\n\nç‰¹å¾å˜é‡ï¼šé‚®ä»¶å…³é”®è¯é¢‘ç‡ã€å‘ä»¶äººä¿¡èª‰ã€é‚®ä»¶é•¿åº¦ç­‰\nå“åº”å˜é‡ï¼šé‚®ä»¶ç±»å‹ï¼ˆåƒåœ¾é‚®ä»¶/æ­£å¸¸é‚®ä»¶ï¼‰\né—®é¢˜ç±»å‹ï¼šäºŒåˆ†ç±»é—®é¢˜\n1.1.3 é¢„æµ‹å»ºæ¨¡çš„æµç¨‹\nå®Œæ•´å·¥ä½œæµï¼š\n\né—®é¢˜å®šä¹‰ï¼š\n\næ˜ç¡®ä¸šåŠ¡ç›®æ ‡\nç¡®å®šé¢„æµ‹ä»»åŠ¡ç±»å‹ï¼ˆå›å½’/åˆ†ç±»ï¼‰\nåˆ¶å®šæˆåŠŸæ ‡å‡†\n\n\næ•°æ®å‡†å¤‡ï¼š\n\næ•°æ®æ”¶é›†ä¸æ•´åˆ\næ•°æ®æ¸…æ´—ä¸é¢„å¤„ç†\næ¢ç´¢æ€§æ•°æ®åˆ†æ\n\n\nç‰¹å¾å·¥ç¨‹ï¼š\n\nç‰¹å¾é€‰æ‹©\nç‰¹å¾å˜æ¢\nç‰¹å¾åˆ›å»º\n\n\næ¨¡å‹é€‰æ‹©ï¼š\n\næ ¹æ®é—®é¢˜ç‰¹ç‚¹é€‰æ‹©ç®—æ³•å®¶æ—\nè€ƒè™‘æ•°æ®è§„æ¨¡å’Œç‰¹å¾ç±»å‹\nè¯„ä¼°æ¨¡å‹å‡è®¾çš„åˆç†æ€§\n\n\næ¨¡å‹è®­ç»ƒï¼š\n\nå‚æ•°ä¼°è®¡\nè¶…å‚æ•°è°ƒä¼˜\næ¨¡å‹éªŒè¯\n\n\næ¨¡å‹è¯„ä¼°ï¼š\n\næ€§èƒ½æŒ‡æ ‡è®¡ç®—\næ¨¡å‹æ¯”è¾ƒ\nè¯¯å·®åˆ†æ\n\n\næ¨¡å‹éƒ¨ç½²ï¼š\n\nç”Ÿäº§ç¯å¢ƒé›†æˆ\næ€§èƒ½ç›‘æ§\næ¨¡å‹æ›´æ–°",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#è¿‡æ‹Ÿåˆä¸æ¨¡å‹å¤æ‚åº¦",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#è¿‡æ‹Ÿåˆä¸æ¨¡å‹å¤æ‚åº¦",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "1.2 è¿‡æ‹Ÿåˆä¸æ¨¡å‹å¤æ‚åº¦",
    "text": "1.2 è¿‡æ‹Ÿåˆä¸æ¨¡å‹å¤æ‚åº¦\n1.2.1 è¿‡æ‹Ÿåˆçš„æ¦‚å¿µä¸æœºåˆ¶\nè¿‡æ‹Ÿåˆçš„æœ¬è´¨ï¼š æ¨¡å‹è¿‡åº¦é€‚åº”è®­ç»ƒæ•°æ®ä¸­çš„ç‰¹å®šæ¨¡å¼ï¼ˆåŒ…æ‹¬å™ªå£°ï¼‰ï¼Œå¯¼è‡´åœ¨æ–°æ•°æ®ä¸Šæ³›åŒ–èƒ½åŠ›ä¸‹é™ã€‚\nè¿‡æ‹Ÿåˆçš„æ•°å­¦æè¿°ï¼š è®¾ \\(f\\) ä¸ºçœŸå®å‡½æ•°ï¼Œ\\(\\hat{f}\\) ä¸ºä¼°è®¡å‡½æ•°ï¼Œåˆ™ï¼š\n\nè®­ç»ƒè¯¯å·®ï¼š\\(\\text{Err}_{\\text{train}} = E[L(Y, \\hat{f}(X)) | \\text{train}]\\)\næµ‹è¯•è¯¯å·®ï¼š\\(\\text{Err}_{\\text{test}} = E[L(Y, \\hat{f}(X)) | \\text{test}]\\)\n\nå½“ \\(\\text{Err}_{\\text{train}} \\ll \\text{Err}_{\\text{test}}\\) æ—¶ï¼Œå‘ç”Ÿè¿‡æ‹Ÿåˆã€‚\nè¿‡æ‹Ÿåˆçš„è§†è§‰ç¤ºä¾‹ï¼š è€ƒè™‘å¤šé¡¹å¼å›å½’ï¼š - é€‚å½“é˜¶æ•°ï¼šå¹³æ»‘æ›²çº¿ï¼Œå¾ˆå¥½æ‹ŸåˆçœŸå®è¶‹åŠ¿ - è¿‡é«˜é˜¶æ•°ï¼šæ›²çº¿å‰§çƒˆæ³¢åŠ¨ï¼Œæ‹Ÿåˆæ¯ä¸ªæ•°æ®ç‚¹ï¼ˆåŒ…æ‹¬å™ªå£°ï¼‰\næ¬ æ‹Ÿåˆï¼š ä¸è¿‡æ‹Ÿåˆç›¸å¯¹ï¼Œæ¨¡å‹è¿‡äºç®€å•ï¼Œæ— æ³•æ•æ‰æ•°æ®ä¸­çš„åŸºæœ¬æ¨¡å¼ï¼š - \\(\\text{Err}_{\\text{train}}\\) å¾ˆå¤§ - \\(\\text{Err}_{\\text{test}}\\) ä¹Ÿå¾ˆå¤§ - æ¨¡å‹èƒ½åŠ›ä¸è¶³\nç¼–ç¨‹æ¼”ç¤ºï¼šè¿‡æ‹Ÿåˆç°è±¡\n\n# è¿‡æ‹Ÿåˆç°è±¡æ¼”ç¤º - ç”Ÿæˆæ•°æ®\n# ç”Ÿæˆç†æƒ³çš„è¿‡æ‹Ÿåˆæ¼”ç¤ºæ•°æ®\ngenerate_overfitting_demo_data &lt;- function(n = 100) {\n  set.seed(123)\n  x &lt;- seq(0, 4 * pi, length.out = n)\n  # çœŸå®å…³ç³»ï¼šæ­£å¼¦å‡½æ•° + å™ªå£°\n  y_true &lt;- sin(x) + 0.5 * sin(2*x)\n  y_observed &lt;- y_true + rnorm(n, 0, 0.2)\n  return(data.frame(x = x, y_true = y_true, y_observed = y_observed))\n}\n\n# ç”Ÿæˆæ•°æ®\ndemo_data &lt;- generate_overfitting_demo_data(100)\n\n# æ‹Ÿåˆä¸åŒå¤æ‚åº¦çš„å¤šé¡¹å¼æ¨¡å‹\nlibrary(ggplot2)\nfit_polynomial_models &lt;- function(data, max_degree = 6) {\n  models &lt;- list()\n  predictions &lt;- data.frame(x = data$x)\n  \n  for (degree in 1:max_degree) {\n    model &lt;- lm(y_observed ~ poly(x, degree), data = data)\n    models[[paste0(\"degree_\", degree)]] &lt;- model\n    predictions[[paste0(\"pred_\", degree)]] &lt;- predict(model, newdata = data)\n  }\n  \n  return(list(models = models, predictions = predictions))\n}\n\n# æ‹Ÿåˆæ¨¡å‹\nresults &lt;- fit_polynomial_models(demo_data)\n\n# å¯è§†åŒ–è¿‡æ‹Ÿåˆç°è±¡\nplot_overfitting_demo &lt;- function(data, predictions) {\n  plot_data &lt;- cbind(data, predictions)\n  plot_data_long &lt;- reshape2::melt(plot_data, id.vars = c(\"x\", \"y_true\", \"y_observed\"), \n                                  variable.name = \"model\", value.name = \"prediction\")\n  \n  ggplot(plot_data_long, aes(x = x)) +\n    geom_point(aes(y = y_observed), alpha = 0.6, size = 1) +\n    geom_line(aes(y = y_true, color = \"çœŸå®å…³ç³»\"), size = 1) +\n    geom_line(aes(y = prediction, color = model), size = 0.7) +\n    facet_wrap(~ model, ncol = 3) +\n    labs(title = \"è¿‡æ‹Ÿåˆç°è±¡æ¼”ç¤ºï¼šä¸åŒé˜¶æ•°å¤šé¡¹å¼å›å½’\",\n         x = \"X\", y = \"Y\",\n         color = \"æ›²çº¿ç±»å‹\") +\n    theme_minimal() +\n    scale_color_manual(values = c(\"çœŸå®å…³ç³»\" = \"black\", \n                                 \"pred_1\" = \"red\", \"pred_2\" = \"blue\", \n                                 \"pred_3\" = \"green\", \"pred_4\" = \"orange\",\n                                 \"pred_5\" = \"purple\", \"pred_6\" = \"brown\")) +\n    theme(legend.position = \"bottom\")\n}\n\n# æ˜¾ç¤ºå›¾å½¢\nplot_overfitting_demo(demo_data, results$predictions)\n\n\n\n\n\n\n\n1.2.2 åå·®-æ–¹å·®æƒè¡¡çš„æ·±å…¥åˆ†æ\nå›å¿†ã€Šæ•°ç†ç»Ÿè®¡ã€‹é‡Œå‚æ•°ä¼°è®¡çš„è¯„ä»·æ ‡å‡†ï¼š æ— åæ€§ï¼šä¼°è®¡é‡çš„æœŸæœ›ç­‰äºè¢«ä¼°è®¡å‚æ•°ã€‚ æœ‰æ•ˆæ€§ï¼šåœ¨æ‰€æœ‰æ— åä¼°è®¡é‡ä¸­ï¼Œæ–¹å·®æœ€å°ã€‚ ä¸€è‡´æ€§ï¼šéšç€æ ·æœ¬é‡å¢åŠ ï¼Œä¼°è®¡é‡è¶‹è¿‘äºè¢«ä¼°è®¡å‚æ•°ã€‚ åœ¨é¢„æµ‹å»ºæ¨¡ä¸­ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯é¢„æµ‹è¯¯å·®çš„æ¥æºã€‚åå·®-æ–¹å·®æƒè¡¡ï¼ˆBias-Variance Tradeoffï¼‰æ˜¯ç†è§£æ¨¡å‹å¤æ‚åº¦ä¸é¢„æµ‹æ€§èƒ½å…³ç³»çš„å…³é”®æ¦‚å¿µã€‚\næœŸæœ›é¢„æµ‹è¯¯å·®çš„ä¸¥æ ¼åˆ†è§£ï¼š\nå¯¹äºå›å½’é—®é¢˜ï¼Œåœ¨å¹³æ–¹æŸå¤±ä¸‹ï¼š \\[\n\\begin{aligned}\nE[(Y - \\hat{f}(X))^2] &= E[(Y - E[Y|X] + E[Y|X] - \\hat{f}(X))^2] \\\\\n&= E[(Y - E[Y|X])^2] + E[(E[Y|X] - \\hat{f}(X))^2] \\\\\n&= \\text{Var}(Y|X) + \\text{Bias}^2(\\hat{f}(X)) + \\text{Var}(\\hat{f}(X))\n\\end{aligned}\n\\]\nåå·®ï¼š - \\(\\text{Bias}(\\hat{f}(X)) = E[\\hat{f}(X)] - f(X)\\) - ç³»ç»Ÿæ€§é”™è¯¯ï¼Œæ¨¡å‹ä¸çœŸå®å…³ç³»çš„å·®è· - é«˜åå·®åŸå› ï¼šæ¨¡å‹è¿‡äºç®€å•ï¼Œå‡è®¾å¤ªå¼º\næ–¹å·®ï¼š - \\(\\text{Var}(\\hat{f}(X)) = E[(\\hat{f}(X) - E[\\hat{f}(X)])^2]\\) - æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®å˜åŒ–çš„æ•æ„Ÿæ€§ - é«˜æ–¹å·®åŸå› ï¼šæ¨¡å‹è¿‡äºå¤æ‚ï¼Œå¯¹å™ªå£°æ•æ„Ÿ\nä¸å¯çº¦è¯¯å·®ï¼š - \\(\\sigma_\\varepsilon^2 = \\text{Var}(Y|X)\\) - æ•°æ®å†…åœ¨çš„éšæœºæ€§ - æ— æ³•é€šè¿‡æ”¹è¿›æ¨¡å‹å‡å°‘\nç¼–ç¨‹æ¼”ç¤ºï¼šåå·®-æ–¹å·®æƒè¡¡\n\n# 1.2.2 åå·®-æ–¹å·®æƒè¡¡æ¼”ç¤º\ndemonstrate_bias_variance &lt;- function() {\n  set.seed(123)\n  n_simulations &lt;- 100\n  x &lt;- seq(0, 1, length.out = 50)\n  true_function &lt;- function(x) sin(2 * pi * x)\n  \n  # ç”Ÿæˆå¤šä¸ªè®­ç»ƒé›†\n  generate_training_set &lt;- function() {\n    x_train &lt;- runif(20, 0, 1)\n    y_train &lt;- true_function(x_train) + rnorm(20, 0, 0.3)\n    return(data.frame(x = x_train, y = y_train))\n  }\n  \n  # æ‹Ÿåˆä¸åŒå¤æ‚åº¦çš„æ¨¡å‹\n  fit_models &lt;- function(data, degree) {\n    if (degree == 1) {\n      lm(y ~ x, data = data)\n    } else {\n      lm(y ~ poly(x, degree), data = data)\n    }\n  }\n  \n  # è®¡ç®—åå·®å’Œæ–¹å·®\n  results &lt;- list()\n  degrees &lt;- c(1, 3, 10)  # ä½ã€ä¸­ã€é«˜å¤æ‚åº¦\n  \n  for (degree in degrees) {\n    predictions &lt;- matrix(0, nrow = length(x), ncol = n_simulations)\n    \n    for (i in 1:n_simulations) {\n      train_data &lt;- generate_training_set()\n      model &lt;- fit_models(train_data, degree)\n      pred &lt;- predict(model, newdata = data.frame(x = x))\n      predictions[, i] &lt;- pred\n    }\n    \n    # è®¡ç®—åå·®å’Œæ–¹å·®\n    mean_pred &lt;- rowMeans(predictions)\n    bias_sq &lt;- mean((mean_pred - true_function(x))^2)\n    variance &lt;- mean(apply(predictions, 1, var))\n    \n    results[[as.character(degree)]] &lt;- list(\n      bias_sq = bias_sq,\n      variance = variance,\n      total_error = bias_sq + variance + 0.3^2,  # åŠ ä¸Šå™ªå£°æ–¹å·®\n      predictions = predictions,\n      mean_pred = mean_pred\n    )\n  }\n  \n  return(results)\n}\n\n# è¿è¡Œæ¼”ç¤º\nbias_variance_results &lt;- demonstrate_bias_variance()\n\n# å¯è§†åŒ–ç»“æœ\nplot_bias_variance &lt;- function(results, x) {\n  true_y &lt;- sin(2 * pi * x)\n  \n  par(mfrow = c(1, 3))\n  for (i in 1:3) {\n    degree &lt;- c(1, 3, 10)[i]\n    res &lt;- results[[as.character(degree)]]\n    \n    plot(x, true_y, type = \"l\", lwd = 3, col = \"black\", \n         ylim = c(-1.5, 1.5), main = paste(\"å¤šé¡¹å¼é˜¶æ•°:\", degree),\n         xlab = \"X\", ylab = \"Y\")\n    \n    # ç»˜åˆ¶å¤šä¸ªæ‹Ÿåˆæ›²çº¿\n    for (j in 1:20) {\n      lines(x, res$predictions[, j], col = rgb(0.7, 0.7, 0.7, 0.3))\n    }\n    \n    # ç»˜åˆ¶å¹³å‡é¢„æµ‹å’ŒçœŸå®å‡½æ•°\n    lines(x, res$mean_pred, col = \"red\", lwd = 2)\n    lines(x, true_y, col = \"black\", lwd = 2)\n    \n    # æ·»åŠ å›¾ä¾‹\n    legend(\"topright\", \n           legend = c(\"çœŸå®å‡½æ•°\", \"å¹³å‡é¢„æµ‹\", \"å•ä¸ªæ‹Ÿåˆ\"),\n           col = c(\"black\", \"red\", \"gray\"), lwd = c(2, 2, 1), bty = \"n\")\n  }\n  par(mfrow = c(1, 1))\n}\n\n# åˆ›å»ºxå€¼ç”¨äºç»˜å›¾\nx_plot &lt;- seq(0, 1, length.out = 50)\nplot_bias_variance(bias_variance_results, x_plot)\n\n\n\n\n\n\n# æ‰“å°åå·®-æ–¹å·®åˆ†è§£ç»“æœ\ncat(\"åå·®-æ–¹å·®åˆ†è§£ç»“æœ:\\n\")\n\nåå·®-æ–¹å·®åˆ†è§£ç»“æœ:\n\nfor (degree in c(1, 3, 10)) {\n  res &lt;- bias_variance_results[[as.character(degree)]]\n  cat(sprintf(\"é˜¶æ•° %d: åå·®Â²=%.4f, æ–¹å·®=%.4f, æ€»è¯¯å·®=%.4f\\n\", \n              degree, res$bias_sq, res$variance, res$total_error))\n}\n\né˜¶æ•° 1: åå·®Â²=0.2124, æ–¹å·®=0.0309, æ€»è¯¯å·®=0.3333\né˜¶æ•° 3: åå·®Â²=0.0068, æ–¹å·®=0.0269, æ€»è¯¯å·®=0.1236\né˜¶æ•° 10: åå·®Â²=479112.8409, æ–¹å·®=48825232.2140, æ€»è¯¯å·®=49304345.1449\n\n\n1.2.3 æ¨¡å‹å¤æ‚åº¦çš„å½±å“åˆ†æ\nå¤æ‚åº¦ä¸è¯¯å·®çš„å…³ç³»ï¼š\n\n\nå¤æ‚åº¦çŠ¶æ€\nè®­ç»ƒè¯¯å·®\næµ‹è¯•è¯¯å·®\nåå·®\næ–¹å·®\n\n\n\nä½å¤æ‚åº¦\né«˜\né«˜\né«˜\nä½\n\n\næœ€ä¼˜å¤æ‚åº¦\nä¸­ç­‰\næœ€ä½\nä¸­ç­‰\nä¸­ç­‰\n\n\né«˜å¤æ‚åº¦\nå¾ˆä½\né«˜\nä½\né«˜\n\n\n\nå­¦ä¹ æ›²çº¿åˆ†æï¼š ç»˜åˆ¶è®­ç»ƒé›†å¤§å°ä¸è¯¯å·®çš„å…³ç³»ï¼š - è®­ç»ƒè¯¯å·®ï¼šéšæ ·æœ¬å¢åŠ è€Œå¢åŠ ï¼ˆè¶‹äºç¨³å®šï¼‰ - æµ‹è¯•è¯¯å·®ï¼šéšæ ·æœ¬å¢åŠ è€Œå‡å°‘ï¼ˆè¶‹äºç¨³å®šï¼‰ - ä¸¤è€…å·®è·ï¼šåæ˜ æ–¹å·®å¤§å°\nå®é™…æŒ‡å¯¼æ„ä¹‰ï¼š - é«˜åå·®ï¼šå¢åŠ æ¨¡å‹å¤æ‚åº¦ï¼Œå¢åŠ ç‰¹å¾ - é«˜æ–¹å·®ï¼šå‡å°‘æ¨¡å‹å¤æ‚åº¦ï¼Œå¢åŠ æ•°æ®ï¼Œæ­£åˆ™åŒ–",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#æ¨¡å‹è¯„ä¼°æ¡†æ¶",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#æ¨¡å‹è¯„ä¼°æ¡†æ¶",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "1.3 æ¨¡å‹è¯„ä¼°æ¡†æ¶",
    "text": "1.3 æ¨¡å‹è¯„ä¼°æ¡†æ¶\n1.3.1 æ•°æ®åˆ’åˆ†çš„è¯¦ç»†ç­–ç•¥\nä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åˆ’åˆ†ï¼š - è¯„ä¼°æ¨¡å‹æ³›åŒ–èƒ½åŠ› - é¿å…å¯¹è®­ç»ƒæ•°æ®çš„è¿‡åº¦ä¼˜åŒ– - æä¾›æ— åçš„æ€§èƒ½ä¼°è®¡\nè®­ç»ƒé›†ï¼š - ç”¨äºæ¨¡å‹å‚æ•°ä¼°è®¡ - åº”è¯¥è¶³å¤Ÿå¤§ä»¥å­¦ä¹ æ•°æ®æ¨¡å¼ - é€šå¸¸å 60-80%\néªŒè¯é›†ï¼š - ç”¨äºæ¨¡å‹é€‰æ‹©å’Œè¶…å‚æ•°è°ƒä¼˜ - æä¾›æ¨¡å‹æ¯”è¾ƒçš„åŸºç¡€ - é€šå¸¸å 10-20%\næµ‹è¯•é›†ï¼š - ç”¨äºæœ€ç»ˆæ¨¡å‹è¯„ä¼° - åœ¨æ•´ä¸ªå»ºæ¨¡è¿‡ç¨‹ä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ - é€šå¸¸å 10-20%\næ•°å­¦è¡¨è¾¾ï¼š å°†æ•°æ®é›† \\(D\\) åˆ’åˆ†ä¸ºï¼š \\[\nD = D_{\\text{train}} \\cup D_{\\text{val}} \\cup D_{\\text{test}}\n\\] å…¶ä¸­ï¼š\n\n\\(D_{\\text{train}} \\cap D_{\\text{val}} = \\emptyset\\)\n\\(D_{\\text{train}} \\cap D_{\\text{test}} = \\emptyset\\)\n\\(D_{\\text{val}} \\cap D_{\\text{test}} = \\emptyset\\)\n\nç‰¹æ®Šæƒ…å†µçš„å¤„ç†ï¼š\n\n- å°æ ·æœ¬ï¼šä½¿ç”¨äº¤å‰éªŒè¯\n- æ—¶é—´åºåˆ—ï¼šæŒ‰æ—¶é—´é¡ºåºåˆ’åˆ†\n- ä¸å¹³è¡¡æ•°æ®ï¼šåˆ†å±‚æŠ½æ ·\n\nç¼–ç¨‹æ¼”ç¤ºï¼šæ•°æ®åˆ’åˆ†ç­–ç•¥\n\n# 1.3.1 æ•°æ®åˆ’åˆ†ç­–ç•¥æ¼”ç¤º\ndemonstrate_data_splitting &lt;- function() {\n  set.seed(123)\n  n &lt;- 1000\n  # ç”Ÿæˆå›å½’æ•°æ®\n  x1 &lt;- rnorm(n)\n  x2 &lt;- rnorm(n)\n  y &lt;- 2*x1 + 3*x2 + rnorm(n, 0, 1)\n  data &lt;- data.frame(x1 = x1, x2 = x2, y = y)\n  \n  # ç®€å•åˆ’åˆ†ï¼ˆ70%è®­ç»ƒï¼Œ30%æµ‹è¯•ï¼‰\n  train_idx_simple &lt;- sample(1:n, size = 0.7 * n)\n  test_idx_simple &lt;- setdiff(1:n, train_idx_simple)\n  \n  cat(\"ç®€å•åˆ’åˆ†ç»“æœ:\\n\")\n  cat(\"è®­ç»ƒé›†å¤§å°:\", length(train_idx_simple), \"\\n\")\n  cat(\"æµ‹è¯•é›†å¤§å°:\", length(test_idx_simple), \"\\n\")\n  \n  # æ£€æŸ¥åˆ†å¸ƒæ˜¯å¦ç›¸ä¼¼\n  cat(\"\\nè®­ç»ƒé›†å’Œæµ‹è¯•é›†åˆ†å¸ƒæ¯”è¾ƒ:\\n\")\n  cat(\"è®­ç»ƒé›†yå‡å€¼:\", mean(data$y[train_idx_simple]), \"\\n\")\n  cat(\"æµ‹è¯•é›†yå‡å€¼:\", mean(data$y[test_idx_simple]), \"\\n\")\n  \n  return(list(\n    data = data,\n    train_idx = train_idx_simple,\n    test_idx = test_idx_simple\n  ))\n}\n\n# è¿è¡Œæ¼”ç¤º\nsplit_results &lt;- demonstrate_data_splitting()\n\nç®€å•åˆ’åˆ†ç»“æœ:\nè®­ç»ƒé›†å¤§å°: 700 \næµ‹è¯•é›†å¤§å°: 300 \n\nè®­ç»ƒé›†å’Œæµ‹è¯•é›†åˆ†å¸ƒæ¯”è¾ƒ:\nè®­ç»ƒé›†yå‡å€¼: 0.1586161 \næµ‹è¯•é›†yå‡å€¼: 0.09502576 \n\n\n1.3.2 äº¤å‰éªŒè¯æ–¹æ³•\nkæŠ˜äº¤å‰éªŒè¯çš„å®Œæ•´æµç¨‹ï¼š\n\næ•°æ®å‡†å¤‡ï¼š\n\néšæœºæ‰“ä¹±æ•°æ®\nå°†æ•°æ®åˆ†ä¸ºkä¸ªå¤§å°ç›¸ç­‰çš„å­é›† \\(D_1, D_2, \\ldots, D_k\\)\n\n\n\näº¤å‰éªŒè¯å¾ªç¯ï¼š For \\(i = 1\\) to \\(k\\):\n\nè®­ç»ƒé›†ï¼š\\(D_{\\text{train}}^{(i)} = D \\setminus D_i\\)\n\néªŒè¯é›†ï¼š\\(D_{\\text{val}}^{(i)} = D_i\\)\n\nåœ¨ \\(D_{\\text{train}}^{(i)}\\) ä¸Šè®­ç»ƒæ¨¡å‹\nåœ¨ \\(D_{\\text{val}}^{(i)}\\) ä¸Šè®¡ç®—éªŒè¯è¯¯å·® \\(\\text{Err}^{(i)}\\)\n\n\n\nç»“æœæ±‡æ€»ï¼š\n\nå¹³å‡éªŒè¯è¯¯å·®ï¼š\\(CV(k) = \\frac{1}{k} \\sum_{i=1}^k \\text{Err}^{(i)}\\)\n\nè¯¯å·®æ ‡å‡†å·®ï¼š\\(SE_{CV} = \\sqrt{\\frac{1}{k-1} \\sum_{i=1}^k (\\text{Err}^{(i)} - CV(k))^2}\\)\n\n\n\n\nkå€¼é€‰æ‹©ï¼š\n\n- \\(k=5\\) æˆ– \\(k=10\\)ï¼šå¸¸ç”¨é€‰æ‹©\n- \\(k=n\\)ï¼ˆç•™ä¸€æ³•ï¼‰ï¼šè®¡ç®—é‡å¤§ï¼Œæ–¹å·®å¯èƒ½è¾ƒé«˜\n- å°kå€¼ï¼šåå·®è¾ƒå°ï¼Œæ–¹å·®è¾ƒå¤§ - å¤§kå€¼ï¼šåå·®è¾ƒå¤§ï¼Œæ–¹å·®è¾ƒå°\n\nåˆ†å±‚kæŠ˜äº¤å‰éªŒè¯ï¼š å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œä¿æŒæ¯ä¸ªæŠ˜ä¸­ç±»åˆ«æ¯”ä¾‹ä¸æ•´ä½“ä¸€è‡´ã€‚\næ—¶é—´åºåˆ—äº¤å‰éªŒè¯ï¼š å¯¹äºæ—¶é—´ç›¸å…³æ•°æ®ï¼Œç¡®ä¿éªŒè¯é›†æ—¶é—´åœ¨è®­ç»ƒé›†ä¹‹åã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#è¯„ä¼°æŒ‡æ ‡",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#è¯„ä¼°æŒ‡æ ‡",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "1.4 è¯„ä¼°æŒ‡æ ‡",
    "text": "1.4 è¯„ä¼°æŒ‡æ ‡\n1.4.1 å›å½’é—®é¢˜è¯„ä¼°æŒ‡æ ‡\nå‡æ–¹è¯¯å·®ï¼š \\[\nMSE = \\frac{1}{n} \\sum_{i=1}^n (y_i - \\hat{y}_i)^2\n\\] - ä¼˜ç‚¹ï¼šæ•°å­¦æ€§è´¨å¥½ï¼Œä¾¿äºä¼˜åŒ–\n- ç¼ºç‚¹ï¼šå¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼Œé‡çº²ä¸åŸå§‹æ•°æ®ä¸åŒ\nå‡æ–¹æ ¹è¯¯å·®ï¼š \\[\nRMSE = \\sqrt{MSE}\n\\] - ä¼˜ç‚¹ï¼šé‡çº²ä¸åŸå§‹æ•°æ®ç›¸åŒ\n\nç¼ºç‚¹ï¼šä»ç„¶å¯¹å¼‚å¸¸å€¼æ•æ„Ÿ\n\nå¹³å‡ç»å¯¹è¯¯å·®ï¼š \\[\nMAE = \\frac{1}{n} \\sum_{i=1}^n |y_i - \\hat{y}_i|\n\\] - ä¼˜ç‚¹ï¼šå¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿ\n- ç¼ºç‚¹ï¼šæ•°å­¦æ€§è´¨è¾ƒå·®ï¼Œä¼˜åŒ–å›°éš¾\nå¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®ï¼š \\[\nMAPE = \\frac{100\\%}{n} \\sum_{i=1}^n \\left| \\frac{y_i - \\hat{y}_i}{y_i} \\right|\n\\] - ä¼˜ç‚¹ï¼šç›¸å¯¹è¯¯å·®ï¼Œæ˜“äºè§£é‡Š\n- ç¼ºç‚¹ï¼š\\(y_i=0\\)æ—¶æ— æ³•è®¡ç®—ï¼Œå¯¹è´Ÿå€¼å¤„ç†å›°éš¾\nå†³å®šç³»æ•° \\(R^2\\)ï¼š \\[\nR^2 = 1 - \\frac{\\sum_{i=1}^n (y_i - \\hat{y}_i)^2}{\\sum_{i=1}^n (y_i - \\bar{y})^2}\n\\] - ä¼˜ç‚¹ï¼šæ ‡å‡†åŒ–ï¼Œæ˜“äºæ¯”è¾ƒ\n- ç¼ºç‚¹ï¼šéšç‰¹å¾å¢åŠ è€Œå¢åŠ ï¼Œå¯èƒ½è¯¯å¯¼\nè°ƒæ•´\\(R^2\\)ï¼š \\[\nR^2_{\\text{adj}} = 1 - \\frac{(1-R^2)(n-1)}{n-p-1}\n\\] å…¶ä¸­ \\(p\\) æ˜¯ç‰¹å¾æ•°ï¼Œæƒ©ç½šç‰¹å¾è¿‡å¤šçš„æ¨¡å‹ã€‚\n** æ¼”ç¤ºï¼šå›å½’è¯„ä¼°æŒ‡æ ‡**\n\n# 1.4.1 å›å½’è¯„ä¼°æŒ‡æ ‡æ¼”ç¤º\ndemonstrate_regression_metrics &lt;- function() {\n  set.seed(123)\n  n &lt;- 100\n  # ç”Ÿæˆæ•°æ®\n  x &lt;- rnorm(n)\n  y_true &lt;- 2*x + 1\n  y_pred &lt;- y_true + rnorm(n, 0, 0.5)  # é¢„æµ‹å€¼ï¼ˆå¸¦æœ‰è¯¯å·®ï¼‰\n  y_actual &lt;- y_true + rnorm(n, 0, 0.3)  # å®é™…è§‚æµ‹å€¼ï¼ˆå¸¦æœ‰å™ªå£°ï¼‰\n  \n  # è®¡ç®—å„ç§è¯„ä¼°æŒ‡æ ‡\n  calculate_regression_metrics &lt;- function(actual, predicted) {\n    n &lt;- length(actual)\n    residuals &lt;- actual - predicted\n    \n    mse &lt;- mean(residuals^2)\n    rmse &lt;- sqrt(mse)\n    mae &lt;- mean(abs(residuals))\n    \n    # R-squared\n    ss_residual &lt;- sum(residuals^2)\n    ss_total &lt;- sum((actual - mean(actual))^2)\n    r_squared &lt;- 1 - (ss_residual / ss_total)\n    \n    # è°ƒæ•´R-squared\n    p &lt;- 1  # ç‰¹å¾æ•°\n    r_squared_adj &lt;- 1 - (1 - r_squared) * (n - 1) / (n - p - 1)\n    \n    return(list(\n      MSE = mse,\n      RMSE = rmse,\n      MAE = mae,\n      R2 = r_squared,\n      R2_adj = r_squared_adj\n    ))\n  }\n  \n  metrics &lt;- calculate_regression_metrics(y_actual, y_pred)\n  \n  cat(\"å›å½’è¯„ä¼°æŒ‡æ ‡:\\n\")\n  cat(\"MSE (å‡æ–¹è¯¯å·®):\", round(metrics$MSE, 4), \"\\n\")\n  cat(\"RMSE (å‡æ–¹æ ¹è¯¯å·®):\", round(metrics$RMSE, 4), \"\\n\")\n  cat(\"MAE (å¹³å‡ç»å¯¹è¯¯å·®):\", round(metrics$MAE, 4), \"\\n\")\n  cat(\"RÂ² (å†³å®šç³»æ•°):\", round(metrics$R2, 4), \"\\n\")\n  cat(\"è°ƒæ•´RÂ²:\", round(metrics$R2_adj, 4), \"\\n\")\n  \n  # å¯è§†åŒ–é¢„æµ‹æ•ˆæœ\n  plot_data &lt;- data.frame(\n    Actual = y_actual,\n    Predicted = y_pred,\n    Perfect = y_actual  # å®Œç¾é¢„æµ‹çº¿\n  )\n  \n  library(ggplot2)\n  p &lt;- ggplot(plot_data, aes(x = Actual, y = Predicted)) +\n    geom_point(alpha = 0.6) +\n    geom_abline(slope = 1, intercept = 0, color = \"red\", linetype = \"dashed\") +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"blue\") +\n    labs(title = \"é¢„æµ‹å€¼ vs å®é™…å€¼\",\n         subtitle = paste(\"RÂ² =\", round(metrics$R2, 4)),\n         x = \"å®é™…å€¼\", y = \"é¢„æµ‹å€¼\") +\n    theme_minimal()\n  \n  print(p)\n  \n  return(metrics)\n}\n\n# è¿è¡Œå›å½’æŒ‡æ ‡æ¼”ç¤º\nregression_metrics &lt;- demonstrate_regression_metrics()\n\nå›å½’è¯„ä¼°æŒ‡æ ‡:\nMSE (å‡æ–¹è¯¯å·®): 0.3116 \nRMSE (å‡æ–¹æ ¹è¯¯å·®): 0.5582 \nMAE (å¹³å‡ç»å¯¹è¯¯å·®): 0.4523 \nRÂ² (å†³å®šç³»æ•°): 0.904 \nè°ƒæ•´RÂ²: 0.9031 \n\n\n\n\n\n\n\n\n1.4.2 åˆ†ç±»é—®é¢˜è¯„ä¼°æŒ‡æ ‡\næ··æ·†çŸ©é˜µçš„æ‰©å±•ï¼š å¯¹äºå¤šåˆ†ç±»é—®é¢˜ï¼Œæ··æ·†çŸ©é˜µæ˜¯ \\(K \\times K\\) çš„è¡¨æ ¼ã€‚\nå‡†ç¡®ç‡çš„å±€é™æ€§ï¼š - åœ¨ä¸å¹³è¡¡æ•°æ®ä¸­å¯èƒ½è¯¯å¯¼ - ä¾‹ï¼š99%è´Ÿä¾‹ï¼Œå…¨é¢„æµ‹è´Ÿç±»ä»æœ‰99%å‡†ç¡®ç‡\nç²¾ç¡®ç‡ä¸å¬å›ç‡çš„æƒè¡¡ï¼š - ç²¾ç¡®ç‡ï¼šé¢„æµ‹ä¸ºæ­£çš„æ ·æœ¬ä¸­å®é™…ä¸ºæ­£çš„æ¯”ä¾‹ - å¬å›ç‡ï¼šå®é™…ä¸ºæ­£çš„æ ·æœ¬ä¸­è¢«é¢„æµ‹ä¸ºæ­£çš„æ¯”ä¾‹ - é€šå¸¸å­˜åœ¨trade-offå…³ç³»\nFÎ²åˆ†æ•°ï¼š \\[\nF_\\beta = (1+\\beta^2) \\times \\frac{\\text{Precision} \\times \\text{Recall}}{(\\beta^2 \\times \\text{Precision}) + \\text{Recall}}\n\\] - \\(\\beta &gt; 1\\)ï¼šæ›´é‡è§†å¬å›ç‡ - \\(\\beta &lt; 1\\)ï¼šæ›´é‡è§†ç²¾ç¡®ç‡ - \\(\\beta = 1\\)ï¼šå¹³è¡¡ï¼ˆF1åˆ†æ•°ï¼‰\né©¬ä¿®æ–¯ç›¸å…³ç³»æ•°ï¼š \\[\nMCC = \\frac{TP \\times TN - FP \\times FN}{\\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}\n\\] é€‚ç”¨äºä¸å¹³è¡¡æ•°æ®çš„ç»¼åˆæŒ‡æ ‡ã€‚\n\nç¼–ç¨‹æ¼”ç¤ºï¼šåˆ†ç±»è¯„ä¼°æŒ‡æ ‡*\n\n\n# 1.4.2 åˆ†ç±»è¯„ä¼°æŒ‡æ ‡æ¼”ç¤º\ndemonstrate_classification_metrics &lt;- function() {\n  set.seed(123)\n  n &lt;- 1000\n  # ç”ŸæˆäºŒåˆ†ç±»æ•°æ®\n  feature1 &lt;- rnorm(n)\n  feature2 &lt;- rnorm(n)\n  \n  # ç”ŸæˆçœŸå®æ¦‚ç‡\n  true_prob &lt;- plogis(0.5 + 1.2 * feature1 - 0.8 * feature2)\n  true_labels &lt;- rbinom(n, 1, true_prob)\n  \n  # ç”Ÿæˆé¢„æµ‹æ¦‚ç‡ï¼ˆå¸¦æœ‰ä¸€äº›è¯¯å·®ï¼‰\n  pred_prob &lt;- true_prob + rnorm(n, 0, 0.1)\n  pred_prob &lt;- pmin(pmax(pred_prob, 0), 1)  # é™åˆ¶åœ¨[0,1]èŒƒå›´å†…\n  pred_labels &lt;- ifelse(pred_prob &gt; 0.5, 1, 0)\n  \n  # è®¡ç®—æ··æ·†çŸ©é˜µ\n  calculate_confusion_matrix &lt;- function(actual, predicted) {\n    tp &lt;- sum(actual == 1 & predicted == 1)\n    tn &lt;- sum(actual == 0 & predicted == 0)\n    fp &lt;- sum(actual == 0 & predicted == 1)\n    fn &lt;- sum(actual == 1 & predicted == 0)\n    \n    return(list(TP = tp, TN = tn, FP = fp, FN = fn))\n  }\n  \n  cm &lt;- calculate_confusion_matrix(true_labels, pred_labels)\n  \n  # è®¡ç®—å„ç§æŒ‡æ ‡\n  accuracy &lt;- (cm$TP + cm$TN) / n\n  precision &lt;- cm$TP / (cm$TP + cm$FP)\n  recall &lt;- cm$TP / (cm$TP + cm$FN)\n  f1_score &lt;- 2 * (precision * recall) / (precision + recall)\n  \n  # è®¡ç®—AUC\n  calculate_auc &lt;- function(actual, prob) {\n    # ç®€å•å®ç°AUCè®¡ç®—\n    positive_probs &lt;- prob[actual == 1]\n    negative_probs &lt;- prob[actual == 0]\n    \n    comparisons &lt;- 0\n    correct &lt;- 0\n    \n    # æŠ½æ ·è®¡ç®—ä»¥åŠ å¿«é€Ÿåº¦\n    n_sample &lt;- min(100, length(positive_probs), length(negative_probs))\n    pos_sample &lt;- sample(positive_probs, n_sample)\n    neg_sample &lt;- sample(negative_probs, n_sample)\n    \n    for (p in pos_sample) {\n      for (n in neg_sample) {\n        comparisons &lt;- comparisons + 1\n        if (p &gt; n) correct &lt;- correct + 1\n        else if (p == n) correct &lt;- correct + 0.5\n      }\n    }\n    \n    return(correct / comparisons)\n  }\n  \n  auc_score &lt;- calculate_auc(true_labels, pred_prob)\n  \n  cat(\"åˆ†ç±»è¯„ä¼°æŒ‡æ ‡:\\n\")\n  cat(\"å‡†ç¡®ç‡:\", round(accuracy, 4), \"\\n\")\n  cat(\"ç²¾ç¡®ç‡:\", round(precision, 4), \"\\n\")\n  cat(\"å¬å›ç‡:\", round(recall, 4), \"\\n\")\n  cat(\"F1åˆ†æ•°:\", round(f1_score, 4), \"\\n\")\n  cat(\"AUC:\", round(auc_score, 4), \"\\n\")\n  \n  # æ‰“å°æ··æ·†çŸ©é˜µ\n  cat(\"\\næ··æ·†çŸ©é˜µ:\\n\")\n  confusion_df &lt;- data.frame(\n    Actual_0 = c(cm$TN, cm$FN),\n    Actual_1 = c(cm$FP, cm$TP)\n  )\n  rownames(confusion_df) &lt;- c(\"Predicted_0\", \"Predicted_1\")\n  print(confusion_df)\n  \n  # å¯è§†åŒ–ROCæ›²çº¿\n  plot_roc_curve &lt;- function(actual, prob) {\n    thresholds &lt;- seq(0, 1, 0.01)\n    tpr &lt;- numeric(length(thresholds))\n    fpr &lt;- numeric(length(thresholds))\n    \n    for (i in 1:length(thresholds)) {\n      pred &lt;- ifelse(prob &gt; thresholds[i], 1, 0)\n      cm_temp &lt;- calculate_confusion_matrix(actual, pred)\n      tpr[i] &lt;- cm_temp$TP / (cm_temp$TP + cm_temp$FN)  # çœŸæ­£ç‡\n      fpr[i] &lt;- cm_temp$FP / (cm_temp$FP + cm_temp$TN)  # å‡æ­£ç‡\n    }\n    \n    roc_data &lt;- data.frame(FPR = fpr, TPR = tpr)\n    \n    ggplot(roc_data, aes(x = FPR, y = TPR)) +\n      geom_line(color = \"blue\", size = 1) +\n      geom_abline(slope = 1, intercept = 0, linetype = \"dashed\", color = \"gray\") +\n      labs(title = \"ROCæ›²çº¿\",\n           subtitle = paste(\"AUC =\", round(auc_score, 4)),\n           x = \"å‡æ­£ç‡ (FPR)\", y = \"çœŸæ­£ç‡ (TPR)\") +\n      theme_minimal() +\n      coord_equal()\n  }\n  \n  roc_plot &lt;- plot_roc_curve(true_labels, pred_prob)\n  print(roc_plot)\n  \n  return(list(\n    accuracy = accuracy,\n    precision = precision,\n    recall = recall,\n    f1_score = f1_score,\n    auc = auc_score,\n    confusion_matrix = cm\n  ))\n}\n\n# è¿è¡Œåˆ†ç±»æŒ‡æ ‡æ¼”ç¤º\nclassification_metrics &lt;- demonstrate_classification_metrics()\n\nåˆ†ç±»è¯„ä¼°æŒ‡æ ‡:\nå‡†ç¡®ç‡: 0.748 \nç²¾ç¡®ç‡: 0.779 \nå¬å›ç‡: 0.8126 \nF1åˆ†æ•°: 0.7955 \nAUC: 0.77 \n\næ··æ·†çŸ©é˜µ:\n            Actual_0 Actual_1\nPredicted_0      258      139\nPredicted_1      113      490\n\n\n\n\n\n\n\n\n1.4.3 ROCæ›²çº¿ä¸AUCæ›²çº¿\nROCæ›²çº¿çš„ç»˜åˆ¶ï¼š 1. è®¡ç®—ä¸åŒåˆ†ç±»é˜ˆå€¼ä¸‹çš„TPRå’ŒFPR 2. ä»¥FPRä¸ºæ¨ªè½´ï¼ŒTPRä¸ºçºµè½´ç»˜åˆ¶æ›²çº¿ 3. æ›²çº¿è¶Šé è¿‘å·¦ä¸Šè§’ï¼Œæ€§èƒ½è¶Šå¥½\nAUCçš„æ¦‚ç‡è§£é‡Šï¼š AUCç­‰äºéšæœºé€‰å–çš„æ­£æ ·æœ¬å¾—åˆ†é«˜äºéšæœºé€‰å–çš„è´Ÿæ ·æœ¬å¾—åˆ†çš„æ¦‚ç‡ã€‚\nAUCçš„ä¼˜åŠ¿ï¼š - ä¸åˆ†ç±»é˜ˆå€¼æ— å…³ - åæ˜ æ¨¡å‹æ•´ä½“æ’åºèƒ½åŠ› - é€‚ç”¨äºä¸å¹³è¡¡æ•°æ®\nAUCçš„å±€é™æ€§ï¼š - åªå…³æ³¨æ’åºï¼Œä¸å…³æ³¨å…·ä½“æ¦‚ç‡å€¼ - åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½è¿‡äºä¹è§‚\nç²¾ç¡®ç‡-å¬å›ç‡æ›²çº¿ï¼š åœ¨ä¸å¹³è¡¡æ•°æ®ä¸­é€šå¸¸æ¯”ROCæ›²çº¿æ›´æœ‰ä¿¡æ¯é‡ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#æ¨¡å‹é€‰æ‹©åŸåˆ™",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#æ¨¡å‹é€‰æ‹©åŸåˆ™",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "1.5 æ¨¡å‹é€‰æ‹©åŸåˆ™",
    "text": "1.5 æ¨¡å‹é€‰æ‹©åŸåˆ™\n1.5.1 å¥¥å¡å§†å‰ƒåˆ€åŸç†çš„ç»Ÿè®¡åŸºç¡€\nç®€çº¦æ€§åŸåˆ™ï¼š åœ¨åŒæ ·èƒ½å¤Ÿè§£é‡Šæ•°æ®çš„æ¨¡å‹ä¸­ï¼Œé€‰æ‹©æœ€ç®€å•çš„æ¨¡å‹ã€‚\næ•°å­¦å½¢å¼åŒ–ï¼š é€‰æ‹©ä½¿ä»¥ä¸‹ç›®æ ‡å‡½æ•°æœ€å°çš„æ¨¡å‹ï¼š \\[\n\\text{Objective} = \\text{æ‹Ÿåˆä¼˜åº¦} + \\lambda \\times \\text{æ¨¡å‹å¤æ‚åº¦}\n\\]\næ¨¡å‹å¤æ‚åº¦çš„åº¦é‡ï¼š - å‚æ•°ä¸ªæ•° - VCç»´ - æœ‰æ•ˆå‚æ•°ä¸ªæ•°\n1.5.2 ä¿¡æ¯å‡†åˆ™çš„è¯¦ç»†æ¨å¯¼\nAICçš„æ¨å¯¼ï¼š åŸºäºKullback-Leibleræ•£åº¦ï¼Œç›®æ ‡æ˜¯é€‰æ‹©æœ€æ¥è¿‘çœŸå®åˆ†å¸ƒçš„æ¨¡å‹ã€‚ \\[\nAIC = 2k - 2\\ln(\\hat{L})\n\\] å…¶ä¸­ï¼š - \\(k\\)ï¼šæ¨¡å‹å‚æ•°ä¸ªæ•° - \\(\\hat{L}\\)ï¼šæœ€å¤§ä¼¼ç„¶å€¼\nBICçš„æ¨å¯¼ï¼š åŸºäºè´å¶æ–¯å› å­ï¼Œåœ¨æ ·æœ¬é‡è¾ƒå¤§æ—¶çš„ä¸€è‡´æ€§é€‰æ‹©ã€‚ \\[\nBIC = \\ln(n)k - 2\\ln(\\hat{L})\n\\]\nAICcï¼š å°æ ·æœ¬ä¿®æ­£çš„AICï¼š \\[\nAICc = AIC + \\frac{2k(k+1)}{n-k-1}\n\\]\nä¿¡æ¯å‡†åˆ™çš„æ¯”è¾ƒï¼š\n\n\nå‡†åˆ™\nç›®æ ‡\nä¸€è‡´æ€§\næ•ˆç‡\n\n\n\nAIC\né¢„æµ‹ç²¾åº¦\nå¦\næ˜¯\n\n\nBIC\né€‰æ‹©çœŸå®æ¨¡å‹\næ˜¯\nå¦\n\n\nAICc\nå°æ ·æœ¬é¢„æµ‹\nå¦\næ˜¯\n\n\n1.5.3 å®é™…é€‰æ‹©ç­–ç•¥\nå¤šå‡†åˆ™ç»¼åˆè¯„ä¼°ï¼š\n\nè®¡ç®—å¤šä¸ªä¿¡æ¯å‡†åˆ™\nåˆ†æå­¦ä¹ æ›²çº¿\nè€ƒè™‘ä¸šåŠ¡çº¦æŸ\nè¯„ä¼°è®¡ç®—æˆæœ¬\n\né¢†åŸŸçŸ¥è¯†çš„ä½œç”¨ï¼š\n\nç†è§£æ•°æ®çš„ç”Ÿæˆæœºåˆ¶\nè€ƒè™‘ç‰¹å¾çš„ç‰©ç†æ„ä¹‰\nè¯„ä¼°æ¨¡å‹çš„å¯è§£é‡Šæ€§",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#è½¯ä»¶ä½¿ç”¨",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#è½¯ä»¶ä½¿ç”¨",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "1.6 è½¯ä»¶ä½¿ç”¨",
    "text": "1.6 è½¯ä»¶ä½¿ç”¨\næœ¬ä¹¦ä¸»è¦ä½¿ç”¨å¼€æºè½¯ä»¶Rã€Pythonã€‚\n16.1 Rè¯­è¨€\nR+Rstudioï¼Œä½¿ç”¨åˆ°çš„åŒ…(package)åŒ…æ‹¬knirã€tidyverseã€ggplot2ç­‰ï¼Œæ–‡ä»¶æ ¼å¼ä¸º.rmdï¼Œå¯ä»¥æ··ç¼–æ˜¾ç¤ºæ–‡æœ¬ã€ä»£ç å—ï¼ˆchunkï¼‰ã€ä»£ç è¿è¡Œç»“æœç­‰å„ç§æ ¼å¼å†…å®¹ï¼Œè¿›è¡Œäº¤äº’å¼çš„åˆ†æï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆhtmlã€docã€PDFã€PPTç­‰æ ¼å¼ï¼Œæ’°å†™å®éªŒæŠ¥å‘Šã€è®ºæ–‡ã€ä¹¦ç±ç­‰ã€‚\nå…¸å‹RåŒ…ç»“æ„\na_r_package/\nâ”œâ”€â”€ DESCRIPTION                    # ğŸ“‹ åŒ…çš„\"èº«ä»½è¯\"\nâ”‚   - Package: my_r_package        # åŒ…å\nâ”‚   - Version: 0.1.0               # ç‰ˆæœ¬å·\nâ”‚   - Title: åŒ…çš„åŠŸèƒ½æè¿°          # æ ‡é¢˜\nâ”‚   - Author: ä½œè€…ä¿¡æ¯             # ä½œè€…\nâ”‚   - Description: è¯¦ç»†æè¿°        # è¯¦ç»†æè¿°\nâ”‚   - License: MIT                 # è®¸å¯è¯\nâ”‚   - Imports: dplyr, ggplot2      # ä¾èµ–åŒ…\nâ”‚   - Suggests: testthat           # å»ºè®®ä¾èµ–\nâ”‚\nâ”œâ”€â”€ NAMESPACE                      # ğŸšª å‡½æ•°çš„\"é—¨å«\"\nâ”‚   - export(hello_world)         # å¯¼å‡ºå‡½æ•°ä¾›ç”¨æˆ·ä½¿ç”¨\nâ”‚   - import(dplyr)               # å¯¼å…¥ä¾èµ–åŒ…çš„å‡½æ•°\nâ”‚   - importFrom(ggplot2, aes)    # å¯¼å…¥ç‰¹å®šå‡½æ•°\nâ”‚\nâ”œâ”€â”€ R/                            # ğŸ’» æ ¸å¿ƒä»£ç ç›®å½•\nâ”‚   â”œâ”€â”€ hello.R                   # å‡½æ•°å®šä¹‰æ–‡ä»¶1\nâ”‚   â”‚   # å‡½æ•°å®šä¹‰\nâ”‚   â”‚   hello_world &lt;- function() {\nâ”‚   â”‚     print(\"Hello from R package!\")\nâ”‚   â”‚   }\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ data_processing.R         # å‡½æ•°å®šä¹‰æ–‡ä»¶2\nâ”‚   â”‚   clean_data &lt;- function(df) {\nâ”‚   â”‚     dplyr::filter(df, !is.na(value))\nâ”‚   â”‚   }\nâ”‚   â”‚\nâ”‚   â””â”€â”€ utils.R                   # å·¥å…·å‡½æ•°ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰\nâ”‚       internal_func &lt;- function() {\nâ”‚         # ä¸å¯¼å‡ºï¼Œä»…å†…éƒ¨ä½¿ç”¨\nâ”‚       }\nâ”‚\nâ”œâ”€â”€ man/                          # ğŸ“š æ–‡æ¡£ç›®å½•ï¼ˆ.Rdæ–‡ä»¶ï¼‰\nâ”‚   â”œâ”€â”€ hello_world.Rd            # å‡½æ•°çš„å¸®åŠ©æ–‡æ¡£\nâ”‚   â”‚   \\name{hello_world}\nâ”‚   â”‚   \\title{æ‰“æ‹›å‘¼å‡½æ•°}\nâ”‚   â”‚   \\description{è¯¦ç»†æè¿°}\nâ”‚   â”‚   \\usage{hello_world()}\nâ”‚   â”‚   \\examples{hello_world()}\nâ”‚   â”‚\nâ”‚   â””â”€â”€ my_r_package-package.Rd   # åŒ…çš„æ€»ä½“æ–‡æ¡£\nâ”‚\nâ”œâ”€â”€ tests/                        # ğŸ§ª æµ‹è¯•ç›®å½•\nâ”‚   â”œâ”€â”€ testthat/                 # testthatæµ‹è¯•æ¡†æ¶\nâ”‚   â”‚   â”œâ”€â”€ test-hello.R          # æµ‹è¯•æ–‡ä»¶\nâ”‚   â”‚   â”‚   test_that(\"hello works\", {\nâ”‚   â”‚   â”‚     expect_output(hello_world(), \"Hello\")\nâ”‚   â”‚   â”‚   })\nâ”‚   â”‚   â””â”€â”€ test-data.R\nâ”‚   â””â”€â”€ testthat.R                # æµ‹è¯•è¿è¡Œå™¨\nâ”‚\nâ”œâ”€â”€ vignettes/                    # ğŸ“– é•¿ç¯‡æ•™ç¨‹/æ¡ˆä¾‹\nâ”‚   â””â”€â”€ introduction.Rmd          # åŒ…çš„ä½¿ç”¨æ•™ç¨‹\nâ”‚\nâ”œâ”€â”€ data/                         # ğŸ“Š åŒ…å†…ç½®æ•°æ®é›†\nâ”‚   â”œâ”€â”€ sample_data.rda           # Ræ•°æ®æ–‡ä»¶\nâ”‚   â””â”€â”€ internal_data.rda         # å†…éƒ¨æ•°æ®\nâ”‚\nâ”œâ”€â”€ inst/                         # ğŸ å®‰è£…æ—¶åŒ…å«çš„æ–‡ä»¶\nâ”‚   â”œâ”€â”€ CITATION                  # å¼•ç”¨ä¿¡æ¯\nâ”‚   â”œâ”€â”€ extdata/                  # å¤–éƒ¨æ•°æ®ç¤ºä¾‹\nâ”‚   â””â”€â”€ templates/                # æ¨¡æ¿æ–‡ä»¶\nâ”‚\nâ””â”€â”€ .Rbuildignore                 # âŒ æ„å»ºæ—¶å¿½ç•¥çš„æ–‡ä»¶\nRæ•°æ®åˆ†æå…¸å‹é¡¹ç›®ç»“æ„\ndata_analysis_project/          # ğŸ“ˆ æ•°æ®åˆ†æé¡¹ç›®\nâ”œâ”€â”€ data/                       # ğŸ“Š æ•°æ®ç®¡ç†\nâ”‚   â”œâ”€â”€ raw/                    # åŸå§‹æ•°æ®ï¼ˆåªè¯»ï¼‰\nâ”‚   â”œâ”€â”€ processed/              # å¤„ç†åçš„æ•°æ®\nâ”‚   â””â”€â”€ external/               # å¤–éƒ¨æ•°æ®æº\nâ”‚\nâ”œâ”€â”€ R/                          # ğŸ’» Rä»£ç \nâ”‚   â”œâ”€â”€ 01_data_cleaning.R      # æ•°æ®æ¸…æ´—\nâ”‚   â”œâ”€â”€ 02_exploratory.R        # æ¢ç´¢æ€§åˆ†æ\nâ”‚   â”œâ”€â”€ 03_modeling.R           # å»ºæ¨¡\nâ”‚   â”œâ”€â”€ 04_visualization.R      # å¯è§†åŒ–\nâ”‚   â””â”€â”€ functions/              # è‡ªå®šä¹‰å‡½æ•°\nâ”‚       â”œâ”€â”€ utils.R\nâ”‚       â””â”€â”€ plotting_functions.R\nâ”‚\nâ”œâ”€â”€ analysis/                   # ğŸ“– åˆ†ææ–‡æ¡£\nâ”‚   â”œâ”€â”€ report.Rmd              # R MarkdownæŠ¥å‘Š\nâ”‚   â”œâ”€â”€ presentation.Rmd        # æ¼”ç¤ºæ–‡ç¨¿\nâ”‚   â””â”€â”€ dashboard/              # Shinyåº”ç”¨\nâ”‚\nâ”œâ”€â”€ outputs/                    # ğŸ¨ è¾“å‡ºç»“æœ\nâ”‚   â”œâ”€â”€ figures/                # ç”Ÿæˆçš„å›¾è¡¨\nâ”‚   â”œâ”€â”€ tables/                 # ç”Ÿæˆçš„è¡¨æ ¼\nâ”‚   â””â”€â”€ models/                 # ä¿å­˜çš„æ¨¡å‹\nâ”‚\nâ”œâ”€â”€ tests/                      # ğŸ§ª æµ‹è¯•\nâ”œâ”€â”€ references/                 # ğŸ“š å‚è€ƒæ–‡çŒ®/æ–‡æ¡£\nâ”œâ”€â”€ .Rprofile                   # ğŸ”§ Rå¯åŠ¨é…ç½®\nâ”œâ”€â”€ .Renviron                   # ğŸŒ ç¯å¢ƒå˜é‡\nâ””â”€â”€ data_analysis_project.Rproj # ğŸ  RStudioé¡¹ç›®æ–‡ä»¶\n16.2 Python\nä¾æ‰˜Anacondaå¹³å°ï¼Œè¯¥å¹³å°æ‰“åŒ…äº†pythonå’Œé‡è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ç¯å¢ƒçš„è®¾ç½®ï¼Œè‡ªå¸¦IDEåŒ…æ‹¬jupyter notebookã€jupyterlabã€pycharmç­‰ï¼Œä½¿ç”¨åˆ°çš„åº“ï¼ˆlibraryï¼‰åŒ…æ‹¬pandasã€numpyã€sklearnï¼Œç”±jupyter notebookç¼–è¯‘æ–‡ä»¶æ ¼å¼ä¸º.ipynbï¼Œå¯ä»¥å®ç°æ–‡æœ¬ã€ä»£ç å—ï¼ˆcellï¼‰ã€ä»£ç è¿è¡Œç»“æœã€ç»“æœåˆ†æç­‰æ··ç¼–ï¼Œè¿›è¡Œäº¤äº’å¼çš„åˆ†æï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆhtmlã€docã€PDFç­‰æ ¼å¼ã€‚\nPythonåŒ…ç»“æ„\na_python_package/\nâ”œâ”€â”€ pyproject.toml                    # ğŸ¯ ç°ä»£æ„å»ºé…ç½®ï¼ˆæ›¿ä»£setup.pyï¼‰\nâ”‚   [build-system]\nâ”‚   requires = [\"setuptools\", \"wheel\"]\nâ”‚   \nâ”‚   [project]\nâ”‚   name = \"my_python_package\"\nâ”‚   version = \"0.1.0\"\nâ”‚   dependencies = [\nâ”‚     \"numpy&gt;=1.20\",\nâ”‚     \"pandas&gt;=1.3\"\nâ”‚   ]\nâ”‚\nâ”œâ”€â”€ src/                              # ğŸ“ æºä»£ç ç›®å½•ï¼ˆæ¨èç»“æ„ï¼‰\nâ”‚   â””â”€â”€ my_python_package/           # åŒ…çš„ä¸»ç›®å½•\nâ”‚       â”œâ”€â”€ __init__.py              # ğŸšª åŒ…çš„å…¥å£ç‚¹\nâ”‚       â”‚   \"\"\"åŒ…çš„ä¸»æ¨¡å—\"\"\"\nâ”‚       â”‚   __version__ = \"0.1.0\"\nâ”‚       â”‚   __author__ = \"Your Name\"\nâ”‚       â”‚   \nâ”‚       â”‚   # å¯¼å…¥å…³é”®å‡½æ•°ï¼Œæ–¹ä¾¿ç”¨æˆ·è®¿é—®\nâ”‚       â”‚   from .core import (\nâ”‚       â”‚       normalize_data,\nâ”‚       â”‚       process_dataframe\nâ”‚       â”‚   )\nâ”‚       â”‚   \nâ”‚       â”‚   # ä¹Ÿå¯ä»¥ä½¿ç”¨ __all__ æ§åˆ¶å¯¼å…¥\nâ”‚       â”‚   __all__ = [\"normalize_data\", \"process_dataframe\"]\nâ”‚       â”‚\nâ”‚       â”œâ”€â”€ core.py                   # ğŸ’¼ æ ¸å¿ƒæ¨¡å—\nâ”‚       â”‚   \"\"\"æ ¸å¿ƒåŠŸèƒ½å®ç°\"\"\"\nâ”‚       â”‚   import numpy as np\nâ”‚       â”‚   import pandas as pd\nâ”‚       â”‚   \nâ”‚       â”‚   def normalize_data(x):\nâ”‚       â”‚       \"\"\"æ ‡å‡†åŒ–æ•°æ®\"\"\"\nâ”‚       â”‚       if not isinstance(x, (np.ndarray, list)):\nâ”‚       â”‚           raise TypeError(\"è¾“å…¥å¿…é¡»æ˜¯æ•°ç»„æˆ–åˆ—è¡¨\")\nâ”‚       â”‚       x = np.array(x)\nâ”‚       â”‚       return (x - np.mean(x)) / np.std(x)\nâ”‚       â”‚   \nâ”‚       â”‚   def _internal_helper():\nâ”‚       â”‚       \"\"\"å†…éƒ¨å‡½æ•°ï¼ˆä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼‰\"\"\"\nâ”‚       â”‚       return \"internal\"\nâ”‚       â”‚\nâ”‚       â”œâ”€â”€ utils/                    # ğŸ§° å­åŒ…/å·¥å…·æ¨¡å—ç›®å½•\nâ”‚       â”‚   â”œâ”€â”€ __init__.py\nâ”‚       â”‚   â”œâ”€â”€ file_utils.py\nâ”‚       â”‚   â””â”€â”€ math_utils.py\nâ”‚       â”‚\nâ”‚       â”œâ”€â”€ data/                     # ğŸ“Š æ•°æ®ç®¡ç†\nâ”‚       â”‚   â”œâ”€â”€ __init__.py\nâ”‚       â”‚   â”œâ”€â”€ datasets.py          # æ•°æ®é›†åŠ è½½å‡½æ•°\nâ”‚       â”‚   â””â”€â”€ constants.py         # å¸¸é‡å®šä¹‰\nâ”‚       â”‚\nâ”‚       â””â”€â”€ tests/                    # ğŸ§ª æµ‹è¯•ç›®å½•ï¼ˆå¯é€‰æ”¾è¿™é‡Œï¼‰\nâ”‚           â”œâ”€â”€ __init__.py\nâ”‚           â”œâ”€â”€ test_core.py\nâ”‚           â””â”€â”€ test_utils/\nâ”‚\nâ”œâ”€â”€ tests/                           # ğŸ§ª æµ‹è¯•ç›®å½•ï¼ˆæˆ–æ”¾å¤–é¢ï¼‰\nâ”‚   â”œâ”€â”€ test_core.py\nâ”‚   â”‚   def test_normalize():\nâ”‚   â”‚       from src.my_python_package.core import normalize_data\nâ”‚   â”‚       result = normalize_data([1, 2, 3])\nâ”‚   â”‚       assert np.allclose(result.mean(), 0)\nâ”‚   â”‚\nâ”‚   â””â”€â”€ conftest.py                  # pytesté…ç½®\nâ”‚\nâ”œâ”€â”€ docs/                            # ğŸ“š æ–‡æ¡£\nâ”‚   â”œâ”€â”€ conf.py                      # Sphinxé…ç½®\nâ”‚   â”œâ”€â”€ index.rst                    # æ–‡æ¡£é¦–é¡µ\nâ”‚   â””â”€â”€ api.rst                      # APIæ–‡æ¡£\nâ”‚\nâ”œâ”€â”€ examples/                        # ğŸš€ ä½¿ç”¨ç¤ºä¾‹\nâ”‚   â”œâ”€â”€ basic_usage.ipynb            # Jupyterç¤ºä¾‹\nâ”‚   â””â”€â”€ advanced_demo.py\nâ”‚\nâ”œâ”€â”€ .github/                         # ğŸ¤– GitHubé…ç½®\nâ”‚   â”œâ”€â”€ workflows/\nâ”‚   â”‚   â””â”€â”€ ci.yml                   # æŒç»­é›†æˆ\nâ”‚   â””â”€â”€ ISSUE_TEMPLATE/              # Issueæ¨¡æ¿\nâ”‚\nâ”œâ”€â”€ README.md                        # ğŸ“– é¡¹ç›®è¯´æ˜\nâ”œâ”€â”€ LICENSE                          # âš–ï¸ è®¸å¯è¯\nâ”œâ”€â”€ requirements.txt                 # ğŸ“¦ ä¾èµ–åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰\nâ””â”€â”€ setup.cfg                        # âš™ï¸ ä¼ ç»Ÿé…ç½®ï¼ˆå…¼å®¹æ€§ï¼‰\nPythonæ•°æ®åˆ†æé¡¹ç›®ç»“æ„\nmy_project/                     # ğŸ¤– æœºå™¨å­¦ä¹ é¡¹ç›®\nâ”œâ”€â”€ src/                        # ğŸ’» æºä»£ç \nâ”‚   â”œâ”€â”€ data/                   # æ•°æ®æ¨¡å—\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ make_dataset.py     # æ•°æ®å‡†å¤‡\nâ”‚   â”‚   â””â”€â”€ preprocessing.py    # é¢„å¤„ç†\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ features/               # ç‰¹å¾å·¥ç¨‹\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ build_features.py\nâ”‚   â”‚   â””â”€â”€ selection.py\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ models/                 # æ¨¡å‹\nâ”‚   â”‚   â”œâ”€â”€ __init__.py\nâ”‚   â”‚   â”œâ”€â”€ train_model.py\nâ”‚   â”‚   â””â”€â”€ predict_model.py\nâ”‚   â”‚\nâ”‚   â””â”€â”€ visualization/          # å¯è§†åŒ–\nâ”‚       â”œâ”€â”€ __init__.py\nâ”‚       â””â”€â”€ plot_results.py\nâ”‚\nâ”œâ”€â”€ notebooks/                  # ğŸ““ Jupyterç¬”è®°æœ¬\nâ”‚   â”œâ”€â”€ 01_exploratory.ipynb    # æ¢ç´¢æ€§åˆ†æ\nâ”‚   â”œâ”€â”€ 02_feature_engineering.ipynb\nâ”‚   â””â”€â”€ 03_model_training.ipynb\nâ”‚\nâ”œâ”€â”€ data/                       # ğŸ“Š æ•°æ®\nâ”‚   â”œâ”€â”€ raw/                    # åŸå§‹æ•°æ®\nâ”‚   â”œâ”€â”€ interim/                # ä¸­é—´æ•°æ®\nâ”‚   â””â”€â”€ processed/              # å¤„ç†åçš„æ•°æ®\nâ”‚\nâ”œâ”€â”€ models/                     # ğŸ’¾ æ¨¡å‹å­˜å‚¨\nâ”‚   â”œâ”€â”€ trained_models/\nâ”‚   â””â”€â”€ model_metrics.json\nâ”‚\nâ”œâ”€â”€ reports/                    # ğŸ“„ æŠ¥å‘Š\nâ”‚   â”œâ”€â”€ figures/                # å›¾è¡¨\nâ”‚   â””â”€â”€ final_report.md\nâ”‚\nâ”œâ”€â”€ tests/                      # ğŸ§ª æµ‹è¯•\nâ”œâ”€â”€ configs/                    # âš™ï¸ é…ç½®æ–‡ä»¶\nâ”‚   â”œâ”€â”€ data_config.yaml\nâ”‚   â””â”€â”€ model_config.yaml\nâ”‚\nâ”œâ”€â”€ requirements.txt            # ğŸ“¦ ä¾èµ–\nâ”œâ”€â”€ setup.py                    # ğŸ—ï¸ å®‰è£…é…ç½®\nâ”œâ”€â”€ pyproject.toml              # ğŸ¯ ç°ä»£é…ç½®\nâ”œâ”€â”€ Dockerfile                  # ğŸ³ å®¹å™¨åŒ–\nâ””â”€â”€ README.md                   # ğŸ“– è¯´æ˜æ–‡æ¡£\n1.6.3 å­¦ä¹ å·¥å…·å¹³å°æ­å»º\nç»Ÿè®¡å­¦ä¸“ä¸šçš„åŒå­¦ï¼Œå¯ä»¥è€ƒè™‘R+Rtools+Rstudioï¼Œä½¿ç”¨Rstudioä½œä¸ºåˆ†æå¹³å°ï¼Œæ–‡ä»¶æ ¼å¼ä¸ºRMDï¼Œå¦‚æœæƒ³æ··åˆPythonä½¿ç”¨ï¼Œå¯ä»¥åŠ è½½åŒ…reticulateï¼Œè¿æ¥è°ƒç”¨pythonä½¿ç”¨ã€‚\né¢å‘æœºå™¨å­¦ä¹ çš„åŒå­¦ï¼Œåº”è¯¥ä»¥Pythonä¸ºä¸»ï¼Œå­¦ä¹ ã€ç¬”è®°ã€æŠ¥å‘Šã€ä½œä¸šç­‰è€ƒè™‘Anacondaé‡Œé¢çš„IDEå·¥å…·jupyter notebookï¼Œæ–‡ä»¶æ ¼å¼ä¸ºipynbï¼Œæˆ–è€…è€ƒè™‘ä½¿ç”¨jupyterlabã€‚\né¢å‘å·¥ç¨‹å¼€å‘ã€é¡¹ç›®ç®¡ç†çš„åŒå­¦ï¼Œè€ƒè™‘ä½¿ç”¨VScodeï¼Œå¦‚æœå·¥ä½œåå‘äºæ•°æ®ç§‘å­¦ï¼Œå¯ä»¥ä½¿ç”¨Positrenï¼Œæ˜¯ä¸€ä¸ªç±»ä¼¼vscodeçš„æ•°æ®ç§‘å­¦å®šåˆ¶ç‰ˆï¼Œå¯ä»¥äº¤å‰è°ƒç”¨Rã€Pythonã€Juliaç­‰è¯­è¨€è¿›è¡Œæ··åˆç¼–ç¨‹ï¼Œé›†æˆgitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶å’Œå‘å¸ƒï¼Œæœ¬ä¹¦å³ä½¿ç”¨Positrenç¼–å†™ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#ç»¼åˆæ¡ˆä¾‹",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#ç»¼åˆæ¡ˆä¾‹",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "1.7 ç»¼åˆæ¡ˆä¾‹",
    "text": "1.7 ç»¼åˆæ¡ˆä¾‹\n1.7.1 mtcarsæ•°æ®é›†åˆ†æï¼šRè¯­è¨€å®ç°\n\nanalyze_mtcars_dataset &lt;- function() {\n  # åŠ è½½æ•°æ®\n  data(mtcars)\n  cat(\"mtcarsæ•°æ®é›†åŸºæœ¬ä¿¡æ¯:\\n\")\n  cat(\"æ ·æœ¬æ•°:\", nrow(mtcars), \"\\n\")\n  cat(\"å˜é‡æ•°:\", ncol(mtcars), \"\\n\")\n  cat(\"\\nå˜é‡åç§°:\\n\")\n  print(names(mtcars))\n  \n  # æ•°æ®æ¦‚è§ˆ\n  cat(\"\\næ•°æ®æ¦‚è§ˆ:\\n\")\n  print(summary(mtcars))\n  \n  # æ¢ç´¢æ€§æ•°æ®åˆ†æ\n  library(ggplot2)\n  library(patchwork)\n  \n  # ç›®æ ‡å˜é‡ï¼šmpgï¼ˆæ¯åŠ ä»‘è¡Œé©¶è‹±é‡Œæ•°ï¼‰\n  p1 &lt;- ggplot(mtcars, aes(x = mpg)) +\n    geom_histogram(bins = 15, fill = \"steelblue\", alpha = 0.5) +\n    labs(title = \"MPGåˆ†å¸ƒ\", x = \"MPG\", y = \"é¢‘æ•°\") +\n    theme_minimal()\n  \n  p2 &lt;- ggplot(mtcars, aes(x = wt, y = mpg)) +\n    geom_point(alpha = 0.7) +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"red\") +\n    labs(title = \"è½¦é‡ä¸MPGå…³ç³»\", x = \"é‡é‡\", y = \"MPG\") +\n    theme_minimal()\n  \n  p3 &lt;- ggplot(mtcars, aes(x = factor(cyl), y = mpg)) +\n    geom_boxplot(fill = \"lightgreen\", alpha = 0.7) +\n    labs(title = \"æ°”ç¼¸æ•°ä¸MPGå…³ç³»\", x = \"æ°”ç¼¸æ•°\", y = \"MPG\") +\n    theme_minimal()\n  \n  # ç»„åˆå›¾å½¢\n  combined_plot &lt;- (p1 | p2 | p3)\n  print(combined_plot)\n  \n  # æ•°æ®åˆ’åˆ†\n  set.seed(123)\n  train_indices &lt;- sample(1:nrow(mtcars), 0.7 * nrow(mtcars))\n  test_indices &lt;- setdiff(1:nrow(mtcars), train_indices)\n  \n  cat(\"\\næ•°æ®åˆ’åˆ†ç»“æœ:\\n\")\n  cat(\"è®­ç»ƒé›†å¤§å°:\", length(train_indices), \"\\n\")\n  cat(\"æµ‹è¯•é›†å¤§å°:\", length(test_indices), \"\\n\")\n  \n  # è®­ç»ƒä¸åŒå¤æ‚åº¦çš„æ¨¡å‹\n  models &lt;- list()\n  \n  # ç®€å•æ¨¡å‹\n  models[[\"simple\"]] &lt;- lm(mpg ~ wt, data = mtcars[train_indices, ])\n  \n  # ä¸­ç­‰å¤æ‚åº¦æ¨¡å‹\n  models[[\"medium\"]] &lt;- lm(mpg ~ wt + cyl + hp, data = mtcars[train_indices, ])\n  \n  # å¤æ‚æ¨¡å‹\n  models[[\"complex\"]] &lt;- lm(mpg ~ wt + cyl + hp + disp + drat + qsec, \n                           data = mtcars[train_indices, ])\n  \n  # è¯„ä¼°æ¨¡å‹æ€§èƒ½\n  evaluate_model &lt;- function(model, test_data) {\n    predictions &lt;- predict(model, newdata = test_data)\n    actual &lt;- test_data$mpg\n    \n    mse &lt;- mean((actual - predictions)^2)\n    rmse &lt;- sqrt(mse)\n    mae &lt;- mean(abs(actual - predictions))\n    r2 &lt;- 1 - sum((actual - predictions)^2) / sum((actual - mean(actual))^2)\n    \n    return(list(MSE = mse, RMSE = rmse, MAE = mae, R2 = r2))\n  }\n  \n  # æ¯”è¾ƒæ‰€æœ‰æ¨¡å‹\n  test_data &lt;- mtcars[test_indices, ]\n  performance &lt;- data.frame()\n  \n  for (model_name in names(models)) {\n    model &lt;- models[[model_name]]\n    perf &lt;- evaluate_model(model, test_data)\n    \n    performance &lt;- rbind(performance, data.frame(\n      Model = model_name,\n      Parameters = length(coef(model)),\n      MSE = perf$MSE,\n      RMSE = perf$RMSE,\n      MAE = perf$MAE,\n      R2 = perf$R2\n    ))\n  }\n  \n  cat(\"\\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\\n\")\n  print(performance)\n  \n  # äº¤å‰éªŒè¯æ¯”è¾ƒ\n  library(mlr3)\n  library(mlr3verse)\n  \n  # åˆ›å»ºä»»åŠ¡\n  mtcars_task &lt;- as_task_regr(mtcars[, c(\"mpg\", \"wt\", \"cyl\", \"hp\", \"disp\", \"drat\", \"qsec\")], \n                             target = \"mpg\", id = \"mtcars\")\n  \n  # å®šä¹‰å­¦ä¹ å™¨\n  learners &lt;- list(\n    lrn(\"regr.lm\", id = \"simple_lm\"),\n    lrn(\"regr.rpart\", id = \"tree\"),\n    lrn(\"regr.kknn\", id = \"knn\")\n  )\n  \n  # äº¤å‰éªŒè¯\n  resampling &lt;- rsmp(\"cv\", folds = 5)\n  \n  cv_results &lt;- data.frame()\n  for (learner in learners) {\n    rr &lt;- resample(mtcars_task, learner, resampling)\n    cv_results &lt;- rbind(cv_results, data.frame(\n      Model = learner$id,\n      CV_RMSE = sqrt(rr$aggregate(msr(\"regr.mse\"))),\n      CV_MAE = rr$aggregate(msr(\"regr.mae\")),\n      CV_R2 = rr$aggregate(msr(\"regr.rsq\"))\n    ))\n  }\n  \n  cat(\"\\näº¤å‰éªŒè¯ç»“æœ:\\n\")\n  print(cv_results)\n  \n  # è¿‡æ‹Ÿåˆåˆ†æ\n  analyze_overfitting &lt;- function() {\n    train_errors &lt;- numeric(3)\n    test_errors &lt;- numeric(3)\n    model_names &lt;- c(\"simple\", \"medium\", \"complex\")\n    \n    for (i in 1:3) {\n      model &lt;- models[[model_names[i]]]\n      \n      # è®­ç»ƒè¯¯å·®\n      train_pred &lt;- predict(model, newdata = mtcars[train_indices, ])\n      train_errors[i] &lt;- mean((mtcars$mpg[train_indices] - train_pred)^2)\n      \n      # æµ‹è¯•è¯¯å·®\n      test_pred &lt;- predict(model, newdata = test_data)\n      test_errors[i] &lt;- mean((test_data$mpg - test_pred)^2)\n    }\n    \n    overfitting_data &lt;- data.frame(\n      Model = model_names,\n      Train_MSE = train_errors,\n      Test_MSE = test_errors,\n      Overfitting_Gap = test_errors - train_errors\n    )\n    \n    cat(\"\\nè¿‡æ‹Ÿåˆåˆ†æ:\\n\")\n    print(overfitting_data)\n    \n    # å¯è§†åŒ–è¿‡æ‹Ÿåˆç°è±¡\n    p &lt;- ggplot(overfitting_data, aes(x = Model)) +\n      geom_line(aes(y = Train_MSE, color = \"è®­ç»ƒè¯¯å·®\", group = 1), size = 1) +\n      geom_line(aes(y = Test_MSE, color = \"æµ‹è¯•è¯¯å·®\", group = 1), size = 1) +\n      geom_point(aes(y = Train_MSE, color = \"è®­ç»ƒè¯¯å·®\"), size = 3) +\n      geom_point(aes(y = Test_MSE, color = \"æµ‹è¯•è¯¯å·®\"), size = 3) +\n      labs(title = \"è¿‡æ‹Ÿåˆåˆ†æï¼šè®­ç»ƒè¯¯å·® vs æµ‹è¯•è¯¯å·®\",\n           x = \"æ¨¡å‹å¤æ‚åº¦\", y = \"å‡æ–¹è¯¯å·® (MSE)\",\n           color = \"è¯¯å·®ç±»å‹\") +\n      theme_minimal() +\n      scale_color_manual(values = c(\"è®­ç»ƒè¯¯å·®\" = \"blue\", \"æµ‹è¯•è¯¯å·®\" = \"red\"))\n    \n    print(p)\n    \n    return(overfitting_data)\n  }\n  \n  overfitting_analysis &lt;- analyze_overfitting()\n  \n  return(list(\n    performance = performance,\n    cv_results = cv_results,\n    overfitting_analysis = overfitting_analysis,\n    models = models\n  ))\n}\n\n# è¿è¡Œç»¼åˆæ¡ˆä¾‹åˆ†æ\nmtcars_analysis &lt;- analyze_mtcars_dataset()\n\nmtcarsæ•°æ®é›†åŸºæœ¬ä¿¡æ¯:\næ ·æœ¬æ•°: 32 \nå˜é‡æ•°: 11 \n\nå˜é‡åç§°:\n [1] \"mpg\"  \"cyl\"  \"disp\" \"hp\"   \"drat\" \"wt\"   \"qsec\" \"vs\"   \"am\"   \"gear\"\n[11] \"carb\"\n\næ•°æ®æ¦‚è§ˆ:\n      mpg             cyl             disp             hp       \n Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  \n 1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  \n Median :19.20   Median :6.000   Median :196.3   Median :123.0  \n Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  \n 3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  \n Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  \n      drat             wt             qsec             vs        \n Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  \n 1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  \n Median :3.695   Median :3.325   Median :17.71   Median :0.0000  \n Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  \n 3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  \n Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  \n       am              gear            carb      \n Min.   :0.0000   Min.   :3.000   Min.   :1.000  \n 1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  \n Median :0.0000   Median :4.000   Median :2.000  \n Mean   :0.4062   Mean   :3.688   Mean   :2.812  \n 3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  \n Max.   :1.0000   Max.   :5.000   Max.   :8.000  \n\n\n\n\n\n\n\n\n\næ•°æ®åˆ’åˆ†ç»“æœ:\nè®­ç»ƒé›†å¤§å°: 22 \næµ‹è¯•é›†å¤§å°: 10 \n\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n    Model Parameters      MSE     RMSE      MAE        R2\n1  simple          2 4.567618 2.137199 1.845953 0.6379045\n2  medium          4 5.152415 2.269893 1.877027 0.5915450\n3 complex          7 5.345615 2.312059 1.765717 0.5762291\n\näº¤å‰éªŒè¯ç»“æœ:\n              Model  CV_RMSE   CV_MAE      CV_R2\nregr.mse  simple_lm 2.871556 2.279431  0.7249341\nregr.mse1      tree 4.899379 3.895609 -0.2874332\nregr.mse2       knn 2.723761 2.179108  0.6664141\n\nè¿‡æ‹Ÿåˆåˆ†æ:\n    Model Train_MSE Test_MSE Overfitting_Gap\n1  simple 10.762613 4.567618     -6.19499560\n2  medium  5.962236 5.152415     -0.80982161\n3 complex  5.436092 5.345615     -0.09047663\n\n\n\n\n\n\n\n\n1.7.2 mtcarsæ•°æ®é›†åˆ†æï¼šPythonè¯­è¨€å®ç°\n\n# mtcarsæ•°æ®é›†åˆ†æ - Pythonç‰ˆæœ¬\ndef analyze_mtcars_python():\n    import pandas as pd\n    import numpy as np\n    import matplotlib\n    matplotlib.rc(\"font\",family=\"Microsoft YaHei\")\n    import matplotlib.pyplot as plt\n    import seaborn as sns\n    from sklearn.model_selection import train_test_split, cross_val_score\n    from sklearn.linear_model import LinearRegression\n    from sklearn.tree import DecisionTreeRegressor\n    from sklearn.neighbors import KNeighborsRegressor\n    from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score\n    from sklearn.preprocessing import StandardScaler\n    \n    # åŠ è½½mtcarsæ•°æ®é›†\n    try:\n        # å°è¯•ä»åœ¨çº¿æºåŠ è½½\n        url = \"https://raw.githubusercontent.com/plotly/datasets/master/mtcars.csv\"\n        mtcars = pd.read_csv(url)\n    except:\n        # å¦‚æœç½‘ç»œä¸å¯ç”¨ï¼Œä½¿ç”¨å†…ç½®æ•°æ®é›†æˆ–åˆ›å»ºæ¨¡æ‹Ÿæ•°æ®\n        print(\"ç½‘ç»œæ•°æ®åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®\")\n        np.random.seed(42)\n        n = 32\n        mtcars = pd.DataFrame({\n            'mpg': np.random.normal(20, 6, n),\n            'cyl': np.random.choice([4, 6, 8], n),\n            'disp': np.random.normal(200, 100, n),\n            'hp': np.random.normal(150, 50, n),\n            'wt': np.random.normal(3, 1, n),\n            'qsec': np.random.normal(18, 2, n)\n        })\n    \n    print(\"mtcarsæ•°æ®é›†åŸºæœ¬ä¿¡æ¯:\")\n    print(f\"æ ·æœ¬æ•°: {mtcars.shape[0]}\")\n    print(f\"å˜é‡æ•°: {mtcars.shape[1]}\")\n    print(\"\\næ•°æ®æ¦‚è§ˆ:\")\n    print(mtcars.describe())\n    \n    # æ•°æ®å¯è§†åŒ–\n    fig, axes = plt.subplots(2, 2, figsize=(12, 10))\n    \n    # MPGåˆ†å¸ƒ\n    axes[0,0].hist(mtcars['mpg'], bins=10, alpha=0.7, color='steelblue')\n    axes[0,0].set_title('MPGåˆ†å¸ƒ')\n    axes[0,0].set_xlabel('MPG')\n    axes[0,0].set_ylabel('é¢‘æ•°')\n    \n    # è½¦é‡ä¸MPGå…³ç³»\n    axes[0,1].scatter(mtcars['wt'], mtcars['mpg'], alpha=0.7)\n    z = np.polyfit(mtcars['wt'], mtcars['mpg'], 1)\n    p = np.poly1d(z)\n    axes[0,1].plot(mtcars['wt'], p(mtcars['wt']), \"r--\", alpha=0.8)\n    axes[0,1].set_title('è½¦é‡ä¸MPGå…³ç³»')\n    axes[0,1].set_xlabel('é‡é‡')\n    axes[0,1].set_ylabel('MPG')\n    \n    # é©¬åŠ›ä¸MPGå…³ç³»\n    axes[1,0].scatter(mtcars['hp'], mtcars['mpg'], alpha=0.7)\n    z = np.polyfit(mtcars['hp'], mtcars['mpg'], 1)\n    p = np.poly1d(z)\n    axes[1,0].plot(mtcars['hp'], p(mtcars['hp']), \"r--\", alpha=0.8)\n    axes[1,0].set_title('é©¬åŠ›ä¸MPGå…³ç³»')\n    axes[1,0].set_xlabel('é©¬åŠ›')\n    axes[1,0].set_ylabel('MPG')\n    \n    # æ°”ç¼¸æ•°ä¸MPGå…³ç³»\n    mtcars.boxplot(column='mpg', by='cyl', ax=axes[1,1])\n    axes[1,1].set_title('æ°”ç¼¸æ•°ä¸MPGå…³ç³»')\n    axes[1,1].set_xlabel('æ°”ç¼¸æ•°')\n    \n    plt.tight_layout()\n    plt.show()\n    \n    # å‡†å¤‡æ•°æ®\n    X = mtcars[['wt', 'cyl', 'hp', 'disp', 'qsec']]\n    y = mtcars['mpg']\n    \n    # æ•°æ®åˆ’åˆ†\n    X_train, X_test, y_train, y_test = train_test_split(\n        X, y, test_size=0.3, random_state=42\n    )\n    \n    print(f\"\\næ•°æ®åˆ’åˆ†ç»“æœ:\")\n    print(f\"è®­ç»ƒé›†å¤§å°: {X_train.shape[0]}\")\n    print(f\"æµ‹è¯•é›†å¤§å°: {X_test.shape[0]}\")\n    \n    # è®­ç»ƒä¸åŒæ¨¡å‹\n    models = {\n        'Linear Regression': LinearRegression(),\n        'Decision Tree': DecisionTreeRegressor(random_state=42),\n        'K-Neighbors': KNeighborsRegressor()\n    }\n    \n    # è¯„ä¼°å‡½æ•°\n    def evaluate_model(model, X_train, X_test, y_train, y_test):\n        model.fit(X_train, y_train)\n        y_pred_train = model.predict(X_train)\n        y_pred_test = model.predict(X_test)\n        \n        metrics = {\n            'Train_MSE': mean_squared_error(y_train, y_pred_train),\n            'Test_MSE': mean_squared_error(y_test, y_pred_test),\n            'Train_R2': r2_score(y_train, y_pred_train),\n            'Test_R2': r2_score(y_test, y_pred_test),\n            'Overfitting_Gap': mean_squared_error(y_test, y_pred_test) - mean_squared_error(y_train, y_pred_train)\n        }\n        return metrics\n    \n    # æ¯”è¾ƒæ¨¡å‹æ€§èƒ½\n    results = []\n    for name, model in models.items():\n        metrics = evaluate_model(model, X_train, X_test, y_train, y_test)\n        results.append({\n            'Model': name,\n            **metrics\n        })\n    \n    results_df = pd.DataFrame(results)\n    print(\"\\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\")\n    print(results_df)\n    \n    # äº¤å‰éªŒè¯\n    print(\"\\näº¤å‰éªŒè¯ç»“æœ (5æŠ˜):\")\n    cv_results = []\n    for name, model in models.items():\n        cv_scores = cross_val_score(model, X, y, cv=5, scoring='neg_mean_squared_error')\n        cv_rmse = np.sqrt(-cv_scores)\n        cv_results.append({\n            'Model': name,\n            'CV_RMSE_mean': cv_rmse.mean(),\n            'CV_RMSE_std': cv_rmse.std()\n        })\n    \n    cv_df = pd.DataFrame(cv_results)\n    print(cv_df)\n    \n    # å¯è§†åŒ–ç»“æœ\n    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 5))\n    \n    # è¿‡æ‹Ÿåˆåˆ†æ\n    x_pos = np.arange(len(models))\n    width = 0.35\n    \n    train_mse = results_df['Train_MSE'].values\n    test_mse = results_df['Test_MSE'].values\n    \n    ax1.bar(x_pos - width/2, train_mse, width, label='è®­ç»ƒMSE', alpha=0.7)\n    ax1.bar(x_pos + width/2, test_mse, width, label='æµ‹è¯•MSE', alpha=0.7)\n    ax1.set_xlabel('æ¨¡å‹')\n    ax1.set_ylabel('å‡æ–¹è¯¯å·® (MSE)')\n    ax1.set_title('è¿‡æ‹Ÿåˆåˆ†æ')\n    ax1.set_xticks(x_pos)\n    ax1.set_xticklabels(results_df['Model'])\n    ax1.legend()\n    \n    # RÂ²æ¯”è¾ƒ\n    train_r2 = results_df['Train_R2'].values\n    test_r2 = results_df['Test_R2'].values\n    \n    ax2.bar(x_pos - width/2, train_r2, width, label='è®­ç»ƒRÂ²', alpha=0.7)\n    ax2.bar(x_pos + width/2, test_r2, width, label='æµ‹è¯•RÂ²', alpha=0.7)\n    ax2.set_xlabel('æ¨¡å‹')\n    ax2.set_ylabel('RÂ²')\n    ax2.set_title('æ‹Ÿåˆä¼˜åº¦æ¯”è¾ƒ')\n    ax2.set_xticks(x_pos)\n    ax2.set_xticklabels(results_df['Model'])\n    ax2.legend()\n    \n    plt.tight_layout()\n    plt.show()\n    \n    return {\n        'performance': results_df,\n        'cv_results': cv_df,\n        'data': mtcars\n    }\n\n# è¿è¡ŒPythonåˆ†æ\nmtcars_python_analysis = analyze_mtcars_python()\n\n1.7.3 æ¡ˆä¾‹æ€»ç»“ä¸æœ€ä½³å®è·µ\nå…³é”®å‘ç°æ€»ç»“\n\nè¿‡æ‹ŸåˆéªŒè¯ï¼šåœ¨mtcarsæ•°æ®é›†ä¸­ï¼Œå¤æ‚æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°æ›´å¥½ï¼Œä½†åœ¨æµ‹è¯•é›†ä¸Šå¯èƒ½è¡¨ç°æ›´å·®\näº¤å‰éªŒè¯ä»·å€¼ï¼šç›¸æ¯”å•ä¸€åˆ’åˆ†ï¼Œäº¤å‰éªŒè¯æä¾›æ›´ç¨³å®šçš„æ€§èƒ½ä¼°è®¡\næ¨¡å‹é€‰æ‹©ï¼šä¸åŒè¯„ä¼°æŒ‡æ ‡å¯èƒ½é€‰æ‹©ä¸åŒçš„æœ€ä¼˜æ¨¡å‹\næ•°æ®è´¨é‡ï¼šçœŸå®æ•°æ®é›†é€šå¸¸åŒ…å«å¤æ‚çš„å˜é‡å…³ç³»å’Œæ•°æ®é—®é¢˜\n\næœ€ä½³å®è·µå»ºè®®\n\nå§‹ç»ˆä½¿ç”¨äº¤å‰éªŒè¯ï¼šç‰¹åˆ«æ˜¯å¯¹äºå°æ•°æ®é›†\nç›‘æ§è¿‡æ‹Ÿåˆï¼šæ¯”è¾ƒè®­ç»ƒå’Œæµ‹è¯•æ€§èƒ½çš„å·®å¼‚\nå¤šæŒ‡æ ‡è¯„ä¼°ï¼šä½¿ç”¨å¤šä¸ªè¯„ä¼°æŒ‡æ ‡å…¨é¢è¯„ä»·æ¨¡å‹\nç†è§£æ•°æ®ï¼šè¿›è¡Œå……åˆ†çš„æ¢ç´¢æ€§æ•°æ®åˆ†æ",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#æœ¬ç« æ€»ç»“",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒæ¦‚å¿µå›é¡¾\n\né¢„æµ‹å»ºæ¨¡ç±»å‹ï¼šå›å½’åˆ†æé¢„æµ‹è¿ç»­å€¼ï¼Œåˆ†ç±»åˆ†æé¢„æµ‹ç¦»æ•£ç±»åˆ«\nè¿‡æ‹Ÿåˆç°è±¡ï¼šæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°è¿‡å¥½ï¼Œä½†åœ¨æ–°æ•°æ®ä¸Šè¡¨ç°å·®\nåå·®-æ–¹å·®æƒè¡¡ï¼šæ¨¡å‹å¤æ‚åº¦éœ€è¦åœ¨åå·®å’Œæ–¹å·®ä¹‹é—´å–å¾—å¹³è¡¡\næ•°æ®åˆ’åˆ†ï¼šè®­ç»ƒé›†ç”¨äºå‚æ•°ä¼°è®¡ï¼ŒéªŒè¯é›†ç”¨äºæ¨¡å‹é€‰æ‹©ï¼Œæµ‹è¯•é›†ç”¨äºæœ€ç»ˆè¯„ä¼°\näº¤å‰éªŒè¯ï¼škæŠ˜äº¤å‰éªŒè¯æä¾›æ›´ç¨³å®šçš„è¯¯å·®ä¼°è®¡\nè¯„ä¼°æŒ‡æ ‡ï¼šå›å½’é—®é¢˜ç”¨MSEã€RMSEã€\\(R^2\\)ï¼Œåˆ†ç±»é—®é¢˜ç”¨å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€AUCç­‰\næ¨¡å‹é€‰æ‹©ï¼šåŸºäºä¿¡æ¯å‡†åˆ™å’Œä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚æ¨¡å‹\n\næ•°æ®åˆ’åˆ†æœ€ä½³å®è·µï¼š\n\nåœ¨æ•°æ®åˆ†æå¼€å§‹å‰åˆ’åˆ†æµ‹è¯•é›†\nä½¿ç”¨éšæœºç§å­ç¡®ä¿ç»“æœå¯é‡ç°\nå¯¹äºæ—¶é—´åºåˆ—æ•°æ®ï¼ŒæŒ‰æ—¶é—´é¡ºåºåˆ’åˆ†\nå¯¹äºä¸å¹³è¡¡æ•°æ®ï¼Œä½¿ç”¨åˆ†å±‚æŠ½æ ·\n\näº¤å‰éªŒè¯å®æ–½è¦ç‚¹ï¼š\n1. é€‰æ‹©åˆé€‚çš„kå€¼ï¼ˆé€šå¸¸5æˆ–10ï¼‰\n2. ä½¿ç”¨åˆ†å±‚æŠ½æ ·ä¿æŒç±»åˆ«æ¯”ä¾‹\n3. å¤šæ¬¡è¿è¡Œå–å¹³å‡ä»¥å‡å°‘éšæœºæ€§\n4. è®°å½•æ¯æ¬¡äº¤å‰éªŒè¯çš„ç»“æœå’Œæ ‡å‡†å·®\næ¨¡å‹è¯„ä¼°ç»¼åˆç­–ç•¥ï¼š\n\nä½¿ç”¨å¤šä¸ªè¯„ä¼°æŒ‡æ ‡å…¨é¢è¯„ä¼°\nè€ƒè™‘ä¸šåŠ¡åœºæ™¯é€‰æ‹©é‡ç‚¹æŒ‡æ ‡\nåˆ†æé”™è¯¯æ¡ˆä¾‹ç†è§£æ¨¡å‹å±€é™\næ¯”è¾ƒåŸºå‡†æ¨¡å‹ç¡®è®¤æ”¹è¿›æ•ˆæœ\n\né‡è¦æ•°å­¦å…¬å¼æ€»ç»“\n\nåå·®-æ–¹å·®åˆ†è§£ï¼š\\(E[(Y-\\hat{f})^2] = \\text{Bias}^2 + \\text{Var} + \\sigma_\\varepsilon^2\\)\n\nkæŠ˜äº¤å‰éªŒè¯ï¼š\\(CV(k) = \\frac{1}{k}\\sum_{i=1}^k \\text{Err}(D_{\\text{test}}^{(i)})\\)\n\nå›å½’è¯„ä¼°ï¼š\n\n\\(MSE = \\frac{1}{n}\\sum_{i=1}^n (y_i - \\hat{y}_i)^2\\)\n\\(R^2 = 1 - \\frac{SS_{res}}{SS_{tot}}\\)\n\n\nåˆ†ç±»è¯„ä¼°ï¼š\n\n\\(\\text{Precision} = \\frac{TP}{TP+FP}\\)\n\\(\\text{Recall} = \\frac{TP}{TP+FN}\\)\n\\(F_1 = 2 \\times \\frac{\\text{Precision} \\times \\text{Recall}}{\\text{Precision} + \\text{Recall}}\\)\n\n\nä¿¡æ¯å‡†åˆ™ï¼š\n\n\\(AIC = 2k - 2\\ln(L)\\)\n\\(BIC = \\ln(n)k - 2\\ln(L)\\)",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#ä¸åç»­ç« èŠ‚çš„è”ç³»",
    "href": "chapters/1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°.html#ä¸åç»­ç« èŠ‚çš„è”ç³»",
    "title": "1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°",
    "section": "ä¸åç»­ç« èŠ‚çš„è”ç³»",
    "text": "ä¸åç»­ç« èŠ‚çš„è”ç³»\næœ¬ç« å»ºç«‹çš„è¯„ä¼°æ¡†æ¶å°†è´¯ç©¿æ•´ä¸ªæ•™æï¼š\n\n- ç¬¬2-4ç« ï¼šçº¿æ€§æ¨¡å‹çš„è¯„ä¼°ä¸é€‰æ‹©ï¼Œé‡ç‚¹å…³æ³¨\\(R^2\\)ã€MSEç­‰æŒ‡æ ‡\n- ç¬¬5-7ç« ï¼šå¤æ‚æ¨¡å‹çš„è¿‡æ‹Ÿåˆæ§åˆ¶ï¼Œåº”ç”¨äº¤å‰éªŒè¯å’Œæ­£åˆ™åŒ–\n- ç¬¬8ç« ï¼šé›†æˆå­¦ä¹ çš„åå·®-æ–¹å·®åˆ†æï¼Œæ¯”è¾ƒä¸åŒé›†æˆç­–ç•¥\n- ç¬¬9-10ç« ï¼šæ”¯æŒå‘é‡æœºå’Œç¥ç»ç½‘ç»œçš„è°ƒä¼˜ç­–ç•¥ï¼Œä½¿ç”¨éªŒè¯é›†é€‰æ‹©è¶…å‚æ•°\n\nç†è§£æœ¬ç« å†…å®¹æ˜¯å­¦ä¹ åç»­æ‰€æœ‰é¢„æµ‹æ¨¡å‹çš„åŸºç¡€ï¼Œè‰¯å¥½çš„è¯„ä¼°ä¹ æƒ¯æ˜¯æ„å»ºæœ‰æ•ˆé¢„æµ‹æ¨¡å‹çš„å…³é”®ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåº”è¯¥æ ¹æ®å…·ä½“é—®é¢˜é€‰æ‹©åˆé€‚çš„è¯„ä¼°æŒ‡æ ‡å’Œæ–¹æ³•ï¼Œå¹¶å§‹ç»ˆå…³æ³¨æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>1 é¢„æµ‹æ¨¡å‹ä¸è¯„ä¼°</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html",
    "href": "chapters/2 çº¿æ€§å›å½’.html",
    "title": "2 çº¿æ€§å›å½’",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\nçº¿æ€§å›å½’å’Œçº¿æ€§åˆ†ææ˜¯ä¸€ä¸ªå¼ºå¤§è€Œåˆç»ä¹…ä¸è¡°çš„å·¥å…·ï¼Œå…¶æ€æƒ³çš„ç®€æ´æ€§ã€æ•°å­¦çš„ä¼˜é›…æ€§ã€è§£é‡Šçš„ç›´è§‚æ€§ä»¥åŠå¹¿æ³›çš„å¯æ‰©å±•æ€§è®©äººèµå¹ã€‚ç†è§£çº¿æ€§å›å½’ï¼Œä¸ä»…æ˜¯æŒæ¡ä¸€ä¸ªå·¥å…·ï¼Œæ›´æ˜¯ç†è§£ç°ä»£å®šé‡ç§‘å­¦å¦‚ä½•ä»æ•°æ®ä¸­æå–ä¿¡æ¯ã€å»ºç«‹æ¨¡å‹çš„åŸºæœ¬èŒƒå¼ï¼Œå®ƒæ˜¯é€šå¾€æ›´å¤æ‚æ•°æ®ä¸–ç•Œçš„ä¸€æ‰‡ä¸å¯æˆ–ç¼ºçš„å¤§é—¨ã€‚ä¸‹é¢æˆ‘ä»¬ä»å†å²çš„è§’åº¦å›æº¯çº¿æ€§å›å½’æ€æƒ³çš„å†ç¨‹ï¼š\nï¼ˆ1ï¼‰èµ·æºï¼šä»â€œå¹³å‡ä¸»ä¹‰â€åˆ°â€œå…³ç³»é‡åŒ–â€ï¼ˆ18-19ä¸–çºªï¼‰\nçº¿æ€§å›å½’çš„èŒèŠ½å¹¶éæºäºå¤æ‚çš„æ•°å­¦ç†è®ºï¼Œè€Œæ˜¯æ¥è‡ªå¤©æ–‡å­¦å’Œæµ‹é‡å­¦ä¸­å¯¹â€œè¯¯å·®â€å¤„ç†çš„è¿«åˆ‡éœ€æ±‚ã€‚\na)æ ¸å¿ƒé—®é¢˜ï¼š åœ¨æµ‹é‡åŒä¸€å¤©æ–‡ç°è±¡ï¼ˆå¦‚è¡Œæ˜Ÿè½¨é“ï¼‰æ—¶ï¼Œä¸åŒè§‚æµ‹è€…æˆ–åŒä¸€è§‚æµ‹è€…çš„å¤šæ¬¡æµ‹é‡ä¼šå¾—åˆ°ç•¥æœ‰å·®å¼‚çš„ç»“æœã€‚å“ªä¸€ä¸ªæ˜¯æœ€å¯ä¿¡çš„â€œçœŸå€¼â€ï¼Ÿ\nb)å…ˆé©±ä¸å…³é”®æ€æƒ³ï¼š\næ­¤æ—¶ï¼Œçº¿æ€§å›å½’æ›´å¤šåœ°è¢«è§†ä¸ºä¸€ç§ç²¾å¦™çš„â€œæ•°å€¼è®¡ç®—æŠ€æœ¯â€ï¼Œè€Œéä¸€ä¸ªç»Ÿè®¡æ¨¡å‹ã€‚\nï¼ˆ2ï¼‰å‘å±•ï¼šå¥ å®šç»Ÿè®¡å­¦åŸºçŸ³ï¼ˆ19ä¸–çºªæœ« - 20ä¸–çºªä¸­å¶ï¼‰\néšç€ç”Ÿç‰©å­¦ã€ç»æµå­¦ç­‰ç¤¾ä¼šç§‘å­¦å¯¹æ•°æ®åˆ†æçš„éœ€æ±‚å¢é•¿ï¼Œå­¦è€…ä»¬å¼€å§‹æ¢ç©¶è¿™ç§â€œå…³ç³»â€èƒŒåçš„ä¸ç¡®å®šæ€§å’Œç»Ÿè®¡æ„ä¹‰ã€‚\na)å¼—æœ—è¥¿æ–¯Â·é«˜å°”é¡¿ï¼š è¢«èª‰ä¸ºå›å½’çš„â€œæ¦‚å¿µä¹‹çˆ¶â€ã€‚ä»–åœ¨1886å¹´ç ”ç©¶é—ä¼ å­¦ï¼ˆèº«é«˜é—ä¼ ï¼‰æ—¶å‘ç°ï¼Œè™½ç„¶é«˜ä¸ªå­çˆ¶æ¯çš„å­©å­ä¹Ÿå€¾å‘äºé«˜ï¼Œä½†å…¶èº«é«˜ä¼šâ€œå›å½’â€åˆ°ä¸€ä¸ªå¹³å‡è¶‹åŠ¿ã€‚ ä»–å¼•å…¥äº† â€œå›å½’â€ï¼ˆRegressionï¼‰ ä¸€è¯ï¼ŒåŸæ„æŒ‡â€œå€’é€€ã€é€€å›å¹³å‡å€¼â€ã€‚è¿™ä¸€ç°è±¡æ­ç¤ºäº†ç›¸å…³ä½†éå®Œç¾çš„å…³ç³»ï¼Œæ˜¯ç°ä»£ç›¸å…³ä¸å›å½’åˆ†æçš„èµ·ç‚¹ã€‚\nb)å¡å°”Â·çš®å°”é€Šï¼š é«˜å°”é¡¿çš„å­¦ç”Ÿï¼Œå°†å›å½’ä¸ç›¸å…³åˆ†æç³»ç»ŸåŒ–ã€æ•°å­¦åŒ–ã€‚ ä»–å»ºç«‹äº†çš®å°”é€Šç›¸å…³ç³»æ•°ï¼Œå¹¶å‘å±•äº†å®Œæ•´çš„åŒå˜é‡æ­£æ€åˆ†å¸ƒç†è®ºï¼Œä¸ºå›å½’åˆ†ææä¾›äº†åšå®çš„æ¦‚ç‡åˆ†å¸ƒåŸºç¡€ã€‚\nc)ç½—çº³å¾·Â·è´¹å¸Œå°”ï¼š 20ä¸–çºªç»Ÿè®¡å­¦å·¨æ“˜ï¼Œå®Œæˆäº†çº¿æ€§å›å½’çš„ç°ä»£ç»Ÿè®¡æ¡†æ¶ã€‚ ä»–çš„å…³é”®è´¡çŒ®åœ¨äºï¼šæ–¹å·®åˆ†æã€æ˜¾è‘—æ€§æ£€éªŒã€æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚ ä»–å°†å›å½’ä»æè¿°æ€§å·¥å…·å‡çº§ä¸ºæ¨æ–­æ€§å·¥å…·â€”â€”æˆ‘ä»¬ä¸ä»…èƒ½æ‹Ÿåˆä¸€æ¡çº¿ï¼Œè¿˜èƒ½æ£€éªŒæ–œç‡æ˜¯å¦æ˜¾è‘—ä¸ä¸ºé›¶ï¼ˆå³å˜é‡é—´æ˜¯å¦å­˜åœ¨ç»Ÿè®¡æ˜¾è‘—çš„å…³ç³»ï¼‰ï¼Œå¹¶è¿›è¡Œé¢„æµ‹å’Œç½®ä¿¡åŒºé—´ä¼°è®¡ã€‚\nè‡³æ­¤ï¼Œçº¿æ€§å›å½’ä»ä¸€ä¸ªâ€œæ›²çº¿æ‹Ÿåˆâ€æ–¹æ³•ï¼Œæ¼”å˜ä¸ºä¸€å¥—å®Œæ•´çš„ã€åŸºäºæ¦‚ç‡è®ºçš„ç»Ÿè®¡æ¨æ–­ä½“ç³»ã€‚\nï¼ˆ3ï¼‰æˆç†Ÿä¸æ‰©å±•ï¼šåº”å¯¹å¤æ‚ç°å®ï¼ˆ20ä¸–çºªä¸‹åŠå¶è‡³ä»Šï¼‰\nè®¡ç®—æœºçš„å‡ºç°å’Œç§‘å­¦ç ”ç©¶çš„å¤æ‚åŒ–ï¼Œæ¨åŠ¨äº†çº¿æ€§å›å½’æ¨¡å‹çš„æå¤§ä¸°å¯Œã€‚\na)è®¡ç®—é©å‘½ï¼š æœ€å°äºŒä¹˜æ³•çš„æ±‚è§£æ¶‰åŠçŸ©é˜µè¿ç®—ã€‚è®¡ç®—æœºä½¿å¿«é€Ÿå¤„ç†æµ·é‡æ•°æ®å’Œå¤šä¸ªå˜é‡æˆä¸ºå¯èƒ½ï¼Œå‚¬ç”Ÿäº†å¤šå…ƒçº¿æ€§å›å½’çš„å¹¿æ³›åº”ç”¨ã€‚\nb)ç†è®ºæ‰©å±•ä¸å˜ä½“ï¼š\nc)æˆä¸ºæœºå™¨å­¦ä¹ çš„åŸºç¡€ï¼š\nï¼ˆ4ï¼‰æ ¸å¿ƒæ€æƒ³ä¸å±€é™\na)æ ¸å¿ƒæ€æƒ³ï¼š å»ºæ¨¡ç¡®å®šæ€§å…³ç³»ï¼š å‡è®¾å› å˜é‡ï¼ˆYï¼‰å¯ä»¥ç”±è‡ªå˜é‡ï¼ˆXï¼‰çš„çº¿æ€§ç»„åˆåŠ ä¸Šä¸€ä¸ªéšæœºè¯¯å·®æ¥å®Œç¾è§£é‡Šã€‚ ç›®æ ‡ï¼š é€šè¿‡æ•°æ®ä¼°è®¡çº¿æ€§æ–¹ç¨‹çš„ç³»æ•°ï¼Œä»¥é‡åŒ–Xå˜åŒ–æ—¶Yçš„å¹³å‡å˜åŒ–é‡ï¼Œå¹¶ç”¨äºé¢„æµ‹å’Œè§£é‡Šã€‚\nb)ä¸»è¦å±€é™ï¼š\nçº¿æ€§å›å½’çš„å‘å±•è„‰ç»œæ¸…æ™°å¯è§ï¼šèµ·æºäºå¤©æ–‡å­¦çš„è¯¯å·®å¤„ç†ï¼ˆæœ€å°äºŒä¹˜æ³•ï¼‰ï¼Œæ¦‚å¿µåŒ–äºç”Ÿç‰©å­¦çš„é—ä¼ ç ”ç©¶ï¼ˆé«˜å°”é¡¿çš„â€œå›å½’â€ï¼‰ï¼Œä½“ç³»åŒ–äºç»Ÿè®¡å­¦çš„æ¨æ–­é©å‘½ï¼ˆçš®å°”é€Šã€è´¹å¸Œå°”ï¼‰ï¼Œæ‰©å±•åŒ–äºè®¡ç®—æœºæ—¶ä»£çš„å¤æ‚æ•°æ®åˆ†æï¼ˆæ­£åˆ™åŒ–ã€å¹¿ä¹‰æ¨¡å‹ï¼‰ï¼Œ åŸºç¡€åŒ–äºäººå·¥æ™ºèƒ½/æœºå™¨å­¦ä¹ çš„æ¨¡å‹åŸºçŸ³ã€‚\nçº¿æ€§å›å½’æ˜¯é¢„æµ‹å»ºæ¨¡æœ€åŸºç¡€ã€æœ€é‡è¦çš„æ–¹æ³•ã€‚æœ¬ç« å°†ç³»ç»Ÿä»‹ç»çº¿æ€§å›å½’æ¨¡å‹çš„ä¸‰ç§è¡¨è¿°å½¢å¼ï¼Œè¯¦ç»†æ¨å¯¼å‚æ•°ä¼°è®¡çš„ä¸¤ç§ä¸»è¦æ–¹æ³•â€”â€”æœ€å°äºŒä¹˜ä¼°è®¡å’Œæå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæ·±å…¥æ¢è®¨æ¨¡å‹æ‹Ÿåˆä¼˜åº¦çš„è¯„ä»·æŒ‡æ ‡ï¼Œå¹¶å»ºç«‹å®Œæ•´çš„ç»Ÿè®¡æ¨æ–­æ¡†æ¶ã€‚æœ€åï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•åˆ©ç”¨å»ºç«‹å¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œä¸ºåç»­çš„æ¨¡å‹è¯Šæ–­å’Œæ‰©å±•å¥ å®šåšå®åŸºç¡€ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html#æœ¬ç« å¯¼è¯»",
    "href": "chapters/2 çº¿æ€§å›å½’.html#æœ¬ç« å¯¼è¯»",
    "title": "2 çº¿æ€§å›å½’",
    "section": "",
    "text": "é«˜æ–¯ä¸å‹’è®©å¾·ï¼šå¾·å›½æ•°å­¦å®¶é«˜æ–¯å’Œæ³•å›½æ•°å­¦å®¶å‹’è®©å¾·åœ¨18ä¸–çºªæœ«è‡³19ä¸–çºªåˆç‹¬ç«‹æå‡ºäº†æœ€å°äºŒä¹˜æ³•ã€‚\næ ¸å¿ƒæ€æƒ³ï¼šæœ€æœ‰å¯èƒ½çš„â€œçœŸå€¼â€æˆ–æœ€ä½³æ‹Ÿåˆçº¿ï¼Œæ˜¯èƒ½ä½¿æ‰€æœ‰è§‚æµ‹å€¼ä¸é¢„æµ‹å€¼ä¹‹å·®çš„å¹³æ–¹å’Œè¾¾åˆ°æœ€å°çš„é‚£æ¡çº¿ã€‚è¯¯å·®å¹³æ–¹ï¼ˆè€Œéç»å¯¹å·®ï¼‰åœ¨æ•°å­¦ä¸Šæ›´æ˜“å¤„ç†ï¼Œä¸”èƒ½æƒ©ç½šå¤§çš„è¯¯å·®ã€‚\né¦–æ¬¡åº”ç”¨ï¼šå‹’è®©å¾·åœ¨1805å¹´æ˜ç¡®å‘è¡¨äº†æœ€å°äºŒä¹˜æ³•ï¼Œç”¨äºåˆ†æå½—æ˜Ÿè½¨é“ï¼›é«˜æ–¯å£°ç§°æ›´æ—©ä½¿ç”¨å®ƒé¢„æµ‹äº†è°·ç¥æ˜Ÿçš„è½¨è¿¹ã€‚\n\n\n\n\n\n\n\n\n\n\n\n\n\nå¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼š ç”±å†…å°”å¾·å’ŒéŸ¦å¾·ä¼¯æ©æå‡ºï¼Œå…è®¸å› å˜é‡ä¸é™äºè¿ç»­æ­£æ€åˆ†å¸ƒï¼ˆå¦‚äºŒé¡¹åˆ†å¸ƒçš„Logisticå›å½’ã€æ³Šæ¾åˆ†å¸ƒçš„è®¡æ•°æ•°æ®å›å½’ï¼‰ã€‚\næ­£åˆ™åŒ–æ–¹æ³•ï¼š ä¸ºåº”å¯¹é«˜ç»´æ•°æ®ã€å¤šé‡å…±çº¿æ€§å’Œè¿‡æ‹Ÿåˆé—®é¢˜ï¼Œäº§ç”Ÿäº†å²­å›å½’ã€Lassoå›å½’ç­‰ï¼Œå®ƒä»¬åœ¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥æƒ©ç½šé¡¹ï¼Œæå‡æ¨¡å‹ç¨³å¥æ€§å’Œå¯è§£é‡Šæ€§ã€‚\nç¨³å¥å›å½’ï¼š é’ˆå¯¹å¼‚å¸¸å€¼æ•æ„Ÿé—®é¢˜ï¼Œå‘å±•å‡ºå¦‚Huberå›å½’ç­‰æ–¹æ³•ã€‚\n\n\n\nåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œçº¿æ€§å›å½’è¢«è§†ä¸ºæœ€ç®€å•çš„ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œæ˜¯ç†è§£å‚æ•°å­¦ä¹ ã€æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ç­‰æ¦‚å¿µçš„ç†æƒ³èµ·ç‚¹ã€‚\nå®ƒä¹Ÿæ˜¯è®¸å¤šå¤æ‚æ¨¡å‹ï¼ˆå¦‚ç¥ç»ç½‘ç»œä¸­çš„å•ä¸ªç¥ç»å…ƒï¼‰çš„æ„æˆæ¨¡å—ã€‚\n\n\n\n\n\nçº¿æ€§å‡è®¾å¼ºï¼š æ— æ³•ç›´æ¥æ•æ‰å˜é‡é—´çš„éçº¿æ€§å…³ç³»ã€‚\nå¯¹å‡è®¾æ•æ„Ÿï¼š è¦æ±‚è¯¯å·®ç‹¬ç«‹ã€åŒæ–¹å·®ã€æ­£æ€åˆ†å¸ƒç­‰ï¼Œç°å®æ•°æ®å¸¸ä¸ä¸¥æ ¼æ»¡è¶³ã€‚\næ˜“å—å¼‚å¸¸å€¼å½±å“ã€‚\nç›¸å…³éå› æœï¼š è¿™æ˜¯æœ€é‡è¦çš„ä¸€ç‚¹ã€‚å›å½’æ­ç¤ºçš„æ˜¯å…³è”æ€§ï¼Œè€Œéå› æœæ€§ã€‚å¿½è§†æ··æ·†å˜é‡ä¼šå¯¼è‡´é”™è¯¯çš„å› æœè§£è¯»ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html#çº¿æ€§å›å½’æ¨¡å‹",
    "href": "chapters/2 çº¿æ€§å›å½’.html#çº¿æ€§å›å½’æ¨¡å‹",
    "title": "2 çº¿æ€§å›å½’",
    "section": "2.1 çº¿æ€§å›å½’æ¨¡å‹",
    "text": "2.1 çº¿æ€§å›å½’æ¨¡å‹\nå˜é‡ä¹‹é—´çš„å…³ç³»ï¼šå‡½æ•°å…³ç³»ï¼Œç»Ÿè®¡å…³ç³»ï¼Œæ²¡æœ‰å…³ç³»\nå›å¿†æ•°ç†ç»Ÿè®¡çš„å†…å®¹ï¼Œç›¸å…³ç³»æ•°ï¼š\n\\[\n\\rho = \\frac{\\text{Cov}(X, Y)}{\\sigma_X \\sigma_Y}\n\\] \\[\nr = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^n (x_i - \\bar{x})^2 \\sum_{i=1}^n (y_i - \\bar{y})^2}}\n\\]\nå–å€¼èŒƒå›´ï¼š \\(-1 â‰¤ Ï â‰¤ 1\\)ã€‚\n\n\\(Ï = 1\\)ï¼šå®Œå…¨æ­£ç›¸å…³ï¼ˆæ‰€æœ‰ç‚¹è½åœ¨ä¸€æ¡æ–œå‘ä¸Šçš„ç›´çº¿ä¸Šï¼‰ã€‚\n\\(Ï = -1\\)ï¼šå®Œå…¨è´Ÿç›¸å…³ï¼ˆæ‰€æœ‰ç‚¹è½åœ¨ä¸€æ¡æ–œå‘ä¸‹çš„ç›´çº¿ä¸Šï¼‰ã€‚\n\\(Ï = 0\\)ï¼šæ€»ä½“ä¸­ä¸å­˜åœ¨çº¿æ€§ç›¸å…³ã€‚ä½†è¿™ä¸æ„å‘³ç€æ²¡æœ‰å…¶ä»–å…³ç³»ï¼ˆå¦‚æ›²çº¿å…³ç³»ï¼‰ã€‚\n\næˆ‘ä»¬å‡ ä¹æ°¸è¿œæ— æ³•æ”¶é›†åˆ°æ•´ä¸ªæ€»ä½“çš„æ•°æ®ï¼Œå› æ­¤ \\(Ï\\) å¯¹æˆ‘ä»¬æ¥è¯´é€šå¸¸æ˜¯æœªçŸ¥çš„ã€‚\næ ·æœ¬ç›¸å…³ç³»æ•°ç”±è‹±å›½ç»Ÿè®¡å­¦å®¶å¡å°”Â·çš®å°”é€Šæå‡ºï¼Œæ•…å¸¸ç§°â€œçš®å°”é€Šç§¯çŸ©ç›¸å…³ç³»æ•°â€ã€‚ å…¬å¼æœ¬è´¨æ˜¯æ ·æœ¬åæ–¹å·®é™¤ä»¥å„è‡ªæ ·æœ¬æ ‡å‡†å·®çš„ä¹˜ç§¯å–å€¼èŒƒå›´ï¼š \\(-1 â‰¤ r â‰¤ 1\\)ã€‚ å®ƒæ˜¯ä¸€ä¸ªç»Ÿè®¡é‡ï¼Œå¦‚æœä½ ä»åŒä¸€ä¸ªæ€»ä½“ä¸­æŠ½å–ä¸åŒçš„æ ·æœ¬ï¼Œè®¡ç®—å‡ºçš„ \\(r\\) å€¼ä¼šä¸åŒã€‚è¿™ç§æ³¢åŠ¨ç§°ä¸ºæŠ½æ ·å˜å¼‚ã€‚\n2.1.1 æ€»ä½“å›å½’æ¨¡å‹\næ€»ä½“å›å½’æ¨¡å‹ï¼š \\[\nY = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\cdots + \\beta_p X_p + \\varepsilon\n\\]\nå…¶ä¸­ï¼š\n\n\\(\\beta_0\\) æ˜¯æˆªè·é¡¹\n\\(\\beta_1, \\beta_2, \\cdots, \\beta_p\\) æ˜¯å›å½’ç³»æ•°\n\n\\(\\varepsilon\\) æ˜¯éšæœºè¯¯å·®é¡¹ï¼Œæ»¡è¶³ \\(E(\\varepsilon|X) = 0\\)\næ€»ä½“å›å½’å‡½æ•°æè¿°äº†å› å˜é‡ \\(Y\\) ä¸è‡ªå˜é‡ \\(X_1, X_2, \\cdots, X_p\\) ä¹‹é—´çš„çœŸå®å…³ç³»ï¼š\n\\[\nE(Y|X_1, \\cdots, X_p) = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\cdots + \\beta_p X_p\n\\]\n\n2.1.2 æ ·æœ¬å›å½’æ¨¡å‹\nåŸºäº \\(n\\) ä¸ªè§‚æµ‹æ ·æœ¬ \\((x_{i1}, x_{i2}, \\cdots, x_{ip}, y_i)\\), \\(i=1,2,\\cdots,n\\)ï¼Œæ ·æœ¬å›å½’æ¨¡å‹ä¸ºï¼š\n\\[\ny_i = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_{i1} + \\hat{\\beta}_2 x_{i2} + \\cdots + \\hat{\\beta}_p x_{ip} + e_i\n\\]\nå…¶ä¸­ï¼š\n\n\\(\\hat{\\beta}_0, \\hat{\\beta}_1, \\cdots, \\hat{\\beta}_p\\) æ˜¯æ€»ä½“å‚æ•°çš„ä¼°è®¡å€¼\n\\(e_i = y_i - \\hat{y}_i\\) æ˜¯ç¬¬ \\(i\\) ä¸ªè§‚æµ‹çš„æ®‹å·®\n\\(\\hat{y}_i\\) æ˜¯ç¬¬ \\(i\\) ä¸ªè§‚æµ‹çš„æ‹Ÿåˆå€¼\n\næ ·æœ¬å›å½’å‡½æ•°ï¼š\n\\[\n\\hat{y_i} = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_{i1} + \\hat{\\beta}_2 x_{i2} + \\cdots + \\hat{\\beta}_p x_{ip}\n\\]\n2.1.3 çŸ©é˜µå½¢å¼çš„å›å½’æ¨¡å‹\nä»¤ï¼š \\[\n\\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_n \\end{pmatrix},\n\\quad\n\\mathbf{X} = \\begin{pmatrix}\n1 & x_{11} & \\cdots & x_{1p} \\\\\n1 & x_{21} & \\cdots & x_{2p} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n1 & x_{n1} & \\cdots & x_{np}\n\\end{pmatrix},\n\\quad\n\\pmb{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\\\ \\vdots \\\\ \\beta_p \\end{pmatrix},\n\\quad\n\\pmb{\\varepsilon} = \\begin{pmatrix} \\varepsilon_1 \\\\ \\varepsilon_2 \\\\ \\vdots \\\\ \\varepsilon_n \\end{pmatrix}\n\\]\nåˆ™çº¿æ€§å›å½’æ¨¡å‹çš„çŸ©é˜µå½¢å¼ä¸ºï¼š \\[\n\\mathbf{y} = \\mathbf{X}\\pmb{\\beta} + \\pmb{\\varepsilon}\n\\]\nå…¶ä¸­ï¼š\n\n\\(\\mathbf{y}\\) æ˜¯ \\(n \\times 1\\) çš„å› å˜é‡å‘é‡\n\\(\\mathbf{X}\\) æ˜¯ \\(n \\times (p+1)\\) çš„è®¾è®¡çŸ©é˜µ\n\\(\\pmb{\\beta}\\) æ˜¯ \\((p+1) \\times 1\\) çš„å‚æ•°å‘é‡\n\\(\\pmb{\\varepsilon}\\) æ˜¯ \\(n \\times 1\\) çš„è¯¯å·®é¡¹å‘é‡\n2.1.4 åŸºæœ¬å‡è®¾\nå‡è®¾ 1ï¼šçº¿æ€§å…³ç³»\n\nå†…å®¹ï¼šå› å˜é‡ \\(Y\\) ä¸è‡ªå˜é‡ \\(X\\) ä¹‹é—´å­˜åœ¨çº¿æ€§å…³ç³»ï¼Œä¸”å‚æ•° \\(Î²\\) æ˜¯çº¿æ€§çš„ã€‚è¯¯å·®é¡¹ \\(Îµ\\) ä»¥ç›¸åŠ çš„å½¢å¼è¿›å…¥æ¨¡å‹ã€‚\nå«ä¹‰ï¼š\\(X\\) å˜åŒ–ä¸€ä¸ªå•ä½ï¼Œ\\(Y\\) å¹³å‡å˜åŒ– \\(Î²\\) ä¸ªå•ä½ï¼Œä¸ \\(X\\) æœ¬èº«çš„å–å€¼æ— å…³ã€‚\nè¿ååæœï¼šæ¨¡å‹æ— æ³•æ•æ‰çœŸå®å…³ç³»ï¼Œå¯¼è‡´é¢„æµ‹åå·®ã€‚ä¾‹å¦‚ï¼ŒçœŸå®å…³ç³»æ˜¯äºŒæ¬¡çš„ï¼Œç”¨çº¿æ€§æ¨¡å‹ä¼šç³»ç»Ÿæ€§åœ°é«˜ä¼°æˆ–ä½ä¼°ã€‚\næ£€éªŒä¸å¤„ç†ï¼šç»˜åˆ¶ \\(Y\\) ä¸æ¯ä¸ª \\(X\\) çš„æ•£ç‚¹å›¾ï¼›æ£€æŸ¥æ®‹å·®ä¸æ‹Ÿåˆå€¼çš„å›¾ã€‚è‹¥è¿åï¼Œå¯å¯¹ \\(X\\) æˆ– \\(Y\\) è¿›è¡Œå˜é‡å˜æ¢ï¼ˆå¦‚å–å¯¹æ•°ã€å¹³æ–¹ï¼‰ï¼Œæˆ–ä½¿ç”¨å¤šé¡¹å¼å›å½’ã€‚\n\nå‡è®¾ 2ï¼šéšæœºæŠ½æ ·\n\nå†…å®¹ï¼šæ ·æœ¬æ•°æ®æ˜¯ä»æ€»ä½“ä¸­éšæœºæŠ½æ ·å¾—åˆ°çš„ã€‚\nå«ä¹‰ï¼šæ ·æœ¬èƒ½ä»£è¡¨æ€»ä½“ï¼Œé¿å…é€‰æ‹©åå·®ã€‚\nè¿ååæœï¼šæ ·æœ¬ä¼°è®¡æ— æ³•æ¨å¹¿åˆ°æ€»ä½“ï¼ˆå¤–éƒ¨æ•ˆåº¦ä½ï¼‰ã€‚ä¾‹å¦‚ï¼Œåªç”¨å¤§å­¦ç”Ÿæ•°æ®ç ”ç©¶å…¨æ°‘æ”¶å…¥ã€‚\næ£€éªŒä¸å¤„ç†ï¼šæ— æ³•ä»æ•°æ®æœ¬èº«ç›´æ¥è¯Šæ–­ï¼Œéœ€äº†è§£æŠ½æ ·è¿‡ç¨‹ã€‚å¤„ç†æ–¹æ³•æ˜¯æ”¹è¿›æŠ½æ ·è®¾è®¡ã€‚\n\nå‡è®¾ 3ï¼šä¸¥æ ¼å¤–ç”Ÿæ€§\n\nå†…å®¹ï¼šç»™å®šæ‰€æœ‰è‡ªå˜é‡ \\(X\\) çš„å€¼ï¼Œè¯¯å·®é¡¹ \\(Îµ\\) çš„æ¡ä»¶æœŸæœ›ä¸ºé›¶ã€‚å³ \\(E(Îµ|X) = 0\\)ã€‚\nå«ä¹‰ï¼šæ¨¡å‹ä¸­æ²¡æœ‰é—æ¼é‡è¦çš„è§£é‡Šå˜é‡ï¼Œä¸”æ‰€æœ‰åŒ…å«çš„ \\(X\\) éƒ½ä¸è¯¯å·®é¡¹ \\(Îµ\\) ä¸ç›¸å…³ã€‚æ¢å¥è¯è¯´ï¼Œ\\(X\\) æ˜¯â€œå¤–ç”Ÿâ€çš„ã€‚\nè¿ååæœï¼ˆæœ€ä¸¥é‡ä¹‹ä¸€ï¼‰ï¼šå¯¼è‡´ â€œå†…ç”Ÿæ€§â€ é—®é¢˜ï¼Œä½¿å‚æ•°ä¼°è®¡ \\(Î²\\) æœ‰åä¸”ä¸ä¸€è‡´ã€‚æ— è®ºæ ·æœ¬å¤šå¤§ï¼Œåå·®éƒ½ä¸ä¼šæ¶ˆå¤±ã€‚\nå¸¸è§åŸå› ï¼šé—æ¼å˜é‡ã€æµ‹é‡è¯¯å·®ã€äº’ä¸ºå› æœï¼ˆåå‘å› æœï¼‰ã€‚\næ£€éªŒä¸å¤„ç†ï¼šéš¾ä»¥ç›´æ¥æ£€éªŒã€‚é€šå¸¸åŸºäºç†è®ºæ¨ç†ã€‚å¤„ç†éœ€ç”¨å·¥å…·å˜é‡æ³•ã€é¢æ¿æ•°æ®æ¨¡å‹ã€æ–­ç‚¹å›å½’ç­‰é«˜çº§æ–¹æ³•ã€‚\n\nå‡è®¾ 4ï¼šæ— å®Œå…¨å¤šé‡å…±çº¿æ€§\n\nå†…å®¹ï¼šè‡ªå˜é‡ä¹‹é—´ä¸å­˜åœ¨å®Œå…¨çš„çº¿æ€§å…³ç³»ã€‚\nå«ä¹‰ï¼šæ²¡æœ‰ä¸€ä¸ªè‡ªå˜é‡å¯ä»¥ç²¾ç¡®åœ°ç”±å…¶ä»–è‡ªå˜é‡çš„çº¿æ€§ç»„åˆè¡¨ç¤ºã€‚æ ·æœ¬æ•°æ®ä¸­ï¼Œå„ \\(X\\) æä¾›ç‹¬ç«‹ä¿¡æ¯ã€‚ * è¿ååæœï¼šOLS æ— æ³•å”¯ä¸€æ±‚è§£å‚æ•°ä¼°è®¡å€¼ï¼ˆçŸ©é˜µä¸å¯é€†ï¼‰ã€‚\næ£€éªŒï¼šæŸ¥çœ‹ç›¸å…³ç³»æ•°çŸ©é˜µï¼›è®¡ç®—æ–¹å·®è†¨èƒ€å› å­å’Œæ¡ä»¶æ•°ã€‚\nå¤„ç†ï¼šåˆ é™¤é«˜åº¦ç›¸å…³çš„å˜é‡ä¹‹ä¸€ï¼›ä½¿ç”¨ä¸»æˆåˆ†å›å½’æˆ–å²­å›å½’ç­‰é™ç»´/æ­£åˆ™åŒ–æ–¹æ³•ã€‚\n\nå‡è®¾ 5ï¼šçƒå½¢è¯¯å·®ï¼ˆåŒæ–¹å·®ä¸æ— è‡ªç›¸å…³ï¼‰ è¿™æ˜¯ä¸¤ä¸ªå­å‡è®¾çš„åˆç§°ï¼š\n5a) åŒæ–¹å·®æ€§ï¼šç»™å®šæ‰€æœ‰ \\(X\\)ï¼Œè¯¯å·®é¡¹ \\(Îµ\\) çš„æ¡ä»¶æ–¹å·®ä¸ºå¸¸æ•°ã€‚å³ \\(Var(Îµ|X) = ÏƒÂ²\\)ã€‚\n\nè¿ååæœï¼šOLSä¼°è®¡é‡ä»æ— åï¼Œä½†ä¸å†æ˜¯æœ€æœ‰æ•ˆçš„ï¼ˆæ–¹å·®ä¸æ˜¯æœ€å°ï¼‰ï¼›æ ‡å‡†è¯¯ä¼°è®¡æœ‰åï¼Œå¯¼è‡´å‡è®¾æ£€éªŒå¤±æ•ˆã€‚\næ£€éªŒï¼šç»˜åˆ¶æ®‹å·®ä¸æ‹Ÿåˆå€¼çš„æ•£ç‚¹å›¾ï¼Œçœ‹æ˜¯å¦å‘ˆæ¼æ–—å½¢ã€æ‰‡å½¢ç­‰ã€‚æ­£å¼æ£€éªŒæœ‰Breusch-Paganæ£€éªŒã€Whiteæ£€éªŒç­‰ã€‚\nå¤„ç†ï¼šä½¿ç”¨ç¨³å¥æ ‡å‡†è¯¯ï¼ˆæœ€å¸¸è§ä¸”ç®€å•ï¼‰ã€åŠ æƒæœ€å°äºŒä¹˜æ³•ã€å¯¹å˜é‡è¿›è¡Œå˜æ¢ã€‚\n\n5b) æ— è‡ªç›¸å…³ï¼šå¯¹äºä¸åŒè§‚æµ‹ \\(i\\) å’Œ \\(j\\)ï¼Œå…¶è¯¯å·®é¡¹äº’ä¸ç›¸å…³ã€‚å³ \\(Cov(Îµáµ¢, Îµâ±¼|X) = 0\\) (i â‰  j)ã€‚\n\nè¿ååæœï¼šä¸å¼‚æ–¹å·®ç±»ä¼¼ï¼Œæ•ˆç‡é™ä½ï¼Œæ ‡å‡†è¯¯ä¼°è®¡æœ‰åï¼ˆé€šå¸¸åä½ï¼‰ï¼Œå¯¼è‡´ \\(t\\) ç»Ÿè®¡é‡è™šé«˜ï¼Œæ˜“å¾—å‡ºæ˜¾è‘—ç»“è®ºã€‚\nå¸¸è§äºï¼šæ—¶é—´åºåˆ—æ•°æ®ï¼ˆæœ¬æœŸè¯¯å·®å—ä¸ŠæœŸå½±å“ï¼‰ã€ç©ºé—´æ•°æ®ã€‚\næ£€éªŒï¼šç»˜åˆ¶æ®‹å·®ä¸æ—¶é—´/é¡ºåºçš„å›¾ï¼›ä½¿ç”¨Durbin-Watsonæ£€éªŒï¼ˆé’ˆå¯¹ä¸€é˜¶è‡ªç›¸å…³ï¼‰ã€‚\nå¤„ç†ï¼šæ—¶é—´åºåˆ—æ¨¡å‹ï¼ˆå¦‚ARIMAï¼‰ã€ä½¿ç”¨å¼‚æ–¹å·®è‡ªç›¸å…³ç¨³å¥æ ‡å‡†è¯¯ã€å¹¿ä¹‰æœ€å°äºŒä¹˜æ³•ã€‚\n\nå‡è®¾ 6ï¼šè¯¯å·®é¡¹çš„æ­£æ€æ€§ï¼ˆå¯é€‰ä½†é‡è¦ï¼‰ * å†…å®¹ï¼šè¯¯å·®é¡¹ \\(Îµ\\) æœä»æ­£æ€åˆ†å¸ƒã€‚å³ \\(Îµ|X ~ N(0, ÏƒÂ²I)\\)ã€‚\n\nå«ä¹‰ï¼šåœ¨æ ·æœ¬é‡ä¸å¤§æ—¶ï¼Œæ­¤å‡è®¾æ˜¯è¿›è¡Œç²¾ç¡®ç»Ÿè®¡æ¨æ–­ï¼ˆå¦‚ \\(t\\) æ£€éªŒã€\\(F\\) æ£€éªŒï¼‰çš„åŸºç¡€ã€‚\nè¿ååæœï¼šåœ¨å°æ ·æœ¬ä¸‹ï¼Œ\\(Î²\\) çš„åˆ†å¸ƒä¸æ˜¯ç²¾ç¡®çš„ \\(t\\) åˆ†å¸ƒï¼Œæ£€éªŒå’Œç½®ä¿¡åŒºé—´å¯èƒ½ä¸å‡†ç¡®ã€‚ä½†åœ¨å¤§æ ·æœ¬ä¸‹ï¼ˆä¸­å¿ƒæé™å®šç†ï¼‰ï¼ŒOLSä¼°è®¡é‡è¿‘ä¼¼æ­£æ€ï¼Œæ­¤å‡è®¾å¯æ”¾æ¾ã€‚\næ£€éªŒï¼šç»˜åˆ¶æ®‹å·®çš„æ­£æ€Q-Qå›¾ï¼›ä½¿ç”¨Shapiro-Wilkã€Kolmogorov-Smirnovç­‰æ£€éªŒã€‚\nå¤„ç†ï¼šå¢å¤§æ ·æœ¬é‡ï¼›ä½¿ç”¨è‡ªåŠ©æ³•è¿›è¡Œæ¨æ–­ï¼›è€ƒè™‘å¯¹ \\(Y\\) è¿›è¡Œå˜æ¢ã€‚\n\nè¿™å…­ä¸ªå‡è®¾å¯ä»¥æŒ‰ç›®æ ‡å½’ç±»ï¼š\n\n\n\n\n\n\n\nç›®æ ‡\næ ¸å¿ƒå‡è®¾\nå…³é”®ç‚¹\n\n\n\nä¼°è®¡æ— å\n1. çº¿æ€§å…³ç³»3. ä¸¥æ ¼å¤–ç”Ÿæ€§\næ¨¡å‹è®¾å®šæ­£ç¡®ï¼Œæ— é—æ¼å˜é‡å’Œåå‘å› æœã€‚\n\n\nä¼°è®¡å¯ç®—\n4. æ— å®Œå…¨å¤šé‡å…±çº¿æ€§\nè‡ªå˜é‡æä¾›ç‹¬ç«‹ä¿¡æ¯ï¼ŒçŸ©é˜µå¯é€†ã€‚\n\n\nä¼°è®¡æœ‰æ•ˆï¼ˆBLUEï¼‰\n5. çƒå½¢è¯¯å·®ï¼ˆåŒæ–¹å·®+æ— è‡ªç›¸å…³ï¼‰\nOLSä¼°è®¡é‡çš„æ–¹å·®æœ€å°ã€‚\n\n\næ¨æ–­å¯é \n6. è¯¯å·®æ­£æ€æ€§ï¼ˆå°æ ·æœ¬ï¼‰+ ä»¥ä¸Šæ‰€æœ‰\nå¯ç”¨äºå‡è®¾æ£€éªŒå’Œç½®ä¿¡åŒºé—´ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html#å‚æ•°ä¼°è®¡æ–¹æ³•",
    "href": "chapters/2 çº¿æ€§å›å½’.html#å‚æ•°ä¼°è®¡æ–¹æ³•",
    "title": "2 çº¿æ€§å›å½’",
    "section": "2.2 å‚æ•°ä¼°è®¡æ–¹æ³•",
    "text": "2.2 å‚æ•°ä¼°è®¡æ–¹æ³•\n2.2.1 æ™®é€šæœ€å°äºŒä¹˜ä¼°è®¡\nåŸºæœ¬åŸç†ï¼šå¯»æ‰¾å‚æ•°ä¼°è®¡å€¼ \\(\\hat{\\pmb{\\beta}}\\)ï¼Œä½¿å¾—æ®‹å·®å¹³æ–¹å’Œæœ€å°ã€‚\næ®‹å·®å¹³æ–¹å’Œï¼š \\[\nSSE = \\sum_{i=1}^n e_i^2 = \\sum_{i=1}^n (y_i - \\hat{y}_i)^2 = (\\mathbf{y} - \\mathbf{X}\\pmb{\\beta})'(\\mathbf{y} - \\mathbf{X}\\pmb{\\beta})\n\\]\næœ€å°äºŒä¹˜ä¼°è®¡é‡ï¼š é€šè¿‡å¯¹ \\(SSE\\) å…³äº \\(\\pmb{\\beta}\\) æ±‚å¯¼å¹¶ä»¤å¯¼æ•°ä¸ºé›¶ï¼Œå¯å¾—æ­£è§„æ–¹ç¨‹ç»„ï¼š \\[\n\\mathbf{X}'\\mathbf{X}\\hat{\\pmb{\\beta}} = \\mathbf{X}'\\mathbf{y}\n\\]\nå½“ \\(\\mathbf{X}'\\mathbf{X}\\) å¯é€†æ—¶ï¼ŒOLSä¼°è®¡é‡ä¸ºï¼š \\[\n\\hat{\\pmb{\\beta}} = (\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{y}\n\\]\nOLSä¼°è®¡é‡çš„æ€§è´¨ï¼ˆåœ¨ç»å…¸å‡è®¾ä¸‹ï¼‰ï¼š\n1. æ— åæ€§ï¼š\\(E(\\hat{\\pmb{\\beta}}) = \\pmb{\\beta}\\)\n2. æ–¹å·®-åæ–¹å·®çŸ©é˜µï¼š\\(\\text{Var}(\\hat{\\pmb{\\beta}}) = \\sigma^2(\\mathbf{X}'\\mathbf{X})^{-1}\\)\n3. é«˜æ–¯-é©¬å°”å¯å¤«å®šç†ï¼šOLSä¼°è®¡é‡æ˜¯æœ€ä½³çº¿æ€§æ— åä¼°è®¡\n2.2.2 æå¤§ä¼¼ç„¶ä¼°è®¡\nåŸºæœ¬æ€æƒ³ï¼šåœ¨æ­£æ€è¯¯å·®çš„å‡è®¾ä¸‹ï¼Œé€‰æ‹©ä½¿æ ·æœ¬è§‚æµ‹å€¼å‡ºç°æ¦‚ç‡æœ€å¤§çš„å‚æ•°å€¼ã€‚\nä¼¼ç„¶å‡½æ•°ï¼šå‡è®¾ \\(\\varepsilon_i \\sim N(0, \\sigma^2)\\)ï¼Œåˆ™ \\(y_i \\sim N(\\mathbf{x}_i'\\pmb{\\beta}, \\sigma^2)\\)ï¼Œä¼¼ç„¶å‡½æ•°ä¸ºï¼š \\[\nL(\\pmb{\\beta}, \\sigma^2) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - \\mathbf{x}_i'\\pmb{\\beta})^2}{2\\sigma^2}\\right)\n\\]\nå¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š \\[\n\\ell(\\pmb{\\beta}, \\sigma^2) = -\\frac{n}{2} \\ln(2\\pi) - \\frac{n}{2} \\ln(\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^n (y_i - \\mathbf{x}_i'\\pmb{\\beta})^2\n\\]\næå¤§ä¼¼ç„¶ä¼°è®¡é‡ï¼š - å›å½’ç³»æ•°ï¼š\\(\\hat{\\pmb{\\beta}}_{MLE} = (\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{y}\\)ï¼ˆä¸OLSç›¸åŒï¼‰ - è¯¯å·®æ–¹å·®ï¼š\\(\\hat{\\sigma}^2_{MLE} = \\frac{1}{n} \\sum_{i=1}^n (y_i - \\mathbf{x}_i'\\hat{\\pmb{\\beta}})^2\\)\næ³¨æ„ï¼š\\(\\hat{\\sigma}^2_{MLE}\\) æ˜¯æœ‰åä¼°è®¡ï¼Œé€šå¸¸ä½¿ç”¨æ— åä¼°è®¡ï¼š \\[\ns^2 = \\frac{1}{n-p-1} \\sum_{i=1}^n (y_i - \\hat{y}_i)^2\n\\]\n2.2.3 ç‚¹ä¼°è®¡ä¸åŒºé—´ä¼°è®¡\nç³»æ•°ä¼°è®¡ï¼š - ç‚¹ä¼°è®¡ï¼š\\(\\hat{\\beta}_j\\)ï¼ˆOLSæˆ–MLEä¼°è®¡å€¼ï¼‰ - æ ‡å‡†è¯¯ï¼š\\(SE(\\hat{\\beta}_j) = s \\sqrt{[(\\mathbf{X}'\\mathbf{X})^{-1}]_{jj}}\\)\nç³»æ•°çš„ç½®ä¿¡åŒºé—´ï¼ˆç½®ä¿¡æ°´å¹³ \\(1-\\alpha\\)ï¼‰ï¼š \\[\n\\hat{\\beta}_j \\pm t_{1-\\alpha/2}(n-p-1) \\cdot SE(\\hat{\\beta}_j)\n\\]\nè¯¯å·®æ–¹å·®çš„ç½®ä¿¡åŒºé—´ï¼š \\[\n\\left[ \\frac{(n-p-1)s^2}{\\chi^2_{1-\\alpha/2}(n-p-1)}, \\frac{(n-p-1)s^2}{\\chi^2_{\\alpha/2}(n-p-1)} \\right]\n\\]\næœ€å°äºŒä¹˜æ³•å®ç°\n\nset.seed(123)\nn &lt;- 100\nx &lt;- seq(1, 10, length.out = n)\ny &lt;- 2 + 1.5 * x + rnorm(n, 0, 1.5)\n\n# æ‰‹åŠ¨å®ç°OLS\nmanual_ols &lt;- function(x, y) {\n  x_mean &lt;- mean(x)\n  y_mean &lt;- mean(y)\n  slope &lt;- sum((x - x_mean) * (y - y_mean)) / sum((x - x_mean)^2)\n  intercept &lt;- y_mean - slope * x_mean\n  return(c(intercept = intercept, slope = slope))\n}\n\nmanual_coef &lt;- manual_ols(x, y)\nlm_coef &lt;- coef(lm(y ~ x))\n\ncat(\"å‚æ•°ä¼°è®¡æ¯”è¾ƒ:\\n\")\n\nå‚æ•°ä¼°è®¡æ¯”è¾ƒ:\n\nprint(data.frame(\n  æ–¹æ³• = c(\"æ‰‹åŠ¨OLS\", \"lmå‡½æ•°\"),\n  æˆªè· = c(manual_coef[1], lm_coef[1]),\n  æ–œç‡ = c(manual_coef[2], lm_coef[2])\n))\n\n               æ–¹æ³•     æˆªè·     æ–œç‡\nintercept   æ‰‹åŠ¨OLS 1.907728 1.541433\n(Intercept)  lmå‡½æ•° 1.907728 1.541433\n\n\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso\nfrom sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.metrics import mean_squared_error, r2_score\nfrom sklearn.datasets import fetch_openml\n\n# è®¾ç½®æ ·å¼\nplt.style.use('default')\nsns.set_palette(\"husl\")\n\n# ç”Ÿæˆæ•°æ®\nnp.random.seed(123)\nn = 100\nx = np.linspace(1, 10, n)\ny = 2 + 1.5 * x + np.random.normal(0, 1.5, n)\n\ndef manual_ols(x, y):\n    \"\"\"æ‰‹åŠ¨å®ç°OLS\"\"\"\n    x_mean, y_mean = np.mean(x), np.mean(y)\n    slope = np.sum((x - x_mean) * (y - y_mean)) / np.sum((x - x_mean)**2)\n    intercept = y_mean - slope * x_mean\n    return intercept, slope\n\n# æ¯”è¾ƒç»“æœ\nmanual_intercept, manual_slope = manual_ols(x, y)\nlr = LinearRegression()\nlr.fit(x.reshape(-1, 1), y)\n\n\n\n\nLinearRegression()\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\nLinearRegression\n\n?Documentation for LinearRegressioniFitted\nLinearRegression() \n\n\nprint(\"å‚æ•°ä¼°è®¡æ¯”è¾ƒ:\")\n\nå‚æ•°ä¼°è®¡æ¯”è¾ƒ:\n\nprint(f\"{'æ–¹æ³•':&lt;10} {'æˆªè·':&lt;8} {'æ–œç‡':&lt;8}\")\n\næ–¹æ³•         æˆªè·       æ–œç‡      \n\nprint(f\"{'æ‰‹åŠ¨OLS':&lt;10} {manual_intercept:.4f}  {manual_slope:.4f}\")\n\næ‰‹åŠ¨OLS      2.0149  1.5047\n\nprint(f\"{'Sklearn':&lt;10} {lr.intercept_:.4f}  {lr.coef_[0]:.4f}\")\n\nSklearn    2.0149  1.5047",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html#æ‹Ÿåˆä¼˜åº¦",
    "href": "chapters/2 çº¿æ€§å›å½’.html#æ‹Ÿåˆä¼˜åº¦",
    "title": "2 çº¿æ€§å›å½’",
    "section": "2.3 æ‹Ÿåˆä¼˜åº¦",
    "text": "2.3 æ‹Ÿåˆä¼˜åº¦\n2.3.1 æ€»å¹³æ–¹å’Œåˆ†è§£\næ€»å¹³æ–¹å’Œï¼š\\(SST = \\sum_{i=1}^n (y_i - \\bar{y})^2\\) å›å½’å¹³æ–¹å’Œï¼š\\(SSR = \\sum_{i=1}^n (\\hat{y}_i - \\bar{y})^2\\) æ®‹å·®å¹³æ–¹å’Œï¼š\\(SSE = \\sum_{i=1}^n (y_i - \\hat{y}_i)^2\\)\nå¹³æ–¹å’Œåˆ†è§£å…¬å¼ï¼š \\[\nSST = SSR + SSE\n\\]\n2.3.2 å†³å®šç³»æ•°\nå®šä¹‰ï¼š \\[\nR^2 = \\frac{SSR}{SST} = 1 - \\frac{SSE}{SST}\n\\]\næ€§è´¨ï¼š - \\(0 \\leq R^2 \\leq 1\\) - \\(R^2\\) è¡¡é‡æ¨¡å‹å¯¹å› å˜é‡å˜å¼‚çš„è§£é‡Šæ¯”ä¾‹ - \\(R^2\\) éšè‡ªå˜é‡å¢åŠ è€Œå¢åŠ ï¼Œå¯èƒ½è¿‡æ‹Ÿåˆ\n2.3.3 è°ƒæ•´çš„å†³å®šç³»æ•°\nå®šä¹‰ï¼š \\[\nR^2_{adj} = 1 - \\frac{SSE/(n-p-1)}{SST/(n-1)} = 1 - (1-R^2)\\frac{n-1}{n-p-1}\n\\]\nä¼˜ç‚¹ï¼šå¯¹æ¨¡å‹å¤æ‚åº¦æ–½åŠ æƒ©ç½šï¼Œæ›´é€‚åˆæ¨¡å‹æ¯”è¾ƒ",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html#å‡è®¾æ£€éªŒ",
    "href": "chapters/2 çº¿æ€§å›å½’.html#å‡è®¾æ£€éªŒ",
    "title": "2 çº¿æ€§å›å½’",
    "section": "2.4 å‡è®¾æ£€éªŒ",
    "text": "2.4 å‡è®¾æ£€éªŒ\n2.4.1 æ¨¡å‹æ•´ä½“æ˜¾è‘—æ€§æ£€éªŒï¼ˆFæ£€éªŒï¼‰\nåŸå‡è®¾ï¼š\\(H_0: \\beta_1 = \\beta_2 = \\cdots = \\beta_p = 0\\)\nFç»Ÿè®¡é‡ï¼š \\[\nF = \\frac{SSR/p}{SSE/(n-p-1)} = \\frac{MSR}{MSE} \\sim F(p, n-p-1)\n\\]\nå†³ç­–è§„åˆ™ï¼šå¦‚æœ \\(F &gt; F_{1-\\alpha}(p, n-p-1)\\)ï¼Œæ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºæ¨¡å‹æ•´ä½“æ˜¾è‘—\n2.4.2 å•ä¸ªç³»æ•°æ˜¾è‘—æ€§æ£€éªŒï¼ˆtæ£€éªŒï¼‰\nåŸå‡è®¾ï¼š\\(H_0: \\beta_j = 0\\)\ntç»Ÿè®¡é‡ï¼š \\[\nt = \\frac{\\hat{\\beta}_j}{SE(\\hat{\\beta}_j)} \\sim t(n-p-1)\n\\]\nå†³ç­–è§„åˆ™ï¼šå¦‚æœ \\(|t| &gt; t_{1-\\alpha/2}(n-p-1)\\)ï¼Œæ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºè¯¥è‡ªå˜é‡å¯¹å› å˜é‡æœ‰æ˜¾è‘—å½±å“\näº¤äº’æ¼”ç¤ºï¼štæ£€éªŒä¸på€¼\n\n# 2.3.2 äº¤äº’å¼å‡è®¾æ£€éªŒæ¼”ç¤º\ninteractive_hypothesis_test &lt;- function() {\n  if (!require(manipulate)) {\n    stop(\"è¯·å®‰è£…manipulateåŒ…: install.packages('manipulate')\")\n  }\n  \n  set.seed(123)\n  \n  manipulate({\n    # ç”Ÿæˆæ•°æ®\n    n &lt;- sample_size\n    x &lt;- runif(n, 0, 10)\n    true_slope &lt;- 0  # é›¶å‡è®¾ä¸ºçœŸ\n    y &lt;- 1 + true_slope * x + rnorm(n, 0, noise_sd)\n    \n    data &lt;- data.frame(x = x, y = y)\n    model &lt;- lm(y ~ x, data = data)\n    summary_model &lt;- summary(model)\n    \n    # æå–tç»Ÿè®¡é‡å’Œpå€¼\n    t_stat &lt;- summary_model$coefficients[2, \"t value\"]\n    p_value &lt;- summary_model$coefficients[2, \"Pr(&gt;|t|)\"]\n    \n    # ç»˜åˆ¶æ•°æ®ç‚¹å’Œå›å½’çº¿\n    par(mfrow = c(1, 2))\n    \n    # å·¦å›¾ï¼šæ•£ç‚¹å›¾å’Œå›å½’çº¿\n    plot(x, y, pch = 16, col = \"blue\", \n         main = paste(\"æ•°æ®ä¸å›å½’çº¿\\nn =\", n, \"Ïƒ =\", noise_sd),\n         xlab = \"X\", ylab = \"Y\",\n         xlim = c(0, 10), ylim = c(1 - 3*noise_sd, 1 + 3*noise_sd))\n    abline(model, col = \"red\", lwd = 2)\n    abline(h = mean(y), col = \"green\", lwd = 2, lty = 2)\n    legend(\"topright\", \n           legend = c(\"æ•°æ®\", \"å›å½’çº¿\", \"Yå‡å€¼\"),\n           col = c(\"blue\", \"red\", \"green\"),\n           lwd = c(NA, 2, 2), pch = c(16, NA, NA),\n           lty = c(NA, 1, 2))\n    \n    # å³å›¾ï¼štåˆ†å¸ƒå’Œpå€¼\n    x_t &lt;- seq(-4, 4, length.out = 100)\n    y_t &lt;- dt(x_t, df = n - 2)\n    \n    plot(x_t, y_t, type = \"l\", lwd = 2, col = \"black\",\n         main = paste(\"tæ£€éªŒ: t =\", round(t_stat, 3), \n                     \"p =\", round(p_value, 4)),\n         xlab = \"tç»Ÿè®¡é‡\", ylab = \"å¯†åº¦\")\n    \n    # ç€è‰²æ‹’ç»åŸŸ\n    alpha &lt;- 0.05\n    critical_value &lt;- qt(1 - alpha/2, df = n - 2)\n    \n    # å·¦ä¾§æ‹’ç»åŸŸ\n    x_left &lt;- seq(-4, -critical_value, length.out = 50)\n    y_left &lt;- dt(x_left, df = n - 2)\n    polygon(c(-4, x_left, -critical_value), c(0, y_left, 0), \n            col = \"red\", density = 20, angle = 45)\n    \n    # å³ä¾§æ‹’ç»åŸŸ  \n    x_right &lt;- seq(critical_value, 4, length.out = 50)\n    y_right &lt;- dt(x_right, df = n - 2)\n    polygon(c(critical_value, x_right, 4), c(0, y_right, 0),\n            col = \"red\", density = 20, angle = 45)\n    \n    # æ ‡è®°tç»Ÿè®¡é‡\n    abline(v = t_stat, col = \"blue\", lwd = 2, lty = 2)\n    points(t_stat, dt(t_stat, df = n - 2), pch = 16, col = \"blue\", cex = 1.5)\n    text(t_stat, dt(t_stat, df = n - 2) + 0.02, \n         paste(\"t =\", round(t_stat, 3)), pos = 3, col = \"blue\")\n    \n    # æ ‡è®°ä¸´ç•Œå€¼\n    abline(v = c(-critical_value, critical_value), \n           col = \"red\", lwd = 1, lty = 2)\n    text(critical_value, 0.3, paste(\"ä¸´ç•Œå€¼ =\", round(critical_value, 3)), \n         pos = 4, col = \"red\")\n    \n    # æ·»åŠ å†³ç­–\n    decision &lt;- ifelse(p_value &lt; alpha, \"æ‹’ç»H0\", \"ä¸æ‹’ç»H0\")\n    legend(\"topright\", \n           legend = c(paste(\"på€¼:\", round(p_value, 4)),\n                     paste(\"Î±:\", alpha),\n                     paste(\"å†³ç­–:\", decision)),\n           bty = \"n\", cex = 0.8)\n    \n  },\n  sample_size = slider(10, 200, initial = 30, step = 10, label = \"æ ·æœ¬é‡ n\"),\n  noise_sd = slider(0.5, 5, initial = 2, step = 0.5, label = \"å™ªå£°æ ‡å‡†å·® Ïƒ\")\n  )\n}\n\n# è¿è¡Œäº¤äº’æ¼”ç¤ºï¼ˆéœ€è¦RStudioï¼‰\n# interactive_hypothesis_test()\n\n# é™æ€ç‰ˆæœ¬\nstatic_hypothesis_test &lt;- function(n = 30, noise_sd = 2) {\n  set.seed(123)\n  \n  # ç”Ÿæˆæ•°æ®\n  x &lt;- runif(n, 0, 10)\n  true_slope &lt;- 0  # é›¶å‡è®¾ä¸ºçœŸ\n  y &lt;- 1 + true_slope * x + rnorm(n, 0, noise_sd)\n  \n  data &lt;- data.frame(x = x, y = y)\n  model &lt;- lm(y ~ x, data = data)\n  summary_model &lt;- summary(model)\n  \n  # æå–ç»Ÿè®¡é‡\n  t_stat &lt;- summary_model$coefficients[2, \"t value\"]\n  p_value &lt;- summary_model$coefficients[2, \"Pr(&gt;|t|)\"]\n  conf_int &lt;- confint(model)[2, ]\n  \n  # ç»˜åˆ¶å›¾å½¢\n  par(mfrow = c(1, 2))\n  \n  # å·¦å›¾ï¼šæ•°æ®ä¸å›å½’çº¿\n  plot(x, y, pch = 16, col = \"blue\", \n       main = paste(\"æ•°æ®ä¸å›å½’çº¿\\nn =\", n, \"Ïƒ =\", noise_sd),\n       xlab = \"X\", ylab = \"Y\")\n  abline(model, col = \"red\", lwd = 2)\n  abline(h = mean(y), col = \"green\", lwd = 2, lty = 2)\n  legend(\"topright\", \n         legend = c(\"æ•°æ®\", \"å›å½’çº¿\", \"Yå‡å€¼\"),\n         col = c(\"blue\", \"red\", \"green\"),\n         lwd = c(NA, 2, 2), pch = c(16, NA, NA),\n         lty = c(NA, 1, 2))\n  \n  # å³å›¾ï¼štåˆ†å¸ƒ\n  x_t &lt;- seq(-4, 4, length.out = 100)\n  y_t &lt;- dt(x_t, df = n - 2)\n  \n  plot(x_t, y_t, type = \"l\", lwd = 2, col = \"black\",\n       main = paste(\"tæ£€éªŒ: t =\", round(t_stat, 3), \n                   \"p =\", round(p_value, 4)),\n       xlab = \"tç»Ÿè®¡é‡\", ylab = \"å¯†åº¦\")\n  \n  alpha &lt;- 0.05\n  critical_value &lt;- qt(1 - alpha/2, df = n - 2)\n  \n  # ç€è‰²æ‹’ç»åŸŸ\n  x_left &lt;- seq(-4, -critical_value, length.out = 50)\n  y_left &lt;- dt(x_left, df = n - 2)\n  polygon(c(-4, x_left, -critical_value), c(0, y_left, 0), \n          col = \"red\", alpha = 0.3)\n  \n  x_right &lt;- seq(critical_value, 4, length.out = 50)\n  y_right &lt;- dt(x_right, df = n - 2)\n  polygon(c(critical_value, x_right, 4), c(0, y_right, 0),\n          col = \"red\", alpha = 0.3)\n  \n  # æ ‡è®°ç»Ÿè®¡é‡\n  abline(v = t_stat, col = \"blue\", lwd = 2, lty = 2)\n  points(t_stat, dt(t_stat, df = n - 2), pch = 16, col = \"blue\", cex = 1.5)\n  \n  # æ ‡è®°ä¸´ç•Œå€¼\n  abline(v = c(-critical_value, critical_value), \n         col = \"red\", lwd = 1, lty = 2)\n  \n  # å†³ç­–\n  decision &lt;- ifelse(p_value &lt; alpha, \"æ‹’ç»H0\", \"ä¸æ‹’ç»H0\")\n  legend(\"topright\", \n         legend = c(paste(\"på€¼:\", round(p_value, 4)),\n                   paste(\"Î±:\", alpha),\n                   paste(\"å†³ç­–:\", decision)),\n         bty = \"n\")\n  \n  par(mfrow = c(1, 1))\n  \n  cat(\"å‡è®¾æ£€éªŒç»“æœ:\\n\")\n  cat(\"tç»Ÿè®¡é‡:\", round(t_stat, 4), \"\\n\")\n  cat(\"på€¼:\", round(p_value, 4), \"\\n\")\n  cat(\"95%ç½®ä¿¡åŒºé—´: [\", round(conf_int[1], 4), \",\", round(conf_int[2], 4), \"]\\n\")\n  cat(\"å†³ç­–:\", decision, \"\\n\")\n  \n  return(list(\n    model = model,\n    t_stat = t_stat,\n    p_value = p_value,\n    decision = decision\n  ))\n}\n\n# è¿è¡Œé™æ€æ£€éªŒæ¼”ç¤º\nstatic_test &lt;- static_hypothesis_test(n = 50, noise_sd = 1.5)\n\n\n\n\n\n\n\nå‡è®¾æ£€éªŒç»“æœ:\ntç»Ÿè®¡é‡: 0.8363 \npå€¼: 0.4071 \n95%ç½®ä¿¡åŒºé—´: [ -0.0804 , 0.1949 ]\nå†³ç­–: ä¸æ‹’ç»H0 \n\n\n2.4.3 ç³»æ•°çº¿æ€§ç»„åˆçš„æ£€éªŒ\nåŸå‡è®¾ï¼š\n\\(H_0: \\mathbf{C}\\pmb{\\beta} = \\mathbf{d}\\)\nFç»Ÿè®¡é‡ï¼š \\[\nF = \\frac{(\\mathbf{C}\\hat{\\pmb{\\beta}} - \\mathbf{d})'[\\mathbf{C}(\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{C}']^{-1}(\\mathbf{C}\\hat{\\pmb{\\beta}} - \\mathbf{d})}{q \\cdot MSE} \\sim F(q, n-p-1)\n\\]\nå…¶ä¸­ \\(\\mathbf{C}\\) æ˜¯ \\(q \\times (p+1)\\) çš„çº¦æŸçŸ©é˜µï¼Œ\\(\\mathbf{d}\\) æ˜¯ \\(q \\times 1\\) çš„å¸¸æ•°å‘é‡\næ¨¡å‹æ˜¾è‘—æ€§æ£€éªŒ\n\nmodel &lt;- lm(y ~ x)\nsummary_model &lt;- summary(model)\n\ncat(\"æ¨¡å‹æ˜¾è‘—æ€§æ£€éªŒ:\\n\")\n\næ¨¡å‹æ˜¾è‘—æ€§æ£€éªŒ:\n\ncat(\"Fç»Ÿè®¡é‡:\", round(summary_model$fstatistic[1], 3), \"\\n\")\n\nFç»Ÿè®¡é‡: 869.473 \n\ncat(\"på€¼:\", format.pval(pf(summary_model$fstatistic[1], \n                          summary_model$fstatistic[2], \n                          summary_model$fstatistic[3], \n                          lower.tail = FALSE)), \"\\n\")\n\npå€¼: &lt; 2.22e-16 \n\ncat(\"\\nç³»æ•°æ£€éªŒ:\\n\")\n\n\nç³»æ•°æ£€éªŒ:\n\nprint(round(summary_model$coefficients, 4))\n\n            Estimate Std. Error t value Pr(&gt;|t|)\n(Intercept)   1.9077     0.3186  5.9885        0\nx             1.5414     0.0523 29.4868        0",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html#é¢„æµ‹",
    "href": "chapters/2 çº¿æ€§å›å½’.html#é¢„æµ‹",
    "title": "2 çº¿æ€§å›å½’",
    "section": "2.5 é¢„æµ‹",
    "text": "2.5 é¢„æµ‹\n2.5.1 ç‚¹é¢„æµ‹\nå¯¹äºæ–°çš„è‡ªå˜é‡è§‚æµ‹ \\(\\mathbf{x}_0 = (1, x_{01}, x_{02}, \\cdots, x_{0p})'\\)ï¼Œå› å˜é‡çš„ç‚¹é¢„æµ‹ä¸ºï¼š \\[\n\\hat{y}_0 = \\mathbf{x}_0'\\hat{\\pmb{\\beta}}\n\\]\n2.5.2 åŒºé—´é¢„æµ‹\nå‡å€¼çš„ç½®ä¿¡åŒºé—´ï¼ˆä¼°è®¡æ¡ä»¶å‡å€¼çš„ç½®ä¿¡åŒºé—´ï¼‰ï¼š \\[\n\\hat{y}_0 \\pm t_{1-\\alpha/2}(n-p-1) \\cdot s \\sqrt{\\mathbf{x}_0'(\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{x}_0}\n\\]\nä¸ªåˆ«å€¼çš„é¢„æµ‹åŒºé—´ï¼ˆé¢„æµ‹å•ä¸ªæ–°è§‚æµ‹å€¼çš„åŒºé—´ï¼‰ï¼š \\[\n\\hat{y}_0 \\pm t_{1-\\alpha/2}(n-p-1) \\cdot s \\sqrt{1 + \\mathbf{x}_0'(\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{x}_0}\n\\]\né‡è¦åŒºåˆ«ï¼š - å‡å€¼ç½®ä¿¡åŒºé—´ï¼šä¼°è®¡çš„æ˜¯ \\(E(y|\\mathbf{x}_0)\\) çš„ç½®ä¿¡åŒºé—´ - ä¸ªåˆ«å€¼é¢„æµ‹åŒºé—´ï¼šé¢„æµ‹çš„æ˜¯å•ä¸ª \\(y_0\\) çš„åŒºé—´ï¼ŒåŒ…å«é¢å¤–çš„è¯¯å·®æ–¹å·®é¡¹\n2.5.3 é¢„æµ‹ç²¾åº¦çš„å½±å“å› ç´ \n\næ ·æœ¬é‡ \\(n\\)ï¼šæ ·æœ¬é‡è¶Šå¤§ï¼Œé¢„æµ‹è¶Šç²¾ç¡®\nè‡ªå˜é‡å˜å¼‚ï¼š\\(\\mathbf{X}'\\mathbf{X}\\) çš„è¡Œåˆ—å¼å€¼è¶Šå¤§ï¼Œé¢„æµ‹è¶Šç²¾ç¡®\næ æ†å€¼ï¼š\\(\\mathbf{x}_0\\) ä¸æ ·æœ¬ä¸­å¿ƒçš„è·ç¦»å½±å“é¢„æµ‹æ–¹å·®\nè¯¯å·®æ–¹å·®ï¼š\\(\\sigma^2\\) è¶Šå°ï¼Œé¢„æµ‹è¶Šç²¾ç¡®",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/2 çº¿æ€§å›å½’.html#æ¡ˆä¾‹åˆ†æ",
    "title": "2 çº¿æ€§å›å½’",
    "section": "2.6 æ¡ˆä¾‹åˆ†æ",
    "text": "2.6 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/2 çº¿æ€§å›å½’.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/2 çº¿æ€§å›å½’.html#æœ¬ç« æ€»ç»“",
    "title": "2 çº¿æ€§å›å½’",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾\n\nOLSä¼°è®¡ï¼š\\(\\hat{\\pmb{\\beta}} = (\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{y}\\)\n\nç³»æ•°æ–¹å·®ï¼š\\(\\text{Var}(\\hat{\\pmb{\\beta}}) = \\sigma^2(\\mathbf{X}'\\mathbf{X})^{-1}\\)\n\næ‹Ÿåˆä¼˜åº¦ï¼š\\(R^2 = 1 - \\frac{SSE}{SST}\\)\n\nFæ£€éªŒï¼š\\(F = \\frac{MSR}{MSE} \\sim F(p, n-p-1)\\)\n\ntæ£€éªŒï¼š\\(t = \\frac{\\hat{\\beta}_j}{SE(\\hat{\\beta}_j)} \\sim t(n-p-1)\\)\n\né¢„æµ‹åŒºé—´ï¼š\\(\\hat{y}_0 \\pm t_{\\alpha/2} \\cdot s \\sqrt{1 + \\mathbf{x}_0'(\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{x}_0}\\)\n\n\nå…³é”®æ¦‚å¿µ\n\n\næ¦‚å¿µ\nå®šä¹‰\nåº”ç”¨\n\n\n\nOLSä¼°è®¡\næœ€å°åŒ–æ®‹å·®å¹³æ–¹å’Œ\nå‚æ•°ä¼°è®¡çš„ä¸»è¦æ–¹æ³•\n\n\nMLEä¼°è®¡\næœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°\nåœ¨æ­£æ€å‡è®¾ä¸‹ä¸OLSç­‰ä»·\n\n\n\\(R^2\\)\næ¨¡å‹è§£é‡Šçš„å˜å¼‚æ¯”ä¾‹\næ‹Ÿåˆä¼˜åº¦åˆæ­¥è¯„ä»·\n\n\nè°ƒæ•´\\(R^2\\)\n\nå¯¹å¤æ‚åº¦æƒ©ç½šçš„\\(R^2\\)\n\næ¨¡å‹æ¯”è¾ƒ\n\n\nFæ£€éªŒ\næ¨¡å‹æ•´ä½“æ˜¾è‘—æ€§æ£€éªŒ\nåˆ¤æ–­æ¨¡å‹æ˜¯å¦æœ‰æ„ä¹‰\n\n\ntæ£€éªŒ\nå•ä¸ªç³»æ•°æ˜¾è‘—æ€§æ£€éªŒ\nå˜é‡é€‰æ‹©ä¾æ®\n\n\né¢„æµ‹åŒºé—´\nä¸ªåˆ«å€¼çš„é¢„æµ‹èŒƒå›´\nå®é™…é¢„æµ‹åº”ç”¨\n\n\n\nçº¿æ€§å›å½’ä¸ºåç»­æ‰€æœ‰é¢„æµ‹å»ºæ¨¡æ–¹æ³•æä¾›äº†ç†è®ºåŸºç¡€å’Œåˆ†ææ¡†æ¶ã€‚ç†è§£æœ¬ç« å†…å®¹å¯¹äºæŒæ¡ç°ä»£é¢„æµ‹å»ºæ¨¡æŠ€æœ¯è‡³å…³é‡è¦ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>2 çº¿æ€§å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/3 æ¨¡å‹è¯Šæ–­.html",
    "href": "chapters/3 æ¨¡å‹è¯Šæ–­.html",
    "title": "3 æ¨¡å‹è¯Šæ–­",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\nåœ¨å»ºç«‹çº¿æ€§å›å½’æ¨¡å‹åï¼Œæˆ‘ä»¬ç»ä¸èƒ½å°†å…¶è§†ä¸ºç»ˆæçœŸç†ã€‚æ¨¡å‹è¯Šæ–­å¦‚åŒä¸€æ¬¡ä¸¥è°¨çš„â€ä½“æ£€â€ï¼Œæ—¨åœ¨è¯„ä¼°æ¨¡å‹çš„åŸºæœ¬å‡è®¾æ˜¯å¦æˆç«‹ï¼Œæ•°æ®ä¸­æ˜¯å¦å­˜åœ¨å¼‚å¸¸æƒ…å†µã€‚æœ¬ç« å°†ç³»ç»Ÿå­¦ä¹ å¦‚ä½•ä½¿ç”¨æ®‹å·®åˆ†æè¿™ä¸€æ ¸å¿ƒå·¥å…·ï¼Œæ£€éªŒæ¨¡å‹çš„çº¿æ€§æ€§ã€æ­£æ€æ€§åŠåŒæ–¹å·®æ€§å‡è®¾ï¼Œå¹¶æ·±å…¥æ¢è®¨å¼‚å¸¸å€¼å’Œé«˜æ æ†ç‚¹çš„è¯†åˆ«æ–¹æ³•ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å°†å»ºç«‹å®Œæ•´çš„é—®é¢˜è¯Šæ–­ä¸å¤„ç†æ¡†æ¶ï¼Œä¸ºæ„å»ºæ›´å¯é çš„é¢„æµ‹æ¨¡å‹å¥ å®šåŸºç¡€ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>3 æ¨¡å‹è¯Šæ–­</span>"
    ]
  },
  {
    "objectID": "chapters/3 æ¨¡å‹è¯Šæ–­.html#æ®‹å·®åˆ†æ",
    "href": "chapters/3 æ¨¡å‹è¯Šæ–­.html#æ®‹å·®åˆ†æ",
    "title": "3 æ¨¡å‹è¯Šæ–­",
    "section": "3.1 æ®‹å·®åˆ†æ",
    "text": "3.1 æ®‹å·®åˆ†æ\n\n3.1.1 æ®‹å·®çš„åŸºæœ¬æ¦‚å¿µä¸ç†è®ºåŸºç¡€\næ®‹å·®çš„å®šä¹‰ï¼šå¯¹äºçº¿æ€§å›å½’æ¨¡å‹ \\[\ny_i = \\beta_0 + \\beta_1x_{i1} + \\beta_2x_{i2} + \\cdots + \\beta_px_{ip} + \\varepsilon_i\n\\]\nç¬¬ \\(i\\) ä¸ªè§‚æµ‹å€¼çš„æ®‹å·®å®šä¹‰ä¸ºï¼š \\[\ne_i = y_i - \\hat{y}_i\n\\] å…¶ä¸­ \\(\\hat{y}_i\\) æ˜¯æ¨¡å‹çš„é¢„æµ‹å€¼ã€‚\nç»å…¸çº¿æ€§å›å½’çš„åŸºæœ¬å‡è®¾ï¼š\nï¼ˆ1ï¼‰. çº¿æ€§å…³ç³»ï¼š\\(E(\\varepsilon_i) = 0\\)\nï¼ˆ2ï¼‰. åŒæ–¹å·®æ€§ï¼š\\(\\text{Var}(\\varepsilon_i) = \\sigma^2\\)ï¼ˆå¸¸æ•°ï¼‰\nï¼ˆ3ï¼‰. æ— è‡ªç›¸å…³ï¼š\\(\\text{Cov}(\\varepsilon_i, \\varepsilon_j) = 0\\)ï¼ˆå½“ \\(i \\neq j\\)ï¼‰\nï¼ˆ4ï¼‰. æ­£æ€æ€§ï¼š\\(\\varepsilon_i \\sim N(0, \\sigma^2)\\) 5. æ— å¤šé‡å…±çº¿æ€§ï¼šè‡ªå˜é‡ä¹‹é—´ä¸å­˜åœ¨å®Œå…¨çº¿æ€§å…³ç³»\n\n\n3.1.2 æ ‡å‡†åŒ–æ®‹å·®ä¸å­¦ç”ŸåŒ–æ®‹å·®\næ ‡å‡†åŒ–æ®‹å·®ï¼š \\[\nz_i = \\frac{e_i}{\\hat{\\sigma}} = \\frac{e_i}{\\sqrt{\\frac{1}{n-p-1}\\sum_{i=1}^n e_i^2}}\n\\]\nå­¦ç”ŸåŒ–æ®‹å·®ï¼ˆå†…éƒ¨å­¦ç”ŸåŒ–ï¼‰ï¼š \\[\nr_i = \\frac{e_i}{\\hat{\\sigma}\\sqrt{1 - h_{ii}}}\n\\]\nå¤–éƒ¨å­¦ç”ŸåŒ–æ®‹å·®ï¼š \\[\nt_i = \\frac{e_i}{\\hat{\\sigma}_{(i)}\\sqrt{1 - h_{ii}}} \\sim t(n-p-2)\n\\] å…¶ä¸­ \\(\\hat{\\sigma}_{(i)}\\) æ˜¯å‰”é™¤ç¬¬ \\(i\\) ä¸ªè§‚æµ‹å€¼åé‡æ–°ä¼°è®¡çš„æ ‡å‡†å·®ï¼š \\[\n\\hat{\\sigma}_{(i)}^2 = \\frac{(n-p-1)\\hat{\\sigma}^2 - e_i^2/(1-h_{ii})}{n-p-2}\n\\]\n\n\n3.1.3 æ®‹å·®å›¾çš„ç³»ç»Ÿåˆ†æ\næ®‹å·®vsæ‹Ÿåˆå€¼å›¾\nè¿™æ˜¯æœ€é‡è¦çš„è¯Šæ–­å›¾ï¼Œç”¨äºæ£€éªŒï¼š - çº¿æ€§æ€§ï¼šç‚¹åº”éšæœºåˆ†å¸ƒåœ¨æ°´å¹³å¸¦ around 0 - åŒæ–¹å·®æ€§ï¼šç‚¹çš„æ•£å¸ƒèŒƒå›´åº”æ’å®š\nå¼‚å¸¸æ¨¡å¼è¯†åˆ«ï¼š - å–‡å­å£å½¢ï¼š\\(\\text{Var}(e_i) \\propto \\hat{y}_i^k\\)ï¼Œæç¤ºå¼‚æ–¹å·® - æ›²çº¿æ¨¡å¼ï¼šæç¤ºéçº¿æ€§å…³ç³»ï¼Œéœ€è€ƒè™‘ \\(E(y|x) = f(x'\\beta)\\)\næ­£æ€Q-Qå›¾\næ£€éªŒæ®‹å·®çš„æ­£æ€æ€§å‡è®¾ã€‚ç†è®ºåˆ†ä½æ•°ä¸æ ·æœ¬åˆ†ä½æ•°åº”å¤§è‡´åœ¨ç›´çº¿ä¸Šï¼š\nç†è®ºåˆ†ä½æ•°ï¼š\\(z_{(i)} = \\Phi^{-1}\\left(\\frac{i-0.375}{n+0.25}\\right)\\)\nåç¦»æ¨¡å¼ï¼š\n\n- Så½¢æ›²çº¿ï¼šåˆ†å¸ƒæœ‰å\n- å°¾éƒ¨åç¦»ï¼šé‡å°¾æˆ–è½»å°¾åˆ†å¸ƒ\n\næ®‹å·®vsè‡ªå˜é‡å›¾\nç”¨äºè¯†åˆ«ç‰¹å®šè‡ªå˜é‡çš„éçº¿æ€§å…³ç³»ï¼š \\[\ne_i \\text{ vs } x_{ij}\n\\]",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>3 æ¨¡å‹è¯Šæ–­</span>"
    ]
  },
  {
    "objectID": "chapters/3 æ¨¡å‹è¯Šæ–­.html#å¼‚å¸¸å€¼ä¸é«˜æ æ†ç‚¹",
    "href": "chapters/3 æ¨¡å‹è¯Šæ–­.html#å¼‚å¸¸å€¼ä¸é«˜æ æ†ç‚¹",
    "title": "3 æ¨¡å‹è¯Šæ–­",
    "section": "3.2 å¼‚å¸¸å€¼ä¸é«˜æ æ†ç‚¹",
    "text": "3.2 å¼‚å¸¸å€¼ä¸é«˜æ æ†ç‚¹\n\n3.2.1 æ æ†å€¼åˆ†æ\næ æ†å€¼çš„å®šä¹‰ï¼š \\[\nh_{ii} = \\mathbf{x}_i'(\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{x}_i\n\\]\nå…¶ä¸­ \\(\\mathbf{x}_i = (1, x_{i1}, x_{i2}, \\cdots, x_{ip})'\\)\næ æ†å€¼çš„æ€§è´¨ï¼š\n- \\(0 \\leq h_{ii} \\leq 1\\) - \\(\\sum_{i=1}^n h_{ii} = p + 1\\)\n- å¹³å‡æ æ†å€¼ï¼š\\(\\bar{h} = \\frac{p+1}{n}\\)\né«˜æ æ†ç‚¹çš„è¯†åˆ«ï¼š\n\n- ç»éªŒæ³•åˆ™ï¼š\\(h_{ii} &gt; 2\\bar{h} = \\frac{2(p+1)}{n}\\)\n- ä¸¥æ ¼æ ‡å‡†ï¼š\\(h_{ii} &gt; 3\\bar{h} = \\frac{3(p+1)}{n}\\)\n\n\n\n3.2.2 å¼‚å¸¸å€¼æ£€æµ‹\nåŸºäºå­¦ç”ŸåŒ–æ®‹å·®çš„å‡†åˆ™ï¼š \\[\n|t_i| &gt; t_{1-\\alpha/2}(n-p-2)\n\\]\nå¼‚å¸¸å€¼çš„æ•°å­¦å®šä¹‰ï¼šè§‚æµ‹å€¼ \\((y_i, \\mathbf{x}_i)\\) è¢«ç§°ä¸ºå¼‚å¸¸å€¼ï¼Œå¦‚æœ \\[\n|y_i - \\mathbf{x}_i'\\hat{\\pmb{\\beta}}| \\gg \\sigma\n\\]\n\n\n3.2.3 å½±å“ç‚¹çš„ç»¼åˆåº¦é‡\nCookè·ç¦»\nå®šä¹‰ï¼š \\[\nD_i = \\frac{(\\hat{\\pmb{\\beta}} - \\hat{\\pmb{\\beta}}_{(i)})'(\\mathbf{X}'\\mathbf{X})(\\hat{\\pmb{\\beta}} - \\hat{\\pmb{\\beta}}_{(i)})}{(p+1)\\hat{\\sigma}^2}\n\\]\nè®¡ç®—å…¬å¼ï¼š \\[\nD_i = \\frac{e_i^2}{(p+1)\\hat{\\sigma}^2} \\times \\frac{h_{ii}}{(1-h_{ii})^2}\n\\]\nåˆ¤æ–­å‡†åˆ™ï¼š\n- \\(D_i &gt; 1\\)ï¼šç»å¯¹éœ€è¦æ£€æŸ¥\n- \\(D_i &gt; \\frac{4}{n}\\)ï¼šå»ºè®®æ£€æŸ¥\nDFFITSç»Ÿè®¡é‡\nå®šä¹‰ï¼šè¡¡é‡ç¬¬ \\(i\\) ä¸ªè§‚æµ‹å¯¹è‡ªèº«æ‹Ÿåˆå€¼çš„å½±å“ \\[\n\\text{DFFITS}_i = \\frac{\\hat{y}_i - \\hat{y}_{i(i)}}{\\hat{\\sigma}_{(i)}\\sqrt{h_{ii}}}\n\\]\nè®¡ç®—å…¬å¼ï¼š \\[\n\\text{DFFITS}_i = t_i \\times \\sqrt{\\frac{h_{ii}}{1-h_{ii}}}\n\\]\nåˆ¤æ–­å‡†åˆ™ï¼š\\(|\\text{DFFITS}_i| &gt; 2\\sqrt{\\frac{p+1}{n}}\\)\nDFBETASç»Ÿè®¡é‡\nå®šä¹‰ï¼šè¡¡é‡ç¬¬ \\(i\\) ä¸ªè§‚æµ‹å¯¹æ¯ä¸ªç³»æ•°ä¼°è®¡çš„å½±å“ \\[\n\\text{DFBETAS}_{j(i)} = \\frac{\\hat{\\beta}_j - \\hat{\\beta}_{j(i)}}{\\hat{\\sigma}_{(i)}\\sqrt{[(\\mathbf{X}'\\mathbf{X})^{-1}]_{jj}}}\n\\]\nåˆ¤æ–­å‡†åˆ™ï¼š\\(|\\text{DFBETAS}_{j(i)}| &gt; \\frac{2}{\\sqrt{n}}\\)\n\n\n3.2.4 å½±å“ç‚¹çš„å¤„ç†ç­–ç•¥\nè¯Šæ–­æµç¨‹ï¼š 1. è®¡ç®—æ æ†å€¼ \\(h_{ii}\\)ï¼Œè¯†åˆ«é«˜æ æ†ç‚¹ 2. è®¡ç®—å­¦ç”ŸåŒ–æ®‹å·® \\(t_i\\)ï¼Œè¯†åˆ«å¼‚å¸¸å€¼ 3. è®¡ç®—Cookè·ç¦» \\(D_i\\)ï¼Œè¯†åˆ«å¼ºå½±å“ç‚¹ 4. åˆ†æDFFITSå’ŒDFBETASï¼Œäº†è§£å…·ä½“å½±å“\nå¤„ç†æ–¹æ¡ˆï¼š 1. æ•°æ®æ ¸æŸ¥ï¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨å½•å…¥é”™è¯¯ 2. ç¨³å¥å›å½’ï¼šå¦‚Mä¼°è®¡ï¼Œæœ€å°åŒ– \\(\\sum_{i=1}^n \\rho(e_i)\\) 3. å˜é‡å˜æ¢ï¼šé™ä½å¼‚å¸¸å€¼çš„å½±å“ 4. åˆ†æ®µå»ºæ¨¡ï¼šå¯¹å¼‚å¸¸åŒºåŸŸå•ç‹¬å»ºç«‹æ¨¡å‹",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>3 æ¨¡å‹è¯Šæ–­</span>"
    ]
  },
  {
    "objectID": "chapters/3 æ¨¡å‹è¯Šæ–­.html#å¼‚æ–¹å·®åŠå¤„ç†",
    "href": "chapters/3 æ¨¡å‹è¯Šæ–­.html#å¼‚æ–¹å·®åŠå¤„ç†",
    "title": "3 æ¨¡å‹è¯Šæ–­",
    "section": "3.3 å¼‚æ–¹å·®åŠå¤„ç†",
    "text": "3.3 å¼‚æ–¹å·®åŠå¤„ç†\n\n3.3.1 å¼‚æ–¹å·®çš„æ•°å­¦è¡¨è¿°ä¸å½±å“\nå¼‚æ–¹å·®çš„å®šä¹‰ï¼š \\[\n\\text{Var}(\\varepsilon_i) = \\sigma_i^2 \\neq \\text{å¸¸æ•°}\n\\]\nå¼‚æ–¹å·®å¯¹OLSä¼°è®¡çš„å½±å“ï¼š\n- æ— åæ€§ï¼š\\(E(\\hat{\\beta}) = \\beta\\)ï¼ˆä»ç„¶æˆç«‹ï¼‰\n- æœ‰æ•ˆæ€§ï¼š\\(\\text{Var}(\\hat{\\beta})\\) ä¸æ˜¯æœ€å°æ–¹å·®\n- æ¨æ–­å¯é æ€§ï¼šæ ‡å‡†è¯¯ä¼°è®¡æœ‰åï¼Œ\\(t\\) æ£€éªŒå’Œ \\(F\\) æ£€éªŒå¤±æ•ˆ\næ–¹å·®-åæ–¹å·®çŸ©é˜µï¼š \\[\n\\text{Var}(\\hat{\\pmb{\\beta}}) = (\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\pmb{\\Omega}\\mathbf{X}(\\mathbf{X}'\\mathbf{X})^{-1}\n\\] å…¶ä¸­ \\(\\pmb{\\Omega} = \\text{diag}(\\sigma_1^2, \\sigma_2^2, \\cdots, \\sigma_n^2)\\)\n\n\n3.3.2 å¼‚æ–¹å·®çš„ç»Ÿè®¡æ£€éªŒ\n\nBreusch-Paganæ£€éªŒ\nè¾…åŠ©å›å½’æ¨¡å‹ï¼š \\[\ne_i^2 = \\alpha_0 + \\alpha_1x_{i1} + \\cdots + \\alpha_px_{ip} + u_i\n\\]\næ£€éªŒç»Ÿè®¡é‡ï¼š \\[\n\\text{LM} = nR^2 \\sim \\chi^2(p)\n\\] å…¶ä¸­ \\(R^2\\) æ˜¯è¾…åŠ©å›å½’çš„å†³å®šç³»æ•°ã€‚\n\n\nWhiteæ£€éªŒ\nè¾…åŠ©å›å½’ï¼š \\[\ne_i^2 = \\alpha_0 + \\sum_{j=1}^p \\alpha_jx_{ij} + \\sum_{j=1}^p \\sum_{k\\geq j}^p \\alpha_{jk}x_{ij}x_{ik} + u_i\n\\]\næ£€éªŒç»Ÿè®¡é‡ï¼š \\[\n\\text{LM} = nR^2 \\sim \\chi^2(q)\n\\] å…¶ä¸­ \\(q\\) æ˜¯è¾…åŠ©å›å½’ä¸­è‡ªå˜é‡çš„ä¸ªæ•°ï¼ˆä¸åŒ…æ‹¬å¸¸æ•°é¡¹ï¼‰ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>3 æ¨¡å‹è¯Šæ–­</span>"
    ]
  },
  {
    "objectID": "chapters/3 æ¨¡å‹è¯Šæ–­.html#å¼‚æ–¹å·®çš„ä¿®æ­£",
    "href": "chapters/3 æ¨¡å‹è¯Šæ–­.html#å¼‚æ–¹å·®çš„ä¿®æ­£",
    "title": "3 æ¨¡å‹è¯Šæ–­",
    "section": "3.4 å¼‚æ–¹å·®çš„ä¿®æ­£",
    "text": "3.4 å¼‚æ–¹å·®çš„ä¿®æ­£\n\n3.4.1 ç¨³å¥æ ‡å‡†è¯¯ï¼ˆEicker-Huber-Whiteæ ‡å‡†è¯¯ï¼‰\nHC0ä¼°è®¡é‡ï¼š \\[\n\\text{Var}_{HC0}(\\hat{\\pmb{\\beta}}) = (\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\hat{\\pmb{\\Omega}}_{HC0}\\mathbf{X}(\\mathbf{X}'\\mathbf{X})^{-1}\n\\] å…¶ä¸­ \\(\\hat{\\pmb{\\Omega}}_{HC0} = \\text{diag}(e_1^2, e_2^2, \\cdots, e_n^2)\\)\nHC3ä¼°è®¡é‡ï¼ˆå°æ ·æœ¬æ›´ä¼˜ï¼‰ï¼š \\[\n\\hat{\\pmb{\\Omega}}_{HC3} = \\text{diag}\\left(\\frac{e_1^2}{(1-h_{11})^2}, \\frac{e_2^2}{(1-h_{22})^2}, \\cdots, \\frac{e_n^2}{(1-h_{nn})^2}\\right)\n\\]\n\n\n3.4.2 åŠ æƒæœ€å°äºŒä¹˜æ³•\næƒé‡é€‰æ‹©ï¼š\\(w_i = 1/\\sigma_i^2\\)\nWLSä¼°è®¡é‡ï¼š \\[\n\\hat{\\pmb{\\beta}}_{WLS} = (\\mathbf{X}'\\mathbf{W}\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{W}\\mathbf{y}\n\\] å…¶ä¸­ \\(\\mathbf{W} = \\text{diag}(w_1, w_2, \\cdots, w_n)\\)\nå¯è¡ŒGLSï¼šå½“ \\(\\sigma_i^2\\) æœªçŸ¥æ—¶ï¼Œä½¿ç”¨ \\(\\hat{w}_i = 1/\\hat{\\sigma}_i^2\\)\nå…¶ä»–æ–¹æ³•ï¼šå˜é‡å˜æ¢æ³•\nå¯¹æ•°å˜æ¢ï¼š\\(y^* = \\ln(y)\\)ï¼Œå½“ \\(\\text{Var}(\\varepsilon) \\propto [E(y)]^2\\) æ—¶é€‚ç”¨\nå¹³æ–¹æ ¹å˜æ¢ï¼š\\(y^* = \\sqrt{y}\\)ï¼Œå½“ \\(\\text{Var}(\\varepsilon) \\propto E(y)\\) æ—¶é€‚ç”¨",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>3 æ¨¡å‹è¯Šæ–­</span>"
    ]
  },
  {
    "objectID": "chapters/3 æ¨¡å‹è¯Šæ–­.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/3 æ¨¡å‹è¯Šæ–­.html#æ¡ˆä¾‹åˆ†æ",
    "title": "3 æ¨¡å‹è¯Šæ–­",
    "section": "3.5 æ¡ˆä¾‹åˆ†æ",
    "text": "3.5 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>3 æ¨¡å‹è¯Šæ–­</span>"
    ]
  },
  {
    "objectID": "chapters/3 æ¨¡å‹è¯Šæ–­.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/3 æ¨¡å‹è¯Šæ–­.html#æœ¬ç« æ€»ç»“",
    "title": "3 æ¨¡å‹è¯Šæ–­",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾\n\nå­¦ç”ŸåŒ–æ®‹å·®ï¼š\\(t_i = \\frac{e_i}{\\hat{\\sigma}_{(i)}\\sqrt{1-h_{ii}}}\\)\næ æ†å€¼ï¼š\\(h_{ii} = \\mathbf{x}_i'(\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{x}_i\\)\nCookè·ç¦»ï¼š\\(D_i = \\frac{e_i^2}{(p+1)\\hat{\\sigma}^2} \\times \\frac{h_{ii}}{(1-h_{ii})^2}\\)\nç¨³å¥æ ‡å‡†è¯¯ï¼š\\(\\text{Var}_{HC3}(\\hat{\\pmb{\\beta}}) = (\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\hat{\\pmb{\\Omega}}_{HC3}\\mathbf{X}(\\mathbf{X}'\\mathbf{X})^{-1}\\)\nDFFITSï¼š\\(\\text{DFFITS}_i = t_i \\times \\sqrt{\\frac{h_{ii}}{1-h_{ii}}}\\)\n\nè¯Šæ–­å†³ç­–æ¡†æ¶\n\n\n\n\n\n\n\n\n\né—®é¢˜ç±»å‹\nè¯Šæ–­å·¥å…·\nåˆ¤æ–­æ ‡å‡†\nå¤„ç†æ–¹æ¡ˆ\n\n\n\n\nå¼‚æ–¹å·®\næ®‹å·®vsæ‹Ÿåˆå€¼å›¾ã€BPæ£€éªŒ\næ®‹å·®æ–¹å·®éå¸¸æ•°ã€BPæ£€éªŒæ˜¾è‘—\nç¨³å¥æ ‡å‡†è¯¯ã€WLSã€å˜é‡å˜æ¢\n\n\néçº¿æ€§\næ®‹å·®vsæ‹Ÿåˆå€¼å›¾\næ®‹å·®å‘ˆç°æ›²çº¿æ¨¡å¼\nå¤šé¡¹å¼é¡¹ã€æ ·æ¡å›å½’ã€å˜é‡å˜æ¢\n\n\né«˜æ æ†ç‚¹\næ æ†å€¼\n\\(h_{ii} &gt; 2(p+1)/n\\)\næ•°æ®æ ¸æŸ¥ã€å¢åŠ æ ·æœ¬é‡\n\n\nå¼‚å¸¸å€¼\nå­¦ç”ŸåŒ–æ®‹å·®\n\\(\\|t_i\\| &gt; t_{1-\\alpha/2}(n-p-2)\\)\næ•°æ®æ ¸æŸ¥ã€ç¨³å¥å›å½’\n\n\nå¼ºå½±å“ç‚¹\nCookè·ç¦»\n\\(D_i &gt; 4/n\\)\nç»¼åˆåˆ†æã€è°¨æ…å¤„ç†\n\n\n\nè¯Šæ–­æµç¨‹ä½“ç³»\n\nåˆæ­¥ç­›æŸ¥ï¼šæ®‹å·®vsæ‹Ÿåˆå€¼å›¾ã€Q-Qå›¾\nå¼‚æ–¹å·®æ£€éªŒï¼šBreusch-Paganæ£€éªŒã€Whiteæ£€éªŒ\nå½±å“åˆ†æï¼šæ æ†å€¼ã€å­¦ç”ŸåŒ–æ®‹å·®ã€Cookè·ç¦»\næ·±å…¥è¯Šæ–­ï¼šDFFITSã€DFBETASåˆ†æ\nå¤„ç†å®æ–½ï¼šæ ¹æ®è¯Šæ–­ç»“æœé€‰æ‹©é€‚å½“ä¿®æ­£æ–¹æ¡ˆ\n\næ¨¡å‹è¯Šæ–­æ˜¯å»ºç«‹å¯é é¢„æµ‹æ¨¡å‹çš„å…³é”®ç¯èŠ‚ã€‚é€šè¿‡ç³»ç»Ÿæ€§çš„è¯Šæ–­åˆ†æï¼Œæˆ‘ä»¬èƒ½å¤Ÿè¯†åˆ«æ¨¡å‹ç¼ºé™·ï¼Œé‡‡å–é’ˆå¯¹æ€§æ”¹è¿›æªæ–½ï¼Œæœ€ç»ˆè·å¾—æ›´åŠ ç¨³å¥ã€å¯é çš„é¢„æµ‹ç»“æœã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>3 æ¨¡å‹è¯Šæ–­</span>"
    ]
  },
  {
    "objectID": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html",
    "href": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html",
    "title": "4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\næ—¶é—´åºåˆ—æ•°æ®åœ¨å›å½’åˆ†ææ¡†æ¶ä¸‹é¢ä¸´ç€ç‹¬ç‰¹çš„æŒ‘æˆ˜ï¼Œå…¶ä¸­è‡ªç›¸å…³é—®é¢˜å°¤ä¸ºçªå‡ºã€‚æœ¬ç« å°†ä»å›å½’åˆ†æçš„è§†è§’é‡æ–°å®¡è§†æ—¶é—´åºåˆ—æ•°æ®ï¼Œç³»ç»Ÿä»‹ç»å¦‚ä½•å°†è‡ªç›¸å…³é—®é¢˜è½¬åŒ–ä¸ºå›å½’æ¨¡å‹çš„æ–¹å·®å‡è®¾æ£€éªŒé—®é¢˜ã€‚é€šè¿‡å­¦ä¹ ï¼Œæ‚¨å°†æŒæ¡åœ¨å›å½’æ¡†æ¶ä¸‹è¯Šæ–­å’Œå¤„ç†è‡ªç›¸å…³çš„æ–¹æ³•ï¼Œä¸ºæ—¶é—´åºåˆ—æ•°æ®å»ºç«‹æ›´å¯é çš„é¢„æµ‹æ¨¡å‹ã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥</span>"
    ]
  },
  {
    "objectID": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#æ—¶é—´åºåˆ—å›å½’æ¨¡å‹çš„åŸºæœ¬æ¡†æ¶",
    "href": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#æ—¶é—´åºåˆ—å›å½’æ¨¡å‹çš„åŸºæœ¬æ¡†æ¶",
    "title": "4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥",
    "section": "4.1 æ—¶é—´åºåˆ—å›å½’æ¨¡å‹çš„åŸºæœ¬æ¡†æ¶",
    "text": "4.1 æ—¶é—´åºåˆ—å›å½’æ¨¡å‹çš„åŸºæœ¬æ¡†æ¶\n\n4.1.1 æ—¶é—´åºåˆ—å›å½’æ¨¡å‹è®¾å®š\nåŸºæœ¬å›å½’æ¨¡å‹ï¼š \\[\nY_t = \\beta_0 + \\beta_1 X_{t1} + \\beta_2 X_{t2} + \\cdots + \\beta_p X_{tp} + \\varepsilon_t\n\\]\nå…¶ä¸­ \\(\\varepsilon_t\\) æ˜¯è¯¯å·®é¡¹ï¼Œåœ¨æ—¶é—´åºåˆ—èƒŒæ™¯ä¸‹å¯èƒ½å…·æœ‰è‡ªç›¸å…³æ€§ã€‚\nç»å…¸å›å½’å‡è®¾çš„è¿èƒŒï¼š - ç‹¬ç«‹æ€§å‡è®¾ï¼š\\(\\text{Cov}(\\varepsilon_t, \\varepsilon_s) = 0\\)ï¼ˆå½“ \\(t \\neq s\\)ï¼‰å¯èƒ½ä¸æˆç«‹ - åŒæ–¹å·®æ€§å‡è®¾ï¼š\\(\\text{Var}(\\varepsilon_t) = \\sigma^2\\) å¯èƒ½éšæ—¶é—´å˜åŒ–\n\n\n4.1.2 è‡ªç›¸å…³çš„å›å½’è§£é‡Š\nä¸€é˜¶è‡ªå›å½’è¯¯å·®ç»“æ„ï¼š \\[\n\\varepsilon_t = \\rho \\varepsilon_{t-1} + u_t\n\\] å…¶ä¸­ \\(u_t \\sim \\text{WN}(0, \\sigma_u^2)\\)ï¼Œä¸” \\(|\\rho| &lt; 1\\)\næ–¹å·®-åæ–¹å·®çŸ©é˜µï¼š åœ¨è‡ªç›¸å…³æƒ…å†µä¸‹ï¼Œè¯¯å·®é¡¹çš„æ–¹å·®-åæ–¹å·®çŸ©é˜µä¸å†æ˜¯æ ‡é‡çŸ©é˜µï¼š \\[\n\\text{Var}(\\boldsymbol{\\varepsilon}) = \\sigma^2 \\boldsymbol{\\Omega} = \\sigma^2 \\begin{pmatrix}\n1 & \\rho & \\rho^2 & \\cdots & \\rho^{n-1} \\\\\n\\rho & 1 & \\rho & \\cdots & \\rho^{n-2} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n\\rho^{n-1} & \\rho^{n-2} & \\rho^{n-3} & \\cdots & 1\n\\end{pmatrix}\n\\]",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥</span>"
    ]
  },
  {
    "objectID": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#è‡ªç›¸å…³çš„æ£€éªŒæ–¹æ³•",
    "href": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#è‡ªç›¸å…³çš„æ£€éªŒæ–¹æ³•",
    "title": "4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥",
    "section": "4.2 è‡ªç›¸å…³çš„æ£€éªŒæ–¹æ³•",
    "text": "4.2 è‡ªç›¸å…³çš„æ£€éªŒæ–¹æ³•\n\n4.2.1 åŸºäºæ®‹å·®çš„å›¾å½¢æ£€éªŒæ³•\næ®‹å·®åºåˆ—å›¾ï¼š ç»˜åˆ¶æ®‹å·® \\(e_t\\) å¯¹æ—¶é—´ \\(t\\) çš„æ•£ç‚¹å›¾ï¼Œè§‚å¯Ÿæ˜¯å¦å­˜åœ¨ï¼š - ç³»ç»Ÿæ€§æ¨¡å¼ - å‘¨æœŸæ³¢åŠ¨ - è¶‹åŠ¿æ€§å˜åŒ–\næ®‹å·®è‡ªç›¸å…³å›¾ï¼š è®¡ç®—æ®‹å·®çš„æ ·æœ¬è‡ªç›¸å…³å‡½æ•°ï¼š \\[\nr_k = \\frac{\\sum_{t=k+1}^n e_t e_{t-k}}{\\sum_{t=1}^n e_t^2}\n\\]\n\n\n4.2.2 Durbin-Watsonæ£€éªŒ\næ£€éªŒç»Ÿè®¡é‡ï¼š \\[\nd = \\frac{\\sum_{t=2}^n (e_t - e_{t-1})^2}{\\sum_{t=1}^n e_t^2}\n\\]\nç»Ÿè®¡é‡çš„æ€§è´¨ï¼š - \\(d \\approx 2(1 - r_1)\\)ï¼Œå…¶ä¸­ \\(r_1\\) æ˜¯ä¸€é˜¶è‡ªç›¸å…³ç³»æ•° - \\(d \\to 2\\)ï¼šæ— è‡ªç›¸å…³ - \\(d \\to 0\\)ï¼šæ­£è‡ªç›¸å…³ - \\(d \\to 4\\)ï¼šè´Ÿè‡ªç›¸å…³\nå‡è®¾æ£€éªŒï¼š - \\(H_0: \\rho = 0\\)ï¼ˆæ— è‡ªç›¸å…³ï¼‰ - é€šè¿‡Durbin-Watsonè¡¨æŸ¥æ‰¾ä¸´ç•Œå€¼\n\n\n4.2.3 Breusch-Godfreyæ£€éªŒï¼ˆLMæ£€éªŒï¼‰\nè¾…åŠ©å›å½’æ¨¡å‹ï¼š \\[\ne_t = \\alpha_0 + \\alpha_1 X_{t1} + \\cdots + \\alpha_p X_{tp} + \\phi_1 e_{t-1} + \\cdots + \\phi_m e_{t-m} + u_t\n\\]\næ£€éªŒç»Ÿè®¡é‡ï¼š \\[\n\\text{LM} = (n-m)R^2 \\sim \\chi^2(m)\n\\] å…¶ä¸­ \\(R^2\\) æ˜¯è¾…åŠ©å›å½’çš„å†³å®šç³»æ•°ã€‚\næ£€éªŒæ­¥éª¤ï¼š 1. ç”¨OLSä¼°è®¡åŸæ¨¡å‹ï¼Œå¾—åˆ°æ®‹å·® \\(e_t\\) 2. å»ºç«‹åŒ…å«æ»åæ®‹å·®çš„è¾…åŠ©å›å½’ 3. è®¡ç®—LMç»Ÿè®¡é‡å¹¶è¿›è¡Œæ£€éªŒ\n\n\n4.2.4 å›å½’ç³»æ•°çš„æœ‰æ•ˆæ€§æ£€éªŒ\nOLSä¼°è®¡é‡çš„æ–¹å·®åè¯¯ï¼š åœ¨è‡ªç›¸å…³æƒ…å†µä¸‹ï¼ŒOLSä¼°è®¡é‡çš„çœŸå®æ–¹å·®ä¸ºï¼š \\[\n\\text{Var}(\\hat{\\boldsymbol{\\beta}}) = \\sigma^2(\\mathbf{X}'\\mathbf{X})^{-1}\\mathbf{X}'\\boldsymbol{\\Omega}\\mathbf{X}(\\mathbf{X}'\\mathbf{X})^{-1}\n\\]\nä¼ ç»Ÿæ ‡å‡†è¯¯çš„åè¯¯ï¼š å½“å­˜åœ¨æ­£è‡ªç›¸å…³æ—¶ï¼Œä¼ ç»Ÿæ ‡å‡†è¯¯é€šå¸¸è¢«ä½ä¼°ï¼Œå¯¼è‡´ï¼š - \\(t\\) ç»Ÿè®¡é‡è¢«é«˜ä¼° - ç½®ä¿¡åŒºé—´è¿‡çª„ - å‡è®¾æ£€éªŒçš„ç¬¬ä¸€ç±»é”™è¯¯ç‡å¢åŠ ",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥</span>"
    ]
  },
  {
    "objectID": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#è‡ªç›¸å…³çš„å¤„ç†æ–¹æ³•",
    "href": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#è‡ªç›¸å…³çš„å¤„ç†æ–¹æ³•",
    "title": "4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥",
    "section": "4.3 è‡ªç›¸å…³çš„å¤„ç†æ–¹æ³•",
    "text": "4.3 è‡ªç›¸å…³çš„å¤„ç†æ–¹æ³•\n\n4.3.1 å¹¿ä¹‰æœ€å°äºŒä¹˜æ³•ï¼ˆGLSï¼‰\nåŸºæœ¬æ€æƒ³ï¼šé€šè¿‡å˜æ¢å°†è‡ªç›¸å…³è¯¯å·®è½¬åŒ–ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒè¯¯å·®ã€‚\nå˜æ¢çŸ©é˜µï¼šå¯»æ‰¾çŸ©é˜µ \\(\\mathbf{P}\\)ï¼Œä½¿å¾—ï¼š \\[\n\\mathbf{P}\\boldsymbol{\\Omega}\\mathbf{P}' = \\mathbf{I}\n\\]\nGLSä¼°è®¡é‡ï¼š \\[\n\\hat{\\boldsymbol{\\beta}}_{GLS} = (\\mathbf{X}'\\boldsymbol{\\Omega}^{-1}\\mathbf{X})^{-1}\\mathbf{X}'\\boldsymbol{\\Omega}^{-1}\\mathbf{Y}\n\\]\n\n\n4.3.2 Cochrane-Orcuttè¿­ä»£æ³•\nç®—æ³•æ­¥éª¤ï¼š\n\nåˆå§‹ä¼°è®¡ï¼šç”¨OLSä¼°è®¡åŸæ¨¡å‹ï¼Œå¾—åˆ°æ®‹å·® \\(e_t\\)\nä¼°è®¡è‡ªç›¸å…³ç³»æ•°ï¼š \\[\n\\hat{\\rho} = \\frac{\\sum_{t=2}^n e_t e_{t-1}}{\\sum_{t=2}^n e_{t-1}^2}\n\\]\næ•°æ®å˜æ¢ï¼š \\[\nY_t^* = Y_t - \\hat{\\rho} Y_{t-1}, \\quad X_{tj}^* = X_{tj} - \\hat{\\rho} X_{t-1,j}\n\\]\né‡æ–°ä¼°è®¡ï¼šç”¨OLSä¼°è®¡å˜æ¢åçš„æ¨¡å‹\nè¿­ä»£ï¼šé‡å¤æ­¥éª¤2-4ç›´åˆ°æ”¶æ•›\n\n\n\n4.3.3 Prais-Winstenä¼°è®¡\næ”¹è¿›çš„Cochrane-Orcuttæ–¹æ³•ï¼š ä¿ç•™ç¬¬ä¸€ä¸ªè§‚æµ‹çš„å˜æ¢ï¼š \\[\nY_1^* = \\sqrt{1-\\hat{\\rho}^2}Y_1, \\quad X_{1j}^* = \\sqrt{1-\\hat{\\rho}^2}X_{1j}\n\\]\nå…¶ä»–è§‚æµ‹å˜æ¢åŒCochrane-Orcuttæ–¹æ³•ã€‚\n\n\n4.3.4 Newey-Westå¼‚æ–¹å·®è‡ªç›¸å…³ä¸€è‡´æ ‡å‡†è¯¯\nHACæ ‡å‡†è¯¯ä¼°è®¡é‡ï¼š \\[\n\\text{Var}_{HAC}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}'\\mathbf{X})^{-1} \\mathbf{S} (\\mathbf{X}'\\mathbf{X})^{-1}\n\\]\nå…¶ä¸­ï¼š \\[\n\\mathbf{S} = \\sum_{t=1}^n e_t^2 \\mathbf{x}_t\\mathbf{x}_t' + \\sum_{l=1}^m w_l \\sum_{t=l+1}^n (e_t e_{t-l} \\mathbf{x}_t\\mathbf{x}_{t-l}' + e_t e_{t-l} \\mathbf{x}_{t-l}\\mathbf{x}_t')\n\\]\næƒé‡å‡½æ•°ï¼ˆBartlettæ ¸ï¼‰ï¼š \\[\nw_l = 1 - \\frac{l}{m+1}\n\\]\nå¸¦å®½é€‰æ‹©ï¼š \\[\nm = \\left\\lfloor 4(n/100)^{2/9} \\right\\rfloor\n\\]",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥</span>"
    ]
  },
  {
    "objectID": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#åŠ¨æ€å›å½’æ¨¡å‹",
    "href": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#åŠ¨æ€å›å½’æ¨¡å‹",
    "title": "4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥",
    "section": "4.4 åŠ¨æ€å›å½’æ¨¡å‹",
    "text": "4.4 åŠ¨æ€å›å½’æ¨¡å‹\n\n4.4.1 åˆ†å¸ƒæ»åæ¨¡å‹\næœ‰é™åˆ†å¸ƒæ»åæ¨¡å‹ï¼š \\[\nY_t = \\alpha + \\sum_{i=0}^k \\beta_i X_{t-i} + \\varepsilon_t\n\\]\næ— é™åˆ†å¸ƒæ»åæ¨¡å‹ï¼ˆKoyckå‡ ä½•æ»åï¼‰ï¼š \\[\nY_t = \\alpha + \\beta \\sum_{i=0}^\\infty \\lambda^i X_{t-i} + \\varepsilon_t\n\\]\n\n\n4.4.2 è‡ªå›å½’åˆ†å¸ƒæ»åæ¨¡å‹ï¼ˆARDLï¼‰\nARDL(p,q)æ¨¡å‹ï¼š \\[\nY_t = \\alpha + \\sum_{i=1}^p \\phi_i Y_{t-i} + \\sum_{j=0}^q \\beta_j X_{t-j} + \\varepsilon_t\n\\]\nè¯¯å·®ä¿®æ­£å½¢å¼ï¼š \\[\n\\Delta Y_t = \\alpha + \\gamma(Y_{t-1} - \\theta X_{t-1}) + \\sum_{i=1}^{p-1} \\phi_i^* \\Delta Y_{t-i} + \\sum_{j=0}^{q-1} \\beta_j^* \\Delta X_{t-j} + \\varepsilon_t\n\\]\n\n\n4.4.3 æ¨¡å‹é€‰æ‹©ä¸è¯Šæ–­\nä¿¡æ¯å‡†åˆ™ï¼š - AICï¼š\\(AIC = \\ln(\\hat{\\sigma}^2) + \\frac{2k}{n}\\) - BICï¼š\\(BIC = \\ln(\\hat{\\sigma}^2) + \\frac{k\\ln(n)}{n}\\)\næ®‹å·®è¯Šæ–­ï¼š - Durbin-Watsonæ£€éªŒ - Breusch-Godfreyæ£€éªŒ - æ®‹å·®è‡ªç›¸å…³å›¾åˆ†æ",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥</span>"
    ]
  },
  {
    "objectID": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#æ¡ˆä¾‹åˆ†æ",
    "title": "4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥",
    "section": "4.5 æ¡ˆä¾‹åˆ†æ",
    "text": "4.5 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥</span>"
    ]
  },
  {
    "objectID": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥.html#æœ¬ç« æ€»ç»“",
    "title": "4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾\n\nDurbin-Watsonç»Ÿè®¡é‡ï¼š\\(d = \\frac{\\sum_{t=2}^n (e_t - e_{t-1})^2}{\\sum_{t=1}^n e_t^2}\\)\nBreusch-Godfreyæ£€éªŒï¼š\\(LM = (n-m)R^2 \\sim \\chi^2(m)\\)\nCochrane-Orcuttå˜æ¢ï¼š\\(Y_t^* = Y_t - \\hat{\\rho} Y_{t-1}\\)\nNewey-Westæ–¹å·®ï¼š\\(\\text{Var}_{HAC}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}'\\mathbf{X})^{-1} \\mathbf{S} (\\mathbf{X}'\\mathbf{X})^{-1}\\)\nARDLæ¨¡å‹ï¼š\\(Y_t = \\alpha + \\sum_{i=1}^p \\phi_i Y_{t-i} + \\sum_{j=0}^q \\beta_j X_{t-j} + \\varepsilon_t\\)\n\nè‡ªç›¸å…³æ£€éªŒæ–¹æ³•æ¯”è¾ƒ\n\n\n\næ£€éªŒæ–¹æ³•\né€‚ç”¨åœºæ™¯\nä¼˜ç‚¹\nå±€é™æ€§\n\n\n\n\nDurbin-Watson\nä¸€é˜¶è‡ªç›¸å…³æ£€éªŒ\nè®¡ç®—ç®€å•\nä¸é€‚ç”¨äºé«˜é˜¶è‡ªç›¸å…³\n\n\nBreusch-Godfrey\né«˜é˜¶è‡ªç›¸å…³æ£€éªŒ\né€‚ç”¨æ€§å¹¿\néœ€è¦é€‰æ‹©æ»åé˜¶æ•°\n\n\næ®‹å·®å›¾åˆ†æ\nåˆæ­¥è¯Šæ–­\nç›´è§‚æ˜“æ‡‚\nä¸»è§‚æ€§å¼º\n\n\nACF/PACFå›¾\nè‡ªç›¸å…³ç»“æ„è¯†åˆ«\næä¾›è¯¦ç»†ä¿¡æ¯\néœ€è¦ç»éªŒåˆ¤æ–­\n\n\n\nå¤„ç†æ–¹æ³•çš„å†³ç­–æ¡†æ¶\n\n\n\n\n\n\n\n\né—®é¢˜ç±»å‹\næ¨èæ–¹æ³•\né€‚ç”¨æ¡ä»¶\n\n\n\n\nå·²çŸ¥è‡ªç›¸å…³ç»“æ„\nGLSä¼°è®¡\n\\(\\boldsymbol{\\Omega}\\) å·²çŸ¥æˆ–å¯ä¼°è®¡\n\n\nä¸€é˜¶è‡ªç›¸å…³\nCochrane-Orcutt\nä¸­ç­‰æ ·æœ¬é‡ï¼Œä¸€é˜¶ARç»“æ„\n\n\nå¤§æ ·æœ¬æ¨æ–­\nNewey-Westæ ‡å‡†è¯¯\nä»»æ„å½¢å¼çš„è‡ªç›¸å…³å’Œå¼‚æ–¹å·®\n\n\nåŠ¨æ€å…³ç³»å»ºæ¨¡\nARDLæ¨¡å‹\nå­˜åœ¨ç†è®ºæ”¯æŒçš„åŠ¨æ€ç»“æ„\n\n\né¢„æµ‹å¯¼å‘\nåŠ¨æ€å›å½’æ¨¡å‹\nå…³æ³¨é¢„æµ‹ç²¾åº¦è€Œéå› æœæ¨æ–­\n\n\n\né‡è¦æ¦‚å¿µä½“ç³»\n\nè‡ªç›¸å…³æ£€éªŒï¼šè¯Šæ–­å›å½’æ¨¡å‹æ–¹å·®å‡è®¾çš„è¿èƒŒ\nä¸€è‡´æ ‡å‡†è¯¯ï¼šåœ¨è¿èƒŒç»å…¸å‡è®¾ä¸‹çš„æœ‰æ•ˆæ¨æ–­\nå¯è¡ŒGLSï¼šåŸºäºæ•°æ®ä¼°è®¡çš„å¹¿ä¹‰æœ€å°äºŒä¹˜æ³•\nåŠ¨æ€è®¾å®šï¼šåŒ…å«æ»åé¡¹çš„æ‰©å±•å›å½’æ¨¡å‹\næ¨¡å‹ç¨³å¥æ€§ï¼šå¯¹å‡è®¾è¿èƒŒä¸æ•æ„Ÿçš„ä¼°è®¡æ–¹æ³•\n\né€šè¿‡å°†æ—¶é—´åºåˆ—é—®é¢˜çº³å…¥å›å½’åˆ†ææ¡†æ¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨æˆç†Ÿçš„å›å½’æŠ€æœ¯æ¥å¤„ç†è‡ªç›¸å…³é—®é¢˜ï¼ŒåŒæ—¶ä¿æŒæ¨¡å‹çš„è§£é‡Šæ€§å’Œæ˜“ç”¨æ€§ã€‚è¿™ç§æ–¹æ³•ä¸ºå®é™…åº”ç”¨æä¾›äº†å®ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚",
    "crumbs": [
      "I åŸºç¡€-çº¿æ€§å›å½’æ¨¡å‹",
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>4 æ—¶é—´åºåˆ—åˆ†æåˆæ­¥</span>"
    ]
  },
  {
    "objectID": "chapters/part-2-introduction.html",
    "href": "chapters/part-2-introduction.html",
    "title": "ç°ä»£é¢„æµ‹å»ºæ¨¡ï¼šä»å›å½’åˆ°æœºå™¨å­¦ä¹ ",
    "section": "",
    "text": "æˆ‘ä»¬å°†ä»ç»å…¸çš„çº¿æ€§å›å½’åˆ†æè¿›è¡Œæ–¹æ³•å’Œåº”ç”¨ä¸Šçš„æ‰©å±•ï¼Œä»¥æ¶µç›–æ›´å¹¿æ³›çš„ç»Ÿè®¡å»ºæ¨¡æŠ€æœ¯ã€‚æœ¬ç« å°†ä»‹ç»ä»¥ä¸‹å†…å®¹ï¼š - æ–¹æ³•çš„æ”¹è¿›ï¼šé€æ­¥å›å½’ã€å²­å›å½’å’Œå¥—ç´¢å›å½’ç­‰æŠ€æœ¯ï¼Œä»¥æé«˜æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½å’Œè§£é‡Šèƒ½åŠ›ã€‚æ­£åˆ™åŒ–å’Œé™ç»´æ–¹æ³• - åº”ç”¨çš„æ‰©å±•ï¼šè¿›å…¥åˆ†ç±»æ¨¡å‹ï¼ˆå¦‚é€»è¾‘å›å½’å’Œåˆ¤åˆ«åˆ†æï¼‰ - éçº¿æ€§æ¨¡å‹çš„æ ·æ¡å›å½’",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>7</span>Â  <span class='chapter-title'>part-2-introduction.html</span>"
    ]
  },
  {
    "objectID": "chapters/5 é™ç»´.html",
    "href": "chapters/5 é™ç»´.html",
    "title": "5 é™ç»´",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\néšç€å¤§æ•°æ®æ—¶ä»£çš„åˆ°æ¥ï¼Œé«˜ç»´æ•°æ®é—®é¢˜æ—¥ç›Šæ™®éã€‚å½“è‡ªå˜é‡æ•°ç›® \\(p\\) æ¥è¿‘ç”šè‡³è¶…è¿‡æ ·æœ¬é‡ \\(n\\) æ—¶ï¼Œä¼ ç»Ÿçš„æœ€å°äºŒä¹˜æ³•é¢ä¸´ä¸¥é‡æŒ‘æˆ˜ã€‚æœ¬ç« å°†ç³»ç»Ÿä»‹ç»æ­£åˆ™åŒ–æ–¹æ³•å’Œé™ç»´æŠ€æœ¯è¿™ä¸¤ç±»å¤„ç†é«˜ç»´é—®é¢˜çš„ä¸»æµæ–¹æ³•ï¼Œä¸ºæ‚¨æä¾›åœ¨â€œç»´æ•°ç¾éš¾â€ä¸‹å»ºç«‹ç¨³å®šé¢„æµ‹æ¨¡å‹çš„æœ‰æ•ˆå·¥å…·ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>5 é™ç»´</span>"
    ]
  },
  {
    "objectID": "chapters/5 é™ç»´.html#å¤šé‡å…±çº¿æ€§",
    "href": "chapters/5 é™ç»´.html#å¤šé‡å…±çº¿æ€§",
    "title": "5 é™ç»´",
    "section": "5.1 å¤šé‡å…±çº¿æ€§",
    "text": "5.1 å¤šé‡å…±çº¿æ€§\n\n5.1.1 é«˜ç»´é—®é¢˜\né«˜ç»´å›å½’æ¨¡å‹ï¼š \\[\n\\mathbf{y} = \\mathbf{X}\\pmb{\\beta} + \\pmb{\\varepsilon}\n\\] å…¶ä¸­ \\(\\mathbf{X} \\in \\mathbb{R}^{n \\times p}\\)ï¼Œå½“ \\(p \\gg n\\) æˆ– \\(p \\approx n\\) æ—¶å‡ºç°é«˜ç»´é—®é¢˜ã€‚\nOLSçš„å¤±æ•ˆï¼š\n\nå½“ \\(p &gt; n\\) æ—¶ï¼Œ\\(\\mathbf{X}'\\mathbf{X}\\) ä¸å¯é€†\nå½“ \\(p \\approx n\\) æ—¶ï¼Œä¼°è®¡æ–¹å·®æå¤§\né¢„æµ‹æ€§èƒ½ä¸‹é™ï¼Œæ¨¡å‹è¿‡æ‹Ÿåˆ\n\nç¨€ç–æ€§å‡è®¾\nç²¾ç¡®ç¨€ç–æ€§ï¼š \\[ ||\\pmb{\\beta}||_0 = \\#\\{j: \\beta_j \\neq 0\\} \\ll p \\]\nè¿‘ä¼¼ç¨€ç–æ€§ï¼š å¤§å¤šæ•°ç³»æ•°çš„ç»å¯¹å€¼å¾ˆå°ï¼Œåªæœ‰å°‘æ•°ç³»æ•°è¾ƒå¤§ã€‚\n\n\n5.1.2 å¤šé‡å…±çº¿æ€§åŸå› ä¸è¡¨ç°\nè€ƒè™‘çº¿æ€§å›å½’æ¨¡å‹ï¼š \\[ \\mathbf{y} = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\cdots + \\beta_p x_p + \\varepsilon \\]\nå®šä¹‰1ï¼ˆå®Œå…¨å¤šé‡å…±çº¿æ€§ï¼‰ï¼š å¦‚æœå­˜åœ¨ä¸å…¨ä¸ºé›¶çš„å¸¸æ•° \\(c_1, c_2, \\dots, c_p\\)ï¼Œä½¿å¾—ï¼š \\[ c_1 x_1 + c_2 x_2 + \\cdots + c_p x_p = 0 \\quad \\text{ï¼ˆå‡ ä¹å¤„å¤„æˆç«‹ï¼‰} \\] åˆ™ç§°è‡ªå˜é‡é—´å­˜åœ¨å®Œå…¨å¤šé‡å…±çº¿æ€§ï¼ˆperfect multicollinearityï¼‰ã€‚\nåœ¨çŸ©é˜µå½¢å¼ä¸‹ï¼Œè®¾è®¾è®¡çŸ©é˜µ \\(\\mathbf{X} = [\\mathbf{1}, \\mathbf{x}_1, \\dots, \\mathbf{x}_p] \\in \\mathbb{R}^{n \\times (p+1)}\\)ï¼Œå®Œå…¨å¤šé‡å…±çº¿æ€§æ„å‘³ç€ï¼š \\[ \\text{rank}(\\mathbf{X}) &lt; p+1 \\] å³ \\(\\mathbf{X}^\\top \\mathbf{X}\\) æ˜¯å¥‡å¼‚çš„ï¼Œä¸å­˜åœ¨å”¯ä¸€çš„æœ€å°äºŒä¹˜è§£ã€‚\nå®šä¹‰2ï¼ˆè¿‘ä¼¼å¤šé‡å…±çº¿æ€§ï¼‰ï¼š å¦‚æœå­˜åœ¨ä¸å…¨ä¸ºé›¶çš„å¸¸æ•° \\(c_1, c_2, \\dots, c_p\\)ï¼Œä½¿å¾—ï¼š \\[ c_1 x_1 + c_2 x_2 + \\cdots + c_p x_p \\approx 0 \\] å³è‡ªå˜é‡é—´å­˜åœ¨é«˜åº¦ä½†ä¸å®Œå…¨çš„çº¿æ€§å…³ç³»ï¼Œåˆ™ç§°ä¸ºè¿‘ä¼¼å¤šé‡å…±çº¿æ€§ã€‚\nå¤šé‡å…±çº¿ç³»çš„åŸå› ï¼š\n\nå˜é‡ä¹‹é—´çš„å…±åŒå˜åŒ–è¶‹åŠ¿\næ—¶é—´åºåˆ—æ•°æ®è¶‹åŠ¿ï¼Œæ»åå˜é‡\nç»æµæŒ‡æ ‡å…³ç³»çº¦æŸæˆ–è€…è™šæ‹Ÿå˜é‡é™·é˜±\næ ·æœ¬é‡ä¸è¶³\næˆªé¢æ•°æ®çš„è§„æ¨¡æ•ˆåº”\n\nå¤šé‡å…±çº¿æ€§çš„è¡¨ç°\nåœ¨å›å½’ç»“æœä¸­ï¼š\nç³»æ•°ä¼°è®¡å¼‚å¸¸\n\nç¬¦å·å¼‚å¸¸ï¼šç³»æ•°ç¬¦å·ä¸ç†è®ºé¢„æœŸç›¸å\næ•°å€¼å¼‚å¸¸å¤§ï¼šç³»æ•°ç»å¯¹å€¼å¼‚å¸¸å¤§\nç»Ÿè®¡ä¸æ˜¾è‘—ä½†è”åˆæ˜¾è‘—ï¼š\nå•ä¸ª \\(t\\) æ£€éªŒï¼š\\(H_0: \\beta_j = 0\\) ä¸æ‹’ç»\næ•´ä½“ \\(F\\) æ£€éªŒï¼š\\(H_0: \\beta_1 = \\cdots = \\beta_p = 0\\) æ‹’ç»\n\nç¨³å®šæ€§æ£€éªŒ\n\nåˆ é™¤è§‚æµ‹å½±å“ï¼šåˆ é™¤ä¸ªåˆ«è§‚æµ‹å¯¼è‡´ç³»æ•°ä¼°è®¡å‰§çƒˆå˜åŒ–\næ·»åŠ /åˆ é™¤å˜é‡ï¼šæ·»åŠ æˆ–åˆ é™¤å…¶ä»–å˜é‡å¯¼è‡´ç³»æ•°ç¬¦å·æˆ–å¤§å°æ˜¾è‘—å˜åŒ–\n\n\n\n5.1.3 å¤šé‡å…±çº¿æ€§çš„å½±å“ï¼š\n\nå‚æ•°ä¼°è®¡æ–¹é¢ï¼šå‚æ•°ä¼°è®¡ä»ç„¶æ˜¯æ— åçš„ï¼Œä½†æ˜¯å‚æ•°ä¼°è®¡æ–¹å·®ä¼šå¾ˆå¤§\nå‡è®¾æ£€éªŒæ–¹é¢ï¼šFæ£€éªŒä¼šæ˜¾è‘—ï¼Œä½†æ˜¯tæ£€éªŒä¼šå¤±æ•ˆ\né¢„æµ‹ï¼šé¢„æµ‹å˜å¾—ä¸ç¨³å®š\nå‚æ•°ä¼°è®¡çš„å€¼ä¸ç¨³å®šï¼Œæ­£è´Ÿç¬¦å·å¯èƒ½ä¸ç¬¦åˆé¢„æœŸ\n\nå¤šé‡å…±çº¿æ€§çš„ä¸»è¦å½±å“åœ¨äºå‚æ•°ä¼°è®¡é‡çš„æ–¹ç¨‹è†¨èƒ€ï¼Œä¸‹é¢ç»™å‡ºç®€å•çš„æ¨å¯¼è¿‡ç¨‹ï¼š\nè¿™é‡Œåªè€ƒè™‘è€ƒè™‘å¤å…±çº¿æ€§ï¼Œå³è®¾è®¡çŸ©é˜µ\\(X\\)çš„åˆ—å‘é‡ä¹‹é—´å­˜åœ¨è¿‘ä¼¼çº¿æ€§ç›¸å…³å…³ç³»ã€‚\næ•°å­¦è¡¨è¿°ä¸ºï¼š\nå­˜åœ¨éé›¶å‘é‡\\(c = (c_1, c_2, \\ldots, c_p)' \\neq 0\\)ï¼Œä½¿å¾—ï¼š\n\\[\nc_1X_1 + c_2X_2 + \\cdots + c_pX_p \\approx 0\n\\]\nå…¶ä¸­\\(X_j \\in \\mathbb{R}^n\\)è¡¨ç¤ºç¬¬\\(j\\)ä¸ªè‡ªå˜é‡çš„è§‚æµ‹å‘é‡ã€‚\nè€ƒè™‘GramçŸ©é˜µ\\(S = X'X\\)ï¼Œå…¶ç‰¹å¾å€¼é—®é¢˜ä¸º\\(Sv = \\lambda v\\)ã€‚åˆ©ç”¨Rayleighå•†çš„æå€¼æ€§è´¨ï¼š\n\\[\\lambda_{min} = \\min_{v \\neq 0} \\frac{v'Sv}{v'v} = \\min_{v \\neq 0} \\frac{\\lVert Xv \\rVert^2}{\\lVert v \\rVert^2}\\]\nå½“å­˜åœ¨å¤šé‡å…±çº¿æ€§æ—¶ï¼Œå–\\(v = c\\)ï¼ˆè¿‘ä¼¼çº¿æ€§ç›¸å…³çš„ç³»æ•°å‘é‡ï¼‰ï¼Œåˆ™æœ‰ï¼š\n\\[\n\\lambda_{min} \\leq \\frac{\\lVert Xc \\rVert^2}{\\lVert c \\rVert^2} \\approx 0\n\\]\nGramçŸ©é˜µçš„è°±åˆ†è§£ä¸ºï¼š \\[\nS = X'X = \\sum_{j=1}^p \\lambda_j v_j v_j'\n\\]\nå…¶é€†çŸ©é˜µç›¸åº”ä¸ºï¼š \\[\n(X'X)^{-1} = \\sum_{j=1}^p \\frac{1}{\\lambda_j} v_j v_j'\n\\]\nè¿™æ—¶ï¼Œé€†çŸ©é˜µä¸­æ¯ä¸ªç‰¹å¾æ–¹å‘çš„è´¡çŒ®è¢«\\(\\frac{1}{\\lambda_j}\\)æ”¾å¤§ã€‚å½“æŸäº›\\(\\lambda_j \\to 0\\)æ—¶ï¼Œå¯¹åº”é¡¹\\(\\frac{1}{\\lambda_j} \\to \\infty\\)ã€‚\næ™®é€šæœ€å°äºŒä¹˜ä¼°è®¡çš„æ–¹å·®-åæ–¹å·®çŸ©é˜µä¸ºï¼š \\[\n\\text{Var}(\\hat{\\beta}) = \\sigma^2(X'X)^{-1} = \\sigma^2 \\sum_{j=1}^p \\frac{1}{\\lambda_j} v_j v_j'\n\\]\nç¬¬\\(j\\)ä¸ªå‚æ•°ä¼°è®¡çš„æ–¹å·®ä¸ºï¼š \\[\n\\text{Var}(\\hat{\\beta}_j) = \\sigma^2[(X'X)^{-1}]_{jj} = \\sigma^2 \\sum_{k=1}^p \\frac{v_{kj}^2}{\\lambda_k}\n\\]\næ¯ä¸ªå‚æ•°ä¼°è®¡çš„æ–¹å·®å¯åˆ†è§£ä¸ºåœ¨å„ç‰¹å¾å‘é‡æ–¹å‘ä¸Šçš„è´¡çŒ®ä¹‹å’Œï¼Œæƒé‡ä¸º\\(\\frac{v_{kj}^2}{\\lambda_k}\\)ã€‚\nè®¾\\(\\lambda_1 \\geq \\lambda_2 \\geq \\cdots \\geq \\lambda_p &gt; 0\\)ï¼Œå½“å­˜åœ¨ä¸¥é‡å¤šé‡å…±çº¿æ€§æ—¶ï¼Œå‡è®¾å‰\\(m\\)ä¸ªç‰¹å¾å€¼æ˜¾è‘—å¤§äºé›¶ï¼Œå\\(p-m\\)ä¸ªç‰¹å¾å€¼æ¥è¿‘é›¶ï¼š\n\\[\n\\text{Var}(\\hat{\\beta}_j) = \\sigma^2\\left(\\sum_{k=1}^m \\frac{v_{kj}^2}{\\lambda_k} + \\sum_{k=m+1}^p \\frac{v_{kj}^2}{\\lambda_k}\\right)\n\\]\nå…¶ä¸­ç¬¬äºŒé¡¹ç”±äº\\(\\lambda_k \\approx 0\\)è€Œæ€¥å‰§å¢å¤§ï¼š\n\\[\\sum_{k=m+1}^p \\frac{v_{kj}^2}{\\lambda_k} \\to \\infty\\]\nå°ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾æ–¹å‘åœ¨æ–¹å·®è¡¨è¾¾å¼ä¸­äº§ç”Ÿå·¨å¤§è´¡çŒ®ã€‚\nåœ¨å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ \\(Y = X\\beta + \\varepsilon\\) ä¸­ï¼Œç¬¬ \\(j\\) ä¸ªå‚æ•°ä¼°è®¡ \\(\\hat{\\beta}_j\\) çš„æ–¹å·®ä¸ºï¼š \\[ \\text{Var}(\\hat{\\beta}_j) = \\frac{\\sigma^2}{(1 - R_j^2) \\sum_{i=1}^n (x_{ij} - \\bar{x}_j)^2} \\]å°†æ–¹å·®é‡å†™ä¸ºï¼š \\[ \\text{Var}(\\hat{\\beta}_j) = \\underbrace{\\frac{\\sigma^2}{\\sum_{i=1}^n (x_{ij} - \\bar{x}_j)^2}}_{\\text{ç®€å•å›å½’æ–¹å·®}} \\times \\underbrace{\\frac{1}{1 - R_j^2}}_{VIF_j} \\]\næ–¹å·®è†¨èƒ€å› å­(Variance Inflation Factor, VIF) æ˜¯è¡¡é‡å¤šé‡å…±çº¿æ€§ä¸¥é‡ç¨‹åº¦çš„æ ¸å¿ƒæŒ‡æ ‡ï¼Œå®šä¹‰ä¸ºï¼š \\[ VIF_j = \\frac{1}{1 - R_j^2} \\] å…¶ä¸­ï¼š\n\n\\(R_j^2\\) æ˜¯ç¬¬ \\(j\\) ä¸ªè‡ªå˜é‡ \\(X_j\\) å¯¹å…¶ä»–æ‰€æœ‰è‡ªå˜é‡ \\(X_1, X_2, \\ldots, X_{j-1}, X_{j+1}, \\ldots, X_p\\) è¿›è¡Œå›å½’æ‰€å¾—çš„å†³å®šç³»æ•°\n\\(VIF_j\\) åº¦é‡äº†ç”±äºä¸å…¶ä»–è‡ªå˜é‡ç›¸å…³è€Œå¯¼è‡´çš„ç¬¬ \\(j\\) ä¸ªå‚æ•°ä¼°è®¡æ–¹å·®çš„è†¨èƒ€å€æ•°\nè¯Šæ–­æ ‡å‡†ï¼š - \\(\\text{VIF}_j &gt; 10\\)ï¼šå­˜åœ¨ä¸¥é‡å¤šé‡å…±çº¿æ€§ - \\(\\text{VIF}_j &gt; 5\\)ï¼šå­˜åœ¨ä¸­åº¦å¤šé‡å…±çº¿æ€§\n\nè¿™æ¸…æ™°åœ°å±•ç¤ºäº†æ–¹å·®è†¨èƒ€å› å­çš„å«ä¹‰ï¼šå‚æ•°ä¼°è®¡æ–¹å·®ç›¸å¯¹äºæ— å¤šé‡å…±çº¿æ€§æƒ…å†µä¸‹çš„è†¨èƒ€å€æ•°ã€‚\nå°†æ–¹å·®ä»£å…¥ï¼š \\[VIF_j = \\frac{1}{1-R_j^2} = \\frac{\\sum_{i=1}^n (x_{ij}-\\bar{x}_j)^2}{s^2} \\cdot [(X'X)^{-1}]_{jj}\\]\nå¯çŸ¥ï¼š \\[VIF_j \\propto \\sum_{k=1}^p \\frac{v_{kj}^2}{\\lambda_k}\\]\næ–¹å·®è†¨èƒ€å› å­æœ¬è´¨ä¸Šåº¦é‡äº†å‚æ•°æ–¹å·®åœ¨å„ç‰¹å¾æ–¹å‘ä¸Šçš„ç´¯ç§¯æ”¾å¤§æ•ˆåº”ã€‚\nçŸ©é˜µ\\(X'X\\)çš„æ¡ä»¶æ•°å®šä¹‰ä¸ºï¼š \\[\\kappa(X'X) = \\frac{\\lambda_{max}}{\\lambda_{min}}\\]\nå¤šé‡å…±çº¿æ€§ä¸‹\\(\\lambda_{min} \\to 0\\)ï¼Œå¯¼è‡´ï¼š\n\n\\(\\kappa(X'X) \\to \\infty\\)\nçŸ©é˜µæ±‚é€†æ•°å€¼ä¸ç¨³å®š\nä¼°è®¡é‡å¯¹æ•°æ®æ‰°åŠ¨æ•æ„Ÿ\n\nè®¾è®¡çŸ©é˜µçš„ç—…æ€æ€§ï¼š æ¡ä»¶æ•° \\(\\kappa(\\mathbf{X}'\\mathbf{X}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}\\) è¿‡å¤§ï¼Œå…¶ä¸­ \\(\\lambda\\) æ˜¯ç‰¹å¾å€¼ã€‚\n\n\n5.1.4 å¤šé‡å…±çº¿æ€§çš„è§£å†³æ–¹æ³•\n\nåˆ é™¤å˜é‡\nåˆå¹¶å˜é‡\nå˜é‡å˜æ¢\nå¢åŠ æ ·æœ¬é‡\næ­£åˆ™åŒ–æ–¹æ³•\né™ç»´æ–¹æ³•",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>5 é™ç»´</span>"
    ]
  },
  {
    "objectID": "chapters/5 é™ç»´.html#è‡ªå˜é‡é€‰æ‹©",
    "href": "chapters/5 é™ç»´.html#è‡ªå˜é‡é€‰æ‹©",
    "title": "5 é™ç»´",
    "section": "5.2 è‡ªå˜é‡é€‰æ‹©",
    "text": "5.2 è‡ªå˜é‡é€‰æ‹©\n\n5.2.1 å­é›†å›å½’æ¨¡å‹\nè€ƒè™‘çº¿æ€§å›å½’æ¨¡å‹ï¼š \\[ \\mathbf{y} = \\mathbf{X}\\pmb{\\beta} + \\pmb{\\varepsilon} \\]\nå…¶ä¸­ï¼š\n\n\\(\\mathbf{y} \\in \\mathbb{R}^n\\)ï¼šå“åº”å˜é‡\n\\(\\mathbf{X} \\in \\mathbb{R}^{n \\times p}\\)ï¼šè®¾è®¡çŸ©é˜µï¼ˆåŒ…å«æˆªè·é¡¹ï¼‰\n\\(\\pmb{\\beta} \\in \\mathbb{R}^p\\)ï¼šå›å½’ç³»æ•°\n\\(\\pmb{\\varepsilon} \\in \\mathbb{R}^n\\)ï¼šè¯¯å·®é¡¹ï¼Œ\\(\\pmb{\\varepsilon} \\sim N(\\mathbf{0}, \\sigma^2 \\mathbf{I}_n)\\)\n\nå­é›†æ¨¡å‹\nè®¾ \\(\\mathcal{M}\\) è¡¨ç¤ºä¸€ä¸ªå€™é€‰æ¨¡å‹ï¼ŒåŒ…å« \\(k\\) ä¸ªè‡ªå˜é‡ï¼ˆä¸åŒ…æ‹¬æˆªè·ï¼‰ï¼Œåˆ™ï¼š \\[ \\mathbf{y} = \\mathbf{X}_{\\mathcal{M}}\\pmb{\\beta}_{\\mathcal{M}} + \\pmb{\\varepsilon}_{\\mathcal{M}} \\] å…¶ä¸­ \\(k = |\\mathcal{M}|\\)ã€‚\n\næ®‹å·®å¹³æ–¹å’Œï¼š \\[ \\text{RSS}_{\\mathcal{M}} = \\|\\mathbf{y} - \\hat{\\mathbf{y}}_{\\mathcal{M}}\\|^2 = \\mathbf{y}^\\top(\\mathbf{I} - \\mathbf{P}_{\\mathcal{M}})\\mathbf{y} \\] å…¶ä¸­ \\(\\mathbf{P}_{\\mathcal{M}} = \\mathbf{X}_{\\mathcal{M}}(\\mathbf{X}_{\\mathcal{M}}^\\top \\mathbf{X}_{\\mathcal{M}})^{-1}\\mathbf{X}_{\\mathcal{M}}^\\top\\) æ˜¯æŠ•å½±çŸ©é˜µã€‚\næœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼š åœ¨æ­£æ€å‡è®¾ä¸‹ï¼Œä¼¼ç„¶å‡½æ•°ä¸ºï¼š \\[ L(\\pmb{\\beta}_{\\mathcal{M}}, \\sigma^2) = (2\\pi\\sigma^2)^{-n/2} \\exp\\left(-\\frac{\\text{RSS}_{\\mathcal{M}} + \\|\\mathbf{X}_{\\mathcal{M}}\\pmb{\\beta}_{\\mathcal{M}} - \\mathbf{X}_{\\mathcal{M}}\\hat{\\pmb{\\beta}}_{\\mathcal{M}}\\|^2}{2\\sigma^2}\\right) \\] æœ€å¤§ä¼¼ç„¶ä¼°è®¡ä¸ºï¼š \\[ \\hat{\\pmb{\\beta}}_{\\mathcal{M}} = (\\mathbf{X}_{\\mathcal{M}}^\\top \\mathbf{X}_{\\mathcal{M}})^{-1}\\mathbf{X}_{\\mathcal{M}}^\\top \\mathbf{y}, \\quad \\hat{\\sigma}^2_{\\mathcal{M}} = \\frac{\\text{RSS}_{\\mathcal{M}}}{n} \\]\nå¯¹æ•°ä¼¼ç„¶ï¼š \\[ \\ell(\\mathcal{M}) = -\\frac{n}{2} \\log(2\\pi) - \\frac{n}{2} \\log(\\hat{\\sigma}^2_{\\mathcal{M}}) - \\frac{n}{2} \\]\n\n\n\n5.2.2 è‡ªå˜é‡é€‰æ‹©æ ‡å‡†\nåœ¨çº¿æ€§å›å½’æ¨¡å‹ä¸­ï¼Œå½“æœ‰å¤§é‡æ½œåœ¨è‡ªå˜é‡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©æœ€ä¼˜çš„å­é›†ã€‚è‡ªå˜é‡é€‰æ‹©çš„ç›®æ ‡æ˜¯ï¼š\n\næé«˜é¢„æµ‹ç²¾åº¦ï¼šå‡å°‘è¿‡æ‹Ÿåˆï¼Œé™ä½é¢„æµ‹æ–¹å·®\nå¢å¼ºæ¨¡å‹è§£é‡Šæ€§ï¼šè¯†åˆ«çœŸæ­£é‡è¦çš„å˜é‡\nç®€åŒ–æ¨¡å‹ï¼šå‡å°‘æ•°æ®æ”¶é›†å’Œè®¡ç®—æˆæœ¬\n\n1 å†³å®šç³»æ•° \\(R^2\\)\n\\[ R^2_{\\mathcal{M}} = 1 - \\frac{\\text{RSS}_{\\mathcal{M}}}{\\text{TSS}} \\] å…¶ä¸­ \\(\\text{TSS} = \\sum_{i=1}^n (y_i - \\bar{y})^2\\) æ˜¯æ€»å¹³æ–¹å’Œã€‚\né—®é¢˜ï¼š\\(R^2\\) éšè‡ªå˜é‡å¢åŠ è€Œå•è°ƒå¢åŠ ï¼Œå€¾å‘äºé€‰æ‹©å¤§æ¨¡å‹ã€‚\nä¸ºäº†æƒ©ç½šæ¨¡å‹å¤æ‚åº¦ï¼š \\[ R^2_{\\text{adj},\\mathcal{M}} = 1 - \\frac{\\text{RSS}_{\\mathcal{M}}/(n-k-1)}{\\text{TSS}/(n-1)} = 1 - \\frac{n-1}{n-k-1}(1 - R^2_{\\mathcal{M}}) \\]\næ€§è´¨ï¼š - ä»…å½“æ–°å˜é‡çš„ \\(t\\) ç»Ÿè®¡é‡ç»å¯¹å€¼å¤§äº 1 æ—¶ï¼Œ\\(R^2_{\\text{adj}}\\) æ‰ä¼šå¢åŠ  - ä½†ä»ä¸æ˜¯ä¸€è‡´æ¨¡å‹é€‰æ‹©å‡†åˆ™\n2 Akaike ä¿¡æ¯å‡†åˆ™ (AIC)\nAIC åŸºäº Kullback-Leibler æ•£åº¦æœ€å°åŒ–ã€‚è®¾çœŸå®åˆ†å¸ƒä¸º \\(g(y)\\)ï¼Œæ¨¡å‹åˆ†å¸ƒä¸º \\(f(y|\\theta)\\)ï¼ŒK-L æ•£åº¦ä¸ºï¼š \\[ I(g; f) = \\int g(y) \\log g(y) dy - \\int g(y) \\log f(y|\\theta) dy \\]\næœ€å°åŒ– K-L æ•£åº¦ç­‰ä»·äºæœ€å¤§åŒ– \\(\\mathbb{E}_g[\\log f(y|\\theta)]\\)ã€‚AIC ä¼°è®¡ï¼š \\[ \\text{AIC} = -2 \\log L(\\hat{\\theta}) + 2k \\]\nå¯¹äºçº¿æ€§å›å½’ï¼š \\[ \\text{AIC} = n \\log\\left(\\frac{\\text{RSS}_{\\mathcal{M}}}{n}\\right) + 2(k+1) + n[\\log(2\\pi) + 1] \\]\nå»æ‰å¸¸æ•°é¡¹ï¼Œå¸¸ç”¨ç®€åŒ–å½¢å¼ï¼š \\[ \\text{AIC} = n \\log(\\hat{\\sigma}^2_{\\mathcal{M}}) + 2k \\]\næˆ–ç­‰ä»·çš„ï¼š \\[ \\text{AIC} = \\frac{\\text{RSS}_{\\mathcal{M}}}{n} e^{2k/n} \\]\nç‰ˆæœ¬å·®å¼‚ï¼š\n\nAICï¼š\\(n \\log(\\text{RSS}/n) + 2k\\)\nAICcï¼ˆå°æ ·æœ¬æ ¡æ­£ï¼‰ï¼š\\(n \\log(\\text{RSS}/n) + 2k + \\frac{2k(k+1)}{n-k-1}\\)\nAICuï¼š\\(n \\log[\\text{RSS}/(n-k)] + 2k\\)\n\n3 è´å¶æ–¯ä¿¡æ¯å‡†åˆ™ (BIC)\nBIC æºäºè´å¶æ–¯å› å­çš„ Laplace è¿‘ä¼¼ã€‚æ¨¡å‹ \\(\\mathcal{M}\\) çš„åéªŒæ¦‚ç‡ï¼š \\[ P(\\mathcal{M}|\\mathbf{y}) \\propto P(\\mathbf{y}|\\mathcal{M}) P(\\mathcal{M}) \\]\nè¾¹ç¼˜ä¼¼ç„¶ï¼š \\[ P(\\mathbf{y}|\\mathcal{M}) = \\int L(\\pmb{\\beta}_{\\mathcal{M}}, \\sigma^2) \\pi(\\pmb{\\beta}_{\\mathcal{M}}, \\sigma^2) d\\pmb{\\beta}_{\\mathcal{M}} d\\sigma^2 \\]\nä½¿ç”¨ Jeffrey æ— ä¿¡æ¯å…ˆéªŒ \\(\\pi(\\pmb{\\beta}, \\sigma^2) \\propto 1/\\sigma^2\\)ï¼Œå¯å¾—ï¼š \\[ -2 \\log P(\\mathbf{y}|\\mathcal{M}) \\approx n \\log(\\hat{\\sigma}^2_{\\mathcal{M}}) + k \\log n \\]\nBIC å…¬å¼\n\\[ \\text{BIC} = n \\log\\left(\\frac{\\text{RSS}_{\\mathcal{M}}}{n}\\right) + k \\log n \\]\næˆ–ç­‰ä»·åœ°ï¼š \\[ \\text{BIC} = \\frac{\\text{RSS}_{\\mathcal{M}}}{n} n^{k/n} \\]\nAIC ä¸ BIC æ¯”è¾ƒ\n\n\n\nå‡†åˆ™\næƒ©ç½šé¡¹\nç›®æ ‡\næ¸è¿‘æ€§è´¨\næ¨¡å‹å€¾å‘\n\n\n\n\nAIC\n\\(2k\\)\né¢„æµ‹æœ€ä¼˜\néä¸€è‡´\nåå¤§æ¨¡å‹\n\n\nBIC\n\\(k \\log n\\)\nçœŸå®æ¨¡å‹\nä¸€è‡´\nåå°æ¨¡å‹\n\n\n\nä¸€è‡´æ€§ï¼šå½“ \\(n \\to \\infty\\) æ—¶ï¼ŒBIC ä»¥æ¦‚ç‡ 1 é€‰æ‹©çœŸå®æ¨¡å‹ï¼ˆå¦‚æœçœŸå®æ¨¡å‹åœ¨å€™é€‰é›†ä¸­ï¼‰ï¼Œè€Œ AIC å¯èƒ½é€‰æ‹©è¿‡å‚æ•°åŒ–æ¨¡å‹ã€‚\næ•ˆç‡ï¼šåœ¨é”™è¯¯è®¾å®šä¸‹ï¼ŒAIC é€‰æ‹©çš„æ¨¡å‹å¯èƒ½æœ‰æ›´å¥½çš„é¢„æµ‹æ€§èƒ½ã€‚\n\nAICï¼šæ¸è¿‘æœ‰æ•ˆï¼ˆå½“çœŸå®æ¨¡å‹ä¸åœ¨å€™é€‰é›†ä¸­æ—¶ï¼Œé€‰æ‹©çš„æ¨¡å‹é¢„æµ‹è¯¯å·®æ¥è¿‘æœ€ä¼˜ï¼‰\nBICï¼šæ¸è¿‘ä¸€è‡´ä½†éæœ‰æ•ˆ\n\næ¨¡æ‹Ÿç ”ç©¶æ˜¾ç¤ºï¼š 1. å½“ä¿¡å™ªæ¯”ä½ã€æ ·æœ¬é‡å°æ—¶ï¼ŒAIC å€¾å‘äºé€‰æ‹©è¿‡å¤§çš„æ¨¡å‹ 2. BIC åœ¨æ ·æœ¬é‡è¶³å¤Ÿå¤§æ—¶è¡¨ç°æ›´å¥½ 3. \\(C_p\\) ä¸ AIC æ¸è¿‘ç­‰ä»·ï¼ˆ\\(C_p = \\text{AIC}/n + \\text{å¸¸æ•°}\\)ï¼‰ é«˜ç»´æƒ…å†µ (\\(p &gt; n\\))\nä¼ ç»Ÿå‡†åˆ™å¤±æ•ˆï¼Œéœ€è¦æ”¹è¿›ï¼š - æ‰©å±• BIC(EBIC)ï¼š\\(\\text{BIC} + \\gamma \\log \\binom{p}{k}\\)ï¼Œ\\(\\gamma \\in [0,1]\\) - é«˜ç»´ AICï¼šä½¿ç”¨æœ‰æ•ˆè‡ªç”±åº¦ä»£æ›¿ \\(k\\)\n4 Mallowâ€™s \\(C_p\\) ç»Ÿè®¡é‡\nè€ƒè™‘æ ‡å‡†åŒ–é¢„æµ‹è¯¯å·®ï¼š \\[ \\Gamma_p(\\mathcal{M}) = \\frac{1}{\\sigma^2} \\mathbb{E}[\\|\\mathbf{X}\\hat{\\pmb{\\beta}}_{\\mathcal{M}} - \\mathbf{X}\\pmb{\\beta}\\|^2] \\]\nå¯ä»¥è¯æ˜ï¼š \\[ \\mathbb{E}[\\text{RSS}_{\\mathcal{M}}] = (n-k)\\sigma^2 + \\|\\mathbf{X}\\pmb{\\beta} - \\mathbf{X}_{\\mathcal{M}}\\pmb{\\beta}_{\\mathcal{M}}^*\\|^2 \\]\nå…¶ä¸­ \\(\\pmb{\\beta}_{\\mathcal{M}}^*\\) æ˜¯ \\(\\pmb{\\beta}\\) åœ¨å­ç©ºé—´ä¸Šçš„æŠ•å½±ã€‚å› æ­¤ï¼š \\[ \\mathbb{E}[C_p(\\mathcal{M})] \\approx \\frac{1}{\\sigma^2} \\|\\mathbf{X}\\pmb{\\beta} - \\mathbf{X}_{\\mathcal{M}}\\pmb{\\beta}_{\\mathcal{M}}^*\\|^2 + k \\]\nå‡è®¾å…¨æ¨¡å‹ï¼ˆåŒ…å«æ‰€æœ‰ \\(p\\) ä¸ªå˜é‡ï¼‰æ˜¯æ­£ç¡®çš„ï¼Œåˆ™ï¼š \\[ C_p(\\mathcal{M}) = \\frac{\\text{RSS}_{\\mathcal{M}}}{\\hat{\\sigma}^2_{\\text{full}}} + 2k - n \\] å…¶ä¸­ \\(\\hat{\\sigma}^2_{\\text{full}} = \\text{RSS}_{\\text{full}}/(n-p)\\)ã€‚\nå¯ä»¥è¯æ˜ \\(C_p\\) æ˜¯ \\(\\Gamma_p(k)\\) çš„æ— åä¼°è®¡\nè§£é‡Š - \\(C_p \\approx k\\)ï¼šæ¨¡å‹æ— å - \\(C_p &gt; k\\)ï¼šæ¨¡å‹æœ‰å - \\(C_p &lt; k\\)ï¼šå¯èƒ½è¿‡æ‹Ÿåˆæˆ–éšæœºæ³¢åŠ¨\né€‰æ‹© \\(C_p\\) å°ä¸”æ¥è¿‘ \\(k\\) çš„æ¨¡å‹ã€‚\nå‡†åˆ™é€‰æ‹©æŒ‡å—\n\né¢„æµ‹å¯¼å‘ï¼šç”¨ AICã€\\(C_p\\) æˆ–äº¤å‰éªŒè¯\nè§£é‡Šå¯¼å‘ï¼šç”¨ BIC æˆ–è°ƒæ•´ \\(R^2\\)\nå¤§æ•°æ®ï¼šBIC æ›´å¯é ï¼ˆ\\(n \\geq 1000\\)ï¼‰\nå°æ•°æ®ï¼šAICc æˆ–äº¤å‰éªŒè¯\n\nè‡ªå˜é‡é€‰æ‹©éœ€è¦æƒè¡¡åå·®-æ–¹å·®ã€è§£é‡Šæ€§ä¸é¢„æµ‹ç²¾åº¦ã€‚æ²¡æœ‰å•ä¸€æœ€ä¼˜å‡†åˆ™ï¼Œå®é™…åº”ç”¨ä¸­åº”ï¼š 1. è€ƒè™‘ç ”ç©¶ç›®æ ‡ï¼ˆé¢„æµ‹ vs è§£é‡Šï¼‰ 2. ç»“åˆå¤šç§å‡†åˆ™ 3. è¿›è¡Œæ¨¡å‹è¯Šæ–­å’ŒéªŒè¯ 4. è€ƒè™‘è®¡ç®—æˆæœ¬å’Œå¯è§£é‡Šæ€§\næ ¸å¿ƒå…¬å¼æ€»ç»“ï¼š\n\n\\(R^2_{\\text{adj}} = 1 - \\frac{n-1}{n-k-1}(1-R^2)\\)\n\\(\\text{AIC} = n \\log(\\text{RSS}/n) + 2k\\)\n\\(\\text{BIC} = n \\log(\\text{RSS}/n) + k \\log n\\)\n\\(C_p = \\text{RSS}/\\hat{\\sigma}^2_{\\text{full}} + 2k - n\\)\n\né€‰æ‹©å‡†åˆ™æœ¬èº«ä¹Ÿæœ‰ä¸ç¡®å®šæ€§ï¼Œæ¨¡å‹å¹³å‡å’Œé›†æˆæ–¹æ³•å¯ä»¥è¿›ä¸€æ­¥æ”¹å–„é¢„æµ‹æ€§èƒ½ã€‚\næœ€ä¼˜å­é›†å›å½’\næœ€ä¼˜å­é›†é€‰æ‹©ï¼š å¯¹äºæ¯ä¸ª \\(k = 1, 2, \\cdots, p\\)ï¼Œé€‰æ‹©ä½¿RSSæœ€å°çš„åŒ…å« \\(k\\) ä¸ªè‡ªå˜é‡çš„æ¨¡å‹ã€‚\nè®¡ç®—æŒ‘æˆ˜ï¼š éœ€è¦è¯„ä¼° \\(2^p\\) ä¸ªæ¨¡å‹ï¼Œè®¡ç®—ä¸å¯è¡Œã€‚\né€æ­¥å›å½’ï¼š - å‰å‘é€‰æ‹© - åå‘å‰”é™¤ - é€æ­¥é€‰æ‹©\nå±€é™æ€§ï¼š - è·¯å¾„ä¾èµ– - å¤šé‡æ£€éªŒé—®é¢˜ - æ ‡å‡†è¯¯ä½ä¼°\n\n\n5.2.3 æœ€ä¼˜å­é›†å›å½’ï¼š\nå¯¹äºç»™å®šçš„æ¨¡å‹å¤§å° \\(k\\)ï¼Œæœ€ä¼˜å­é›†é—®é¢˜æ˜¯ç»„åˆä¼˜åŒ–é—®é¢˜ï¼š \\[ \\mathcal{M}_k^* = \\arg\\min_{\\mathcal{M}:|\\mathcal{M}|=k} \\text{RSS}(\\mathcal{M}) \\]\næ€»æœç´¢ç©ºé—´å¤§å°ä¸º \\(\\sum_{k=0}^p \\binom{p}{k} = 2^p\\)ï¼Œæ˜¯NP-hardé—®é¢˜ã€‚\n\n\n5.2.4 é€æ­¥å›å½’\nå‰å‘é€‰æ‹©\nå‰å‘é€‰æ‹©ç­‰ä»·äºæ±‚è§£ä»¥ä¸‹åºåˆ—ä¼˜åŒ–é—®é¢˜ï¼š \\[ j_t = \\arg\\max_{j \\notin \\mathcal{M}_{t-1}} \\frac{|\\mathbf{x}_j^\\top \\mathbf{r}_{t-1}|}{\\|\\mathbf{x}_j\\|} \\]\nå…¶ä¸­ \\(\\mathbf{r}_{t-1}\\) æ˜¯ç¬¬ \\(t-1\\) æ­¥çš„æ®‹å·®å‘é‡ã€‚\nä¸æ­£äº¤åŒ¹é…è¿½è¸ªï¼ˆOMPï¼‰çš„å…³ç³»\nå‰å‘é€‰æ‹©æ˜¯OMPçš„ç‰¹ä¾‹ã€‚åœ¨æ­£äº¤åŒ–ç‰ˆæœ¬ä¸­ï¼š 1. è®¡ç®—å½“å‰æ®‹å·®ä¸æ‰€æœ‰é¢„æµ‹å˜é‡çš„ç›¸å…³ç³»æ•° 2. é€‰æ‹©æœ€å¤§ç›¸å…³ç³»æ•°å¯¹åº”çš„å˜é‡ 3. æ­£äº¤åŒ–æ›´æ–°æ®‹å·®\næ•°å­¦è¡¨è¾¾ï¼š \\[ \\mathbf{q}_t = \\frac{(\\mathbf{I} - \\mathbf{Q}_{t-1}\\mathbf{Q}_{t-1}^\\top)\\mathbf{x}_{j_t}}{\\|(\\mathbf{I} - \\mathbf{Q}_{t-1}\\mathbf{Q}_{t-1}^\\top)\\mathbf{x}_{j_t}\\|} \\] å…¶ä¸­ \\(\\mathbf{Q}_{t-1} = [\\mathbf{q}_1, \\dots, \\mathbf{q}_{t-1}]\\) ä¸ºæ­£äº¤åŸºã€‚\nåå‘åˆ é™¤çš„\nåå‘åˆ é™¤åŸºäºå‡è®¾æ£€éªŒï¼š \\[ H_0: \\beta_j = 0 \\quad \\text{vs} \\quad H_1: \\beta_j \\neq 0 \\]\nä½¿ç”¨ \\(F\\) ç»Ÿè®¡é‡ï¼š \\[ F_j = \\frac{(\\text{RSS}_{-j} - \\text{RSS})/1}{\\text{RSS}/(n-k)} \\] å…¶ä¸­ \\(\\text{RSS}_{-j}\\) æ˜¯åˆ é™¤å˜é‡ \\(j\\) åçš„RSSã€‚\nåŒå‘é€æ­¥å›å½’\nç®—æ³•æè¿°\nç»“åˆå‰å‘å’Œåå‘æ­¥éª¤ï¼š 1. åˆå§‹åŒ–ï¼š\\(\\mathcal{M} = \\emptyset\\) 2. è¿­ä»£ç›´åˆ°æ”¶æ•›ï¼š - å‰å‘æ­¥ï¼šå°è¯•æ·»åŠ ä¸€ä¸ªå˜é‡ - åå‘æ­¥ï¼šå°è¯•åˆ é™¤ä¸€ä¸ªå˜é‡ - æ¯æ¬¡é€‰æ‹©ä½¿ RSS å‡å°‘æœ€å¤šï¼ˆæˆ–å¢åŠ æœ€å°‘ï¼‰çš„æ“ä½œ - é€šå¸¸åŸºäºç»Ÿè®¡æ˜¾è‘—æ€§ï¼ˆå¦‚ \\(p\\) å€¼ï¼‰å†³å®š\nåŸºäº \\(F\\) æ£€éªŒçš„ç‰ˆæœ¬\nå¸¸ç”¨çš„åœæ­¢å‡†åˆ™æ˜¯ \\(F\\) ç»Ÿè®¡é‡ï¼š - æ·»åŠ å˜é‡ï¼šè®¡ç®—å \\(F\\) ç»Ÿè®¡é‡ \\[   F_{\\text{add}} = \\frac{(\\text{RSS}_{\\text{old}} - \\text{RSS}_{\\text{new}})/1}{\\text{RSS}_{\\text{new}}/(n-|\\mathcal{M}|-1)}   \\] å¦‚æœ \\(F_{\\text{add}} &gt; F_{\\text{in}}\\)ï¼ˆè¿›å…¥ä¸´ç•Œå€¼ï¼‰ï¼Œåˆ™æ·»åŠ è¯¥å˜é‡ - åˆ é™¤å˜é‡ï¼šè®¡ç®— \\(F\\) ç»Ÿè®¡é‡ \\[   F_{\\text{drop}} = \\frac{(\\text{RSS}_{\\text{without}} - \\text{RSS}_{\\text{with}})/1}{\\text{RSS}_{\\text{with}}/(n-|\\mathcal{M}|)}   \\] å¦‚æœ \\(F_{\\text{drop}} &lt; F_{\\text{out}}\\)ï¼ˆåˆ é™¤ä¸´ç•Œå€¼ï¼‰ï¼Œåˆ™åˆ é™¤è¯¥å˜é‡\n** ä¸LAR ç®—æ³•è”ç³»**\næœ€å°è§’å›å½’ï¼ˆLeast Angle Regression, LARï¼‰å¯ä»¥çœ‹ä½œé€æ­¥å›å½’çš„è¿ç»­ç‰ˆæœ¬ï¼š 1. å¼€å§‹æ—¶ï¼Œæ‰€æœ‰ç³»æ•°ä¸º0 2. æ‰¾åˆ°ä¸å½“å‰æ®‹å·®æœ€ç›¸å…³çš„å˜é‡ 3. æ²¿è¯¥æ–¹å‘ç§»åŠ¨ç³»æ•°ï¼Œç›´åˆ°å¦ä¸€ä¸ªå˜é‡ä¸æ®‹å·®çš„ç›¸å…³æ€§ç›¸ç­‰ 4. æ²¿è¿™ä¸¤ä¸ªå˜é‡çš„è§’å¹³åˆ†çº¿æ–¹å‘ç§»åŠ¨ 5. é‡å¤ç›´åˆ°æ‰€æœ‰å˜é‡éƒ½è¿›å…¥æ¨¡å‹\næ€»ç»“ä¸æ¯”è¾ƒ\n\n\n\n\n\n\n\n\n\n\næ–¹æ³•\nä¼˜ç‚¹\nç¼ºç‚¹\nè®¡ç®—å¤æ‚åº¦\né€‚ç”¨åœºæ™¯\n\n\n\n\næœ€ä¼˜å­é›†\nå…¨å±€æœ€ä¼˜\nè®¡ç®—ä¸å¯è¡Œï¼ˆ\\(p&gt;40\\)ï¼‰\n\\(O(2^p)\\)\n\\(p \\leq 20\\)ï¼Œç²¾ç¡®è§£é‡è¦\n\n\nå‰å‘é€‰æ‹©\nè®¡ç®—å¿«ï¼Œå¯å¤„ç† \\(p&gt;n\\)\nè´ªå¿ƒï¼Œå¯èƒ½ä¸æ˜¯æœ€ä¼˜\n\\(O(p^2)\\)\né«˜ç»´æ•°æ®ï¼Œè®¡ç®—èµ„æºæœ‰é™\n\n\nåå‘åˆ é™¤\nè€ƒè™‘å˜é‡é—´äº¤äº’\néœ€è¦ \\(n&gt;p\\)\n\\(O(p^3)\\)\n\\(p\\) ä¸­ç­‰ï¼Œå…¨æ¨¡å‹å¯æ‹Ÿåˆ\n\n\nåŒå‘é€æ­¥\næ›´çµæ´»\nå¯èƒ½è¿‡æ‹Ÿåˆ\n\\(O(p^3)\\)\nä¸­ç­‰ç»´åº¦ï¼Œå¹³è¡¡æ¢ç´¢åˆ©ç”¨\n\n\n\nå®é™…å»ºè®®\n\nå½“ \\(p \\leq 20\\) æ—¶ï¼Œè€ƒè™‘æœ€ä¼˜å­é›†ï¼ˆæˆ–æ‰€æœ‰å­é›†ï¼‰\nå½“ \\(p &gt; n\\) æ—¶ï¼Œä½¿ç”¨å‰å‘é€‰æ‹©æˆ– LASSO\nå½“å…³å¿ƒè§£é‡Šæ€§æ—¶ï¼Œé€æ­¥å›å½’å¯èƒ½ä¼˜äºé»‘ç®±æ–¹æ³•\næ€»æ˜¯ä½¿ç”¨äº¤å‰éªŒè¯é€‰æ‹©æœ€ç»ˆæ¨¡å‹å¤§å°\n\næ•°å­¦æ´å¯Ÿ\né€æ­¥å›å½’æœ¬è´¨ä¸Šæ˜¯åœ¨é€æ­¥ä¼˜åŒ–çš„åŸºç¡€ä¸Šè¿›è¡Œçš„åæ ‡ä¸‹é™ã€‚è®¾ç›®æ ‡å‡½æ•°ï¼š \\[\nJ(\\pmb{\\beta}) = \\frac{1}{2}\\|\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}\\|^2 + \\lambda\\|\\pmb{\\beta}\\|_0\n\\] å…¶ä¸­ \\(\\|\\pmb{\\beta}\\|_0 = \\sum_{j=1}^p I(\\beta_j \\neq 0)\\)ã€‚è¿™æ˜¯ NP éš¾é—®é¢˜ï¼Œé€æ­¥å›å½’æä¾›äº†è¿‘ä¼¼è§£ã€‚\nç°ä»£å‘å±•è¡¨æ˜ï¼Œå‡¸æ¾å¼›ï¼ˆå¦‚ LASSOï¼‰åœ¨ç†è®ºå’Œè®¡ç®—ä¸Šéƒ½æœ‰ä¼˜åŠ¿ï¼Œä½†é€æ­¥å›å½’å› å…¶ç®€å•ç›´è§‚ï¼Œä»åœ¨å®è·µä¸­å¹¿æ³›ä½¿ç”¨ã€‚\n\n\n5.2.6 è°ƒå‚ç­–ç•¥\nç½‘æ ¼æœç´¢ï¼š åœ¨ \\(\\lambda\\)ï¼ˆå’Œ \\(\\alpha\\)ï¼‰çš„ç½‘æ ¼ä¸Šè®¡ç®—äº¤å‰éªŒè¯è¯¯å·®ã€‚\nä¿¡æ¯å‡†åˆ™ï¼š\n\nAICï¼š\\(AIC = n\\ln(\\hat{\\sigma}^2) + 2k\\)\nBICï¼š\\(BIC = n\\ln(\\hat{\\sigma}^2) + k\\ln(n)\\)\n\nä¸€å€æ ‡å‡†è¯¯å‡†åˆ™ï¼š é€‰æ‹©è°ƒä¼˜å‚æ•°ï¼Œä½¿å¾—äº¤å‰éªŒè¯è¯¯å·®åœ¨æœ€å°è¯¯å·®çš„ä¸€å€æ ‡å‡†è¯¯èŒƒå›´å†…ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>5 é™ç»´</span>"
    ]
  },
  {
    "objectID": "chapters/5 é™ç»´.html#ä¸»æˆåˆ†å›å½’",
    "href": "chapters/5 é™ç»´.html#ä¸»æˆåˆ†å›å½’",
    "title": "5 é™ç»´",
    "section": "5.3 ä¸»æˆåˆ†å›å½’",
    "text": "5.3 ä¸»æˆåˆ†å›å½’\n\n5.3.1 ä¸»æˆåˆ†å›å½’åŸç†\nä¸»æˆåˆ†å›å½’ï¼ˆPrincipal Component Regression, PCRï¼‰æ˜¯å¤šå…ƒçº¿æ€§å›å½’ä¸ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰çš„ç»“åˆã€‚å½“è‡ªå˜é‡å­˜åœ¨å¤šé‡å…±çº¿æ€§æ—¶ï¼Œæ™®é€šæœ€å°äºŒä¹˜æ³•ï¼ˆOLSï¼‰ä¼°è®¡çš„æ–¹å·®ä¼šå˜å¾—å¾ˆå¤§ï¼ŒPCRé€šè¿‡å…ˆå¯¹è‡ªå˜é‡è¿›è¡Œä¸»æˆåˆ†åˆ†æï¼Œç„¶åé€‰å–éƒ¨åˆ†ä¸»æˆåˆ†ä½œä¸ºæ–°çš„è‡ªå˜é‡è¿›è¡Œå›å½’ï¼Œä»è€Œæ”¹å–„ä¼°è®¡çš„ç¨³å®šæ€§ã€‚\n\n\n5.3.2 ç†è®ºæ¨å¯¼è¿‡ç¨‹\nè®¾çº¿æ€§å›å½’æ¨¡å‹ï¼š \\[ \\mathbf{y} = \\mathbf{X}\\pmb{\\beta} + \\pmb{\\varepsilon} \\]\nå…¶ä¸­ï¼š\n\n\\(\\mathbf{y} \\in \\mathbb{R}^{n}\\) æ˜¯å› å˜é‡è§‚æµ‹å‘é‡\n\\(\\mathbf{X} \\in \\mathbb{R}^{n \\times p}\\) æ˜¯è‡ªå˜é‡è®¾è®¡çŸ©é˜µï¼ˆå·²ä¸­å¿ƒåŒ–ï¼‰\n\\(\\pmb{\\beta} \\in \\mathbb{R}^{p}\\) æ˜¯å›å½’ç³»æ•°å‘é‡\n\\(\\pmb{\\varepsilon} \\in \\mathbb{R}^{n}\\) æ˜¯è¯¯å·®å‘é‡ï¼Œæ»¡è¶³ \\(\\mathbb{E}(\\pmb{\\varepsilon}) = \\mathbf{0}\\), \\(\\text{Var}(\\pmb{\\varepsilon}) = \\sigma^2 \\mathbf{I}_n\\)\n\nå‡è®¾ \\(\\mathbf{X}\\) å·²ä¸­å¿ƒåŒ–ï¼ˆå³æ¯åˆ—å‡å€¼ä¸º0ï¼‰ï¼Œåˆ™æ— éœ€è€ƒè™‘æˆªè·é¡¹ã€‚\nåˆ™\\(\\mathbf{X}\\) çš„æ ·æœ¬åæ–¹å·®çŸ©é˜µä¸ºï¼š \\[ \\mathbf{S} = \\frac{1}{n-1} \\mathbf{X}^\\top \\mathbf{X} \\]\nå¯¹ \\(\\mathbf{S}\\) è¿›è¡Œç‰¹å¾åˆ†è§£ï¼š \\[ \\mathbf{S} = \\mathbf{V}\\pmb{\\Lambda}\\mathbf{V}^\\top \\]\nå…¶ä¸­ï¼š\n\n\\(\\pmb{\\Lambda} = \\text{diag}(\\lambda_1, \\lambda_2, \\dots, \\lambda_p)\\)ï¼Œ\\(\\lambda_1 \\geq \\lambda_2 \\geq \\cdots \\geq \\lambda_p \\geq 0\\) æ˜¯ç‰¹å¾å€¼\n\\(\\mathbf{V} = [\\mathbf{v}_1, \\mathbf{v}_2, \\dots, \\mathbf{v}_p]\\) æ˜¯æ­£äº¤ç‰¹å¾å‘é‡çŸ©é˜µï¼Œæ»¡è¶³ \\(\\mathbf{V}^\\top \\mathbf{V} = \\mathbf{I}_p\\)\n\nä¸»æˆåˆ†å¾—åˆ†çŸ©é˜µä¸ºï¼š \\[ \\mathbf{Z} = \\mathbf{X}\\mathbf{V} \\]\nå…¶ä¸­ \\(\\mathbf{Z} = [\\mathbf{z}_1, \\mathbf{z}_2, \\dots, \\mathbf{z}_p]\\)ï¼Œç¬¬ \\(j\\) ä¸ªä¸»æˆåˆ† \\(\\mathbf{z}_j = \\mathbf{X}\\mathbf{v}_j\\)ã€‚\nåŸæ¨¡å‹ \\(\\mathbf{y} = \\mathbf{X}\\pmb{\\beta} + \\pmb{\\varepsilon}\\) å¯å†™ä¸ºï¼š \\[ \\mathbf{y} = \\mathbf{X}\\mathbf{V}\\mathbf{V}^\\top\\pmb{\\beta} + \\pmb{\\varepsilon} = \\mathbf{Z}\\pmb{\\alpha} + \\pmb{\\varepsilon} \\]\nå…¶ä¸­ \\(\\pmb{\\alpha} = \\mathbf{V}^\\top\\pmb{\\beta}\\) æ˜¯ä¸»æˆåˆ†å›å½’ä¸­çš„ç³»æ•°å‘é‡ã€‚\né€‰æ‹©å‰ \\(k\\) (\\(k \\leq p\\)) ä¸ªä¸»æˆåˆ†ï¼Œå¾—åˆ°çº¦ç®€æ¨¡å‹ï¼š \\[ \\mathbf{y} = \\mathbf{Z}_k\\pmb{\\alpha}_k + \\pmb{\\varepsilon}^* \\]\nå…¶ä¸­ï¼š\n\n\\(\\mathbf{Z}_k = \\mathbf{X}\\mathbf{V}_k\\)ï¼Œ\\(\\mathbf{V}_k = [\\mathbf{v}_1, \\dots, \\mathbf{v}_k]\\)\n\\(\\pmb{\\alpha}_k = (\\alpha_1, \\dots, \\alpha_k)^\\top\\)\n\nå¯¹çº¦ç®€æ¨¡å‹åº”ç”¨æœ€å°äºŒä¹˜æ³•ï¼š \\[ \\hat{\\pmb{\\alpha}}_k = (\\mathbf{Z}_k^\\top \\mathbf{Z}_k)^{-1} \\mathbf{Z}_k^\\top \\mathbf{y} \\]\nç”±äº \\(\\mathbf{Z}_k^\\top \\mathbf{Z}_k = (n-1)\\pmb{\\Lambda}_k\\)ï¼Œå…¶ä¸­ \\(\\pmb{\\Lambda}_k = \\text{diag}(\\lambda_1, \\dots, \\lambda_k)\\)ï¼Œå¯å¾—ï¼š \\[ \\hat{\\pmb{\\alpha}}_k = \\frac{1}{n-1} \\pmb{\\Lambda}_k^{-1} \\mathbf{Z}_k^\\top \\mathbf{y} \\]\nåˆ†é‡å½¢å¼ä¸ºï¼š \\[ \\hat{\\alpha}_j = \\frac{\\mathbf{z}_j^\\top \\mathbf{y}}{(n-1)\\lambda_j}, \\quad j=1,\\dots,k \\]\nåŸå§‹å‚æ•° \\(\\pmb{\\beta}\\) çš„PCRä¼°è®¡ä¸ºï¼š \\[ \\hat{\\pmb{\\beta}}_{\\text{PCR}} = \\mathbf{V}_k \\hat{\\pmb{\\alpha}}_k = \\sum_{j=1}^k \\mathbf{v}_j \\hat{\\alpha}_j \\]\nä»£å…¥ \\(\\hat{\\alpha}_j\\) è¡¨è¾¾å¼ï¼š \\[ \\hat{\\pmb{\\beta}}_{\\text{PCR}} = \\sum_{j=1}^k \\mathbf{v}_j \\frac{\\mathbf{z}_j^\\top \\mathbf{y}}{(n-1)\\lambda_j} = \\sum_{j=1}^k \\mathbf{v}_j \\frac{\\mathbf{v}_j^\\top \\mathbf{X}^\\top \\mathbf{y}}{(n-1)\\lambda_j} \\]\nç®—æ³•æ­¥éª¤æ€»ç»“\n\nä¸­å¿ƒåŒ– \\(\\mathbf{X}\\) å’Œ \\(\\mathbf{y}\\)\nè®¡ç®— \\(\\mathbf{X}\\) çš„åæ–¹å·®çŸ©é˜µ \\(\\mathbf{S}\\)\nå¯¹ \\(\\mathbf{S}\\) è¿›è¡Œç‰¹å¾åˆ†è§£ï¼Œå¾—åˆ° \\(\\mathbf{V}\\) å’Œ \\(\\pmb{\\Lambda}\\)\né€‰æ‹©ä¸»æˆåˆ†ä¸ªæ•° \\(k\\)\nè®¡ç®—ä¸»æˆåˆ†å¾—åˆ† \\(\\mathbf{Z}_k = \\mathbf{X}\\mathbf{V}_k\\)\nç”¨OLSä¼°è®¡ \\(\\mathbf{y}\\) å¯¹ \\(\\mathbf{Z}_k\\) çš„å›å½’ç³»æ•° \\(\\hat{\\pmb{\\alpha}}_k\\)\nè½¬æ¢å›åŸå§‹ç©ºé—´ï¼š\\(\\hat{\\pmb{\\beta}}_{\\text{PCR}} = \\mathbf{V}_k \\hat{\\pmb{\\alpha}}_k\\)\n\né€‰æ‹©ä¸»æˆåˆ†ä¸ªæ•° \\(k\\) çš„å¸¸ç”¨æ–¹æ³•ï¼š\n\nç´¯ç§¯æ–¹å·®è´¡çŒ®ç‡ï¼šé€‰æ‹©æœ€å°çš„ \\(k\\) ä½¿å¾— \\[    \\frac{\\sum_{j=1}^k \\lambda_j}{\\sum_{j=1}^p \\lambda_j} \\geq \\tau    \\] é€šå¸¸å– \\(\\tau = 0.7 \\sim 0.9\\)\näº¤å‰éªŒè¯ï¼šé€šè¿‡æœ€å°åŒ–é¢„æµ‹è¯¯å·®çš„äº¤å‰éªŒè¯ä¼°è®¡æ¥é€‰æ‹© \\(k\\)\nç‰¹å¾å€¼å¤§äº1å‡†åˆ™ï¼ˆé€‚ç”¨äºæ ‡å‡†åŒ–æ•°æ®ï¼‰",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>5 é™ç»´</span>"
    ]
  },
  {
    "objectID": "chapters/5 é™ç»´.html#ä¼°è®¡é‡çš„æ€§è´¨",
    "href": "chapters/5 é™ç»´.html#ä¼°è®¡é‡çš„æ€§è´¨",
    "title": "5 é™ç»´",
    "section": "5.3.3 ä¼°è®¡é‡çš„æ€§è´¨",
    "text": "5.3.3 ä¼°è®¡é‡çš„æ€§è´¨\n\nåå·®\n\nPCRä¼°è®¡æ˜¯æœ‰åä¼°è®¡ï¼ˆé™¤é \\(k=p\\)ï¼‰ï¼š \\[\n  \\mathbb{E}[\\hat{\\pmb{\\beta}}_{\\text{PCR}}] = \\mathbf{V}_k\\mathbf{V}_k^\\top\\pmb{\\beta}\n\\]\nåå·®ä¸ºï¼š \\[\n\\text{Bias}(\\hat{\\pmb{\\beta}}_{\\text{PCR}}) = (\\mathbf{V}_k\\mathbf{V}_k^\\top - \\mathbf{I})\\pmb{\\beta} = -\\sum_{j=k+1}^p \\mathbf{v}_j\\mathbf{v}_j^\\top\\pmb{\\beta}\n\\]\n\næ–¹å·®\n\n\\[\n\\text{Var}(\\hat{\\pmb{\\beta}}_{\\text{PCR}}) = \\sigma^2 \\mathbf{V}_k \\pmb{\\Lambda}_k^{-1} \\mathbf{V}_k^\\top = \\sigma^2 \\sum_{j=1}^k \\frac{\\mathbf{v}_j\\mathbf{v}_j^\\top}{(n-1)\\lambda_j}\n\\]\n\nå‡æ–¹è¯¯å·®\n\n\\[\n\\text{MSE}(\\hat{\\pmb{\\beta}}_{\\text{PCR}}) = \\text{Var}(\\hat{\\pmb{\\beta}}_{\\text{PCR}}) + \\|\\text{Bias}(\\hat{\\pmb{\\beta}}_{\\text{PCR}})\\|^2\n\\]\nå½“å­˜åœ¨å°ç‰¹å¾å€¼æ—¶ï¼ŒPCRé€šè¿‡ç‰ºç‰²åå·®æ¥æ˜¾è‘—é™ä½æ–¹å·®ï¼Œä»è€Œå¯èƒ½è·å¾—æ¯”OLSæ›´å°çš„å‡æ–¹è¯¯å·®ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>5 é™ç»´</span>"
    ]
  },
  {
    "objectID": "chapters/5 é™ç»´.html#åæœ€å°äºŒä¹˜å›å½’",
    "href": "chapters/5 é™ç»´.html#åæœ€å°äºŒä¹˜å›å½’",
    "title": "5 é™ç»´",
    "section": "5.4 åæœ€å°äºŒä¹˜å›å½’",
    "text": "5.4 åæœ€å°äºŒä¹˜å›å½’\n\n5.4.1 PLSçš„åŸºæœ¬æ€æƒ³\næ½œå˜é‡æ„å»ºï¼š å¯»æ‰¾æ½œå˜é‡ \\(\\mathbf{t} = \\mathbf{X}\\mathbf{w}\\)ï¼Œä½¿å¾—ï¼š 1. \\(\\mathbf{t}\\) çš„æ–¹å·®å°½å¯èƒ½å¤§ 2. \\(\\mathbf{t}\\) ä¸ \\(\\mathbf{y}\\) çš„ç›¸å…³æ€§å°½å¯èƒ½å¤§\nä¼˜åŒ–é—®é¢˜ï¼š\n\\[\n\\begin{aligned}\n\\max_{\\mathbf{w}} & \\quad \\text{Cov}(\\mathbf{X}\\mathbf{w}, \\mathbf{y}) \\\\\n\\text{s.t.} & \\quad \\|\\mathbf{w}\\|_2 = 1\n\\end{aligned}\n\\]\n\n\n5.4.2 PLSç®—æ³•ï¼ˆNIPALSï¼‰\nåˆå§‹åŒ–\nä»¤ï¼š \\[E_0 = X - \\bar{X}, \\quad f_0 = y - \\bar{y}\\] å…¶ä¸­\\(E_0\\)å’Œ\\(f_0\\)æ˜¯ä¸­å¿ƒåŒ–åçš„æ•°æ®ã€‚\nç¬¬hä¸ªæˆåˆ†çš„æå–\næ­¥éª¤1ï¼šè®¡ç®—æƒé‡å‘é‡\\(w_h\\)\n\\[w_h = \\frac{E_{h-1}^T f_{h-1}}{\\|E_{h-1}^T f_{h-1}\\|}\\]\nè§£é‡Šï¼šæ‰¾åˆ°\\(X\\)ä¸­ä¸å½“å‰\\(y\\)æ®‹å·®æœ€ç›¸å…³çš„æ–¹å‘ã€‚\næ­¥éª¤2ï¼šè®¡ç®—å¾—åˆ†å‘é‡\\(t_h\\)\n\\[t_h = E_{h-1} w_h\\]\nè§£é‡Šï¼š\\(X\\)åœ¨æƒé‡æ–¹å‘ä¸Šçš„æŠ•å½±ï¼Œå³æ½œå˜é‡ã€‚\næ­¥éª¤3ï¼šè®¡ç®—Xè½½è·å‘é‡\\(p_h\\)\n\\[p_h = \\frac{E_{h-1}^T t_h}{t_h^T t_h}\\]\nè§£é‡Šï¼š\\(t_h\\)å¯¹åŸå§‹\\(X\\)å˜é‡çš„è§£é‡Šç¨‹åº¦ã€‚\næ­¥éª¤4ï¼šè®¡ç®—yè½½è·\\(c_h\\)\n\\[c_h = \\frac{f_{h-1}^T t_h}{t_h^T t_h}\\]\nè§£é‡Šï¼š\\(t_h\\)å¯¹\\(y\\)çš„è§£é‡Šç¨‹åº¦ï¼ˆæ ‡é‡ï¼‰ã€‚\næ­¥éª¤5ï¼šæ›´æ–°æ®‹å·®\n\\[E_h = E_{h-1} - t_h p_h^T\\] \\[f_h = f_{h-1} - c_h t_h\\]",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>5 é™ç»´</span>"
    ]
  },
  {
    "objectID": "chapters/5 é™ç»´.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/5 é™ç»´.html#æ¡ˆä¾‹åˆ†æ",
    "title": "5 é™ç»´",
    "section": "5.5 æ¡ˆä¾‹åˆ†æ",
    "text": "5.5 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>5 é™ç»´</span>"
    ]
  },
  {
    "objectID": "chapters/5 é™ç»´.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/5 é™ç»´.html#æœ¬ç« æ€»ç»“",
    "title": "5 é™ç»´",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾ 1. ä¸»æˆåˆ†ï¼š\\(\\mathbf{Z} = \\mathbf{X}\\mathbf{V}\\)ï¼Œå…¶ä¸­ \\(\\mathbf{S} = \\mathbf{V}\\pmb{\\Lambda}\\mathbf{V}'\\) 2. åæ ‡ä¸‹é™ï¼š\\(\\beta_j \\leftarrow S\\left(\\frac{1}{n}\\sum_{i=1}^n x_{ij}(y_i - \\tilde{y}_i^{(j)}), \\lambda\\right)\\)\næ–¹æ³•é€‰æ‹©æŒ‡å—\n\n\n\n\n\n\n\n\n\n\næ–¹æ³•\næ ¸å¿ƒæ€æƒ³\nä¼˜ç‚¹\nç¼ºç‚¹\né€‚ç”¨åœºæ™¯\n\n\n\n\næœ€ä¼˜å­é›†\nç©·ä¸¾æœç´¢\nå…¨å±€æœ€ä¼˜è§£\nè®¡ç®—é‡å¤§ï¼Œä¸å¯è¡Œ\nå˜é‡æ•°è¾ƒå°‘(&lt;20)\n\n\né€æ­¥å›å½’\né€æ­¥ç­›é€‰\nè®¡ç®—é«˜æ•ˆï¼Œè‡ªåŠ¨é€‰æ‹©\nå±€éƒ¨æœ€ä¼˜ï¼Œç»“æœä¸ç¨³å®š\nåˆæ­¥å˜é‡ç­›é€‰\n\n\nä¸»æˆåˆ†å›å½’\næ­£äº¤å˜æ¢\næ¶ˆé™¤å…±çº¿æ€§ï¼Œç¨³å®š\nå¯è§£é‡Šæ€§å·®\nå¼ºå…±çº¿æ€§ï¼Œé¢„æµ‹ä¸ºä¸»\n\n\nåæœ€å°äºŒä¹˜\nååŒé™ç»´\nåˆ©ç”¨Yä¿¡æ¯ï¼Œé¢„æµ‹å¥½\nè®¡ç®—å¤æ‚ï¼Œç†è®ºæ·±\né«˜ç»´æ•°æ®ï¼Œé¢„æµ‹ç²¾åº¦è¦æ±‚é«˜\n\n\n\nå®è·µå»ºè®®\n\næ•°æ®é¢„å¤„ç†ï¼šæ ‡å‡†åŒ–è‡ªå˜é‡ï¼Œç¡®ä¿æƒ©ç½šçš„å…¬å¹³æ€§\næ¨¡å‹è¯„ä¼°ï¼šä½¿ç”¨äº¤å‰éªŒè¯ï¼Œé¿å…è¿‡æ‹Ÿåˆ\nç»“æœéªŒè¯ï¼šåœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°é¢„æµ‹æ€§èƒ½\nç¨³å¥æ€§æ£€æŸ¥ï¼šå°è¯•ä¸åŒæ–¹æ³•ï¼Œæ¯”è¾ƒç»“æœä¸€è‡´æ€§\né¢†åŸŸçŸ¥è¯†ï¼šç»“åˆå®é™…é—®é¢˜èƒŒæ™¯é€‰æ‹©åˆé€‚æ–¹æ³•\n\nâ€œä¼ ç»Ÿå˜é‡é€‰æ‹©æ–¹æ³•å¦‚é€æ­¥å›å½’ï¼Œè™½ç„¶åº”ç”¨å¹¿æ³›ï¼Œä½†å­˜åœ¨é€‰æ‹©ç»“æœä¸ç¨³å®šã€å¿½ç•¥å˜é‡é—´ç†è®ºå…³ç³»ç­‰å±€é™æ€§ã€‚è€Œé™ç»´æ–¹æ³•å¦‚ä¸»æˆåˆ†å›å½’ï¼Œè™½ç„¶è§£å†³äº†å…±çº¿æ€§é—®é¢˜ï¼Œå´æŸå¤±äº†åŸå§‹å˜é‡çš„å¯è§£é‡Šæ€§ã€‚20ä¸–çºª70å¹´ä»£ä»¥æ¥ï¼Œä¸€ç§åŸºäºæƒ©ç½šä¼¼ç„¶çš„æ–°æ€è·¯â€”â€”æ­£åˆ™åŒ–æ–¹æ³•é€æ¸å‘å±•èµ·æ¥ï¼Œå®ƒé€šè¿‡åœ¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥æƒ©ç½šé¡¹ï¼ŒåŒæ—¶å®ç°å‚æ•°ä¼°è®¡å’Œå˜é‡é€‰æ‹©ã€‚ä¸‹ä¸€ç« å°†ç³»ç»Ÿä»‹ç»å²­å›å½’ã€LassoåŠå…¶å˜ä½“ï¼Œè¿™äº›æ–¹æ³•ä¸ä»…èƒ½å¤Ÿå¤„ç†å¤šé‡å…±çº¿æ€§ï¼Œè¿˜èƒ½äº§ç”Ÿç¨€ç–è§£ï¼Œåœ¨é«˜ç»´æ•°æ®åˆ†æä¸­è¡¨ç°å‡ºæ˜¾è‘—ä¼˜åŠ¿ã€‚â€",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>5 é™ç»´</span>"
    ]
  },
  {
    "objectID": "chapters/6 æ­£åˆ™åŒ–.html",
    "href": "chapters/6 æ­£åˆ™åŒ–.html",
    "title": "6 æ­£åˆ™åŒ–",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\néšç€å¤§æ•°æ®æ—¶ä»£çš„åˆ°æ¥ï¼Œé«˜ç»´æ•°æ®é—®é¢˜æ—¥ç›Šæ™®éã€‚å½“è‡ªå˜é‡æ•°ç›® \\(p\\) æ¥è¿‘ç”šè‡³è¶…è¿‡æ ·æœ¬é‡ \\(n\\) æ—¶ï¼Œä¼ ç»Ÿçš„æœ€å°äºŒä¹˜æ³•é¢ä¸´ä¸¥é‡æŒ‘æˆ˜ã€‚æœ¬ç« å°†ç³»ç»Ÿä»‹ç»æ­£åˆ™åŒ–æ–¹æ³•å’Œé™ç»´æŠ€æœ¯è¿™ä¸¤ç±»å¤„ç†é«˜ç»´é—®é¢˜çš„ä¸»æµæ–¹æ³•ï¼Œä¸ºæ‚¨æä¾›åœ¨â€œç»´æ•°ç¾éš¾â€ä¸‹å»ºç«‹ç¨³å®šé¢„æµ‹æ¨¡å‹çš„æœ‰æ•ˆå·¥å…·ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>6 æ­£åˆ™åŒ–</span>"
    ]
  },
  {
    "objectID": "chapters/6 æ­£åˆ™åŒ–.html#æ­£åˆ™åŒ–æ–¹æ³•ç†è®ºåŸºç¡€",
    "href": "chapters/6 æ­£åˆ™åŒ–.html#æ­£åˆ™åŒ–æ–¹æ³•ç†è®ºåŸºç¡€",
    "title": "6 æ­£åˆ™åŒ–",
    "section": "6.1 æ­£åˆ™åŒ–æ–¹æ³•ç†è®ºåŸºç¡€",
    "text": "6.1 æ­£åˆ™åŒ–æ–¹æ³•ç†è®ºåŸºç¡€\n\n6.1.1 æ­£åˆ™åŒ–çš„ä¸€èˆ¬æ¡†æ¶\nå¤ä¹ å‰é¢æ™®é€šæœ€å°äºŒä¹˜æ³•çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š \\[ \\min_{\\beta} \\|y - X\\beta\\|_2^2 \\]\nå³ï¼š\n\\[\n\\hat{\\pmb{\\beta}} = \\arg\\min_{\\pmb{\\beta}} ||\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}||_2^2\n\\]\nè§£ä¸ºï¼š \\[ \\hat{\\beta}_{OLS} = (X^T X)^{-1} X^T y \\]\nå½“ \\(X^T X\\) æ¥è¿‘å¥‡å¼‚æ—¶ï¼ˆå¤šé‡å…±çº¿æ€§ï¼‰ï¼ŒOLSä¼°è®¡å˜å¾—ä¸ç¨³å®šï¼Œæ–¹å·®å¾ˆå¤§ã€‚\nä¸‹é¢é€šè¿‡æ·»åŠ æ­£åˆ™åŒ–é¡¹ï¼ˆæƒ©ç½šé¡¹ï¼‰æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š\næƒ©ç½šæœ€å°äºŒä¹˜ï¼š \\[\n\\begin{aligned}\n&\\min_{\\pmb{\\beta}} ||\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}||_2^2 \\\\\n&\\quad \\text{s.t.} \\quad P(\\beta) \\leq t\n\\end{aligned}\n\\]\nå³ï¼š \\[\n\\hat{\\pmb{\\beta}} = \\arg\\min_{\\pmb{\\beta}} \\left\\{ ||\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}||_2^2 + \\lambda P(\\pmb{\\beta}) \\right\\}\n\\]\nå…¶ä¸­ \\(P(\\pmb{\\beta})\\) æ˜¯æƒ©ç½šå‡½æ•°ï¼Œ\\(\\lambda \\geq 0\\) æ˜¯è°ƒèŠ‚å‚æ•°ã€‚\n\n\n6.1.2 åå·®-æ–¹å·®æƒè¡¡çš„æ•°å­¦è¡¨è¾¾\næœŸæœ›é¢„æµ‹è¯¯å·®åˆ†è§£ï¼š \\[\n\\mathbb{E}[(y_0 - \\mathbf{x}_0'\\hat{\\pmb{\\beta}})^2] = \\text{Var}(\\mathbf{x}_0'\\hat{\\pmb{\\beta}}) + [\\text{Bias}(\\mathbf{x}_0'\\hat{\\pmb{\\beta}})]^2 + \\sigma^2\n\\]\næ­£åˆ™åŒ–çš„ä½œç”¨ï¼š é€šè¿‡å¼•å…¥åå·®æ¥é™ä½æ–¹å·®ï¼Œä»è€Œå‡å°‘æœŸæœ›é¢„æµ‹è¯¯å·®ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>6 æ­£åˆ™åŒ–</span>"
    ]
  },
  {
    "objectID": "chapters/6 æ­£åˆ™åŒ–.html#å²­å›å½’",
    "href": "chapters/6 æ­£åˆ™åŒ–.html#å²­å›å½’",
    "title": "6 æ­£åˆ™åŒ–",
    "section": "6.2 å²­å›å½’",
    "text": "6.2 å²­å›å½’\n\n6.2.1 å²­ä¼°è®¡çš„å®šä¹‰ä¸æ€§è´¨\nL2æ­£åˆ™åŒ–ï¼š\n\\[\n\\begin{aligned}\n&\\min_{\\pmb{\\beta}} ||\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}||_2^2 \\\\\n&\\quad \\text{s.t.} \\quad ||\\pmb{\\beta}||_2^2 \\leq t\n\\end{aligned}\n\\]\nå³ï¼š \\[\n\\min_{\\beta} \\left\\{ \\|y - X\\beta\\|_2^2 + \\lambda \\|\\beta\\|_2^2 \\right\\}\n\\]\nå…¶ä¸­ \\(\\lambda &gt; 0\\) æ˜¯æ­£åˆ™åŒ–å‚æ•°ã€‚ å°†ç›®æ ‡å‡½æ•°å±•å¼€\n\\[ J(\\beta) = (y - X\\beta)^T(y - X\\beta) + \\lambda \\beta^T\\beta \\]\nå±•å¼€ç¬¬ä¸€é¡¹ï¼š \\[ (y - X\\beta)^T(y - X\\beta) = y^Ty - 2y^TX\\beta + \\beta^TX^TX\\beta \\]\nå› æ­¤ï¼š \\[ J(\\beta) = y^Ty - 2y^TX\\beta + \\beta^TX^TX\\beta + \\lambda \\beta^T\\beta \\]\nå¯¹ \\(\\beta\\) æ±‚æ¢¯åº¦ï¼š \\[ \\nabla J(\\beta) = -2X^Ty + 2X^TX\\beta + 2\\lambda\\beta \\]\nä»¤æ¢¯åº¦ä¸ºé›¶ï¼š \\[ -2X^Ty + 2X^TX\\beta + 2\\lambda\\beta = 0 \\]\næ•´ç†å¾—ï¼š \\[ (X^TX + \\lambda I)\\beta = X^Ty \\]\nè§£å¾—å²­å›å½’ä¼°è®¡ï¼š \\[ \\hat{\\beta}_{ridge} = (X^TX + \\lambda I)^{-1} X^T y \\]\nå²­ä¼°è®¡é‡ï¼š \\[\n\\hat{\\pmb{\\beta}}_{\\text{ridge}} = (\\mathbf{X}'\\mathbf{X} + \\lambda\\mathbf{I})^{-1}\\mathbf{X}'\\mathbf{y}\n\\]\nç†è®ºæ€§è´¨ï¼š\n\næœ‰åæ€§ï¼š\\(\\mathbb{E}[\\hat{\\pmb{\\beta}}_{\\text{ridge}}] = (\\mathbf{X}'\\mathbf{X} + \\lambda\\mathbf{I})^{-1}\\mathbf{X}'\\mathbf{X}\\pmb{\\beta}\\)\næ–¹å·®ï¼š\\(\\text{Var}(\\hat{\\pmb{\\beta}}_{\\text{ridge}}) = \\sigma^2(\\mathbf{X}'\\mathbf{X} + \\lambda\\mathbf{I})^{-1}\\mathbf{X}'\\mathbf{X}(\\mathbf{X}'\\mathbf{X} + \\lambda\\mathbf{I})^{-1}\\)\n\n\n\n6.2.2 å²­å‚æ•°çš„é€‰æ‹©\näº¤å‰éªŒè¯ï¼š \\[\nCV(\\lambda) = \\frac{1}{n}\\sum_{i=1}^n (y_i - \\mathbf{x}_i'\\hat{\\pmb{\\beta}}^{(-i)}(\\lambda))^2\n\\]\nå¹¿ä¹‰äº¤å‰éªŒè¯(GCV)ï¼š \\[\nGCV(\\lambda) = \\frac{\\frac{1}{n}||(\\mathbf{I} - \\mathbf{S}(\\lambda))\\mathbf{y}||_2^2}{[1 - \\frac{1}{n}\\text{tr}(\\mathbf{S}(\\lambda))]^2}\n\\] å…¶ä¸­ \\(\\mathbf{S}(\\lambda) = \\mathbf{X}(\\mathbf{X}'\\mathbf{X} + \\lambda\\mathbf{I})^{-1}\\mathbf{X}'\\)",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>6 æ­£åˆ™åŒ–</span>"
    ]
  },
  {
    "objectID": "chapters/6 æ­£åˆ™åŒ–.html#lassoå›å½’",
    "href": "chapters/6 æ­£åˆ™åŒ–.html#lassoå›å½’",
    "title": "6 æ­£åˆ™åŒ–",
    "section": "6.3 LASSOå›å½’",
    "text": "6.3 LASSOå›å½’\n\n6.3.1 LASSOçš„å®šä¹‰ä¸ç‰¹æ€§\nL1æ­£åˆ™åŒ–é¡¹ï¼š \\[\n\\hat{\\pmb{\\beta}}_{\\text{lasso}} = \\arg\\min_{\\pmb{\\beta}} \\left\\{\\frac{1}{2n}||\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}||_2^2 + \\lambda||\\pmb{\\beta}||_1 \\right\\}\n\\]\nçº¦æŸå½¢å¼ï¼š \\[\n\\begin{aligned}\n\\min_{\\pmb{\\beta}} ||\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}||_2^2 \\\\\n\\quad \\text{s.t.} \\quad ||\\pmb{\\beta}||_1 \\leq t\n\\end{aligned}\n\\]\n\n\n6.3.2 LASSOçš„å˜é‡é€‰æ‹©æ€§è´¨\nè½¯é˜ˆå€¼ï¼š åœ¨æ­£äº¤è®¾è®¡æƒ…å†µä¸‹ï¼ŒLASSOè§£æœ‰æ˜¾å¼è¡¨è¾¾å¼ï¼š \\[\n\\hat{\\beta}_j^{\\text{lasso}} = \\text{sign}(\\hat{\\beta}_j^{\\text{OLS}})(|\\hat{\\beta}_j^{\\text{OLS}}| - \\lambda)_+\n\\]\nå˜é‡é€‰æ‹©ä¸€è‡´æ€§ï¼š åœ¨é€‚å½“æ¡ä»¶ä¸‹ï¼ŒLASSOèƒ½ä»¥æ¦‚ç‡1é€‰æ‹©å‡ºçœŸå®æ¨¡å‹ã€‚\n\n\n6.3.3 æ±‚è§£ç®—æ³•\nåæ ‡ä¸‹é™æ³•ï¼š å¯¹æ¯ä¸ª \\(j\\)ï¼Œå›ºå®šå…¶ä»–ç³»æ•°ï¼Œæ›´æ–°ï¼š \\[\n\\beta_j \\leftarrow S\\left(\\frac{1}{n}\\sum_{i=1}^n x_{ij}(y_i - \\tilde{y}_i^{(j)}), \\lambda\\right)\n\\] å…¶ä¸­ \\(S(z, \\lambda) = \\text{sign}(z)(|z| - \\lambda)_+\\) æ˜¯è½¯é˜ˆå€¼å‡½æ•°ã€‚\nLARSç®—æ³•ï¼š é€šè¿‡åˆ†æ®µçº¿æ€§è·¯å¾„é«˜æ•ˆè®¡ç®—æ•´ä¸ªè§£è·¯å¾„ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>6 æ­£åˆ™åŒ–</span>"
    ]
  },
  {
    "objectID": "chapters/6 æ­£åˆ™åŒ–.html#å¼¹æ€§ç½‘",
    "href": "chapters/6 æ­£åˆ™åŒ–.html#å¼¹æ€§ç½‘",
    "title": "6 æ­£åˆ™åŒ–",
    "section": "6.4 å¼¹æ€§ç½‘",
    "text": "6.4 å¼¹æ€§ç½‘",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>6 æ­£åˆ™åŒ–</span>"
    ]
  },
  {
    "objectID": "chapters/6 æ­£åˆ™åŒ–.html#æ­£åˆ™åŒ–è·¯å¾„æ¯”è¾ƒ",
    "href": "chapters/6 æ­£åˆ™åŒ–.html#æ­£åˆ™åŒ–è·¯å¾„æ¯”è¾ƒ",
    "title": "6 æ­£åˆ™åŒ–",
    "section": "6.5 æ­£åˆ™åŒ–è·¯å¾„æ¯”è¾ƒ",
    "text": "6.5 æ­£åˆ™åŒ–è·¯å¾„æ¯”è¾ƒ\nå¼¹æ€§ç½‘ï¼š ç»“åˆå²­å›å½’å’ŒLASSOçš„ä¼˜ç‚¹ï¼š \\[\n\\hat{\\pmb{\\beta}}_{\\text{enet}} = \\arg\\min_{\\pmb{\\beta}} \\left\\{ \\frac{1}{2n}||\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}||_2^2 + \\lambda[\\alpha||\\pmb{\\beta}||_1 + \\frac{1}{2}(1-\\alpha)||\\pmb{\\beta}||_2^2] \\right\\}\n\\]\næ–¹æ³•æ¯”è¾ƒï¼š\n\n\n\næ–¹æ³•\nå˜é‡é€‰æ‹©\nç»„æ•ˆåº”\né«˜ç»´é€‚ç”¨æ€§\n\n\n\n\nå²­å›å½’\nå¦\næ˜¯\næ˜¯\n\n\nLASSO\næ˜¯\nå¦\næ˜¯\n\n\nå¼¹æ€§ç½‘\næ˜¯\næ˜¯\næ˜¯\n\n\nPCR\nå¦\næ˜¯\næ˜¯\n\n\nPLS\nå¦\næ˜¯\næ˜¯\n\n\n\nè°ƒå‚ç­–ç•¥\nç½‘æ ¼æœç´¢ï¼š åœ¨ \\(\\lambda\\)ï¼ˆå’Œ \\(\\alpha\\)ï¼‰çš„ç½‘æ ¼ä¸Šè®¡ç®—äº¤å‰éªŒè¯è¯¯å·®ã€‚\nä¿¡æ¯å‡†åˆ™ï¼š\n\nAICï¼š\\(AIC = n\\ln(\\hat{\\sigma}^2) + 2k\\)\nBICï¼š\\(BIC = n\\ln(\\hat{\\sigma}^2) + k\\ln(n)\\)\n\nä¸€å€æ ‡å‡†è¯¯å‡†åˆ™ï¼š é€‰æ‹©è°ƒä¼˜å‚æ•°ï¼Œä½¿å¾—äº¤å‰éªŒè¯è¯¯å·®åœ¨æœ€å°è¯¯å·®çš„ä¸€å€æ ‡å‡†è¯¯èŒƒå›´å†…ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>6 æ­£åˆ™åŒ–</span>"
    ]
  },
  {
    "objectID": "chapters/6 æ­£åˆ™åŒ–.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/6 æ­£åˆ™åŒ–.html#æ¡ˆä¾‹åˆ†æ",
    "title": "6 æ­£åˆ™åŒ–",
    "section": "6.6 æ¡ˆä¾‹åˆ†æ",
    "text": "6.6 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>6 æ­£åˆ™åŒ–</span>"
    ]
  },
  {
    "objectID": "chapters/6 æ­£åˆ™åŒ–.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/6 æ­£åˆ™åŒ–.html#æœ¬ç« æ€»ç»“",
    "title": "6 æ­£åˆ™åŒ–",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾\n\nå²­å›å½’ï¼š\\(\\hat{\\pmb{\\beta}}_{\\text{ridge}} = (\\mathbf{X}'\\mathbf{X} + \\lambda\\mathbf{I})^{-1}\\mathbf{X}'\\mathbf{y}\\)\nLASSOï¼š\\(\\hat{\\pmb{\\beta}}_{\\text{lasso}} = \\arg\\min_{\\pmb{\\beta}} \\left\\{ \\frac{1}{2n}||\\mathbf{y} - \\mathbf{X}\\pmb{\\beta}||_2^2 + \\lambda||\\pmb{\\beta}||_1 \\right\\}\\)\nå¼¹æ€§ç½‘ï¼š\\(P_{\\alpha}(\\pmb{\\beta}) = \\alpha||\\pmb{\\beta}||_1 + \\frac{1}{2}(1-\\alpha)||\\pmb{\\beta}||_2^2\\)\n\næ–¹æ³•é€‰æ‹©æŒ‡å—\n\n\n\né—®é¢˜åœºæ™¯\næ¨èæ–¹æ³•\nç†ç”±\n\n\n\n\nå¤šé‡å…±çº¿æ€§ä¸¥é‡\nå²­å›å½’ã€PCR\nç¨³å®šä¼°è®¡ï¼Œé™ä½æ–¹å·®\n\n\nå˜é‡é€‰æ‹©éœ€æ±‚\nLASSOã€å¼¹æ€§ç½‘\nè‡ªåŠ¨ç‰¹å¾é€‰æ‹©\n\n\né¢„æµ‹ç²¾åº¦ä¼˜å…ˆ\nå¼¹æ€§ç½‘ã€PLS\nå¹³è¡¡åå·®ä¸æ–¹å·®\n\n\nå¯è§£é‡Šæ€§é‡è¦\nLASSO\nç¨€ç–è§£ï¼Œæ˜“äºè§£é‡Š\n\n\nè®¡ç®—æ•ˆç‡è¦æ±‚\nåæ ‡ä¸‹é™\né«˜æ•ˆå¤„ç†é«˜ç»´é—®é¢˜\n\n\n\nå®è·µå»ºè®®\n\næ•°æ®é¢„å¤„ç†ï¼šæ ‡å‡†åŒ–è‡ªå˜é‡ï¼Œç¡®ä¿æƒ©ç½šçš„å…¬å¹³æ€§\næ¨¡å‹è¯„ä¼°ï¼šä½¿ç”¨äº¤å‰éªŒè¯ï¼Œé¿å…è¿‡æ‹Ÿåˆ\nç»“æœéªŒè¯ï¼šåœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°é¢„æµ‹æ€§èƒ½\nç¨³å¥æ€§æ£€æŸ¥ï¼šå°è¯•ä¸åŒæ–¹æ³•ï¼Œæ¯”è¾ƒç»“æœä¸€è‡´æ€§\né¢†åŸŸçŸ¥è¯†ï¼šç»“åˆå®é™…é—®é¢˜èƒŒæ™¯é€‰æ‹©åˆé€‚æ–¹æ³•\n\né«˜ç»´æ•°æ®åˆ†ææ˜¯ç°ä»£ç»Ÿè®¡å­¦ä¹ çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚æŒæ¡æ­£åˆ™åŒ–å’Œé™ç»´æŠ€æœ¯ï¼Œèƒ½å¤Ÿå¸®åŠ©æ‚¨åœ¨é¢å¯¹å¤æ‚æ•°æ®æ—¶å»ºç«‹æ›´åŠ ç¨³å¥å’Œå¯è§£é‡Šçš„é¢„æµ‹æ¨¡å‹ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>6 æ­£åˆ™åŒ–</span>"
    ]
  },
  {
    "objectID": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html",
    "href": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html",
    "title": "7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå“åº”å˜é‡å¹¶ä¸æ€»æ˜¯è¿ç»­å‹çš„ã€‚å½“é¢ä¸´åˆ†ç±»é—®é¢˜æˆ–è®¡æ•°æ•°æ®æ—¶ï¼Œä¼ ç»Ÿçº¿æ€§å›å½’æ¨¡å‹çš„å±€é™æ€§å‡¸æ˜¾ã€‚æœ¬ç« å°†ç³»ç»Ÿä»‹ç»å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„ç»Ÿä¸€æ¡†æ¶ï¼Œé‡ç‚¹è®²è§£é€»è¾‘æ–¯è°›å›å½’ã€Probitå›å½’å’Œçº¿æ€§åˆ¤åˆ«åˆ†æç­‰ç»å…¸åˆ†ç±»æ–¹æ³•ï¼Œä¸ºæ‚¨æä¾›å¤„ç†åˆ†ç±»é—®é¢˜çš„å®Œæ•´ç†è®ºä½“ç³»å’Œå®ç”¨å·¥å…·ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#è™šæ‹Ÿå˜é‡",
    "href": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#è™šæ‹Ÿå˜é‡",
    "title": "7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹",
    "section": "7.1 è™šæ‹Ÿå˜é‡",
    "text": "7.1 è™šæ‹Ÿå˜é‡\n\n7.1.1 è™šæ‹Ÿå˜é‡çš„æœ¬è´¨ä¸æ„å»º\nè™šæ‹Ÿå˜é‡ï¼ˆDummy Variablesï¼‰ï¼Œåˆç§°æŒ‡ç¤ºå˜é‡ï¼ˆIndicator Variablesï¼‰ï¼Œæ˜¯å°†åˆ†ç±»è‡ªå˜é‡è½¬åŒ–ä¸ºæ•°å€¼å˜é‡çš„åŸºæœ¬æŠ€æœ¯ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ç”¨äºŒè¿›åˆ¶ç¼–ç è¡¨ç¤ºç±»åˆ«æˆå‘˜èº«ä»½ã€‚\n\n\n7.1.2 è™šæ‹Ÿå˜é‡çš„æ„å»ºåŸåˆ™\nå¯¹äºä¸€ä¸ªå…·æœ‰\\(k\\)ä¸ªç±»åˆ«çš„åˆ†ç±»å˜é‡ï¼Œé€šå¸¸éœ€è¦\\(k-1\\)ä¸ªè™šæ‹Ÿå˜é‡ï¼Œä»¥é¿å…è™šæ‹Ÿå˜é‡é™·é˜±ï¼ˆå®Œå…¨å¤šé‡å…±çº¿æ€§ï¼‰ã€‚è¿™ç§ç¼–ç æ–¹å¼ç§°ä¸ºå‚ç…§ç»„ç¼–ç æˆ–åŸºçº¿ç¼–ç ã€‚\n\\[\nD_1 = \\begin{cases}\n1 & \\text{å¦‚æœè§‚æµ‹å±äºç±»åˆ«1} \\\\\n0 & \\text{å¦åˆ™}\n\\end{cases},\\quad\nD_2 = \\begin{cases}\n1 & \\text{å¦‚æœè§‚æµ‹å±äºç±»åˆ«2} \\\\\n0 & \\text{å¦åˆ™}\n\\end{cases},\\quad\n\\cdots,\\quad\nD_{k-1} = \\begin{cases}\n1 & \\text{å¦‚æœè§‚æµ‹å±äºç±»åˆ«$k-1$} \\\\\n0 & \\text{å¦åˆ™}\n\\end{cases}\n\\]\nç¬¬\\(k\\)ä¸ªç±»åˆ«ä½œä¸ºå‚ç…§ç»„ï¼Œå½“æ‰€æœ‰\\(D_i=0\\)æ—¶è¡¨ç¤ºå±äºå‚ç…§ç»„ã€‚\n\n\n7.1.3 åŒ…å«è™šæ‹Ÿå˜é‡çš„å›å½’æ¨¡å‹\nè€ƒè™‘ä¸€ä¸ªç®€å•çš„å›å½’æ¨¡å‹ï¼ŒåŒ…å«ä¸€ä¸ªè¿ç»­è‡ªå˜é‡\\(X\\)å’Œä¸€ä¸ªå…·æœ‰ä¸‰ä¸ªç±»åˆ«çš„åˆ†ç±»å˜é‡\\(C\\)ï¼š\n\\[\nY = \\beta_0 + \\beta_1 X + \\beta_2 D_1 + \\beta_3 D_2 + \\beta_4 (X \\times D_1) + \\beta_5 (X \\times D_2) + \\varepsilon\n\\]\nå…¶ä¸­ï¼š - \\(\\beta_0\\)ï¼šå‚ç…§ç»„çš„æˆªè· - \\(\\beta_1\\)ï¼šå‚ç…§ç»„ä¸­\\(X\\)å¯¹\\(Y\\)çš„æ•ˆåº” - \\(\\beta_2, \\beta_3\\)ï¼šç±»åˆ«1å’Œç±»åˆ«2ç›¸å¯¹äºå‚ç…§ç»„çš„æˆªè·å·®å¼‚ - \\(\\beta_4, \\beta_5\\)ï¼šç±»åˆ«1å’Œç±»åˆ«2ä¸­\\(X\\)æ•ˆåº”çš„å·®å¼‚ï¼ˆäº¤äº’ä½œç”¨ï¼‰\n\n\n7.1.4 è™šæ‹Ÿå˜é‡çš„ç»Ÿè®¡æ£€éªŒ\n\nå•ä¸ªè™šæ‹Ÿå˜é‡çš„tæ£€éªŒï¼šæ£€éªŒç‰¹å®šç±»åˆ«ä¸å‚ç…§ç»„æ˜¯å¦å­˜åœ¨æ˜¾è‘—å·®å¼‚\nè”åˆFæ£€éªŒï¼šæ£€éªŒæ‰€æœ‰è™šæ‹Ÿå˜é‡ï¼ˆå³æ•´ä¸ªåˆ†ç±»å˜é‡ï¼‰æ˜¯å¦æ˜¾è‘— \\[\nF = \\frac{(SSR_{\\text{å®Œæ•´}} - SSR_{\\text{ç®€åŒ–}})/(k-1)}{SSR_{\\text{å®Œæ•´}}/(n-k-p)}\n\\] å…¶ä¸­\\(p\\)ä¸ºå…¶ä»–è‡ªå˜é‡çš„æ•°é‡\n\nå¤šé¡¹å¼è™šæ‹Ÿå˜é‡\nå¯¹äºæœ‰åºåˆ†ç±»å˜é‡ï¼Œå¯ä»¥æ£€éªŒçº¿æ€§ã€äºŒæ¬¡ç­‰è¶‹åŠ¿ï¼š \\[\nY = \\beta_0 + \\beta_1 X + \\gamma_1 L + \\gamma_2 Q + \\varepsilon\n\\] å…¶ä¸­\\(L\\)å’Œ\\(Q\\)åˆ†åˆ«è¡¨ç¤ºçº¿æ€§é¡¹å’ŒäºŒæ¬¡é¡¹ç¼–ç ã€‚\nè™šæ‹Ÿå˜é‡ä¸ç»“æ„å˜åŒ–æ£€éªŒ\nè™šæ‹Ÿå˜é‡å¯ç”¨äºæ£€éªŒä¸åŒå­æ ·æœ¬ï¼ˆå¦‚ä¸åŒæ—¶æœŸã€ä¸åŒç¾¤ä½“ï¼‰çš„æ¨¡å‹ç»“æ„æ˜¯å¦ç›¸åŒï¼Œè¿™æ˜¯Chowæ£€éªŒçš„åŸºç¡€ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#å¹¿ä¹‰çº¿æ€§æ¨¡å‹ç†è®º",
    "href": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#å¹¿ä¹‰çº¿æ€§æ¨¡å‹ç†è®º",
    "title": "7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹",
    "section": "7.2 å¹¿ä¹‰çº¿æ€§æ¨¡å‹ç†è®º",
    "text": "7.2 å¹¿ä¹‰çº¿æ€§æ¨¡å‹ç†è®º\n\n7.2.1 æŒ‡æ•°æ—åˆ†å¸ƒ\næŒ‡æ•°æ—çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š \\[\nf(y|\\theta,\\phi) = \\exp\\left\\{\\frac{y\\theta - b(\\theta)}{a(\\phi)} + c(y,\\phi)\\right\\}\n\\]\nå…¶ä¸­ï¼š\n\n\\(\\theta\\)ï¼šè‡ªç„¶å‚æ•°ï¼ˆå…¸åˆ™å‚æ•°ï¼‰\n\\(\\phi\\)ï¼šç¦»æ•£å‚æ•°\n\\(a(\\cdot), b(\\cdot), c(\\cdot)\\)å·²çŸ¥å‡½æ•°\n\nå¸¸è§åˆ†å¸ƒçš„æŒ‡æ•°æ—å½¢å¼ï¼š\n\n\n\n\n\n\n\n\n\n\nåˆ†å¸ƒ\n\\(\\theta\\)\n\\(\\phi\\)\n\\(b(\\theta)\\)\n\\(a(\\phi)\\)\n\n\n\n\næ­£æ€\n\\(\\mu\\)\n\\(\\sigma^2\\)\n\\(\\frac{\\theta^2}{2}\\)\n\\(\\phi\\)\n\n\næ³Šæ¾\n\\(\\ln\\mu\\)\n1\n\\(e^\\theta\\)\n1\n\n\näºŒé¡¹\n\\(\\ln\\left(\\frac{\\pi}{1-\\pi}\\right)\\)\n1\n\\(\\ln(1+e^\\theta)\\)\n1\n\n\nGamma\n\\(-\\frac{1}{\\mu}\\)\n\\(\\nu\\)\n\\(-\\ln(-\\theta)\\)\n\\(\\frac{1}{\\nu}\\)\n\n\n\n\n\n7.2.2 GLMçš„ä¸‰ç»„æˆéƒ¨åˆ†\néšæœºæˆåˆ†ï¼š å“åº”å˜é‡ \\(Y\\) æ¥è‡ªæŒ‡æ•°æ—åˆ†å¸ƒï¼š \\[\nY \\sim f(y|\\theta,\\phi)\n\\]\nç³»ç»Ÿæˆåˆ†ï¼š çº¿æ€§é¢„æµ‹å™¨ï¼š \\[\n\\eta = \\beta_0 + \\beta_1X_1 + \\cdots + \\beta_pX_p = \\mathbf{X}\\pmb{\\beta}\n\\]\nè¿æ¥å‡½æ•°ï¼š è¿æ¥éšæœºæˆåˆ†å’Œç³»ç»Ÿæˆåˆ†ï¼š \\[\ng(\\mu) = \\eta\n\\] å…¶ä¸­ \\(\\mu = E(Y) = b'(\\theta)\\)\n\n\n7.2.3 å…¸åˆ™è¿æ¥å‡½æ•°\nå®šä¹‰ï¼š å½“ \\(g(\\mu) = \\theta\\) æ—¶ï¼Œç§°ä¸ºå…¸åˆ™è¿æ¥å‡½æ•°ã€‚\næ€§è´¨ï¼š - ç®€åŒ–è®¡ç®—å’Œç†è®ºæ¨å¯¼ - ä¿è¯ \\(\\mathbf{X}'\\mathbf{y}\\) æ˜¯å……åˆ†ç»Ÿè®¡é‡ - åœ¨å¤šæ•°æƒ…å†µä¸‹å…·æœ‰è‰¯å¥½çš„ç»Ÿè®¡æ€§è´¨",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#é€»è¾‘æ–¯è°›å›å½’",
    "href": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#é€»è¾‘æ–¯è°›å›å½’",
    "title": "7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹",
    "section": "7.3 é€»è¾‘æ–¯è°›å›å½’",
    "text": "7.3 é€»è¾‘æ–¯è°›å›å½’\n\n7.3.1 äºŒé¡¹åˆ†å¸ƒçš„GLMæ¡†æ¶\nä¼¯åŠªåˆ©åˆ†å¸ƒï¼š \\[\nP(Y=1) = \\pi, \\quad P(Y=0) = 1-\\pi\n\\]\nå…¸åˆ™è¿æ¥å‡½æ•°ï¼ˆlogitå‡½æ•°ï¼‰ï¼š \\[\n\\eta = \\ln\\left(\\frac{\\pi}{1-\\pi}\\right) = \\mathbf{X}\\pmb{\\beta}\n\\]\né€†è¿æ¥å‡½æ•°ï¼ˆsigmoidå‡½æ•°ï¼‰ï¼š \\[\n\\pi = \\frac{e^{\\mathbf{X}\\pmb{\\beta}}}{1 + e^{\\mathbf{X}\\pmb{\\beta}}} = \\frac{1}{1 + e^{-\\mathbf{X}\\pmb{\\beta}}}\n\\]\n\n\n7.3.2 å‚æ•°ä¼°è®¡ï¼šæå¤§ä¼¼ç„¶æ³•\nä¼¼ç„¶å‡½æ•°ï¼š \\[\nL(\\pmb{\\beta}) = \\prod_{i=1}^n \\pi_i^{y_i}(1-\\pi_i)^{1-y_i}\n\\]\nå¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š \\[\n\\ell(\\pmb{\\beta}) = \\sum_{i=1}^n \\left[y_i\\ln\\pi_i + (1-y_i)\\ln(1-\\pi_i)\\right]\n\\]\nå¾—åˆ†å‡½æ•°ï¼š \\[\n\\frac{\\partial \\ell}{\\partial \\pmb{\\beta}} = \\sum_{i=1}^n (y_i - \\pi_i)\\mathbf{x}_i = \\mathbf{0}\n\\]\n\n\n7.3.3 è¿­ä»£åŠ æƒæœ€å°äºŒä¹˜ç®—æ³•\næƒé‡çŸ©é˜µï¼š \\[\n\\mathbf{W} = \\text{diag}\\left[\\pi_i(1-\\pi_i)\\right]\n\\]\nå·¥ä½œå“åº”å˜é‡ï¼š \\[\nz_i = \\mathbf{x}_i'\\pmb{\\beta} + \\frac{y_i - \\pi_i}{\\pi_i(1-\\pi_i)}\n\\]\nè¿­ä»£æ›´æ–°ï¼š \\[\n\\pmb{\\beta}^{(t+1)} = (\\mathbf{X}'\\mathbf{W}^{(t)}\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{W}^{(t)}\\mathbf{z}^{(t)}\n\\]\n\n\n7.3.4 ç»Ÿè®¡æ¨æ–­ä¸è§£é‡Š\nä¼˜åŠ¿æ¯”è§£é‡Šï¼š å¯¹äºäºŒå€¼è‡ªå˜é‡ \\(X_j\\)ï¼š \\[\n\\text{OR}_j = e^{\\beta_j} = \\frac{\\pi|X_j=1/(1-\\pi|X_j=1)}{\\pi|X_j=0/(1-\\pi|X_j=0)}\n\\]\nWaldæ£€éªŒï¼š \\[\nz_j = \\frac{\\hat{\\beta}_j}{SE(\\hat{\\beta}_j)} \\sim N(0,1)\n\\]\nä¼¼ç„¶æ¯”æ£€éªŒï¼š \\[\nG = 2[\\ell(\\hat{\\pmb{\\beta}}) - \\ell(\\hat{\\pmb{\\beta}}_0)] \\sim \\chi^2(p-p_0)\n\\]\n\n\n7.3.5 å¤šé¡¹é€»è¾‘æ–¯è°›å›å½’\nåŸºçº¿ç±»åˆ«Logitæ¨¡å‹\nå¯¹äº\\(J\\)ä¸ªç±»åˆ«çš„å“åº”å˜é‡ï¼Œä»¥ç¬¬\\(J\\)ç±»ä¸ºå‚ç…§ï¼š \\[\n\\log\\left(\\frac{P(Y_i=j|\\mathbf{x}_i)}{P(Y_i=J|\\mathbf{x}_i)}\\right) = \\beta_{j0} + \\beta_{j1}x_{i1} + \\cdots + \\beta_{jp}x_{ip}, \\quad j=1,\\ldots,J-1\n\\]\nç±»åˆ«æ¦‚ç‡è®¡ç®—\n\\[\nP(Y_i=j|\\mathbf{x}_i) = \\frac{\\exp(\\eta_{ij})}{1 + \\sum_{m=1}^{J-1} \\exp(\\eta_{im})}, \\quad j=1,\\ldots,J-1\n\\]\n\\[\nP(Y_i=J|\\mathbf{x}_i) = \\frac{1}{1 + \\sum_{m=1}^{J-1} \\exp(\\eta_{im})}\n\\]\nå…¶ä¸­\\(\\eta_{ij} = \\beta_{j0} + \\beta_{j1}x_{i1} + \\cdots + \\beta_{jp}x_{ip}\\)ã€‚\n\n\n7.3.6 æœ‰åºé€»è¾‘æ–¯è°›å›å½’\nå¯¹äºæœ‰åºå“åº”å˜é‡ï¼Œä½¿ç”¨æ¯”ä¾‹ä¼˜åŠ¿æ¨¡å‹ï¼š \\[\n\\log\\left(\\frac{P(Y_i \\leq j|\\mathbf{x}_i)}{P(Y_i &gt; j|\\mathbf{x}_i)}\\right) = \\alpha_j - (\\beta_1 x_{i1} + \\cdots + \\beta_p x_{ip}), \\quad j=1,\\ldots,J-1\n\\]\nå…¶ä¸­\\(\\alpha_1 &lt; \\alpha_2 &lt; \\cdots &lt; \\alpha_{J-1}\\)ä¸ºåˆ‡ç‚¹å‚æ•°ï¼Œè´Ÿå·ä½¿å¾—\\(\\beta\\)çš„æ­£å€¼è¡¨ç¤ºæ›´å¯èƒ½å±äºæ›´é«˜ç±»åˆ«ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#probitå›å½’",
    "href": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#probitå›å½’",
    "title": "7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹",
    "section": "7.4 Probitå›å½’",
    "text": "7.4 Probitå›å½’\n\n7.4.1 Probitæ¨¡å‹è®¾å®š\nProbitè¿æ¥å‡½æ•°ï¼š \\[\n\\Phi^{-1}(\\pi) = \\mathbf{X}\\pmb{\\beta}\n\\]\nå…¶ä¸­ \\(\\Phi(\\cdot)\\) æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ã€‚\næ¦‚ç‡å½¢å¼ï¼š \\[\n\\pi = \\Phi(\\mathbf{X}\\pmb{\\beta})\n\\]\n\n\n7.4.2 æ½œåœ¨å˜é‡è§£é‡Š\næ½œå˜é‡æ¨¡å‹ï¼š å‡è®¾å­˜åœ¨è¿ç»­æ½œå˜é‡ \\(Y^*\\)ï¼š \\[\nY^* = \\mathbf{X}\\pmb{\\beta} + \\varepsilon, \\quad \\varepsilon \\sim N(0,1)\n\\]\nè§‚æµ‹å“åº”ï¼š \\[\nY = \\begin{cases}\n1 & \\text{if } Y^* &gt; 0 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n\\]\næ¦‚ç‡æ¨å¯¼ï¼š \\[\nP(Y=1|\\mathbf{X}) = P(Y^* &gt; 0) = P(\\varepsilon &gt; -\\mathbf{X}\\pmb{\\beta}) = \\Phi(\\mathbf{X}\\pmb{\\beta})\n\\]\n\n\n7.4.3 ä¸Logitæ¨¡å‹çš„æ¯”è¾ƒ\nè¿æ¥å‡½æ•°å½¢çŠ¶ï¼š - Logitï¼š\\(g(p) = \\ln\\left(\\frac{p}{1-p}\\right)\\) - Probitï¼š\\(g(p) = \\Phi^{-1}(p)\\)\nå°¾éƒ¨è¡Œä¸ºï¼š - Logitå‡½æ•°æœ‰æ›´é‡çš„å°¾éƒ¨ - åœ¨å®è·µä¸­ä¸¤è€…é€šå¸¸ç»™å‡ºç›¸ä¼¼çš„ç»“æœ\nç³»æ•°è½¬æ¢ï¼š \\[\n\\beta_{\\text{logit}} \\approx 1.6 \\times \\beta_{\\text{probit}}\n\\]",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#æ¨¡å‹æ¯”è¾ƒä¸é€‰æ‹©",
    "href": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#æ¨¡å‹æ¯”è¾ƒä¸é€‰æ‹©",
    "title": "7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹",
    "section": "7.5 æ¨¡å‹æ¯”è¾ƒä¸é€‰æ‹©",
    "text": "7.5 æ¨¡å‹æ¯”è¾ƒä¸é€‰æ‹©\n\n7.5.1 åˆ†ç±»æ€§èƒ½è¯„ä¼°\næ··æ·†çŸ©é˜µï¼š\n\n\n\n\né¢„æµ‹æ­£ç±»\né¢„æµ‹è´Ÿç±»\n\n\n\n\nå®é™…æ­£ç±»\nTP\nFN\n\n\nå®é™…è´Ÿç±»\nFP\nTN\n\n\n\nå¸¸ç”¨æŒ‡æ ‡ï¼š - å‡†ç¡®ç‡ï¼š\\(\\frac{TP+TN}{n}\\) - ç²¾ç¡®ç‡ï¼š\\(\\frac{TP}{TP+FP}\\) - å¬å›ç‡ï¼š\\(\\frac{TP}{TP+FN}\\) - F1åˆ†æ•°ï¼š\\(\\frac{2\\times\\text{ç²¾ç¡®ç‡}\\times\\text{å¬å›ç‡}}{\\text{ç²¾ç¡®ç‡}+\\text{å¬å›ç‡}}\\)\n\n\n7.5.2 ROCæ›²çº¿ä¸AUC\nROCæ›²çº¿ï¼š ä»¥å‡æ­£ç‡ä¸ºæ¨ªè½´ï¼ŒçœŸæ­£ç‡ä¸ºçºµè½´çš„æ›²çº¿ã€‚\nAUCè§£é‡Šï¼š - AUC = 0.5ï¼šéšæœºçŒœæµ‹ - AUC = 1.0ï¼šå®Œç¾åˆ†ç±» - AUC &gt; 0.8ï¼šé€šå¸¸è®¤ä¸ºæ¨¡å‹è¡¨ç°è‰¯å¥½\n\n\n7.5.3 æ–¹æ³•æ¯”è¾ƒ\n\n\n\n\n\n\n\n\n\n\næ–¹æ³•\nç±»å‹\nå‡è®¾\nä¼˜ç‚¹\nå±€é™æ€§\n\n\n\n\né€»è¾‘å›å½’\nåˆ¤åˆ«å¼\nçº¿æ€§å†³ç­–è¾¹ç•Œ\næ¦‚ç‡è¾“å‡ºï¼Œå¯è§£é‡Šæ€§å¼º\nå¯¹ç‰¹å¾ç›¸å…³æ€§æ•æ„Ÿ\n\n\nProbitå›å½’\nåˆ¤åˆ«å¼\nçº¿æ€§å†³ç­–è¾¹ç•Œ\næœ‰æ½œåœ¨å˜é‡è§£é‡Š\nè®¡ç®—ç¨å¤æ‚\n\n\nLDA\nç”Ÿæˆå¼\næ­£æ€åˆ†å¸ƒï¼Œç­‰åæ–¹å·®\nå°æ ·æœ¬è¡¨ç°å¥½ï¼Œå¤šåˆ†ç±»è‡ªç„¶\nå‡è®¾è¾ƒå¼º\n\n\n\n\n\n7.5.4 æ¨¡å‹è¯Šæ–­\nç¦»ç¾¤å€¼æ£€æµ‹ï¼š - Pearsonæ®‹å·®ï¼š\\(r_i = \\frac{y_i - \\hat{\\pi}_i}{\\sqrt{\\hat{\\pi}_i(1-\\hat{\\pi}_i)}}\\) - Devianceæ®‹å·®ï¼š\\(d_i = \\text{sign}(y_i - \\hat{\\pi}_i)\\sqrt{-2[y_i\\ln\\hat{\\pi}_i + (1-y_i)\\ln(1-\\hat{\\pi}_i)]}\\)\næ‹Ÿåˆä¼˜åº¦æ£€éªŒï¼š - Hosmer-Lemeshowæ£€éªŒ - çš®å°”é€Šå¡æ–¹æ£€éªŒ\nè¿‡åº¦ç¦»æ•£æ£€éªŒï¼š \\[\n\\frac{\\sum_{i=1}^n (y_i - \\hat{\\pi}_i)^2}{\\hat{\\pi}_i(1-\\hat{\\pi}_i)} \\sim \\chi^2(n-p-1)\n\\]",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#æ¡ˆä¾‹åˆ†æ",
    "title": "7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹",
    "section": "7.6 æ¡ˆä¾‹åˆ†æ",
    "text": "7.6 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹.html#æœ¬ç« æ€»ç»“",
    "title": "7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾\n\nGLMè¿æ¥å‡½æ•°ï¼š\\(g(\\mu) = \\mathbf{X}\\pmb{\\beta}\\)\nLogitæ¨¡å‹ï¼š\\(\\ln\\left(\\frac{\\pi}{1-\\pi}\\right) = \\mathbf{X}\\pmb{\\beta}\\)\nProbitæ¨¡å‹ï¼š\\(\\Phi^{-1}(\\pi) = \\mathbf{X}\\pmb{\\beta}\\)\nLDAåˆ¤åˆ«å‡½æ•°ï¼š\\(\\delta_k(\\mathbf{x}) = \\mathbf{x}'\\pmb{\\Sigma}^{-1}\\pmb{\\mu}_k - \\frac{1}{2}\\pmb{\\mu}_k'\\pmb{\\Sigma}^{-1}\\pmb{\\mu}_k + \\ln\\pi_k\\)\nIWLSæ›´æ–°ï¼š\\(\\pmb{\\beta}^{(t+1)} = (\\mathbf{X}'\\mathbf{W}^{(t)}\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{W}^{(t)}\\mathbf{z}^{(t)}\\)\n\næ–¹æ³•é€‰æ‹©æŒ‡å—\n\n\n\né—®é¢˜åœºæ™¯\næ¨èæ–¹æ³•\nç†ç”±\n\n\n\n\néœ€è¦æ¦‚ç‡è¾“å‡º\né€»è¾‘å›å½’ã€Probitå›å½’\nç›´æ¥å»ºæ¨¡æ¡ä»¶æ¦‚ç‡\n\n\nå°æ ·æœ¬é—®é¢˜\nLDA\nå‚æ•°æ›´å°‘ï¼Œä¼°è®¡æ›´ç¨³å®š\n\n\nå¤šåˆ†ç±»é—®é¢˜\nLDAã€å¤šé¡¹é€»è¾‘å›å½’\nå¤©ç„¶å¤„ç†å¤šç±»åˆ«\n\n\nå¯è§£é‡Šæ€§é‡è¦\né€»è¾‘å›å½’\nä¼˜åŠ¿æ¯”æœ‰æ˜ç¡®è§£é‡Š\n\n\nç†è®ºä¸€è‡´æ€§\nProbitå›å½’\næœ‰æ½œåœ¨å˜é‡ç†è®ºåŸºç¡€\n\n\n\nå®è·µå»ºè®®\n\næ•°æ®é¢„å¤„ç†ï¼šæ£€æŸ¥ç±»åˆ«å¹³è¡¡æ€§ï¼Œå¿…è¦æ—¶é‡é‡‡æ ·\nç‰¹å¾å·¥ç¨‹ï¼šè€ƒè™‘äº¤äº’é¡¹å’Œéçº¿æ€§å˜æ¢\næ¨¡å‹éªŒè¯ï¼šä½¿ç”¨äº¤å‰éªŒè¯è¯„ä¼°æ³›åŒ–èƒ½åŠ›\nç»“æœè§£é‡Šï¼šç»“åˆé¢†åŸŸçŸ¥è¯†ç†è§£ç³»æ•°å«ä¹‰\nç¨³å¥æ€§åˆ†æï¼šå°è¯•ä¸åŒæ–¹æ³•ï¼Œæ¯”è¾ƒç»“æœä¸€è‡´æ€§\n\nå¹¿ä¹‰çº¿æ€§æ¨¡å‹ä¸ºå¤„ç†éæ­£æ€å“åº”å˜é‡æä¾›äº†ç»Ÿä¸€çš„æ¡†æ¶ï¼Œè€Œçº¿æ€§åˆ†ç±»æ–¹æ³•åˆ™æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€åŸºç¡€ä¸”é‡è¦çš„å·¥å…·ã€‚æŒæ¡è¿™äº›æ–¹æ³•ä¸ºè¿›ä¸€æ­¥å­¦ä¹ æ›´å¤æ‚çš„éçº¿æ€§æ¨¡å‹å¥ å®šäº†åšå®åŸºç¡€ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>7 å¹¿ä¹‰çº¿æ€§æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html",
    "href": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html",
    "title": "8 çº¿æ€§åˆ†ç±»æ¨¡å‹",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\næŠŠçº¿æ€§åˆ†æè¿›è¡Œæ‰©å±•",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>8 çº¿æ€§åˆ†ç±»æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#çº¿æ€§åˆ¤åˆ«åˆ†æä¸äºŒæ¬¡åˆ¤åˆ«åˆ†æ",
    "href": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#çº¿æ€§åˆ¤åˆ«åˆ†æä¸äºŒæ¬¡åˆ¤åˆ«åˆ†æ",
    "title": "8 çº¿æ€§åˆ†ç±»æ¨¡å‹",
    "section": "8.1 çº¿æ€§åˆ¤åˆ«åˆ†æä¸äºŒæ¬¡åˆ¤åˆ«åˆ†æ",
    "text": "8.1 çº¿æ€§åˆ¤åˆ«åˆ†æä¸äºŒæ¬¡åˆ¤åˆ«åˆ†æ\nåˆ¤åˆ«åˆ†æï¼ˆDiscriminant Analysisï¼‰æ˜¯ä¸€ç§ç»å…¸çš„ç»Ÿè®¡åˆ†ç±»æ–¹æ³•ï¼Œä¸»è¦ç”¨äºè§£å†³åˆ†ç±»é—®é¢˜å’Œé™ç»´é—®é¢˜ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯å¯»æ‰¾èƒ½å¤Ÿæœ€ä½³åŒºåˆ†ä¸åŒç±»åˆ«çš„ç‰¹å¾ç»„åˆã€‚\nå‡è®¾æˆ‘ä»¬æœ‰ï¼š - \\(K\\)ä¸ªç±»åˆ«ï¼š\\(C_1, C_2, \\dots, C_K\\) - \\(p\\)ç»´ç‰¹å¾å‘é‡ï¼š\\(\\mathbf{x} = (x_1, x_2, \\dots, x_p)^\\top\\) - è®­ç»ƒæ•°æ®é›†ï¼š\\(\\{(\\mathbf{x}_i, y_i)\\}_{i=1}^n\\)ï¼Œå…¶ä¸­\\(y_i \\in \\{1, 2, \\dots, K\\}\\)\nåˆ¤åˆ«åˆ†æçš„ç›®æ ‡æ˜¯åŸºäºè´å¶æ–¯å®šç†æ„å»ºåˆ†ç±»è§„åˆ™ï¼š\n\\[\nP(Y=k | \\mathbf{x}) = \\frac{\\pi_k f_k(\\mathbf{x})}{\\sum_{l=1}^K \\pi_l f_l(\\mathbf{x})}\n\\]\nå…¶ä¸­ï¼š - \\(\\pi_k = P(Y=k)\\)ï¼šç±»åˆ«\\(k\\)çš„å…ˆéªŒæ¦‚ç‡ - \\(f_k(\\mathbf{x})\\)ï¼šç±»åˆ«\\(k\\)ä¸­\\(\\mathbf{x}\\)çš„æ¦‚ç‡å¯†åº¦å‡½æ•°\nåŸºæœ¬å‡è®¾\nLDAåŸºäºä»¥ä¸‹å…³é”®å‡è®¾ï¼š\n\nå¤šå…ƒæ­£æ€æ€§ï¼šæ¯ä¸ªç±»åˆ«çš„ç‰¹å¾å‘é‡æœä»å¤šå…ƒæ­£æ€åˆ†å¸ƒ \\[\n\\mathbf{x} | Y=k \\sim N_p(\\pmb{\\mu}_k, \\pmb{\\Sigma})\n\\]\nåŒæ–¹å·®æ€§ï¼šæ‰€æœ‰ç±»åˆ«å…±äº«ç›¸åŒçš„åæ–¹å·®çŸ©é˜µ\\(\\pmb{\\Sigma}\\)\nåæ–¹å·®çŸ©é˜µéå¥‡å¼‚ï¼š\\(\\pmb{\\Sigma}\\)æ˜¯å¯é€†çš„\n\nåˆ¤åˆ«å‡½æ•°æ¨å¯¼\næ ¹æ®å¤šå…ƒæ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š\n\\[\nf_k(\\mathbf{x}) = \\frac{1}{(2\\pi)^{p/2}|\\pmb{\\Sigma}|^{1/2}} \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\pmb{\\mu}_k)^\\top \\pmb{\\Sigma}^{-1} (\\mathbf{x}-\\pmb{\\mu}_k)\\right)\n\\]\nä»£å…¥è´å¶æ–¯å…¬å¼ï¼Œå¿½ç•¥å¸¸æ•°é¡¹ï¼Œå¾—åˆ°åˆ¤åˆ«å‡½æ•°ï¼š\n\\[\n\\begin{aligned}\n\\delta_k(\\mathbf{x}) &= \\log(\\pi_k) + \\log(f_k(\\mathbf{x})) \\\\\n&= \\log(\\pi_k) - \\frac{1}{2}\\pmb{\\mu}_k^\\top \\pmb{\\Sigma}^{-1}\\pmb{\\mu}_k + \\mathbf{x}^\\top \\pmb{\\Sigma}^{-1}\\pmb{\\mu}_k - \\frac{1}{2}\\mathbf{x}^\\top \\pmb{\\Sigma}^{-1}\\mathbf{x}\n\\end{aligned}\n\\]\nç”±äº\\(\\mathbf{x}^\\top \\pmb{\\Sigma}^{-1}\\mathbf{x}\\)ä¸\\(k\\)æ— å…³ï¼Œå¯ä»¥ç®€åŒ–ä¸ºçº¿æ€§åˆ¤åˆ«å‡½æ•°ï¼š\n\\[\n\\delta_k(\\mathbf{x}) = \\mathbf{x}^\\top \\pmb{\\Sigma}^{-1}\\pmb{\\mu}_k - \\frac{1}{2}\\pmb{\\mu}_k^\\top \\pmb{\\Sigma}^{-1}\\pmb{\\mu}_k + \\log(\\pi_k)\n\\]\nåˆ†ç±»è§„åˆ™\nå°†è§‚æµ‹\\(\\mathbf{x}\\)åˆ†é…åˆ°ä½¿åˆ¤åˆ«å‡½æ•°æœ€å¤§çš„ç±»åˆ«ï¼š\n\\[\n\\hat{y}(\\mathbf{x}) = \\arg\\max_{k=1,\\dots,K} \\delta_k(\\mathbf{x})\n\\]\nå†³ç­–è¾¹ç•Œæ˜¯çº¿æ€§çš„ï¼Œå› ä¸ºåˆ¤åˆ«å‡½æ•°æ˜¯\\(\\mathbf{x}\\)çš„çº¿æ€§å‡½æ•°ã€‚\nå‚æ•°ä¼°è®¡\nä»è®­ç»ƒæ•°æ®ä¸­ä¼°è®¡å‚æ•°ï¼š\n\nå…ˆéªŒæ¦‚ç‡ï¼š \\[\n\\hat{\\pi}_k = \\frac{n_k}{n}, \\quad n_k = \\sum_{i=1}^n I(y_i = k)\n\\]\nå‡å€¼å‘é‡ï¼š \\[\n\\hat{\\pmb{\\mu}}_k = \\frac{1}{n_k} \\sum_{i: y_i = k} \\mathbf{x}_i\n\\]\nåæ–¹å·®çŸ©é˜µï¼š \\[\n\\hat{\\pmb{\\Sigma}} = \\frac{1}{n-K} \\sum_{k=1}^K \\sum_{i: y_i = k} (\\mathbf{x}_i - \\hat{\\pmb{\\mu}}_k)(\\mathbf{x}_i - \\hat{\\pmb{\\mu}}_k)^\\top\n\\] è¿™æ˜¯åˆå¹¶åæ–¹å·®çŸ©é˜µï¼ˆpooled covariance matrixï¼‰ã€‚\n\n\n8.1.2 LDAçš„å‡ ä½•è§£é‡Š\né©¬æ°è·ç¦»\nLDAçš„åˆ†ç±»è§„åˆ™ç­‰ä»·äºå°†\\(\\mathbf{x}\\)åˆ†é…åˆ°å…·æœ‰æœ€å°é©¬æ°è·ç¦»ï¼ˆMahalanobis distanceï¼‰çš„ç±»åˆ«ï¼š\n\\[\nD_k^2(\\mathbf{x}) = (\\mathbf{x} - \\pmb{\\mu}_k)^\\top \\pmb{\\Sigma}^{-1} (\\mathbf{x} - \\pmb{\\mu}_k)\n\\]\nè€ƒè™‘å…ˆéªŒæ¦‚ç‡è°ƒæ•´åçš„è·ç¦»ï¼š\n\\[\nD_k^2(\\mathbf{x}) - 2\\log(\\pi_k)\n\\]\né™ç»´è§†è§’\nLDAå¯ä»¥è§†ä¸ºå¯»æ‰¾æœ€ä½³æŠ•å½±æ–¹å‘ä»¥æœ€å¤§åŒ–ç±»é—´æ•£åº¦ä¸ç±»å†…æ•£åº¦çš„æ¯”å€¼ï¼š\n\\[\nJ(\\mathbf{w}) = \\frac{\\mathbf{w}^\\top \\mathbf{S}_B \\mathbf{w}}{\\mathbf{w}^\\top \\mathbf{S}_W \\mathbf{w}}\n\\]\nå…¶ä¸­ï¼š - ç±»é—´æ•£åº¦çŸ©é˜µï¼š\\(\\mathbf{S}_B = \\sum_{k=1}^K n_k (\\pmb{\\mu}_k - \\bar{\\pmb{\\mu}})(\\pmb{\\mu}_k - \\bar{\\pmb{\\mu}})^\\top\\) - ç±»å†…æ•£åº¦çŸ©é˜µï¼š\\(\\mathbf{S}_W = \\sum_{k=1}^K \\sum_{i: y_i = k} (\\mathbf{x}_i - \\pmb{\\mu}_k)(\\mathbf{x}_i - \\pmb{\\mu}_k)^\\top\\) - æ€»ä½“å‡å€¼ï¼š\\(\\bar{\\pmb{\\mu}} = \\frac{1}{n} \\sum_{i=1}^n \\mathbf{x}_i\\)\næœ€ä¼˜æŠ•å½±æ–¹å‘æ˜¯\\(\\mathbf{S}_W^{-1}\\mathbf{S}_B\\)çš„ç‰¹å¾å‘é‡ï¼Œæœ€å¤šæœ‰\\(\\min(p, K-1)\\)ä¸ªæœ‰æ•ˆåˆ¤åˆ«æ–¹å‘ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>8 çº¿æ€§åˆ†ç±»æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#äºŒæ¬¡åˆ¤åˆ«åˆ†æqda",
    "href": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#äºŒæ¬¡åˆ¤åˆ«åˆ†æqda",
    "title": "8 çº¿æ€§åˆ†ç±»æ¨¡å‹",
    "section": "8.2 äºŒæ¬¡åˆ¤åˆ«åˆ†æï¼ˆQDAï¼‰",
    "text": "8.2 äºŒæ¬¡åˆ¤åˆ«åˆ†æï¼ˆQDAï¼‰\nåŸºæœ¬å‡è®¾\nQDAæ”¾å®½äº†LDAçš„åŒæ–¹å·®æ€§å‡è®¾ï¼š\n\nå¤šå…ƒæ­£æ€æ€§ï¼šæ¯ä¸ªç±»åˆ«çš„ç‰¹å¾å‘é‡æœä»å¤šå…ƒæ­£æ€åˆ†å¸ƒ \\[\n\\mathbf{x} | Y=k \\sim N_p(\\pmb{\\mu}_k, \\pmb{\\Sigma}_k)\n\\]\nå¼‚æ–¹å·®æ€§ï¼šæ¯ä¸ªç±»åˆ«æœ‰è‡ªå·±çš„åæ–¹å·®çŸ©é˜µ\\(\\pmb{\\Sigma}_k\\)\n\nåˆ¤åˆ«å‡½æ•°æ¨å¯¼\nå¯¹äºå¤šå…ƒæ­£æ€åˆ†å¸ƒï¼Œç±»åˆ«\\(k\\)çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š\n\\[\nf_k(\\mathbf{x}) = \\frac{1}{(2\\pi)^{p/2}|\\pmb{\\Sigma}_k|^{1/2}} \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\pmb{\\mu}_k)^\\top \\pmb{\\Sigma}_k^{-1} (\\mathbf{x}-\\pmb{\\mu}_k)\\right)\n\\]\nå–å¯¹æ•°å¹¶å¿½ç•¥å¸¸æ•°é¡¹ï¼Œå¾—åˆ°äºŒæ¬¡åˆ¤åˆ«å‡½æ•°ï¼š\n\\[\n\\begin{aligned}\n\\delta_k(\\mathbf{x}) &= \\log(\\pi_k) - \\frac{1}{2}\\log|\\pmb{\\Sigma}_k| \\\\\n&\\quad - \\frac{1}{2}(\\mathbf{x} - \\pmb{\\mu}_k)^\\top \\pmb{\\Sigma}_k^{-1} (\\mathbf{x} - \\pmb{\\mu}_k)\n\\end{aligned}\n\\]\nåˆ†ç±»è§„åˆ™\nåŒæ ·ï¼Œå°†è§‚æµ‹\\(\\mathbf{x}\\)åˆ†é…åˆ°ä½¿åˆ¤åˆ«å‡½æ•°æœ€å¤§çš„ç±»åˆ«ï¼š\n\\[\n\\hat{y}(\\mathbf{x}) = \\arg\\max_{k=1,\\dots,K} \\delta_k(\\mathbf{x})\n\\]\nç”±äºåˆ¤åˆ«å‡½æ•°åŒ…å«\\(\\mathbf{x}\\)çš„äºŒæ¬¡é¡¹ï¼Œå†³ç­–è¾¹ç•Œæ˜¯äºŒæ¬¡æ›²é¢ï¼ˆæ¤­åœ†ã€åŒæ›²çº¿æˆ–æŠ›ç‰©çº¿ï¼‰ã€‚\nå‚æ•°ä¼°è®¡\nä»è®­ç»ƒæ•°æ®ä¸­ä¼°è®¡å‚æ•°ï¼š\n\nå…ˆéªŒæ¦‚ç‡ï¼š \\[\n\\hat{\\pi}_k = \\frac{n_k}{n}\n\\]\nå‡å€¼å‘é‡ï¼š \\[\n\\hat{\\pmb{\\mu}}_k = \\frac{1}{n_k} \\sum_{i: y_i = k} \\mathbf{x}_i\n\\]\nåæ–¹å·®çŸ©é˜µï¼š \\[\n\\hat{\\pmb{\\Sigma}}_k = \\frac{1}{n_k - 1} \\sum_{i: y_i = k} (\\mathbf{x}_i - \\hat{\\pmb{\\mu}}_k)(\\mathbf{x}_i - \\hat{\\pmb{\\mu}}_k)^\\top\n\\]\n\nQDAçš„äºŒæ¬¡é¡¹å±•å¼€\nå°†QDAçš„åˆ¤åˆ«å‡½æ•°å±•å¼€ï¼Œå¯ä»¥æ›´æ¸…æ¥šåœ°çœ‹åˆ°å…¶äºŒæ¬¡æœ¬è´¨ï¼š\n\\[\n\\begin{aligned}\n\\delta_k(\\mathbf{x}) &= \\log(\\pi_k) - \\frac{1}{2}\\log|\\pmb{\\Sigma}_k| - \\frac{1}{2}\\pmb{\\mu}_k^\\top \\pmb{\\Sigma}_k^{-1}\\pmb{\\mu}_k \\\\\n&\\quad + \\mathbf{x}^\\top \\pmb{\\Sigma}_k^{-1}\\pmb{\\mu}_k - \\frac{1}{2}\\mathbf{x}^\\top \\pmb{\\Sigma}_k^{-1}\\mathbf{x}\n\\end{aligned}\n\\]\nä»¤ï¼š - \\(C_k = \\log(\\pi_k) - \\frac{1}{2}\\log|\\pmb{\\Sigma}_k| - \\frac{1}{2}\\pmb{\\mu}_k^\\top \\pmb{\\Sigma}_k^{-1}\\pmb{\\mu}_k\\)ï¼ˆå¸¸æ•°é¡¹ï¼‰ - \\(\\pmb{\\beta}_k = \\pmb{\\Sigma}_k^{-1}\\pmb{\\mu}_k\\)ï¼ˆçº¿æ€§ç³»æ•°ï¼‰ - \\(\\pmb{\\Omega}_k = -\\frac{1}{2}\\pmb{\\Sigma}_k^{-1}\\)ï¼ˆäºŒæ¬¡ç³»æ•°ï¼‰\nåˆ™åˆ¤åˆ«å‡½æ•°å¯å†™ä¸ºï¼š\n\\[\n\\delta_k(\\mathbf{x}) = C_k + \\mathbf{x}^\\top \\pmb{\\beta}_k + \\mathbf{x}^\\top \\pmb{\\Omega}_k \\mathbf{x}\n\\]\n\n\n8.2.2 LDAä¸QDAçš„æ¯”è¾ƒ\nç†è®ºæ¯”è¾ƒ\n\n\n\n\n\n\n\n\nç‰¹æ€§\nLDA\nQDA\n\n\n\n\nåæ–¹å·®çŸ©é˜µ\n\\(\\pmb{\\Sigma}_k = \\pmb{\\Sigma}\\)ï¼ˆç›¸åŒï¼‰\n\\(\\pmb{\\Sigma}_k\\)ï¼ˆä¸åŒï¼‰\n\n\nåˆ¤åˆ«å‡½æ•°\nçº¿æ€§å‡½æ•°\näºŒæ¬¡å‡½æ•°\n\n\nå†³ç­–è¾¹ç•Œ\nçº¿æ€§è¶…å¹³é¢\näºŒæ¬¡æ›²é¢\n\n\nå‚æ•°æ•°é‡\n\\(Kp + p(p+1)/2 + (K-1)\\)\n\\(Kp + K \\cdot p(p+1)/2 + (K-1)\\)\n\n\nå‡è®¾å¼ºåº¦\nè¾ƒå¼º\nè¾ƒå¼±\n\n\n\nå‚æ•°å¤æ‚åº¦åˆ†æ\nLDAçš„å‚æ•°æ•°é‡ï¼š - å‡å€¼å‘é‡ï¼š\\(K \\times p\\)ä¸ªå‚æ•° - åæ–¹å·®çŸ©é˜µï¼š\\(p(p+1)/2\\)ä¸ªå‚æ•° - å…ˆéªŒæ¦‚ç‡ï¼š\\(K-1\\)ä¸ªå‚æ•°ï¼ˆå› ä¸º\\(\\sum_{k=1}^K \\pi_k = 1\\)ï¼‰\næ€»è®¡ï¼š\\(Kp + \\frac{p(p+1)}{2} + (K-1)\\)\nQDAçš„å‚æ•°æ•°é‡ï¼š - å‡å€¼å‘é‡ï¼š\\(K \\times p\\)ä¸ªå‚æ•° - åæ–¹å·®çŸ©é˜µï¼š\\(K \\times p(p+1)/2\\)ä¸ªå‚æ•° - å…ˆéªŒæ¦‚ç‡ï¼š\\(K-1\\)ä¸ªå‚æ•°\næ€»è®¡ï¼š\\(Kp + K \\cdot \\frac{p(p+1)}{2} + (K-1)\\)\nåå·®-æ–¹å·®æƒè¡¡\nLDAçš„ä¼˜åŠ¿ï¼š 1. å‚æ•°æ›´å°‘ï¼Œæ–¹å·®æ›´å° 2. åœ¨æ ·æœ¬é‡è¾ƒå°æ—¶æ›´ç¨³å®š 3. å½“åŒæ–¹å·®æ€§å‡è®¾æˆç«‹æ—¶ï¼Œåˆ†ç±»æ•ˆæœæ›´ä¼˜\nQDAçš„ä¼˜åŠ¿ï¼š 1. æ›´çµæ´»ï¼Œå¯ä»¥æ•æ‰ç±»åˆ«é—´çš„åæ–¹å·®å·®å¼‚ 2. å½“å¼‚æ–¹å·®æ€§æ˜æ˜¾æ—¶ï¼Œåˆ†ç±»ç²¾åº¦æ›´é«˜ 3. å¯¹æ¨¡å‹å‡è®¾çš„ä¾èµ–è¾ƒå°\næ ·æœ¬é‡è¦æ±‚\nQDAéœ€è¦æ›´å¤§çš„æ ·æœ¬é‡æ¥å‡†ç¡®ä¼°è®¡æ¯ä¸ªç±»åˆ«çš„åæ–¹å·®çŸ©é˜µã€‚ç»éªŒæ³•åˆ™ï¼š - LDAï¼šæ¯ä¸ªç±»åˆ«è‡³å°‘éœ€è¦\\(p+1\\)ä¸ªæ ·æœ¬ - QDAï¼šæ¯ä¸ªç±»åˆ«è‡³å°‘éœ€è¦\\(p(p+3)/2 + 1\\)ä¸ªæ ·æœ¬\n\n\n8.2.4 æ­£åˆ™åŒ–åˆ¤åˆ«åˆ†æï¼ˆRDAï¼‰\nRDAçš„åŸºæœ¬æ€æƒ³\nRDAæ˜¯LDAå’ŒQDAçš„æŠ˜ä¸­æ–¹æ¡ˆï¼Œé€šè¿‡æ­£åˆ™åŒ–åæ–¹å·®çŸ©é˜µæ¥å¹³è¡¡åå·®å’Œæ–¹å·®ï¼š\n\\[\n\\hat{\\pmb{\\Sigma}}_k(\\alpha, \\gamma) = \\alpha \\hat{\\pmb{\\Sigma}}_k + (1-\\alpha) \\hat{\\pmb{\\Sigma}}\n\\]\nå…¶ä¸­ï¼š - \\(\\hat{\\pmb{\\Sigma}}_k\\)ï¼šç¬¬\\(k\\)ç±»çš„æ ·æœ¬åæ–¹å·®çŸ©é˜µ - \\(\\hat{\\pmb{\\Sigma}}\\)ï¼šåˆå¹¶åæ–¹å·®çŸ©é˜µ - \\(\\alpha \\in [0, 1]\\)ï¼šæ§åˆ¶ä¸ªä½“åæ–¹å·®ä¸åˆå¹¶åæ–¹å·®çš„æ··åˆæ¯”ä¾‹\nè¿›ä¸€æ­¥è¿›è¡Œç‰¹å¾å€¼æ”¶ç¼©ï¼š\n\\[\n\\hat{\\pmb{\\Sigma}}_k(\\alpha, \\gamma) = \\gamma \\hat{\\pmb{\\Sigma}}_k(\\alpha) + (1-\\gamma) \\frac{\\text{tr}(\\hat{\\pmb{\\Sigma}}_k(\\alpha))}{p} \\mathbf{I}_p\n\\]\nå…¶ä¸­\\(\\gamma \\in [0, 1]\\)æ§åˆ¶æ”¶ç¼©å¼ºåº¦ã€‚\nRDAçš„å‚æ•°é€‰æ‹©\né€šè¿‡äº¤å‰éªŒè¯é€‰æ‹©æœ€ä¼˜çš„\\((\\alpha, \\gamma)\\)ç»„åˆï¼š\n\nåœ¨è®­ç»ƒé›†ä¸Šæ‹Ÿåˆä¸åŒ\\((\\alpha, \\gamma)\\)ç»„åˆçš„RDAæ¨¡å‹\nåœ¨éªŒè¯é›†ä¸Šè¯„ä¼°åˆ†ç±»å‡†ç¡®ç‡\né€‰æ‹©ä½¿éªŒè¯é›†å‡†ç¡®ç‡æœ€é«˜çš„å‚æ•°ç»„åˆ\n\nä¸é€»è¾‘å›å½’çš„æ¯”è¾ƒ\n\n\n\næ–¹é¢\nLDA/QDA\né€»è¾‘å›å½’\n\n\n\n\nå‡è®¾\nç‰¹å¾æœä»å¤šå…ƒæ­£æ€åˆ†å¸ƒ\næ— åˆ†å¸ƒå‡è®¾\n\n\nå»ºæ¨¡å¯¹è±¡\nè”åˆåˆ†å¸ƒ\\(P(X,Y)\\)\næ¡ä»¶åˆ†å¸ƒ\\(P(Y\\|X)\\)\n\n\nå‚æ•°ä¼°è®¡\næœ‰è§£æè§£\nè¿­ä»£æœ€å¤§ä¼¼ç„¶ä¼°è®¡\n\n\næ ·æœ¬æ•ˆç‡\nå½“å‡è®¾æˆç«‹æ—¶æ›´é«˜æ•ˆ\næ›´ç¨³å¥\n\n\nå¤šåˆ†ç±»\nç›´æ¥æ‰©å±•\néœ€è¦å¤šé¡¹é€»è¾‘å›å½’",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>8 çº¿æ€§åˆ†ç±»æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨",
    "href": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨",
    "title": "8 çº¿æ€§åˆ†ç±»æ¨¡å‹",
    "section": "8.3 æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨",
    "text": "8.3 æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨\næœ´ç´ è´å¶æ–¯åŸºæœ¬æ€æƒ³\næœ´ç´ è´å¶æ–¯ï¼ˆNaÃ¯ve Bayesï¼‰æ˜¯ä¸€ç§åŸºäºè´å¶æ–¯å®šç†çš„ç®€å•è€Œé«˜æ•ˆçš„åˆ†ç±»ç®—æ³•ã€‚å…¶â€æœ´ç´ â€ï¼ˆnaÃ¯veï¼‰ä¹‹å¤„åœ¨äºå‡è®¾ç‰¹å¾ä¹‹é—´ç›¸äº’æ¡ä»¶ç‹¬ç«‹ï¼Œå³ç»™å®šç±»åˆ«æ—¶ï¼Œå„ä¸ªç‰¹å¾ä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»ã€‚å°½ç®¡è¿™ä¸€å‡è®¾åœ¨ç°å®ä¸­å¾ˆå°‘å®Œå…¨æˆç«‹ï¼Œä½†æœ´ç´ è´å¶æ–¯åœ¨è®¸å¤šå®é™…åº”ç”¨ä¸­ä»è¡¨ç°å‡ºè‰²ã€‚\nè´å¶æ–¯å®šç†æ˜¯æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨çš„ç†è®ºåŸºç¡€ï¼š\n\\[\nP(Y=k | \\mathbf{x}) = \\frac{P(Y=k) \\cdot P(\\mathbf{x} | Y=k)}{P(\\mathbf{x})}\n\\]\nå…¶ä¸­ï¼š - \\(P(Y=k | \\mathbf{x})\\)ï¼šåéªŒæ¦‚ç‡ï¼ˆç»™å®šç‰¹å¾\\(\\mathbf{x}\\)æ—¶å±äºç±»åˆ«\\(k\\)çš„æ¦‚ç‡ï¼‰ - \\(P(Y=k)\\)ï¼šå…ˆéªŒæ¦‚ç‡ï¼ˆç±»åˆ«\\(k\\)åœ¨è®­ç»ƒé›†ä¸­çš„æ¯”ä¾‹ï¼‰ - \\(P(\\mathbf{x} | Y=k)\\)ï¼šä¼¼ç„¶ï¼ˆç±»åˆ«\\(k\\)ä¸­è§‚å¯Ÿåˆ°ç‰¹å¾\\(\\mathbf{x}\\)çš„æ¦‚ç‡ï¼‰ - \\(P(\\mathbf{x})\\)ï¼šè¯æ®ï¼ˆè¾¹é™…æ¦‚ç‡ï¼Œä½œä¸ºå½’ä¸€åŒ–å¸¸æ•°ï¼‰\næœ´ç´ è´å¶æ–¯å‡è®¾\nå¯¹äº\\(p\\)ç»´ç‰¹å¾å‘é‡\\(\\mathbf{x} = (x_1, x_2, \\dots, x_p)^\\top\\)ï¼Œæœ´ç´ è´å¶æ–¯å‡è®¾ï¼š\n\\[\nP(\\mathbf{x} | Y=k) = P(x_1, x_2, \\dots, x_p | Y=k) = \\prod_{j=1}^p P(x_j | Y=k)\n\\]\nå³ç»™å®šç±»åˆ«\\(k\\)æ—¶ï¼Œå„ä¸ªç‰¹å¾\\(x_1, x_2, \\dots, x_p\\)ç›¸äº’æ¡ä»¶ç‹¬ç«‹ã€‚\nåˆ†ç±»è§„åˆ™\nå°†è§‚æµ‹\\(\\mathbf{x}\\)åˆ†é…åˆ°åéªŒæ¦‚ç‡æœ€å¤§çš„ç±»åˆ«ï¼š\n\\[\n\\hat{y}(\\mathbf{x}) = \\arg\\max_{k=1,\\dots,K} P(Y=k | \\mathbf{x})\n\\]\næ ¹æ®è´å¶æ–¯å®šç†å’Œæœ´ç´ å‡è®¾ï¼š\n\\[\n\\begin{aligned}\n\\hat{y}(\\mathbf{x}) &= \\arg\\max_{k} P(Y=k) \\cdot P(\\mathbf{x} | Y=k) \\\\\n&= \\arg\\max_{k} P(Y=k) \\cdot \\prod_{j=1}^p P(x_j | Y=k)\n\\end{aligned}\n\\]\nç”±äº\\(P(\\mathbf{x})\\)å¯¹æ‰€æœ‰ç±»åˆ«ç›¸åŒï¼Œå¯ä»¥çœç•¥ã€‚\nå¯¹æ•°å½¢å¼\nåœ¨å®é™…è®¡ç®—ä¸­ï¼Œä½¿ç”¨å¯¹æ•°é¿å…æ•°å€¼ä¸‹æº¢ï¼š\n\\[\n\\begin{aligned}\n\\hat{y}(\\mathbf{x}) &= \\arg\\max_{k} \\left[ \\log P(Y=k) + \\sum_{j=1}^p \\log P(x_j | Y=k) \\right]\n\\end{aligned}\n\\]\n\n8.3.2ä¸åŒç‰¹å¾ç±»å‹çš„æ¦‚ç‡ä¼°è®¡\næœ´ç´ è´å¶æ–¯å¯ä»¥æ ¹æ®ç‰¹å¾ç±»å‹é€‰æ‹©ä¸åŒçš„æ¦‚ç‡ä¼°è®¡æ–¹æ³•ã€‚\nåˆ†ç±»ç‰¹å¾ï¼ˆä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯ï¼‰\nå¯¹äºäºŒå€¼ç‰¹å¾æˆ–ç±»åˆ«ç‰¹å¾ï¼Œä½¿ç”¨ä¼¯åŠªåˆ©åˆ†å¸ƒï¼š\n\\[\nP(x_j = v | Y=k) = \\theta_{kjv}\n\\]\nå…¶ä¸­\\(v \\in \\{0, 1\\}\\)æˆ–\\(v \\in \\{1, 2, \\dots, m_j\\}\\)ã€‚\nå‚æ•°ä¼°è®¡\næœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼š\n\\[\n\\hat{\\theta}_{kjv} = \\frac{N_{kjv} + \\alpha}{N_k + \\alpha m_j}\n\\]\nå…¶ä¸­ï¼š - \\(N_{kjv}\\)ï¼šç±»åˆ«\\(k\\)ä¸­ç‰¹å¾\\(j\\)å–å€¼ä¸º\\(v\\)çš„æ ·æœ¬æ•° - \\(N_k\\)ï¼šç±»åˆ«\\(k\\)çš„æ€»æ ·æœ¬æ•° - \\(\\alpha\\)ï¼šå¹³æ»‘å‚æ•°ï¼ˆæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ï¼‰ - \\(m_j\\)ï¼šç‰¹å¾\\(j\\)çš„å¯èƒ½å–å€¼æ•°\næ‹‰æ™®æ‹‰æ–¯å¹³æ»‘\nå½“æŸä¸ªç‰¹å¾å€¼åœ¨è®­ç»ƒé›†ä¸­æœªå‡ºç°æ—¶ï¼Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡ä¸º0ï¼Œå¯¼è‡´æ•´ä¸ªæ¦‚ç‡ä¸º0ã€‚æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ï¼ˆLaplace smoothingï¼‰æˆ–åŠ ä¸€å¹³æ»‘è§£å†³æ­¤é—®é¢˜ï¼š\n\\[\n\\hat{\\theta}_{kjv} = \\frac{N_{kjv} + 1}{N_k + m_j}\n\\]\nè¿™æ˜¯\\(\\alpha=1\\)æ—¶çš„ç‰¹ä¾‹ã€‚\nè¿ç»­ç‰¹å¾ï¼ˆé«˜æ–¯æœ´ç´ è´å¶æ–¯ï¼‰\nå¯¹äºè¿ç»­ç‰¹å¾ï¼Œå‡è®¾æœä»é«˜æ–¯åˆ†å¸ƒï¼š\n\\[\nP(x_j | Y=k) = \\frac{1}{\\sqrt{2\\pi\\sigma_{kj}^2}} \\exp\\left(-\\frac{(x_j - \\mu_{kj})^2}{2\\sigma_{kj}^2}\\right)\n\\]\nå‚æ•°ä¼°è®¡\n\\[\n\\hat{\\mu}_{kj} = \\frac{1}{N_k} \\sum_{i: y_i=k} x_{ij}\n\\]\n\\[\n\\hat{\\sigma}_{kj}^2 = \\frac{1}{N_k} \\sum_{i: y_i=k} (x_{ij} - \\hat{\\mu}_{kj})^2\n\\]\nå¯¹æ•°ä¼¼ç„¶\nå¯¹äºé«˜æ–¯æœ´ç´ è´å¶æ–¯ï¼Œå¯¹æ•°ä¼¼ç„¶ä¸ºï¼š\n\\[\n\\log P(x_j | Y=k) = -\\frac{1}{2} \\log(2\\pi\\sigma_{kj}^2) - \\frac{(x_j - \\mu_{kj})^2}{2\\sigma_{kj}^2}\n\\] ï¼ˆå¤šé¡¹å¼æœ´ç´ è´å¶æ–¯ï¼‰\nå¯¹äºè¡¨ç¤ºé¢‘æ¬¡æˆ–è®¡æ•°çš„ç‰¹å¾ï¼Œä½¿ç”¨å¤šé¡¹å¼åˆ†å¸ƒï¼š\n\\[\nP(\\mathbf{x} | Y=k) = \\frac{(\\sum_{j=1}^p x_j)!}{\\prod_{j=1}^p x_j!} \\prod_{j=1}^p \\theta_{kj}^{x_j}\n\\]\nå‚æ•°ä¼°è®¡\n\\[\n\\hat{\\theta}_{kj} = \\frac{N_{kj} + \\alpha}{\\sum_{j=1}^p N_{kj} + \\alpha p}\n\\]\nå…¶ä¸­\\(N_{kj} = \\sum_{i: y_i=k} x_{ij}\\)æ˜¯ç±»åˆ«\\(k\\)ä¸­ç‰¹å¾\\(j\\)çš„æ€»è®¡æ•°ã€‚\næ··åˆç‰¹å¾ç±»å‹\nå½“æ•°æ®åŒ…å«ä¸åŒç±»å‹ç‰¹å¾æ—¶ï¼Œå¯ä»¥ç»„åˆä¸åŒåˆ†å¸ƒï¼š\n\\[\nP(\\mathbf{x} | Y=k) = \\prod_{j \\in C} P_{\\text{cat}}(x_j | Y=k) \\cdot \\prod_{j \\in R} P_{\\text{cont}}(x_j | Y=k) \\cdot \\prod_{j \\in N} P_{\\text{count}}(x_j | Y=k)\n\\]\nå…¶ä¸­\\(C\\)ã€\\(R\\)ã€\\(N\\)åˆ†åˆ«è¡¨ç¤ºåˆ†ç±»ã€è¿ç»­ã€è®¡æ•°ç‰¹å¾çš„ç´¢å¼•é›†ã€‚\n\n\n\n8.3.3 ç®—æ³•å®ç°\nè®­ç»ƒé˜¶æ®µ\nè¾“å…¥ï¼šè®­ç»ƒé›†\\(D = \\{(\\mathbf{x}_i, y_i)\\}_{i=1}^n\\)ï¼Œå…¶ä¸­\\(\\mathbf{x}_i \\in \\mathbb{R}^p\\)ï¼Œ\\(y_i \\in \\{1, 2, \\dots, K\\}\\)\næ­¥éª¤ï¼š 1. ä¼°è®¡å…ˆéªŒæ¦‚ç‡ï¼š\\(\\hat{\\pi}_k = \\frac{N_k + \\alpha}{n + \\alpha K}\\) 2. å¯¹äºæ¯ä¸ªç±»åˆ«\\(k\\)å’Œæ¯ä¸ªç‰¹å¾\\(j\\)ï¼š - å¦‚æœç‰¹å¾\\(j\\)æ˜¯åˆ†ç±»çš„ï¼šä¼°è®¡\\(\\hat{\\theta}_{kjv}\\)å¯¹äºæ‰€æœ‰\\(v\\) - å¦‚æœç‰¹å¾\\(j\\)æ˜¯è¿ç»­çš„ï¼šä¼°è®¡\\(\\hat{\\mu}_{kj}\\)å’Œ\\(\\hat{\\sigma}_{kj}^2\\) - å¦‚æœç‰¹å¾\\(j\\)æ˜¯è®¡æ•°çš„ï¼šä¼°è®¡\\(\\hat{\\theta}_{kj}\\)\nè¾“å‡ºï¼šæ‰€æœ‰ä¼°è®¡å‚æ•°\né¢„æµ‹é˜¶æ®µ\nè¾“å…¥ï¼šæ–°æ ·æœ¬\\(\\mathbf{x}^* = (x_1^*, x_2^*, \\dots, x_p^*)\\)ï¼Œè®­ç»ƒå¾—åˆ°çš„å‚æ•°\næ­¥éª¤ï¼š 1. å¯¹äºæ¯ä¸ªç±»åˆ«\\(k=1,\\dots,K\\)ï¼š \\[\n   \\text{score}_k = \\log \\hat{\\pi}_k + \\sum_{j=1}^p \\log P(x_j^* | Y=k; \\hat{\\theta}_{kj})\n   \\] 2. é¢„æµ‹ç±»åˆ«ï¼š\\(\\hat{y} = \\arg\\max_k \\text{score}_k\\) 3. ï¼ˆå¯é€‰ï¼‰è®¡ç®—åéªŒæ¦‚ç‡ï¼š \\[\n   P(Y=k | \\mathbf{x}^*) = \\frac{\\exp(\\text{score}_k)}{\\sum_{l=1}^K \\exp(\\text{score}_l)}\n   \\]\nè¾“å‡ºï¼šé¢„æµ‹ç±»åˆ«\\(\\hat{y}\\)å’ŒåéªŒæ¦‚ç‡\n\n\n8.3.4 ä¸åˆ¤åˆ«åˆ†æçš„æ¯”è¾ƒ\nä¸LDA/QDAçš„å…³ç³»\næœ´ç´ è´å¶æ–¯ä¸åˆ¤åˆ«åˆ†æéƒ½åŸºäºè´å¶æ–¯å®šç†ï¼Œä½†æœ‰é‡è¦åŒºåˆ«ï¼š\n\n\n\næ–¹é¢\næœ´ç´ è´å¶æ–¯\nLDA/QDA\n\n\n\n\nç‰¹å¾ç‹¬ç«‹æ€§\næ¡ä»¶ç‹¬ç«‹å‡è®¾\nè€ƒè™‘ç‰¹å¾ç›¸å…³æ€§\n\n\nåˆ†å¸ƒå‡è®¾\nå¯çµæ´»é€‰æ‹©\nå¿…é¡»å¤šå…ƒæ­£æ€\n\n\nå‚æ•°æ•°é‡\n\\(O(Kp)\\)\nLDA: \\(O(p^2)\\), QDA: \\(O(Kp^2)\\)\n\n\nå†³ç­–è¾¹ç•Œ\nå¯èƒ½æ˜¯éçº¿æ€§\nLDAçº¿æ€§ï¼ŒQDAäºŒæ¬¡\n\n\n\nç­‰ä»·æ€§æ¡ä»¶\nå½“ä»¥ä¸‹æ¡ä»¶æˆç«‹æ—¶ï¼Œé«˜æ–¯æœ´ç´ è´å¶æ–¯ç­‰ä»·äºLDAï¼š 1. æ‰€æœ‰ç‰¹å¾æœä»å¤šå…ƒæ­£æ€åˆ†å¸ƒ 2. ç‰¹å¾æ¡ä»¶ç‹¬ç«‹ï¼ˆåæ–¹å·®çŸ©é˜µä¸ºå¯¹è§’çŸ©é˜µï¼‰ 3. å„ç±»åˆ«çš„å¯¹è§’åæ–¹å·®çŸ©é˜µç›¸ç­‰\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ´ç´ è´å¶æ–¯çš„å†³ç­–è¾¹ç•Œä¹Ÿæ˜¯çº¿æ€§çš„ã€‚\nåå·®-æ–¹å·®æƒè¡¡\næœ´ç´ è´å¶æ–¯å¼•å…¥æ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼š - å¢åŠ åå·®ï¼šå½“ç‰¹å¾ç›¸å…³æ—¶ï¼Œæ¨¡å‹å‡è®¾é”™è¯¯ - å‡å°‘æ–¹å·®ï¼šå‚æ•°æ›´å°‘ï¼Œä¼°è®¡æ›´ç¨³å®š\nåœ¨é«˜ç»´å°æ ·æœ¬æƒ…å†µä¸‹ï¼Œæœ´ç´ è´å¶æ–¯é€šå¸¸ä¼˜äºæ›´å¤æ‚çš„æ¨¡å‹ã€‚\næ¨¡å‹å˜ä½“\nä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯\né€‚ç”¨äºäºŒå€¼ç‰¹å¾ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»ä¸­çš„è¯è¢‹æ¨¡å‹ï¼ˆå‡ºç°/ä¸å‡ºç°ï¼‰ã€‚\næ¦‚ç‡æ¨¡å‹ï¼š \\[\nP(x_j | Y=k) = \\theta_{kj}^{x_j} (1-\\theta_{kj})^{1-x_j}\n\\]\nå¤šé¡¹å¼æœ´ç´ è´å¶æ–¯\né€‚ç”¨äºè®¡æ•°æ•°æ®ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»ä¸­çš„è¯é¢‘ã€‚\næ¦‚ç‡æ¨¡å‹ï¼š \\[\nP(\\mathbf{x} | Y=k) = \\frac{(\\sum_j x_j)!}{\\prod_j x_j!} \\prod_j \\theta_{kj}^{x_j}\n\\]\né«˜æ–¯æœ´ç´ è´å¶æ–¯\né€‚ç”¨äºè¿ç»­ç‰¹å¾ï¼Œå‡è®¾æ­£æ€åˆ†å¸ƒã€‚\nè¡¥å……æœ´ç´ è´å¶æ–¯\nå¤„ç†ä¸å¹³è¡¡æ•°æ®ï¼Œè°ƒæ•´å…ˆéªŒæ¦‚ç‡ï¼š\n\\[\n\\pi_k^{\\text{complement}} = \\frac{\\sum_{i \\notin \\text{class } k} \\sum_j x_{ij}}{\\text{æ€»è®¡æ•°}}\n\\]\nè´å¶æ–¯ä¿¡å¿µç½‘ç»œ\næ”¾å®½æ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼Œå…è®¸éƒ¨åˆ†ç‰¹å¾ç›¸å…³ï¼š\n\\[\nP(\\mathbf{x} | Y=k) = \\prod_{j=1}^p P(x_j | \\text{Pa}(x_j), Y=k)\n\\]\nå…¶ä¸­\\(\\text{Pa}(x_j)\\)æ˜¯\\(x_j\\)çš„çˆ¶èŠ‚ç‚¹é›†åˆã€‚\n\nå‚æ•°ä¼°è®¡ä¸æ­£åˆ™åŒ–\næœ€å¤§ä¼¼ç„¶ä¼°è®¡\nå¯¹äºå‚æ•°\\(\\theta\\)ï¼Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡ä¸ºï¼š\n\\[\n\\hat{\\theta}_{\\text{MLE}} = \\arg\\max_{\\theta} \\prod_{i=1}^n P(\\mathbf{x}_i, y_i | \\theta)\n\\]\næœ€å¤§åéªŒä¼°è®¡\nè€ƒè™‘å‚æ•°å…ˆéªŒï¼Œæœ€å¤§åéªŒä¼°è®¡ï¼š\n\\[\n\\hat{\\theta}_{\\text{MAP}} = \\arg\\max_{\\theta} P(\\theta) \\prod_{i=1}^n P(\\mathbf{x}_i, y_i | \\theta)\n\\]\nå…±è½­å…ˆéªŒ\n\n\n\nåˆ†å¸ƒ\nå…±è½­å…ˆéªŒ\nåéªŒåˆ†å¸ƒ\n\n\n\n\nä¼¯åŠªåˆ©\nBetaåˆ†å¸ƒ\nBetaåˆ†å¸ƒ\n\n\nå¤šé¡¹å¼\nDirichletåˆ†å¸ƒ\nDirichletåˆ†å¸ƒ\n\n\né«˜æ–¯ï¼ˆå·²çŸ¥æ–¹å·®ï¼‰\né«˜æ–¯åˆ†å¸ƒ\né«˜æ–¯åˆ†å¸ƒ\n\n\né«˜æ–¯ï¼ˆå·²çŸ¥å‡å€¼ï¼‰\nGammaåˆ†å¸ƒ\nGammaåˆ†å¸ƒ\n\n\n\nç»éªŒè´å¶æ–¯\nä»æ•°æ®ä¸­ä¼°è®¡å…ˆéªŒåˆ†å¸ƒçš„è¶…å‚æ•°ï¼š\n\\[\n\\hat{\\alpha} = \\arg\\max_{\\alpha} \\int P(D | \\theta) P(\\theta | \\alpha) d\\theta\n\\]\nå®é™…åº”ç”¨\næ–‡æœ¬åˆ†ç±»\næœ´ç´ è´å¶æ–¯æ˜¯æ–‡æœ¬åˆ†ç±»çš„ç»å…¸ç®—æ³•ï¼Œå¦‚ï¼š - åƒåœ¾é‚®ä»¶æ£€æµ‹ - æƒ…æ„Ÿåˆ†æ - æ–°é—»åˆ†ç±»\nç‰¹å¾å·¥ç¨‹ï¼š - è¯è¢‹æ¨¡å‹ï¼ˆBag-of-Wordsï¼‰ - TF-IDFåŠ æƒ - N-gramç‰¹å¾\næ¨èç³»ç»Ÿ\nåŸºäºå†…å®¹çš„æ¨èï¼š \\[\nP(\\text{å–œæ¬¢} | \\text{ç‰©å“ç‰¹å¾}) \\propto P(\\text{å–œæ¬¢}) \\prod_j P(\\text{ç‰¹å¾}_j | \\text{å–œæ¬¢})\n\\]\nåŒ»å­¦è¯Šæ–­\nåŸºäºç—‡çŠ¶é¢„æµ‹ç–¾ç—…ï¼š \\[\nP(\\text{ç–¾ç—…} | \\text{ç—‡çŠ¶}) \\propto P(\\text{ç–¾ç—…}) \\prod_j P(\\text{ç—‡çŠ¶}_j | \\text{ç–¾ç—…})\n\\]\nå¼‚å¸¸æ£€æµ‹\nå»ºæ¨¡æ­£å¸¸è¡Œä¸ºï¼Œæ£€æµ‹ä½æ¦‚ç‡äº‹ä»¶ï¼š \\[\nP(\\mathbf{x}) = \\sum_{k=1}^K P(Y=k) \\prod_{j=1}^p P(x_j | Y=k)\n\\] å°†\\(P(\\mathbf{x}) &lt; \\tau\\)çš„æ ·æœ¬æ ‡è®°ä¸ºå¼‚å¸¸ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>8 çº¿æ€§åˆ†ç±»æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#æ¨¡å‹æ¯”è¾ƒä¸é€‰æ‹©",
    "href": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#æ¨¡å‹æ¯”è¾ƒä¸é€‰æ‹©",
    "title": "8 çº¿æ€§åˆ†ç±»æ¨¡å‹",
    "section": "8.5 æ¨¡å‹æ¯”è¾ƒä¸é€‰æ‹©",
    "text": "8.5 æ¨¡å‹æ¯”è¾ƒä¸é€‰æ‹©\n\n8.5.1 åˆ†ç±»æ€§èƒ½è¯„ä¼°\næ··æ·†çŸ©é˜µï¼š\n\n\n\n\né¢„æµ‹æ­£ç±»\né¢„æµ‹è´Ÿç±»\n\n\n\n\nå®é™…æ­£ç±»\nTP\nFN\n\n\nå®é™…è´Ÿç±»\nFP\nTN\n\n\n\nå¸¸ç”¨æŒ‡æ ‡ï¼š - å‡†ç¡®ç‡ï¼š\\(\\frac{TP+TN}{n}\\) - ç²¾ç¡®ç‡ï¼š\\(\\frac{TP}{TP+FP}\\) - å¬å›ç‡ï¼š\\(\\frac{TP}{TP+FN}\\) - F1åˆ†æ•°ï¼š\\(\\frac{2\\times\\text{ç²¾ç¡®ç‡}\\times\\text{å¬å›ç‡}}{\\text{ç²¾ç¡®ç‡}+\\text{å¬å›ç‡}}\\)\n\n\n8.5.2 ROCæ›²çº¿ä¸AUC\nROCæ›²çº¿ï¼š ä»¥å‡æ­£ç‡ä¸ºæ¨ªè½´ï¼ŒçœŸæ­£ç‡ä¸ºçºµè½´çš„æ›²çº¿ã€‚\nAUCè§£é‡Šï¼š - AUC = 0.5ï¼šéšæœºçŒœæµ‹ - AUC = 1.0ï¼šå®Œç¾åˆ†ç±» - AUC &gt; 0.8ï¼šé€šå¸¸è®¤ä¸ºæ¨¡å‹è¡¨ç°è‰¯å¥½\n\n\n8.5.3 æ–¹æ³•æ¯”è¾ƒ\n\n\n\n\n\n\n\n\n\n\næ–¹æ³•\nç±»å‹\nå‡è®¾\nä¼˜ç‚¹\nå±€é™æ€§\n\n\n\n\né€»è¾‘å›å½’\nåˆ¤åˆ«å¼\nçº¿æ€§å†³ç­–è¾¹ç•Œ\næ¦‚ç‡è¾“å‡ºï¼Œå¯è§£é‡Šæ€§å¼º\nå¯¹ç‰¹å¾ç›¸å…³æ€§æ•æ„Ÿ\n\n\nProbitå›å½’\nåˆ¤åˆ«å¼\nçº¿æ€§å†³ç­–è¾¹ç•Œ\næœ‰æ½œåœ¨å˜é‡è§£é‡Š\nè®¡ç®—ç¨å¤æ‚\n\n\nLDA\nç”Ÿæˆå¼\næ­£æ€åˆ†å¸ƒï¼Œç­‰åæ–¹å·®\nå°æ ·æœ¬è¡¨ç°å¥½ï¼Œå¤šåˆ†ç±»è‡ªç„¶\nå‡è®¾è¾ƒå¼º\n\n\n\n\n\n8.5.4 æ¨¡å‹è¯Šæ–­\nç¦»ç¾¤å€¼æ£€æµ‹ï¼š - Pearsonæ®‹å·®ï¼š\\(r_i = \\frac{y_i - \\hat{\\pi}_i}{\\sqrt{\\hat{\\pi}_i(1-\\hat{\\pi}_i)}}\\) - Devianceæ®‹å·®ï¼š\\(d_i = \\text{sign}(y_i - \\hat{\\pi}_i)\\sqrt{-2[y_i\\ln\\hat{\\pi}_i + (1-y_i)\\ln(1-\\hat{\\pi}_i)]}\\)\næ‹Ÿåˆä¼˜åº¦æ£€éªŒï¼š - Hosmer-Lemeshowæ£€éªŒ - çš®å°”é€Šå¡æ–¹æ£€éªŒ\nè¿‡åº¦ç¦»æ•£æ£€éªŒï¼š \\[\n\\frac{\\sum_{i=1}^n (y_i - \\hat{\\pi}_i)^2}{\\hat{\\pi}_i(1-\\hat{\\pi}_i)} \\sim \\chi^2(n-p-1)\n\\]",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>8 çº¿æ€§åˆ†ç±»æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#æ¡ˆä¾‹åˆ†æ",
    "title": "8 çº¿æ€§åˆ†ç±»æ¨¡å‹",
    "section": "8.6 æ¡ˆä¾‹åˆ†æ",
    "text": "8.6 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>8 çº¿æ€§åˆ†ç±»æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/8 çº¿æ€§åˆ†ç±»æ¨¡å‹.html#æœ¬ç« æ€»ç»“",
    "title": "8 çº¿æ€§åˆ†ç±»æ¨¡å‹",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾\n\nGLMè¿æ¥å‡½æ•°ï¼š\\(g(\\mu) = \\mathbf{X}\\pmb{\\beta}\\)\nLogitæ¨¡å‹ï¼š\\(\\ln\\left(\\frac{\\pi}{1-\\pi}\\right) = \\mathbf{X}\\pmb{\\beta}\\)\nProbitæ¨¡å‹ï¼š\\(\\Phi^{-1}(\\pi) = \\mathbf{X}\\pmb{\\beta}\\)\nLDAåˆ¤åˆ«å‡½æ•°ï¼š\\(\\delta_k(\\mathbf{x}) = \\mathbf{x}'\\pmb{\\Sigma}^{-1}\\pmb{\\mu}_k - \\frac{1}{2}\\pmb{\\mu}_k'\\pmb{\\Sigma}^{-1}\\pmb{\\mu}_k + \\ln\\pi_k\\)\nIWLSæ›´æ–°ï¼š\\(\\pmb{\\beta}^{(t+1)} = (\\mathbf{X}'\\mathbf{W}^{(t)}\\mathbf{X})^{-1}\\mathbf{X}'\\mathbf{W}^{(t)}\\mathbf{z}^{(t)}\\)\n\næ–¹æ³•é€‰æ‹©æŒ‡å—\n\n\n\né—®é¢˜åœºæ™¯\næ¨èæ–¹æ³•\nç†ç”±\n\n\n\n\néœ€è¦æ¦‚ç‡è¾“å‡º\né€»è¾‘å›å½’ã€Probitå›å½’\nç›´æ¥å»ºæ¨¡æ¡ä»¶æ¦‚ç‡\n\n\nå°æ ·æœ¬é—®é¢˜\nLDA\nå‚æ•°æ›´å°‘ï¼Œä¼°è®¡æ›´ç¨³å®š\n\n\nå¤šåˆ†ç±»é—®é¢˜\nLDAã€å¤šé¡¹é€»è¾‘å›å½’\nå¤©ç„¶å¤„ç†å¤šç±»åˆ«\n\n\nå¯è§£é‡Šæ€§é‡è¦\né€»è¾‘å›å½’\nä¼˜åŠ¿æ¯”æœ‰æ˜ç¡®è§£é‡Š\n\n\nç†è®ºä¸€è‡´æ€§\nProbitå›å½’\næœ‰æ½œåœ¨å˜é‡ç†è®ºåŸºç¡€\n\n\n\nå®è·µå»ºè®®\n\næ•°æ®é¢„å¤„ç†ï¼šæ£€æŸ¥ç±»åˆ«å¹³è¡¡æ€§ï¼Œå¿…è¦æ—¶é‡é‡‡æ ·\nç‰¹å¾å·¥ç¨‹ï¼šè€ƒè™‘äº¤äº’é¡¹å’Œéçº¿æ€§å˜æ¢\næ¨¡å‹éªŒè¯ï¼šä½¿ç”¨äº¤å‰éªŒè¯è¯„ä¼°æ³›åŒ–èƒ½åŠ›\nç»“æœè§£é‡Šï¼šç»“åˆé¢†åŸŸçŸ¥è¯†ç†è§£ç³»æ•°å«ä¹‰\nç¨³å¥æ€§åˆ†æï¼šå°è¯•ä¸åŒæ–¹æ³•ï¼Œæ¯”è¾ƒç»“æœä¸€è‡´æ€§\n\nå¹¿ä¹‰çº¿æ€§æ¨¡å‹ä¸ºå¤„ç†éæ­£æ€å“åº”å˜é‡æä¾›äº†ç»Ÿä¸€çš„æ¡†æ¶ï¼Œè€Œçº¿æ€§åˆ†ç±»æ–¹æ³•åˆ™æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€åŸºç¡€ä¸”é‡è¦çš„å·¥å…·ã€‚æŒæ¡è¿™äº›æ–¹æ³•ä¸ºè¿›ä¸€æ­¥å­¦ä¹ æ›´å¤æ‚çš„éçº¿æ€§æ¨¡å‹å¥ å®šäº†åšå®åŸºç¡€ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>8 çº¿æ€§åˆ†ç±»æ¨¡å‹</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\nåœ¨å®é™…ç§‘å­¦ç ”ç©¶ä¸æ•°æ®åˆ†æä¸­ï¼Œå˜é‡é—´çš„å…³ç³»å¾€å¾€å¹¶éç®€å•çš„ç›´çº¿å½¢å¼ã€‚ç»æµå¢é•¿çš„Så‹è½¨è¿¹ã€è¯ç‰©ååº”çš„å‰‚é‡-æ•ˆåº”æ›²çº¿ã€æ¸©åº¦å¯¹åŒ–å­¦ååº”çš„åŠ é€Ÿæ•ˆåº”â€”â€”è¿™äº›ç°è±¡éƒ½æ­ç¤ºäº†ä¸€ä¸ªåŸºæœ¬äº‹å®ï¼šç°å®ä¸–ç•Œçš„å…³ç³»æœ¬è´¨ä¸Šæ˜¯éçº¿æ€§çš„ã€‚çº¿æ€§å›å½’æ¨¡å‹è™½ç„¶ç®€æ´ä¼˜é›…ï¼Œä½†å½“å®ƒé¢å¯¹è¿™äº›å¤æ‚çš„æ›²çº¿å…³ç³»æ—¶ï¼Œä¾¿ä¼šæ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚\næœ¬ç« å°†å¸¦é¢†è¯»è€…ä»çº¿æ€§å›å½’çš„èˆ’é€‚åŒºèµ°å‘éçº¿æ€§æ¨¡å‹çš„å¹¿é˜”å¤©åœ°ã€‚æˆ‘ä»¬å°†é¦–å…ˆè®¤è¯†åˆ°çº¿æ€§æ¨¡å‹çš„å±€é™æ€§ï¼Œç„¶åç³»ç»Ÿå­¦ä¹ å››ç§ä¸»æµçš„éçº¿æ€§å»ºæ¨¡æ–¹æ³•ï¼šå¯çº¿æ€§åŒ–çš„å˜æ¢æ¨¡å‹ã€çµæ´»çš„å¤šé¡¹å¼å›å½’ã€é«˜ç»´çš„å¤šå…ƒéçº¿æ€§æ¨¡å‹ï¼Œä»¥åŠå¹³æ»‘çµæ´»çš„æ ·æ¡å›å½’ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰å…¶ç‹¬ç‰¹çš„æ•°å­¦åŸç†ã€é€‚ç”¨åœºæ™¯å’Œè§£é‡Šæ–¹å¼ã€‚\nç‰¹åˆ«å€¼å¾—å…³æ³¨çš„æ˜¯ï¼Œéçº¿æ€§æ¨¡å‹çš„å‚æ•°ä¼°è®¡ä¸å†æœ‰é—­åˆè§£ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©æ•°å€¼ä¼˜åŒ–æ–¹æ³•ã€‚æœ¬ç« å°†æ·±å…¥æµ…å‡ºåœ°ä»‹ç»éçº¿æ€§æœ€å°äºŒä¹˜æ³•å’Œæ¢¯åº¦ä¸‹é™æ³•çš„åŸç†ä¸å®ç°é€»è¾‘ï¼Œå¸®åŠ©è¯»è€…ç†è§£è®¡ç®—æœºæ˜¯å¦‚ä½•â€å­¦ä¹ â€è¿™äº›å¤æ‚æ¨¡å‹å‚æ•°çš„ã€‚\né€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œè¯»è€…å°†æŒæ¡ä»è¯†åˆ«éçº¿æ€§æ¨¡å¼ã€é€‰æ‹©åˆé€‚æ¨¡å‹ã€ä¼°è®¡æ¨¡å‹å‚æ•°åˆ°è§£é‡Šæ¨¡å‹ç»“æœçš„å…¨æµç¨‹èƒ½åŠ›ã€‚éçº¿æ€§å›å½’ä¸ä»…æ˜¯ç»Ÿè®¡æ–¹æ³•çš„æ‰©å±•ï¼Œæ›´æ˜¯è®¤è¯†å¤æ‚ä¸–ç•Œçš„æœ‰åŠ›å·¥å…·ã€‚è®©æˆ‘ä»¬å¼€å§‹è¿™æ®µæ¢ç´¢æ›²çº¿å…³ç³»çš„æ—…ç¨‹ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#éçº¿æ€§çš„å®šä¹‰",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#éçº¿æ€§çš„å®šä¹‰",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "9.1 éçº¿æ€§çš„å®šä¹‰",
    "text": "9.1 éçº¿æ€§çš„å®šä¹‰\nçº¿æ€§å›å½’æ¨¡å‹å‡è®¾å› å˜é‡ä¸è‡ªå˜é‡ä¹‹é—´çš„å…³ç³»æ˜¯çº¿æ€§çš„ï¼š \\[\nY = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p + \\varepsilon\n\\]\nç„¶è€Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œè®¸å¤šå…³ç³»æœ¬è´¨ä¸Šæ˜¯éçº¿æ€§çš„ï¼š - ç»æµå¢é•¿çš„Så‹æ›²çº¿ - è¯ç‰©æµ“åº¦ä¸ååº”çš„é¥±å’Œæ›²çº¿ - æ¸©åº¦ä¸åŒ–å­¦ååº”é€Ÿç‡çš„æŒ‡æ•°å…³ç³»\nå®šä¹‰ï¼šéçº¿æ€§å›å½’æ¨¡å‹æ˜¯æŒ‡å‚æ•°ç›¸å¯¹äºè‡ªå˜é‡æ˜¯éçº¿æ€§çš„æ¨¡å‹ï¼š \\[\nY = f(\\mathbf{X}, \\pmb{\\beta}) + \\varepsilon\n\\] å…¶ä¸­ \\(f\\) æ˜¯å…³äºå‚æ•° \\(\\pmb{\\beta}\\) çš„éçº¿æ€§å‡½æ•°ã€‚\néçº¿æ€§æ¨¡å‹çš„åˆ†ç±»\n\n\n\n\n\n\n\n\nç±»å‹\nç‰¹ç‚¹\nç¤ºä¾‹\n\n\n\n\nå¯çº¿æ€§åŒ–æ¨¡å‹\né€šè¿‡å˜æ¢å¯è½¬ä¸ºçº¿æ€§æ¨¡å‹\n\\(Y = \\beta_0 e^{\\beta_1 X}\\)\n\n\næœ¬è´¨éçº¿æ€§æ¨¡å‹\næ— æ³•é€šè¿‡å˜æ¢çº¿æ€§åŒ–\n\\(Y = \\beta_0 + e^{\\beta_1 X}\\)\n\n\nåˆ†æ®µå›å½’æ¨¡å‹\nä¸åŒåŒºé—´ç”¨ä¸åŒæ¨¡å‹\næ ·æ¡å›å½’ã€é˜ˆå€¼æ¨¡å‹",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#å¯çº¿æ€§åŒ–çš„éçº¿æ€§æ¨¡å‹",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#å¯çº¿æ€§åŒ–çš„éçº¿æ€§æ¨¡å‹",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "9.2 å¯çº¿æ€§åŒ–çš„éçº¿æ€§æ¨¡å‹",
    "text": "9.2 å¯çº¿æ€§åŒ–çš„éçº¿æ€§æ¨¡å‹\næŒ‡æ•°æ¨¡å‹\næ¨¡å‹å½¢å¼ï¼š \\[\nY = \\beta_0 e^{\\beta_1 X} \\varepsilon\n\\] å…¶ä¸­ \\(\\varepsilon\\) ä¸ºä¹˜æ³•è¯¯å·®é¡¹ï¼Œé€šå¸¸å‡è®¾ \\(\\ln \\varepsilon \\sim N(0, \\sigma^2)\\)ã€‚\nçº¿æ€§åŒ–æ–¹æ³•ï¼šå–è‡ªç„¶å¯¹æ•° \\[\n\\ln Y = \\ln \\beta_0 + \\beta_1 X + \\ln \\varepsilon\n\\] ä»¤ \\(Y' = \\ln Y\\)ï¼Œ\\(\\beta_0' = \\ln \\beta_0\\)ï¼Œ\\(\\varepsilon' = \\ln \\varepsilon\\)ï¼Œå¾—ï¼š \\[\nY' = \\beta_0' + \\beta_1 X + \\varepsilon'\n\\]\nå¹‚å‡½æ•°æ¨¡å‹\næ¨¡å‹å½¢å¼ï¼š \\[\nY = \\beta_0 X^{\\beta_1} \\varepsilon\n\\]\nçº¿æ€§åŒ–æ–¹æ³•ï¼šä¸¤è¾¹å–å¯¹æ•° \\[\n\\ln Y = \\ln \\beta_0 + \\beta_1 \\ln X + \\ln \\varepsilon\n\\] ä»¤ \\(Y' = \\ln Y\\)ï¼Œ\\(X' = \\ln X\\)ï¼Œ\\(\\beta_0' = \\ln \\beta_0\\)ï¼Œå¾—ï¼š \\[\nY' = \\beta_0' + \\beta_1 X' + \\varepsilon'\n\\]\nå¯¹æ•°æ¨¡å‹\næ¨¡å‹å½¢å¼ï¼š \\[\nY = \\beta_0 + \\beta_1 \\ln X + \\varepsilon\n\\]\nè¯¥æ¨¡å‹ç›´æ¥æ˜¯çº¿æ€§çš„å½¢å¼ï¼Œåªéœ€å¯¹è‡ªå˜é‡è¿›è¡Œå¯¹æ•°å˜æ¢ã€‚\nåŒæ›²çº¿æ¨¡å‹\næ¨¡å‹å½¢å¼ï¼š \\[\n\\frac{1}{Y} = \\beta_0 + \\beta_1 \\frac{1}{X} + \\varepsilon\n\\]\nä»¤ \\(Y' = 1/Y\\)ï¼Œ\\(X' = 1/X\\)ï¼Œå¾—çº¿æ€§å½¢å¼ï¼š \\[\nY' = \\beta_0 + \\beta_1 X' + \\varepsilon\n\\]\nå¯çº¿æ€§åŒ–æ–¹æ³•çš„å±€é™\n\nè¯¯å·®ç»“æ„çš„æ”¹å˜ï¼šå˜æ¢å¯èƒ½æ”¹å˜è¯¯å·®é¡¹çš„åˆ†å¸ƒå‡è®¾\nå¯è§£é‡Šæ€§ï¼šå˜æ¢åå‚æ•°çš„è§£é‡Šä¸åŸå§‹æ¨¡å‹ä¸åŒ\né¢„æµ‹çš„é€†å˜æ¢åå€šï¼šå¯¹å˜æ¢åçš„é¢„æµ‹å€¼è¿›è¡Œé€†å˜æ¢å¯èƒ½äº§ç”Ÿç³»ç»Ÿåå€š",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#å¤šé¡¹å¼å›å½’",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#å¤šé¡¹å¼å›å½’",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "9.3 å¤šé¡¹å¼å›å½’",
    "text": "9.3 å¤šé¡¹å¼å›å½’\n\n9.3.1 ä¸€å…ƒå¤šé¡¹å¼å›å½’\næ¨¡å‹å½¢å¼ï¼š \\[\nY = \\beta_0 + \\beta_1 X + \\beta_2 X^2 + \\cdots + \\beta_p X^p + \\varepsilon\n\\]\nçŸ©é˜µå½¢å¼ï¼š \\[\n\\mathbf{Y} = \\mathbf{X}\\pmb{\\beta} + \\pmb{\\varepsilon}\n\\] å…¶ä¸­è®¾è®¡çŸ©é˜µ \\(\\mathbf{X} = [\\mathbf{1}, \\mathbf{X}, \\mathbf{X}^2, \\cdots, \\mathbf{X}^p]\\)ã€‚\næ­£äº¤å¤šé¡¹å¼ï¼šä¸ºå‡å°‘å¤šé‡å…±çº¿æ€§ï¼Œå¯ä½¿ç”¨æ­£äº¤å¤šé¡¹å¼ï¼š \\[\nY = \\alpha_0 + \\alpha_1 \\phi_1(X) + \\alpha_2 \\phi_2(X) + \\cdots + \\alpha_p \\phi_p(X) + \\varepsilon\n\\] å…¶ä¸­ \\(\\phi_j(X)\\) æ˜¯ \\(j\\) æ¬¡æ­£äº¤å¤šé¡¹å¼ã€‚\né˜¶æ•°é€‰æ‹©\n\né€æ­¥å›å½’æ³•ï¼šå‘å‰é€‰æ‹©ã€å‘ååˆ é™¤\nä¿¡æ¯å‡†åˆ™ï¼šAICã€BIC \\[\n\\text{AIC} = n\\ln(\\text{RSS}/n) + 2(p+1)\n\\] \\[\n\\text{BIC} = n\\ln(\\text{RSS}/n) + (p+1)\\ln n\n\\]\näº¤å‰éªŒè¯ï¼škæŠ˜äº¤å‰éªŒè¯çš„å‡æ–¹è¯¯å·®æœ€å°åŒ–\n\n\n\n9.3.2 å¤šå…ƒå¤šé¡¹å¼å›å½’\näºŒæ¬¡æ¨¡å‹ï¼ˆå«äº¤äº’é¡¹ï¼‰ï¼š \\[\nY = \\beta_0 + \\sum_{i=1}^k \\beta_i X_i + \\sum_{i=1}^k \\sum_{j \\geq i}^k \\beta_{ij} X_i X_j + \\varepsilon\n\\]\nå®Œæ•´äºŒæ¬¡æ¨¡å‹ï¼š \\[\nY = \\beta_0 + \\sum_{i=1}^k \\beta_i X_i + \\sum_{i=1}^k \\beta_{ii} X_i^2 + \\sum_{i=1}^{k-1} \\sum_{j=i+1}^k \\beta_{ij} X_i X_j + \\varepsilon\n\\]\nå¤šé¡¹å¼å›å½’çš„æ³¨æ„äº‹é¡¹\nè¿‡æ‹Ÿåˆé£é™©ï¼šé«˜é˜¶å¤šé¡¹å¼å¯èƒ½è¿‡åº¦æ‹Ÿåˆå™ªå£° å¤–æ¨ä¸å¯é ï¼šå¤šé¡¹å¼åœ¨å¤–æ¨æ—¶å¯èƒ½äº§ç”Ÿä¸åˆç†é¢„æµ‹ å¤šé‡å…±çº¿æ€§ï¼šé«˜æ¬¡é¡¹ä¹‹é—´é«˜åº¦ç›¸å…³",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#æ ·æ¡å›å½’",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#æ ·æ¡å›å½’",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "9.4 æ ·æ¡å›å½’",
    "text": "9.4 æ ·æ¡å›å½’\n\n9.4.1 åˆ†æ®µå¤šé¡¹å¼å›å½’\nå°†å®šä¹‰åŸŸåˆ’åˆ†ä¸º \\(K+1\\) ä¸ªåŒºé—´ï¼Œæ¯ä¸ªåŒºé—´ä½¿ç”¨ä¸åŒçš„å¤šé¡¹å¼ï¼š \\[\nf(X) =\n\\begin{cases}\n\\beta_{00} + \\beta_{10}X + \\cdots + \\beta_{p0}X^p & \\text{if } X \\leq \\xi_1 \\\\\n\\beta_{01} + \\beta_{11}X + \\cdots + \\beta_{p1}X^p & \\text{if } \\xi_1 &lt; X \\leq \\xi_2 \\\\\n\\vdots & \\vdots \\\\\n\\beta_{0K} + \\beta_{1K}X + \\cdots + \\beta_{pK}X^p & \\text{if } X &gt; \\xi_K\n\\end{cases}\n\\] å…¶ä¸­ \\(\\xi_1, \\xi_2, \\ldots, \\xi_K\\) ä¸ºèŠ‚ç‚¹ã€‚\n\n\n9.4.2 å›å½’æ ·æ¡\nä¸ºä¿è¯åˆ†æ®µå¤šé¡¹å¼åœ¨èŠ‚ç‚¹å¤„å…‰æ»‘ï¼Œæ·»åŠ è¿ç»­æ€§çº¦æŸã€‚\\(m\\) æ¬¡æ ·æ¡è¦æ±‚åœ¨èŠ‚ç‚¹å¤„å‡½æ•°å€¼åŠå‰ \\(m-1\\) é˜¶å¯¼æ•°è¿ç»­ã€‚\nä¸‰æ¬¡æ ·æ¡ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼šåœ¨æ¯ä¸ªåŒºé—´å†…ä¸ºä¸‰æ¬¡å¤šé¡¹å¼ï¼Œåœ¨èŠ‚ç‚¹å¤„å‡½æ•°å€¼ã€ä¸€é˜¶å¯¼æ•°ã€äºŒé˜¶å¯¼æ•°è¿ç»­ã€‚\nåŸºå‡½æ•°è¡¨ç¤ºï¼šä¸‰æ¬¡æ ·æ¡å¯è¡¨ç¤ºä¸ºï¼š \\[\nf(X) = \\beta_0 + \\beta_1 X + \\beta_2 X^2 + \\beta_3 X^3 + \\sum_{k=1}^K \\theta_k (X - \\xi_k)_+^3\n\\] å…¶ä¸­ \\((X - \\xi_k)_+^3 = \\max(0, X - \\xi_k)^3\\)ã€‚\n\n\n9.4.3 è‡ªç„¶æ ·æ¡\nåœ¨è¾¹ç•ŒèŠ‚ç‚¹å¤–æ·»åŠ çº¿æ€§çº¦æŸï¼Œä½¿å‡½æ•°åœ¨è¾¹ç•ŒåŒºåŸŸæ›´ç¨³å®šï¼š \\[\nf''(X) = 0 \\quad \\text{å½“ } X \\leq \\xi_1 \\text{ æˆ– } X \\geq \\xi_K\n\\]\n\n\n9.4.4 å…‰æ»‘æ ·æ¡\né€šè¿‡æƒ©ç½šå¤æ‚åº¦æ¥å¯»æ‰¾æœ€ä¼˜æ‹Ÿåˆå‡½æ•°ï¼š \\[\n\\min_f \\left\\{ \\sum_{i=1}^n [Y_i - f(X_i)]^2 + \\lambda \\int [f''(t)]^2 dt \\right\\}\n\\] å…¶ä¸­ \\(\\lambda\\) ä¸ºå…‰æ»‘å‚æ•°ï¼Œæ§åˆ¶æ‹Ÿåˆä¼˜åº¦ä¸å…‰æ»‘åº¦çš„æƒè¡¡ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#éçº¿æ€§å›å½’çš„ä¼°è®¡æ–¹æ³•",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#éçº¿æ€§å›å½’çš„ä¼°è®¡æ–¹æ³•",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "9.5 éçº¿æ€§å›å½’çš„ä¼°è®¡æ–¹æ³•",
    "text": "9.5 éçº¿æ€§å›å½’çš„ä¼°è®¡æ–¹æ³•\n\n9.5.1 éçº¿æ€§æœ€å°äºŒä¹˜æ³•\nç›®æ ‡å‡½æ•°ï¼š \\[\n\\min_{\\pmb{\\beta}} S(\\pmb{\\beta}) = \\sum_{i=1}^n [Y_i - f(\\mathbf{X}_i, \\pmb{\\beta})]^2\n\\]\né«˜æ–¯-ç‰›é¡¿æ³•ï¼šè¿­ä»£æ±‚è§£ï¼Œåœ¨æ¯æ¬¡è¿­ä»£å¤„å¯¹ \\(f\\) è¿›è¡Œä¸€é˜¶æ³°å‹’å±•å¼€ï¼š \\[\nf(\\mathbf{X}_i, \\pmb{\\beta}) \\approx f(\\mathbf{X}_i, \\pmb{\\beta}^{(t)}) + \\mathbf{J}_i(\\pmb{\\beta}^{(t)})(\\pmb{\\beta} - \\pmb{\\beta}^{(t)})\n\\] å…¶ä¸­ \\(\\mathbf{J}_i(\\pmb{\\beta}) = \\frac{\\partial f(\\mathbf{X}_i, \\pmb{\\beta})}{\\partial \\pmb{\\beta}}\\) ä¸ºé›…å¯æ¯”çŸ©é˜µã€‚\nè¿­ä»£æ›´æ–°å…¬å¼ï¼š \\[\n\\pmb{\\beta}^{(t+1)} = \\pmb{\\beta}^{(t)} + (\\mathbf{J}^\\top \\mathbf{J})^{-1} \\mathbf{J}^\\top (\\mathbf{Y} - \\mathbf{f}(\\pmb{\\beta}^{(t)}))\n\\]\n\n\n9.5.2 æ¢¯åº¦ä¸‹é™æ³•\nåŸºæœ¬æ€æƒ³ï¼šæ²¿ç›®æ ‡å‡½æ•°æ¢¯åº¦åæ–¹å‘è¿­ä»£æ›´æ–°å‚æ•°ã€‚\næ›´æ–°å…¬å¼ï¼š \\[\n\\pmb{\\beta}^{(t+1)} = \\pmb{\\beta}^{(t)} - \\eta \\nabla S(\\pmb{\\beta}^{(t)})\n\\] å…¶ä¸­ \\(\\eta\\) ä¸ºå­¦ä¹ ç‡ï¼Œ\\(\\nabla S(\\pmb{\\beta})\\) ä¸ºæ¢¯åº¦å‘é‡ã€‚\næ¢¯åº¦è®¡ç®—ï¼š \\[\n\\frac{\\partial S}{\\partial \\beta_j} = -2 \\sum_{i=1}^n [Y_i - f(\\mathbf{X}_i, \\pmb{\\beta})] \\frac{\\partial f(\\mathbf{X}_i, \\pmb{\\beta})}{\\partial \\beta_j}\n\\]\nå˜ä½“ï¼š æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼šä½¿ç”¨å…¨éƒ¨æ ·æœ¬è®¡ç®—æ¢¯åº¦ éšæœºæ¢¯åº¦ä¸‹é™ï¼šæ¯æ¬¡éšæœºä½¿ç”¨ä¸€ä¸ªæ ·æœ¬ å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼šæ¯æ¬¡ä½¿ç”¨ä¸€å°æ‰¹æ ·æœ¬\n\n\n9.5.3 ç‰›é¡¿æ³•ä¸æ‹Ÿç‰›é¡¿æ³•\nç‰›é¡¿æ³•ï¼š \\[\n\\pmb{\\beta}^{(t+1)} = \\pmb{\\beta}^{(t)} - \\mathbf{H}^{-1}(\\pmb{\\beta}^{(t)}) \\nabla S(\\pmb{\\beta}^{(t)})\n\\] å…¶ä¸­ \\(\\mathbf{H}\\) ä¸ºæµ·æ£®çŸ©é˜µï¼ˆäºŒé˜¶å¯¼æ•°çŸ©é˜µï¼‰ã€‚\næ‹Ÿç‰›é¡¿æ³•ï¼ˆBFGSï¼‰ï¼šç”¨è¿‘ä¼¼çŸ©é˜µä»£æ›¿æµ·æ£®çŸ©é˜µï¼Œå‡å°‘è®¡ç®—é‡ã€‚\n\n\n9.5.4 å‚æ•°åˆå§‹å€¼ä¸æ”¶æ•›å‡†åˆ™\nåˆå§‹å€¼é€‰æ‹©ï¼š 1. åŸºäºç‰©ç†æ„ä¹‰æˆ–å…ˆéªŒçŸ¥è¯† 2. ç½‘æ ¼æœç´¢æ³• 3. çº¿æ€§åŒ–æ¨¡å‹çš„ä¼°è®¡å€¼\næ”¶æ•›å‡†åˆ™ï¼š 1. å‚æ•°å˜åŒ–é‡ï¼š\\(\\|\\pmb{\\beta}^{(t+1)} - \\pmb{\\beta}^{(t)}\\| &lt; \\epsilon\\) 2. ç›®æ ‡å‡½æ•°å˜åŒ–é‡ï¼š\\(|S(\\pmb{\\beta}^{(t+1)}) - S(\\pmb{\\beta}^{(t)})| &lt; \\epsilon\\) 3. æ¢¯åº¦èŒƒæ•°ï¼š\\(\\|\\nabla S(\\pmb{\\beta}^{(t)})\\| &lt; \\epsilon\\)",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#æ¨¡å‹æ¯”è¾ƒä¸è¯Šæ–­",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#æ¨¡å‹æ¯”è¾ƒä¸è¯Šæ–­",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "9.6 æ¨¡å‹æ¯”è¾ƒä¸è¯Šæ–­",
    "text": "9.6 æ¨¡å‹æ¯”è¾ƒä¸è¯Šæ–­\n\n9.6.1 æ‹Ÿåˆä¼˜åº¦åº¦é‡\næ®‹å·®å¹³æ–¹å’Œï¼š \\[\n\\text{RSS} = \\sum_{i=1}^n [Y_i - \\hat{f}(\\mathbf{X}_i)]^2\n\\]\nè°ƒæ•´åRÂ²ï¼š \\[\nR^2_{\\text{adj}} = 1 - \\frac{\\text{RSS}/(n-p)}{\\text{TSS}/(n-1)}\n\\]\nä¿¡æ¯å‡†åˆ™ï¼š \\[\n\\text{AIC} = n\\ln(\\text{RSS}/n) + 2p\n\\] \\[\n\\text{BIC} = n\\ln(\\text{RSS}/n) + p\\ln n\n\\]\n\n\n9.6.2 æ®‹å·®åˆ†æ\næ ‡å‡†åŒ–æ®‹å·®ï¼š \\[\nr_i = \\frac{Y_i - \\hat{f}(\\mathbf{X}_i)}{\\hat{\\sigma}}\n\\]\nè¯Šæ–­å›¾å½¢ï¼š\n\næ®‹å·®ä¸æ‹Ÿåˆå€¼å›¾ï¼šæ£€æŸ¥æ–¹å·®é½æ€§\næ®‹å·®ä¸è‡ªå˜é‡å›¾ï¼šæ£€æŸ¥æ¨¡å‹è®¾å®š\næ­£æ€Q-Qå›¾ï¼šæ£€æŸ¥æ­£æ€æ€§å‡è®¾",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#å˜é‡å˜æ¢æ–¹æ³•",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#å˜é‡å˜æ¢æ–¹æ³•",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "9.7 å˜é‡å˜æ¢æ–¹æ³•",
    "text": "9.7 å˜é‡å˜æ¢æ–¹æ³•\n\n9.7.1 Box-Coxå˜æ¢\nBox-Coxå˜æ¢é€šè¿‡å¯¹å“åº”å˜é‡è¿›è¡Œå¹‚å˜æ¢ï¼Œä½¿å…¶æ›´æ¥è¿‘æ­£æ€åˆ†å¸ƒå¹¶ç¨³å®šæ–¹å·®ã€‚\nå˜æ¢æ—å®šä¹‰ï¼š \\[\ny^{(\\lambda)} = \\begin{cases}\n\\dfrac{y^\\lambda - 1}{\\lambda} & \\lambda \\neq 0 \\\\\n\\ln y & \\lambda = 0\n\\end{cases}\n\\]\nå‚æ•°é€‰æ‹©ï¼š é€šè¿‡æœ€å¤§åŒ–è½®å»“ä¼¼ç„¶å‡½æ•°é€‰æ‹© \\(\\lambda\\)ï¼š \\[\nL_{\\text{max}}(\\lambda) = -\\frac{n}{2} \\ln(RSS(\\lambda)/n) + (\\lambda-1)\\sum_{i=1}^n \\ln y_i\n\\]\n\n\n9.7.2 å…¶ä»–å¸¸ç”¨å˜æ¢\nå¯¹æ•°å˜æ¢ï¼š é€‚ç”¨äºå³ååˆ†å¸ƒå’Œæ–¹å·®éšå‡å€¼å¢å¤§çš„æƒ…å†µï¼š \\[\ny^* = \\ln(y)\n\\]\nå¹³æ–¹æ ¹å˜æ¢ï¼š é€‚ç”¨äºæ³Šæ¾åˆ†å¸ƒçš„è®¡æ•°æ•°æ®ï¼š \\[\ny^* = \\sqrt{y}\n\\]\né€»è¾‘å˜æ¢ï¼š é€‚ç”¨äºæ¯”ä¾‹æ•°æ®ï¼š \\[\ny^* = \\ln\\left(\\frac{y}{1-y}\\right)\n\\]",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#æ¡ˆä¾‹åˆ†æ",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "9.8 æ¡ˆä¾‹åˆ†æ",
    "text": "9.8 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’.html#æœ¬ç« æ€»ç»“",
    "title": "9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\néçº¿æ€§å›å½’åˆ†æä¸ºæˆ‘ä»¬æ‰“å¼€äº†è®¤è¯†å¤æ‚ä¸–ç•Œå…³ç³»çš„æ–°çª—å£ã€‚é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡äº†ä»ç®€å•å˜æ¢æ¨¡å‹åˆ°å¤æ‚æ ·æ¡å›å½’çš„å®Œæ•´æ–¹æ³•ä½“ç³»ï¼Œç†è§£äº†å¦‚ä½•æ ¹æ®æ•°æ®ç‰¹å¾å’Œé—®é¢˜èƒŒæ™¯é€‰æ‹©é€‚å½“çš„éçº¿æ€§æ¨¡å‹ã€‚\né¦–å…ˆï¼Œå¯¹äºå¯ä»¥é€šè¿‡æ•°å­¦å˜æ¢çº¿æ€§åŒ–çš„æ¨¡å‹ï¼ˆå¦‚æŒ‡æ•°ã€å¹‚å‡½æ•°ã€å¯¹æ•°æ¨¡å‹ï¼‰ï¼Œæˆ‘ä»¬è·å¾—äº†ç®€æ´çš„è§£å†³æ–¹æ¡ˆã€‚è¿™ç±»æ–¹æ³•è™½ç„¶å®ç”¨ï¼Œä½†éœ€è¦è­¦æƒ•å˜æ¢å¯¹è¯¯å·®ç»“æ„å’Œå‚æ•°è§£é‡Šçš„å½±å“ã€‚\nå¤šé¡¹å¼å›å½’ä»¥å…¶æ•°å­¦ç®€æ´æ€§å’Œé«˜åº¦çµæ´»æ€§æˆä¸ºéçº¿æ€§å»ºæ¨¡çš„åŸºç¡€å·¥å…·ã€‚é€šè¿‡æ§åˆ¶å¤šé¡¹å¼é˜¶æ•°å’Œä½¿ç”¨æ­£äº¤å¤šé¡¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ‹Ÿåˆèƒ½åŠ›ä¸æ¨¡å‹ç®€æ´æ€§ä¹‹é—´å–å¾—å¹³è¡¡ã€‚å¤šå…ƒå¤šé¡¹å¼å›å½’è¿›ä¸€æ­¥æ‰©å±•äº†è¿™ä¸€æ€æƒ³ï¼Œèƒ½å¤Ÿæ•æ‰å˜é‡é—´çš„äº¤äº’æ•ˆåº”å’Œæ›²é¢å…³ç³»ã€‚\næ ·æ¡å›å½’ä»£è¡¨äº†éçº¿æ€§å»ºæ¨¡çš„è‰ºæœ¯é«˜åº¦ã€‚é€šè¿‡åˆ†æ®µå¤šé¡¹å¼å’Œå…‰æ»‘æ€§çº¦æŸï¼Œæ ·æ¡æ¨¡å‹æ—¢èƒ½æ•æ‰å±€éƒ¨ç‰¹å¾ï¼Œåˆèƒ½ä¿è¯æ•´ä½“å…‰æ»‘ï¼Œç‰¹åˆ«é€‚ç”¨äºæ²¡æœ‰æ˜ç¡®å‡½æ•°å½¢å¼ä½†éœ€è¦çµæ´»æ‹Ÿåˆçš„æƒ…å½¢ã€‚è‡ªç„¶æ ·æ¡å’Œå…‰æ»‘æ ·æ¡æ›´æ˜¯æä¾›äº†è¾¹ç•Œç¨³å®šæ€§å’Œè‡ªåŠ¨å…‰æ»‘å‚æ•°é€‰æ‹©çš„ä¼˜é›…è§£å†³æ–¹æ¡ˆã€‚\nåœ¨ä¼°è®¡æ–¹æ³•å±‚é¢ï¼Œæˆ‘ä»¬è®¤è¯†åˆ°éçº¿æ€§æ¨¡å‹å‚æ•°ä¼°è®¡çš„æœ¬è´¨æ˜¯æ•°å€¼ä¼˜åŒ–é—®é¢˜ã€‚éçº¿æ€§æœ€å°äºŒä¹˜æ³•ã€æ¢¯åº¦ä¸‹é™æ³•åŠå…¶å˜ä½“æ„æˆäº†æ±‚è§£è¿™ç±»é—®é¢˜çš„å·¥å…·ç®±ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯ï¼šé«˜æ–¯-ç‰›é¡¿æ³•åœ¨æ¥è¿‘æœ€ä¼˜è§£æ—¶æ”¶æ•›è¿…é€Ÿï¼Œæ¢¯åº¦ä¸‹é™æ³•å¯¹åˆå§‹å€¼ä¸æ•æ„Ÿä½†å¯èƒ½æ”¶æ•›è¾ƒæ…¢ï¼Œè€Œæ‹Ÿç‰›é¡¿æ³•åˆ™åœ¨è®¡ç®—æ•ˆç‡ä¸æ”¶æ•›æ€§ä¹‹é—´å–å¾—äº†è‰¯å¥½å¹³è¡¡ã€‚\næœ€åï¼Œæ¨¡å‹æ¯”è¾ƒä¸è¯Šæ–­æé†’æˆ‘ä»¬ï¼Œæ— è®ºæ¨¡å‹å¤šä¹ˆå¤æ‚ï¼Œéƒ½éœ€è¦ä¸¥æ ¼çš„ç»Ÿè®¡éªŒè¯ã€‚æ®‹å·®åˆ†æã€äº¤å‰éªŒè¯ã€ä¿¡æ¯å‡†åˆ™ç­‰å·¥å…·å¸®åŠ©æˆ‘ä»¬é¿å…è¿‡æ‹Ÿåˆï¼Œç¡®ä¿æ¨¡å‹çš„ç¨³å¥æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚\néçº¿æ€§å›å½’ä¸ä»…æ˜¯ä¸€å¥—ç»Ÿè®¡æ–¹æ³•ï¼Œæ›´æ˜¯ä¸€ç§å»ºæ¨¡å“²å­¦ï¼šå®ƒæ•™å¯¼æˆ‘ä»¬åœ¨å°Šé‡æ•°æ®å¤æ‚æ€§çš„åŒæ—¶ï¼Œä¿æŒæ¨¡å‹çš„ç®€çº¦æ€§ï¼›åœ¨è¿½æ±‚æ‹Ÿåˆä¼˜åº¦çš„åŒæ—¶ï¼Œè­¦æƒ•è¿‡åº¦å‚æ•°åŒ–çš„é™·é˜±ã€‚æŒæ¡è¿™äº›æ–¹æ³•åï¼Œè¯»è€…å°†èƒ½å¤Ÿæ›´è‡ªä¿¡åœ°é¢å¯¹ç°å®ä¸–ç•Œä¸­çš„æ›²çº¿å…³ç³»ï¼Œä»æ•°æ®ä¸­æå–æ›´æ·±åˆ»çš„æ´å¯Ÿã€‚\næ ¸å¿ƒå…¬å¼å›é¡¾\n\nå¤šé¡¹å¼å›å½’ï¼š\\(y_i = \\beta_0 + \\beta_1 x_i + \\beta_2 x_i^2 + \\cdots + \\beta_d x_i^d + \\varepsilon_i\\)\næ­£äº¤å¤šé¡¹å¼æ¡ä»¶ï¼š\\(\\sum_{i=1}^n Q_j(x_i)Q_k(x_i) = 0\\)ï¼ˆ\\(j \\neq k\\)ï¼‰\nBox-Coxå˜æ¢ï¼š\\(y^{(\\lambda)} = \\frac{y^\\lambda - 1}{\\lambda}\\)ï¼ˆ\\(\\lambda \\neq 0\\)ï¼‰\næ ·æ¡å…‰æ»‘æ¡ä»¶ï¼š\\(f_j^{(m)}(\\xi_j) = f_{j+1}^{(m)}(\\xi_j)\\)ï¼ˆ\\(m=0,1,2\\)ï¼‰\nå¹³æ»‘æ ·æ¡ç›®æ ‡å‡½æ•°ï¼š\\(\\min_f \\left\\{ \\sum (y_i - f(x_i))^2 + \\lambda \\int [f''(x)]^2 dx \\right\\}\\)\n\næ–¹æ³•æ¯”è¾ƒä¸é€‰æ‹©æŒ‡å—\n\n\n\n\n\n\n\n\n\næ–¹æ³•ç±»å‹\né€‚ç”¨åœºæ™¯\nä¼˜åŠ¿\nå±€é™æ€§\n\n\n\n\nå¤šé¡¹å¼å›å½’\nå…‰æ»‘çš„å…¨å±€è¶‹åŠ¿\nç®€å•ç›´è§‚ï¼Œæ˜“äºè§£é‡Š\nä¸å¤Ÿçµæ´»ï¼Œå¤–æ¨æ€§èƒ½å·®\n\n\næ­£äº¤å¤šé¡¹å¼\né«˜é˜¶å¤šé¡¹å¼æ‹Ÿåˆ\næ•°å€¼ç¨³å®šï¼Œç³»æ•°ç‹¬ç«‹\néœ€è¦ä¸“é—¨çš„åŸºå‡½æ•°æ„é€ \n\n\næ ·æ¡å›å½’\nå±€éƒ¨å˜åŒ–å¤æ‚\nçµæ´»æ€§é«˜ï¼Œé€‚åº”æ€§å¼º\néœ€è¦é€‰æ‹©èŠ‚ç‚¹ä½ç½®\n\n\nå¹³æ»‘æ ·æ¡\nè‡ªåŠ¨å…‰æ»‘åº¦æ§åˆ¶\næ— éœ€é€‰æ‹©èŠ‚ç‚¹ï¼Œç†è®ºæ€§è´¨å¥½\nè®¡ç®—é‡è¾ƒå¤§ï¼Œè§£é‡Šæ€§ç¨å·®\n\n\n\né‡è¦æ¦‚å¿µä½“ç³»\n\nåŸºå‡½æ•°å±•å¼€ï¼šç”¨åŸºå‡½æ•°çš„çº¿æ€§ç»„åˆé€¼è¿‘å¤æ‚å‡½æ•°å…³ç³»\næ­£äº¤æ€§åŸç†ï¼šé€šè¿‡æ­£äº¤åŒ–æ”¹å–„æ•°å€¼ç¨³å®šæ€§å’Œç»Ÿè®¡æ€§è´¨\nåˆ†æ®µå¤šé¡¹å¼ï¼šåœ¨ä¸åŒåŒºé—´ä½¿ç”¨ä¸åŒçš„å¤šé¡¹å¼é€¼è¿‘\nå…‰æ»‘æ€§æ¡ä»¶ï¼šåœ¨åˆ†æ®µè¿æ¥å¤„æ–½åŠ è¿ç»­æ€§çº¦æŸ\næƒ©ç½šå›å½’ï¼šé€šè¿‡æƒ©ç½šé¡¹æ§åˆ¶æ¨¡å‹å¤æ‚åº¦\nåå·®-æ–¹å·®æƒè¡¡ï¼šåœ¨æ¨¡å‹å¤æ‚åº¦å’Œé¢„æµ‹ç²¾åº¦é—´å¯»æ±‚å¹³è¡¡\n\nå®è·µæŒ‡å¯¼åŸåˆ™\n\nä»ç®€åˆ°ç¹ï¼šå…ˆå°è¯•ä½é˜¶å¤šé¡¹å¼ï¼Œå†è€ƒè™‘æ›´å¤æ‚çš„æ–¹æ³•\næ¨¡å‹éªŒè¯ï¼šä½¿ç”¨äº¤å‰éªŒè¯è¯„ä¼°æ¨¡å‹æ³›åŒ–èƒ½åŠ›\næ•°å€¼ç¨³å®šæ€§ï¼šé«˜é˜¶å¤šé¡¹å¼åŠ¡å¿…ä½¿ç”¨æ­£äº¤å¤šé¡¹å¼å½¢å¼\né¢†åŸŸçŸ¥è¯†ï¼šç»“åˆå®é™…é—®é¢˜èƒŒæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ³•\nå¯è§†åŒ–è¯Šæ–­ï¼šé€šè¿‡æ®‹å·®å›¾å’Œæ‹Ÿåˆæ›²çº¿è¯„ä¼°æ¨¡å‹ adequacy\n\nå¤šé¡¹å¼å›å½’å’Œæ ·æ¡å›å½’ä¸ºå¤„ç†éçº¿æ€§å…³ç³»æä¾›äº†ç³»ç»Ÿçš„æ¡†æ¶ï¼Œå®ƒä»¬åœ¨çº¿æ€§æ¨¡å‹çš„åŸºç¡€ä¸Šé€šè¿‡åŸºå‡½æ•°æ‰©å±•æ¥æ•æ‰å¤æ‚çš„æ•°æ®æ¨¡å¼ã€‚ç†è§£è¿™äº›æ–¹æ³•çš„åŸç†å’Œé€‚ç”¨æ¡ä»¶ï¼Œå¯¹äºå»ºç«‹æœ‰æ•ˆçš„é¢„æµ‹æ¨¡å‹å…·æœ‰é‡è¦æ„ä¹‰ã€‚",
    "crumbs": [
      "II æ‰©å±•â€”â€”çº¿æ€§åˆ†ææ–¹æ³•",
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>9 éçº¿æ€§å›å½’ä¸æ ·æ¡å›å½’</span>"
    ]
  },
  {
    "objectID": "chapters/part-3-introduction.html",
    "href": "chapters/part-3-introduction.html",
    "title": "ç°ä»£é¢„æµ‹å»ºæ¨¡ï¼šä»å›å½’åˆ°æœºå™¨å­¦ä¹ ",
    "section": "",
    "text": "åœ¨å‰é¢æˆ‘ä»¬ä»‹ç»äº†çº¿æ€§åˆ†ææ–¹æ³•ï¼ŒåŒ…æ‹¬å›å½’åˆ†æå’Œçº¿æ€§åˆ†ç±»æ¨¡å‹ã€‚æœ¬ç« æˆ‘ä»¬å°†æ‰©å±•åˆ°æ›´å¤æ‚çš„æœºå™¨å­¦ä¹ ï¼Œæ¶µç›–ä»¥ä¸‹å†…å®¹ï¼š - å†³ç­–æ ‘ - é›†æˆæ–¹æ³•ï¼ˆéšæœºæ£®æ—å’Œæ¢¯åº¦æå‡ï¼‰ - æ”¯æŒå‘é‡æœº - ç¥ç»ç½‘ç»œ - æ·±åº¦å­¦ä¹ \nè¿™äº›æ–¹æ³•åœ¨å¤„ç†éçº¿æ€§å…³ç³»å’Œé«˜ç»´æ•°æ®æ—¶è¡¨ç°å‡ºè‰²ï¼Œå¹¿æ³›åº”ç”¨äºåˆ†ç±»å’Œå›å½’ä»»åŠ¡ã€‚æˆ‘ä»¬å°†é€šè¿‡ç†è®ºè®²è§£å’Œå®é™…æ¡ˆä¾‹ï¼Œå¸®åŠ©è¯»è€…ç†è§£è¿™äº›æŠ€æœ¯çš„åŸºæœ¬åŸç†å’Œåº”ç”¨åœºæ™¯ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°†æ¢è®¨æ¨¡å‹è¯„ä¼°ä¸é€‰æ‹©çš„æ–¹æ³•ï¼Œå¦‚äº¤å‰éªŒè¯ã€è¶…å‚æ•°è°ƒä¼˜ç­‰ï¼Œç¡®ä¿è¯»è€…èƒ½å¤Ÿæ„å»ºå‡ºæ€§èƒ½ä¼˜è‰¯çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œè¯»è€…å°†æŒæ¡ç°ä»£æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œä¸ºåç»­æ›´æ·±å…¥çš„ç ”ç©¶æ‰“ä¸‹åšå®åŸºç¡€ã€‚ æœ¬ç« å†…å®¹å®‰æ’å¦‚ä¸‹ï¼š 1. å†³ç­–æ ‘åŸºç¡€ 2. é›†æˆæ–¹æ³•è¯¦è§£ 3. æ”¯æŒå‘é‡æœºåŸç† 4. ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ç®€ä»‹",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>13</span>Â  <span class='chapter-title'>part-3-introduction.html</span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\nåœ¨å‰é¢çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«å»ºç«‹äº†å›å½’åˆ†ææ¡†æ¶ï¼ˆé’ˆå¯¹è¿ç»­å‹å“åº”å˜é‡ï¼‰å’Œåˆ†ç±»åˆ†ææ¡†æ¶ï¼ˆé’ˆå¯¹ç±»åˆ«å‹å“åº”å˜é‡ï¼‰ã€‚å†³ç­–æ ‘æ–¹æ³•ä¸ºè¿™ä¸¤ç±»é—®é¢˜æä¾›äº†ç»Ÿä¸€çš„å»ºæ¨¡è§†è§’ï¼Œå®ƒé€šè¿‡ç›´è§‚çš„æ ‘çŠ¶ç»“æ„å°†å¤æ‚çš„é¢„æµ‹é—®é¢˜åˆ†è§£ä¸ºä¸€ç³»åˆ—ç®€å•çš„å†³ç­–è§„åˆ™ã€‚é›†æˆå­¦ä¹ åˆ™è¿›ä¸€æ­¥é€šè¿‡æ¨¡å‹ç»„åˆçš„ç­–ç•¥ï¼Œæ˜¾è‘—æå‡äº†å•ä¸€æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½ã€‚æœ¬ç« å°†ä»å›å½’å’Œåˆ†ç±»çš„åŒé‡è§’åº¦ï¼Œç³»ç»Ÿé˜è¿°å†³ç­–æ ‘æ–¹æ³•çš„ç†è®ºåŸºç¡€å’Œå®è·µåº”ç”¨ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#å†³ç­–æ ‘çš„åŸºæœ¬æ¡†æ¶",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#å†³ç­–æ ‘çš„åŸºæœ¬æ¡†æ¶",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.1 å†³ç­–æ ‘çš„åŸºæœ¬æ¡†æ¶",
    "text": "10.1 å†³ç­–æ ‘çš„åŸºæœ¬æ¡†æ¶\n\n10.1.1 ç»Ÿä¸€è§†è§’ä¸‹çš„æ ‘æ¨¡å‹\nå†³ç­–æ ‘çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡é€’å½’åœ°åˆ’åˆ†ç‰¹å¾ç©ºé—´æ¥æ„å»ºé¢„æµ‹æ¨¡å‹ï¼Œè¿™ç§æ€æƒ³æ—¢é€‚ç”¨äºå›å½’é—®é¢˜ï¼Œä¹Ÿé€‚ç”¨äºåˆ†ç±»é—®é¢˜ã€‚\næ ‘ç»“æ„çš„é€šç”¨ç»„æˆï¼š - æ ¹èŠ‚ç‚¹ï¼šåŒ…å«å®Œæ•´çš„è®­ç»ƒæ•°æ®é›† - å†…éƒ¨èŠ‚ç‚¹ï¼šåŸºäºæŸä¸ªç‰¹å¾çš„å†³ç­–è§„åˆ™ - åˆ†æ”¯ï¼šå†³ç­–è§„åˆ™çš„å¯èƒ½ç»“æœ - å¶èŠ‚ç‚¹ï¼šæœ€ç»ˆçš„é¢„æµ‹è¾“å‡º\nå…³é”®åŒºåˆ«ï¼š - å›å½’æ ‘ï¼šå¶èŠ‚ç‚¹è¾“å‡ºè¿ç»­æ•°å€¼é¢„æµ‹ - åˆ†ç±»æ ‘ï¼šå¶èŠ‚ç‚¹è¾“å‡ºç±»åˆ«æ ‡ç­¾æˆ–æ¦‚ç‡\n\n\n10.1.2 ç‰¹å¾ç©ºé—´çš„åˆ’åˆ†ç­–ç•¥\nå†³ç­–æ ‘é€šè¿‡è½´å¹³è¡Œåˆ†å‰²å°†ç‰¹å¾ç©ºé—´åˆ’åˆ†ä¸ºçŸ©å½¢åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸå¯¹åº”ä¸€ä¸ªå¶èŠ‚ç‚¹ã€‚\næ•°å­¦è¡¨è¿°ï¼š å¯¹äº \\(p\\) ç»´ç‰¹å¾ç©ºé—´ï¼Œå†³ç­–æ ‘æ„å»ºäº†ä¸€ä¸ªåˆ’åˆ†ï¼š \\[\nR_1, R_2, \\ldots, R_M \\quad \\text{æ»¡è¶³} \\quad \\bigcup_{m=1}^M R_m = \\mathbb{R}^p\n\\]\nå…¶ä¸­æ¯ä¸ªåŒºåŸŸ \\(R_m\\) å¯¹åº”æ ‘çš„ä¸€ä¸ªå¶èŠ‚ç‚¹ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#å›å½’æ ‘è¿ç»­å“åº”çš„å»ºæ¨¡",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#å›å½’æ ‘è¿ç»­å“åº”çš„å»ºæ¨¡",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.2 å›å½’æ ‘ï¼šè¿ç»­å“åº”çš„å»ºæ¨¡",
    "text": "10.2 å›å½’æ ‘ï¼šè¿ç»­å“åº”çš„å»ºæ¨¡\n\n10.2.1 å›å½’æ ‘çš„é¢„æµ‹æœºåˆ¶\nå¶èŠ‚ç‚¹é¢„æµ‹å€¼ï¼š å¯¹äºè½å…¥åŒºåŸŸ \\(R_m\\) çš„è§‚æµ‹ï¼Œå›å½’æ ‘ç»™å‡ºè¯¥åŒºåŸŸå†…æ‰€æœ‰è®­ç»ƒæ ·æœ¬å“åº”å€¼çš„å‡å€¼ä½œä¸ºé¢„æµ‹ï¼š \\[\n\\hat{y}_{R_m} = \\frac{1}{N_m} \\sum_{x_i \\in R_m} y_i = \\bar{y}_{R_m}\n\\]\nå…¶ä¸­ \\(N_m\\) æ˜¯åŒºåŸŸ \\(R_m\\) ä¸­åŒ…å«çš„è®­ç»ƒæ ·æœ¬æ•°ã€‚\næ¨¡å‹è¡¨ç¤ºï¼š å›å½’æ ‘æ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š \\[\nf(x) = \\sum_{m=1}^M \\bar{y}_{R_m} \\cdot I(x \\in R_m)\n\\]\n\n\n10.2.2 å›å½’æ ‘çš„åˆ†è£‚å‡†åˆ™\nç›®æ ‡å‡½æ•°ï¼š é€‰æ‹©åˆ†è£‚ç‰¹å¾ \\(j\\) å’Œåˆ†è£‚ç‚¹ \\(s\\) æ¥æœ€å°åŒ–åŠ æƒå¹³æ–¹è¯¯å·®ï¼š \\[\n\\min_{j,s} \\left[ \\min_{c_1} \\sum_{x_i \\in R_1(j,s)} (y_i - c_1)^2 + \\min_{c_2} \\sum_{x_i \\in R_2(j,s)} (y_i - c_2)^2 \\right]\n\\]\nå…¶ä¸­ï¼š - \\(R_1(j,s) = \\{X | X_j \\leq s\\}\\)ï¼ˆå·¦å­èŠ‚ç‚¹ï¼‰ - \\(R_2(j,s) = \\{X | X_j &gt; s\\}\\)ï¼ˆå³å­èŠ‚ç‚¹ï¼‰ - \\(c_1, c_2\\) åˆ†åˆ«æ˜¯å·¦å³å­èŠ‚ç‚¹çš„æœ€ä¼˜é¢„æµ‹å€¼ï¼ˆå³æ ·æœ¬å‡å€¼ï¼‰\nåˆ†è£‚å¢ç›Šï¼š åˆ†è£‚å¸¦æ¥çš„å¹³æ–¹è¯¯å·®å‡å°‘é‡ä¸ºï¼š \\[\n\\Delta SSE = SSE_{\\text{parent}} - (SSE_{\\text{left}} + SSE_{\\text{right}})\n\\]\nå…¶ä¸­ \\(SSE = \\sum (y_i - \\bar{y})^2\\)\n\n\n10.2.3 å›å½’æ ‘çš„å¤æ‚åº¦æ§åˆ¶\né¢„å‰ªæç­–ç•¥ï¼š - æœ€å¤§æ ‘æ·±åº¦ - å¶èŠ‚ç‚¹æœ€å°æ ·æœ¬æ•° - åˆ†è£‚æ‰€éœ€æœ€å°æ”¹è¿›é‡\nåå‰ªæç­–ç•¥ï¼š ä»£ä»·å¤æ‚åº¦å‰ªæï¼Œæœ€å°åŒ–ï¼š \\[\nC_\\alpha(T) = \\sum_{m=1}^{|T|} N_m \\cdot MSE(R_m) + \\alpha |T|\n\\]\nå…¶ä¸­ \\(MSE(R_m) = \\frac{1}{N_m} \\sum_{x_i \\in R_m} (y_i - \\bar{y}_{R_m})^2\\)",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#åˆ†ç±»æ ‘ç±»åˆ«å“åº”çš„å»ºæ¨¡",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#åˆ†ç±»æ ‘ç±»åˆ«å“åº”çš„å»ºæ¨¡",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.3 åˆ†ç±»æ ‘ï¼šç±»åˆ«å“åº”çš„å»ºæ¨¡",
    "text": "10.3 åˆ†ç±»æ ‘ï¼šç±»åˆ«å“åº”çš„å»ºæ¨¡\n\n10.3.1 åˆ†ç±»æ ‘çš„é¢„æµ‹æœºåˆ¶\nå¶èŠ‚ç‚¹é¢„æµ‹ï¼š å¯¹äºè½å…¥åŒºåŸŸ \\(R_m\\) çš„è§‚æµ‹ï¼Œåˆ†ç±»æ ‘ç»™å‡ºè¯¥åŒºåŸŸå†…æœ€é¢‘ç¹çš„ç±»åˆ«ï¼š \\[\n\\hat{y}_{R_m} = \\arg\\max_k \\left( \\frac{1}{N_m} \\sum_{x_i \\in R_m} I(y_i = k) \\right)\n\\]\næˆ–è€…è¾“å‡ºç±»åˆ«æ¦‚ç‡ï¼š \\[\n\\hat{p}_{mk} = \\frac{1}{N_m} \\sum_{x_i \\in R_m} I(y_i = k)\n\\]\n\n\n10.3.2 åˆ†ç±»æ ‘çš„ä¸çº¯åº¦åº¦é‡\nä¸çº¯åº¦åº¦é‡ç”¨äºè¯„ä¼°èŠ‚ç‚¹å†…ç±»åˆ«çš„æ··æ‚ç¨‹åº¦ï¼Œç†æƒ³çš„ä¸çº¯åº¦å‡½æ•°åº”æ»¡è¶³ï¼š 1. åœ¨å‡åŒ€åˆ†å¸ƒæ—¶å–å¾—æœ€å¤§å€¼ 2. åœ¨çº¯èŠ‚ç‚¹æ—¶å–å¾—æœ€å°å€¼ï¼ˆ0ï¼‰ 3. æ˜¯å¯¹ç§°çš„å‡¹å‡½æ•°\nGiniä¸çº¯åº¦ï¼š \\[\n\\text{Gini}(p) = \\sum_{k=1}^K p_k(1-p_k) = 1 - \\sum_{k=1}^K p_k^2\n\\]\n\nç›´è§‚è§£é‡Šï¼šä»èŠ‚ç‚¹ä¸­éšæœºæŠ½å–ä¸¤ä¸ªæ ·æœ¬ï¼Œå®ƒä»¬å±äºä¸åŒç±»åˆ«çš„æ¦‚ç‡\nå–å€¼èŒƒå›´ï¼š[0, 1-1/K]\nå¯¹ç±»åˆ«åˆ†å¸ƒå˜åŒ–æ•æ„Ÿ\n\nä¿¡æ¯ç†µï¼š \\[\n\\text{Entropy}(p) = -\\sum_{k=1}^K p_k \\log p_k\n\\]\n\nåŸºäºä¿¡æ¯è®ºçš„æ¦‚å¿µ\nåœ¨æœºå™¨å­¦ä¹ ä¸­å¹¿æ³›ä½¿ç”¨\nè®¡ç®—ç›¸å¯¹å¤æ‚\n\nè¯¯åˆ†ç±»è¯¯å·®ï¼š \\[\n\\text{Error}(p) = 1 - \\max_k p_k\n\\]\n\nç›´è§‚ä½†ä¸å¤Ÿæ•æ„Ÿ\nä¸é€‚åˆä½œä¸ºåˆ†è£‚å‡†åˆ™ï¼Œå¸¸ç”¨äºå‰ªæ\n\n\n\n10.3.3 åˆ†ç±»æ ‘çš„åˆ†è£‚å‡†åˆ™\nä¸çº¯åº¦å‡å°‘é‡ï¼š é€‰æ‹©ä½¿å­èŠ‚ç‚¹ä¸çº¯åº¦åŠ æƒå’Œå‡å°‘æœ€å¤šçš„åˆ†è£‚ï¼š \\[\n\\Delta I = I(\\text{parent}) - \\left( \\frac{N_{\\text{left}}}{N} I(\\text{left}) + \\frac{N_{\\text{right}}}{N} I(\\text{right}) \\right)\n\\]\nå…¶ä¸­ \\(I(\\cdot)\\) æ˜¯é€‰æ‹©çš„ä¸çº¯åº¦å‡½æ•°ã€‚\nä¿¡æ¯å¢ç›Šï¼ˆä½¿ç”¨ç†µä¸çº¯åº¦æ—¶ï¼‰ï¼š \\[\n\\text{Information Gain} = \\text{Entropy}(p) - \\sum_{j=1}^2 \\frac{N_j}{N} \\text{Entropy}(p_j)\n\\]",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#æ ‘æ¨¡å‹çš„æ¯”è¾ƒä¸è¯Šæ–­",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#æ ‘æ¨¡å‹çš„æ¯”è¾ƒä¸è¯Šæ–­",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.4 æ ‘æ¨¡å‹çš„æ¯”è¾ƒä¸è¯Šæ–­",
    "text": "10.4 æ ‘æ¨¡å‹çš„æ¯”è¾ƒä¸è¯Šæ–­\n\n10.4.1 å›å½’æ ‘ä¸åˆ†ç±»æ ‘çš„ç»Ÿä¸€è§†è§’\nå…±åŒç‰¹ç‚¹ï¼š 1. éå‚æ•°æ–¹æ³•ï¼šä¸å¯¹æ•°æ®åˆ†å¸ƒåšå¼ºå‡è®¾ 2. ç‰¹å¾é€‰æ‹©ï¼šè‡ªåŠ¨é€‰æ‹©é‡è¦ç‰¹å¾ 3. å¤„ç†æ··åˆç±»å‹æ•°æ®ï¼šèƒ½åŒæ—¶å¤„ç†æ•°å€¼å‹å’Œç±»åˆ«å‹ç‰¹å¾ 4. ç¨³å¥æ€§ï¼šå¯¹å¼‚å¸¸å€¼å’Œç¼ºå¤±å€¼ç›¸å¯¹ç¨³å¥\nä¸»è¦å·®å¼‚ï¼š\n\n\n\næ–¹é¢\nå›å½’æ ‘\nåˆ†ç±»æ ‘\n\n\n\n\nå“åº”å˜é‡\nè¿ç»­å‹\nç±»åˆ«å‹\n\n\nå¶èŠ‚ç‚¹é¢„æµ‹\nå‡å€¼\nä¼—æ•°æˆ–æ¦‚ç‡\n\n\nåˆ†è£‚å‡†åˆ™\nå¹³æ–¹è¯¯å·®å‡å°‘\nä¸çº¯åº¦å‡å°‘\n\n\næ¨¡å‹è¯„ä¼°\nMSE, RÂ²\nå‡†ç¡®ç‡, AUC\n\n\nå¤æ‚åº¦æ§åˆ¶\nåŸºäºMSEçš„ä»£ä»·å¤æ‚åº¦\nåŸºäºä¸çº¯åº¦çš„ä»£ä»·å¤æ‚åº¦\n\n\n\n\n\n10.4.2 æ ‘æ¨¡å‹çš„ä¼˜åŠ¿ä¸å±€é™\nä¸»è¦ä¼˜åŠ¿ï¼š 1. ç›´è§‚æ˜“æ‡‚ï¼šå†³ç­–è§„åˆ™å¯è§£é‡Šæ€§å¼º 2. æ— éœ€é¢„å¤„ç†ï¼šå¯¹ç‰¹å¾ç¼©æ”¾ä¸æ•æ„Ÿ 3. å¤„ç†éçº¿æ€§ï¼šè‡ªåŠ¨æ•æ‰å˜é‡é—´çš„äº¤äº’æ•ˆåº” 4. å˜é‡é‡è¦æ€§ï¼šæä¾›ç‰¹å¾é‡è¦æ€§çš„è‡ªç„¶åº¦é‡\nä¸»è¦å±€é™ï¼š 1. ä¸ç¨³å®šæ€§ï¼šæ•°æ®å¾®å°å˜åŒ–å¯èƒ½å¯¼è‡´æ ‘ç»“æ„å·¨å¤§æ”¹å˜ 2. è´ªå©ªæ€§ï¼šæ¯ä¸€æ­¥é€‰æ‹©å±€éƒ¨æœ€ä¼˜ï¼Œæœªå¿…å…¨å±€æœ€ä¼˜ 3. é¢„æµ‹é¢ä¸å…‰æ»‘ï¼šåˆ†æ®µå¸¸æ•°é¢„æµ‹ 4. å¤–æ¨èƒ½åŠ›å·®ï¼šæ— æ³•é¢„æµ‹è®­ç»ƒæ•°æ®èŒƒå›´å¤–çš„å€¼",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#é›†æˆå­¦ä¹ ç†è®ºåŸºç¡€",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#é›†æˆå­¦ä¹ ç†è®ºåŸºç¡€",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.5 é›†æˆå­¦ä¹ ç†è®ºåŸºç¡€",
    "text": "10.5 é›†æˆå­¦ä¹ ç†è®ºåŸºç¡€\n\n10.5.1 é›†æˆå­¦ä¹ çš„ç»Ÿè®¡åŸç†\né›†æˆå­¦ä¹ é€šè¿‡ç»„åˆå¤šä¸ªåŸºå­¦ä¹ å™¨æ¥æ”¹å–„é¢„æµ‹æ€§èƒ½ï¼Œå…¶ç†è®ºåŸºç¡€å¯ä»¥ä»åå·®-æ–¹å·®åˆ†è§£çš„è§’åº¦ç†è§£ã€‚\nå›å½’é—®é¢˜çš„åå·®-æ–¹å·®åˆ†è§£ï¼š \\[\n\\mathbb{E}[(y - \\hat{f}(x))^2] = \\text{Bias}^2(\\hat{f}(x)) + \\text{Var}(\\hat{f}(x)) + \\sigma_\\varepsilon^2\n\\]\nåˆ†ç±»é—®é¢˜çš„è¯¯å·®åˆ†è§£ï¼š è™½ç„¶åˆ†ç±»é—®é¢˜æ²¡æœ‰ç²¾ç¡®çš„åå·®-æ–¹å·®åˆ†è§£ï¼Œä½†ç±»ä¼¼æ¦‚å¿µä»ç„¶é€‚ç”¨ï¼š - åå·®ï¼šæ¨¡å‹ç³»ç»Ÿæ€§é”™è¯¯ - æ–¹å·®ï¼šæ¨¡å‹å¯¹è®­ç»ƒæ•°æ®å˜åŒ–çš„æ•æ„Ÿæ€§\n\n\n10.5.2 é›†æˆæ–¹æ³•çš„åˆ†ç±»\næ ¹æ®åŸºå­¦ä¹ å™¨çš„ç”Ÿæˆæ–¹å¼å’Œç»„åˆç­–ç•¥ï¼Œé›†æˆæ–¹æ³•ä¸»è¦åˆ†ä¸ºï¼š\n\nå¹¶è¡Œæ–¹æ³•ï¼šåŸºå­¦ä¹ å™¨ç‹¬ç«‹ç”Ÿæˆï¼Œå¦‚Baggingã€éšæœºæ£®æ—\nåºåˆ—æ–¹æ³•ï¼šåŸºå­¦ä¹ å™¨é¡ºåºç”Ÿæˆï¼Œå¦‚Boosting\nå¼‚è´¨é›†æˆï¼šç»„åˆä¸åŒç±»å‹çš„å­¦ä¹ å™¨ï¼Œå¦‚Stacking",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#baggingä¸éšæœºæ£®æ—",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#baggingä¸éšæœºæ£®æ—",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.6 Baggingä¸éšæœºæ£®æ—",
    "text": "10.6 Baggingä¸éšæœºæ£®æ—\n\n10.6.1 Baggingçš„å›å½’åº”ç”¨\nBootstrapé‡‡æ ·ï¼š ä»è®­ç»ƒé›†ä¸­æœ‰æ”¾å›åœ°æŠ½å– \\(B\\) ä¸ªè‡ªåŠ©æ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬å¤§å°ä¸åŸå§‹è®­ç»ƒé›†ç›¸åŒã€‚\nå›å½’é¢„æµ‹èšåˆï¼š \\[\n\\hat{f}_{\\text{bag}}(x) = \\frac{1}{B} \\sum_{b=1}^B \\hat{f}^{*b}(x)\n\\]\næ–¹å·®å‡å°‘æœºåˆ¶ï¼š å‡è®¾åŸºå­¦ä¹ å™¨æ–¹å·®ä¸º \\(\\sigma^2\\)ï¼Œç›¸å…³ç³»æ•°ä¸º \\(\\rho\\)ï¼Œåˆ™Baggingé›†æˆæ–¹å·®ä¸ºï¼š \\[\n\\text{Var}(\\hat{f}_{\\text{bag}}) = \\rho\\sigma^2 + \\frac{1-\\rho}{B}\\sigma^2\n\\]\n\n\n10.6.2 Baggingçš„åˆ†ç±»åº”ç”¨\nå¤šæ•°æŠ•ç¥¨ï¼š \\[\n\\hat{y}_{\\text{bag}}(x) = \\arg\\max_k \\sum_{b=1}^B I(\\hat{f}^{*b}(x) = k)\n\\]\næ¦‚ç‡å¹³å‡ï¼š \\[\n\\hat{p}_k(x) = \\frac{1}{B} \\sum_{b=1}^B \\hat{p}^{*b}_k(x)\n\\]\n\n\n10.6.3 éšæœºæ£®æ—çš„æ”¹è¿›\néšæœºæ£®æ—åœ¨Baggingçš„åŸºç¡€ä¸Šå¼•å…¥ç‰¹å¾éšæœºé€‰æ‹©ï¼Œè¿›ä¸€æ­¥é™ä½åŸºå­¦ä¹ å™¨é—´çš„ç›¸å…³æ€§ã€‚\nç‰¹å¾é‡‡æ ·ç­–ç•¥ï¼š - åˆ†ç±»é—®é¢˜ï¼š\\(m \\approx \\sqrt{p}\\) - å›å½’é—®é¢˜ï¼š\\(m \\approx p/3\\)\nç‰¹å¾é‡è¦æ€§ï¼š åŸºäºä¸çº¯åº¦å‡å°‘çš„å¹³å‡å€¼ï¼š \\[\n\\text{Importance}(X_j) = \\frac{1}{B} \\sum_{b=1}^B \\sum_{t \\in T_b} \\Delta I(t, X_j)\n\\]",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#boostingæ–¹æ³•",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#boostingæ–¹æ³•",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.7 Boostingæ–¹æ³•",
    "text": "10.7 Boostingæ–¹æ³•\n\n10.7.1 å›å½’é—®é¢˜çš„æ¢¯åº¦æå‡\nåŠ æ€§æ¨¡å‹ï¼š \\[\nf_M(x) = \\sum_{m=1}^M \\beta_m h_m(x)\n\\]\næ¢¯åº¦ä¸‹é™è§†è§’ï¼š åœ¨å‡½æ•°ç©ºé—´ä¸­è¿›è¡Œæ¢¯åº¦ä¸‹é™ï¼Œæ¯ä¸€æ­¥æ‹Ÿåˆå½“å‰æ¨¡å‹çš„è´Ÿæ¢¯åº¦ï¼š \\[\nr_{im} = -\\left[\\frac{\\partial L(y_i, f(x_i))}{\\partial f(x_i)}\\right]_{f=f_{m-1}}\n\\]\nå¯¹äºå¹³æ–¹æŸå¤±ï¼š \\[\nr_{im} = y_i - f_{m-1}(x_i)\n\\]\nç®—æ³•æ­¥éª¤ï¼š 1. åˆå§‹åŒ– \\(f_0(x) = \\bar{y}\\) 2. å¯¹äº \\(m = 1\\) åˆ° \\(M\\)ï¼š - è®¡ç®—ä¼ªæ®‹å·® \\(r_{im} = y_i - f_{m-1}(x_i)\\) - ç”¨å†³ç­–æ ‘æ‹Ÿåˆ \\(\\{(x_i, r_{im})\\}\\) å¾—åˆ° \\(h_m(x)\\) - æ›´æ–° \\(f_m(x) = f_{m-1}(x) + \\nu \\cdot h_m(x)\\)\nå…¶ä¸­ \\(\\nu\\) æ˜¯å­¦ä¹ ç‡ã€‚\n\n\n10.7.2 åˆ†ç±»é—®é¢˜çš„AdaBoost\nAdaBoosté€šè¿‡è°ƒæ•´æ ·æœ¬æƒé‡æ¥å…³æ³¨éš¾ä»¥åˆ†ç±»çš„æ ·æœ¬ã€‚\næŒ‡æ•°æŸå¤±å‡½æ•°ï¼š \\[\nL(y, f(x)) = \\exp(-y f(x))\n\\]\nå…¶ä¸­ \\(y \\in \\{-1, +1\\}\\)\nç®—æ³•æµç¨‹ï¼š 1. åˆå§‹åŒ–æƒé‡ \\(w_i = 1/N\\) 2. å¯¹äº \\(m = 1\\) åˆ° \\(M\\)ï¼š - è®­ç»ƒå¼±åˆ†ç±»å™¨ \\(G_m(x)\\) æœ€å°åŒ–åŠ æƒè¯¯å·® - è®¡ç®—è¯¯å·®ç‡ \\(\\text{err}_m = \\frac{\\sum_{i=1}^N w_i I(y_i \\neq G_m(x_i))}{\\sum_{i=1}^N w_i}\\) - è®¡ç®—åˆ†ç±»å™¨æƒé‡ \\(\\alpha_m = \\frac{1}{2} \\log\\left(\\frac{1-\\text{err}_m}{\\text{err}_m}\\right)\\) - æ›´æ–°æ ·æœ¬æƒé‡ \\(w_i \\leftarrow w_i \\exp(-\\alpha_m y_i G_m(x_i))\\) - æƒé‡å½’ä¸€åŒ– 3. è¾“å‡ºæœ€ç»ˆåˆ†ç±»å™¨ \\(\\text{sign}\\left(\\sum_{m=1}^M \\alpha_m G_m(x)\\right)\\)",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#é›†æˆå­¦ä¹ çš„é«˜çº§åº”ç”¨",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#é›†æˆå­¦ä¹ çš„é«˜çº§åº”ç”¨",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.10 é›†æˆå­¦ä¹ çš„é«˜çº§åº”ç”¨",
    "text": "10.10 é›†æˆå­¦ä¹ çš„é«˜çº§åº”ç”¨\n\n10.10.1 å›å½’ä¸åˆ†ç±»çš„æ€§èƒ½å·®å¼‚\nå›å½’é—®é¢˜çš„é›†æˆï¼š\n\n- ä¸»è¦é™ä½æ–¹å·®\n- å¯¹åŸºå­¦ä¹ å™¨çš„å‡†ç¡®æ€§è¦æ±‚ç›¸å¯¹è¾ƒä½\n\nå®¹æ˜“å®ç°é¢„æµ‹åŒºé—´ä¼°è®¡\n\n\nåˆ†ç±»é—®é¢˜çš„é›†æˆï¼š\n\n\nåŒæ—¶å½±å“åå·®å’Œæ–¹å·®\n\n\nå¯¹åŸºå­¦ä¹ å™¨çš„å¤šæ ·æ€§è¦æ±‚æ›´é«˜\n\n\nç±»åˆ«ä¸å¹³è¡¡æ—¶éœ€è¦ç‰¹æ®Šå¤„ç†\n\n\n\n\n10.10.2 æ¨¡å‹è§£é‡Šæ€§å·¥å…·\nç‰¹å¾é‡è¦æ€§ï¼š æ— è®ºå›å½’è¿˜æ˜¯åˆ†ç±»ï¼Œéƒ½å¯ä»¥é€šè¿‡ç‰¹å¾åœ¨é›†æˆä¸­çš„æ€»ä¸çº¯åº¦å‡å°‘æ¥è¯„ä¼°é‡è¦æ€§ã€‚\néƒ¨åˆ†ä¾èµ–å›¾ï¼š æ˜¾ç¤ºæŸä¸ªç‰¹å¾å¯¹é¢„æµ‹å€¼çš„è¾¹é™…æ•ˆåº”ï¼Œé€‚ç”¨äºå›å½’å’Œæ¦‚ç‡é¢„æµ‹ã€‚\nSHAPå€¼ï¼š ç»Ÿä¸€æ¡†æ¶ä¸‹çš„ç‰¹å¾è´¡çŒ®åº¦åˆ†æï¼Œä¸ºæ¯ä¸ªé¢„æµ‹æä¾›å¯è§£é‡Šçš„åˆ†è§£ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#æ¡ˆä¾‹åˆ†æ",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "10.11 æ¡ˆä¾‹åˆ†æ",
    "text": "10.11 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#æœ¬ç« æ€»ç»“",
    "href": "chapters/10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ .html#æœ¬ç« æ€»ç»“",
    "title": "10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ ",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾\n\nå›å½’æ ‘é¢„æµ‹ï¼š\\(\\hat{y}_{R_m} = \\frac{1}{N_m} \\sum_{x_i \\in R_m} y_i\\)\nåˆ†ç±»æ ‘Giniä¸çº¯åº¦ï¼š\\(\\text{Gini}(p) = 1 - \\sum_{k=1}^K p_k^2\\)\nBaggingå›å½’ï¼š\\(\\hat{f}_{\\text{bag}}(x) = \\frac{1}{B} \\sum_{b=1}^B \\hat{f}^{*b}(x)\\)\næ¢¯åº¦æå‡ä¼ªæ®‹å·®ï¼š\\(r_{im} = y_i - f_{m-1}(x_i)\\)\nAdaBooståˆ†ç±»å™¨æƒé‡ï¼š\\(\\alpha_m = \\frac{1}{2} \\log\\left(\\frac{1-\\text{err}_m}{\\text{err}_m}\\right)\\)\n\nå›å½’ä¸åˆ†ç±»çš„å¯¹æ¯”æ€»ç»“\n\n\n\næ–¹é¢\nå›å½’æ ‘\nåˆ†ç±»æ ‘\n\n\n\n\nå“åº”å˜é‡\nè¿ç»­æ•°å€¼\nç¦»æ•£ç±»åˆ«\n\n\né¢„æµ‹è¾“å‡º\nå¶èŠ‚ç‚¹å‡å€¼\nå¶èŠ‚ç‚¹ä¼—æ•°æˆ–æ¦‚ç‡\n\n\næŸå¤±å‡½æ•°\nå¹³æ–¹è¯¯å·®\nGini/ç†µä¸çº¯åº¦\n\n\né›†æˆç›®æ ‡\nä¸»è¦é™ä½æ–¹å·®\nå¹³è¡¡åå·®ä¸æ–¹å·®\n\n\nè¯„ä¼°æŒ‡æ ‡\nMSE, RMSE, RÂ²\nå‡†ç¡®ç‡, ç²¾ç¡®ç‡, å¬å›ç‡\n\n\n\næ–¹æ³•é€‰æ‹©æŒ‡å—\n\n\n\né—®é¢˜ç±»å‹\næ¨èæ–¹æ³•\nå…³é”®è€ƒè™‘\n\n\n\n\néœ€è¦å¼ºè§£é‡Šæ€§\nå•æ£µå†³ç­–æ ‘\næ·±åº¦é™åˆ¶ï¼Œå‰ªæå¼ºåº¦\n\n\nå›å½’é¢„æµ‹ç²¾åº¦\næ¢¯åº¦æå‡æ ‘\nå­¦ä¹ ç‡ï¼Œæ ‘æ·±åº¦ï¼Œè¿­ä»£æ¬¡æ•°\n\n\nåˆ†ç±»å¹³è¡¡æ•°æ®\néšæœºæ£®æ—\næ ‘æ•°é‡ï¼Œç‰¹å¾é‡‡æ ·æ¯”ä¾‹\n\n\nç±»åˆ«ä¸å¹³è¡¡\nAdaBoost\nå…³æ³¨å›°éš¾æ ·æœ¬çš„èƒ½åŠ›\n\n\nè®¡ç®—æ•ˆç‡ä¼˜å…ˆ\nBagging\nå¯å¹¶è¡ŒåŒ–ï¼Œå†…å­˜éœ€æ±‚\n\n\n\né‡è¦æ¦‚å¿µä½“ç³»\n\né€’å½’åˆ’åˆ†ï¼šé€šè¿‡ç‰¹å¾æµ‹è¯•æ„å»ºå±‚æ¬¡å†³ç­–ç»“æ„\nä¸çº¯åº¦åº¦é‡ï¼šé‡åŒ–èŠ‚ç‚¹å†…å“åº”å˜é‡çš„æ··æ‚ç¨‹åº¦\næ¨¡å‹é›†æˆï¼šé€šè¿‡ç»„åˆå¤šä¸ªåŸºå­¦ä¹ å™¨æå‡é¢„æµ‹æ€§èƒ½\nåå·®-æ–¹å·®æƒè¡¡ï¼šåœ¨ä¸åŒé›†æˆæ–¹æ³•ä¸­çš„å·®å¼‚åŒ–è¡¨ç°\nç‰¹å¾é‡è¦æ€§ï¼šåŸºäºæ ‘æ¨¡å‹çš„ç‰¹å¾è´¡çŒ®åº¦è¯„ä¼°\nç¨³å¥é¢„æµ‹ï¼šé€šè¿‡æ¨¡å‹å¹³å‡é™ä½æ–¹å·®å’Œè¿‡æ‹Ÿåˆé£é™©\n\nå†³ç­–æ ‘å’Œé›†æˆå­¦ä¹ æ–¹æ³•ä¸ºå›å½’å’Œåˆ†ç±»é—®é¢˜æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚ä»å•ä¸€æ ‘çš„ç›´è§‚è§£é‡Šåˆ°é›†æˆæ–¹æ³•çš„é«˜ç²¾åº¦é¢„æµ‹ï¼Œè¿™ä¸€æ–¹æ³•ä½“ç³»æ¶µç›–äº†ä»æ¢ç´¢æ€§åˆ†æåˆ°ç”Ÿäº§éƒ¨ç½²çš„å…¨æµç¨‹éœ€æ±‚ã€‚ç†è§£è¿™äº›æ–¹æ³•åœ¨å›å½’å’Œåˆ†ç±»èƒŒæ™¯ä¸‹çš„å…±æ€§ä¸å·®å¼‚ï¼Œæœ‰åŠ©äºåœ¨å®é™…é—®é¢˜ä¸­é€‰æ‹©æœ€é€‚åˆçš„æŠ€æœ¯è·¯çº¿ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>10 å†³ç­–æ ‘ä¸é›†æˆå­¦ä¹ </span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\næ”¯æŒå‘é‡æœºï¼ˆSupport Vector Machine, SVMï¼‰æ˜¯ä¸€ç±»å¼ºå¤§çš„ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œåœ¨çº¿æ€§åˆ†ç±»å’Œå›å½’é—®é¢˜ä¸­è¡¨ç°å‡ºè‰²ã€‚æœ¬ç« å°†ä»å‡ ä½•ç›´è§‚å’Œæ•°å­¦ä¼˜åŒ–ä¸¤ä¸ªè§’åº¦ï¼Œç³»ç»Ÿä»‹ç»SVMçš„åŸºæœ¬åŸç†ã€æ ¸æ–¹æ³•ä»¥åŠåœ¨å®é™…é—®é¢˜ä¸­çš„åº”ç”¨ã€‚SVMçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å¯»æ‰¾æœ€ä¼˜åˆ†ç¦»è¶…å¹³é¢æ¥å®ç°åˆ†ç±»ï¼Œå¹¶é€šè¿‡æ ¸æŠ€å·§å¤„ç†éçº¿æ€§é—®é¢˜ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#çº¿æ€§æ”¯æŒå‘é‡åˆ†ç±»å™¨",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#çº¿æ€§æ”¯æŒå‘é‡åˆ†ç±»å™¨",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "11.1 çº¿æ€§æ”¯æŒå‘é‡åˆ†ç±»å™¨",
    "text": "11.1 çº¿æ€§æ”¯æŒå‘é‡åˆ†ç±»å™¨\n\n11.1.1 æœ€å¤§é—´éš”åˆ†ç±»å™¨\nåŸºæœ¬æ¦‚å¿µï¼š å¯¹äºçº¿æ€§å¯åˆ†çš„äºŒåˆ†ç±»é—®é¢˜ï¼Œå­˜åœ¨æ— æ•°ä¸ªè¶…å¹³é¢å¯ä»¥å°†ä¸¤ç±»æ ·æœ¬åˆ†å¼€ã€‚æœ€å¤§é—´éš”åˆ†ç±»å™¨é€‰æ‹©é‚£ä¸ªå…·æœ‰æœ€å¤§é—´éš”çš„è¶…å¹³é¢ã€‚\næ•°å­¦è¡¨è¿°ï¼š è€ƒè™‘è®­ç»ƒæ•°æ® \\(\\{(x_i, y_i)\\}_{i=1}^n\\)ï¼Œå…¶ä¸­ \\(y_i \\in \\{-1, +1\\}\\)ã€‚åˆ†ç¦»è¶…å¹³é¢å¯ä»¥è¡¨ç¤ºä¸ºï¼š \\[\nw^T x + b = 0\n\\]\nå‡½æ•°é—´éš”ï¼š æ ·æœ¬ç‚¹ \\((x_i, y_i)\\) åˆ°è¶…å¹³é¢çš„å‡½æ•°é—´éš”å®šä¹‰ä¸ºï¼š \\[\n\\hat{\\gamma}_i = y_i(w^T x_i + b)\n\\]\nå‡ ä½•é—´éš”ï¼š å‡ ä½•é—´éš”æ˜¯å‡½æ•°é—´éš”é™¤ä»¥æƒé‡å‘é‡çš„èŒƒæ•°ï¼š \\[\n\\gamma_i = \\frac{y_i(w^T x_i + b)}{\\|w\\|} = \\frac{\\hat{\\gamma}_i}{\\|w\\|}\n\\]\n\n\n11.1.2 ä¼˜åŒ–é—®é¢˜ formulation\næœ€å¤§é—´éš”ä¼˜åŒ–é—®é¢˜ï¼š å¯»æ‰¾è¶…å¹³é¢ä½¿å¾—æœ€å°å‡ ä½•é—´éš”æœ€å¤§åŒ–ï¼š \\[\n\\begin{aligned}\n&\\max_{w,b} \\gamma \\\\\n&\\text{æ»¡è¶³ } \\frac{y_i(w^T x_i + b)}{\\|w\\|} \\geq \\gamma, \\quad i = 1, \\ldots, n\n\\end{aligned}\n\\]\nç­‰ä»·å½¢å¼ï¼š é€šè¿‡ç¼©æ”¾çº¦æŸï¼Œå¯ä»¥å¾—åˆ°ç­‰ä»·çš„å‡¸ä¼˜åŒ–é—®é¢˜ï¼š \\[\n\\begin{aligned}\n&\\min_{w,b} \\frac{1}{2} \\|w\\|^2 \\\\\n&\\text{æ»¡è¶³ } y_i(w^T x_i + b) \\geq 1, \\quad i = 1, \\ldots, n\n\\end{aligned}\n\\]\n\n\n11.1.3 æ”¯æŒå‘é‡çš„æ¦‚å¿µ\næ”¯æŒå‘é‡ï¼š æ˜¯é‚£äº›æ°å¥½æ»¡è¶³ \\(y_i(w^T x_i + b) = 1\\) çš„æ ·æœ¬ç‚¹ï¼Œå®ƒä»¬å®šä¹‰äº†é—´éš”çš„è¾¹ç•Œï¼Œå¹¶å®Œå…¨å†³å®šäº†æœ€ä¼˜è¶…å¹³é¢ã€‚\nå…³é”®æ€§è´¨ï¼š - æ”¯æŒå‘é‡æ˜¯è·ç¦»åˆ†ç¦»è¶…å¹³é¢æœ€è¿‘çš„æ ·æœ¬ç‚¹ - ç§»é™¤éæ”¯æŒå‘é‡ä¸ä¼šå½±å“æ¨¡å‹ - æ”¯æŒå‘é‡çš„æ•°é‡é€šå¸¸å¾ˆå°‘ï¼Œä½¿å¾—SVMå…·æœ‰ç¨€ç–æ€§",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#è½¯é—´éš”æ”¯æŒå‘é‡æœº",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#è½¯é—´éš”æ”¯æŒå‘é‡æœº",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "11.2 è½¯é—´éš”æ”¯æŒå‘é‡æœº",
    "text": "11.2 è½¯é—´éš”æ”¯æŒå‘é‡æœº\n\n11.2.1 çº¿æ€§ä¸å¯åˆ†æƒ…å†µ\nåœ¨å®é™…é—®é¢˜ä¸­ï¼Œæ•°æ®å¾€å¾€ä¸æ˜¯çº¿æ€§å¯åˆ†çš„ã€‚è½¯é—´éš”SVMé€šè¿‡å¼•å…¥æ¾å¼›å˜é‡æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚\næ¾å¼›å˜é‡ï¼š å¯¹äºæ¯ä¸ªæ ·æœ¬å¼•å…¥ \\(\\xi_i \\geq 0\\)ï¼Œå…è®¸æŸäº›æ ·æœ¬è¿åé—´éš”çº¦æŸï¼š \\[\ny_i(w^T x_i + b) \\geq 1 - \\xi_i, \\quad i = 1, \\ldots, n\n\\]\nä¼˜åŒ–é—®é¢˜ï¼š \\[\n\\begin{aligned}\n&\\min_{w,b,\\xi} \\frac{1}{2} \\|w\\|^2 + C \\sum_{i=1}^n \\xi_i \\\\\n&\\text{æ»¡è¶³ } y_i(w^T x_i + b) \\geq 1 - \\xi_i, \\quad i = 1, \\ldots, n \\\\\n&\\xi_i \\geq 0, \\quad i = 1, \\ldots, n\n\\end{aligned}\n\\]\n\n\n11.2.2 å‚æ•°Cçš„è§£é‡Š\næ­£åˆ™åŒ–å‚æ•°ï¼š - \\(C\\) æ§åˆ¶é—´éš”å®½åº¦ä¸åˆ†ç±»é”™è¯¯ä¹‹é—´çš„æƒè¡¡ - \\(C \\to \\infty\\)ï¼šç¡¬é—´éš”SVMï¼Œä¸å…è®¸ä»»ä½•åˆ†ç±»é”™è¯¯ - \\(C \\to 0\\)ï¼šæœ€å¤§åŒ–é—´éš”ï¼Œå®¹å¿æ›´å¤šåˆ†ç±»é”™è¯¯\nå®é™…é€‰æ‹©ï¼š \\(C\\) é€šå¸¸é€šè¿‡äº¤å‰éªŒè¯é€‰æ‹©ï¼Œå¹³è¡¡æ¨¡å‹çš„å¤æ‚åº¦å’Œè®­ç»ƒè¯¯å·®ã€‚\n\n\n11.2.3 æŸå¤±å‡½æ•°è§†è§’\nåˆé¡µæŸå¤±ï¼š è½¯é—´éš”SVMç­‰ä»·äºæœ€å°åŒ–åˆé¡µæŸå¤±ï¼š \\[\n\\min_{w,b} \\frac{1}{2} \\|w\\|^2 + C \\sum_{i=1}^n \\max(0, 1 - y_i(w^T x_i + b))\n\\]\nä¸å…¶ä»–æ–¹æ³•çš„æ¯”è¾ƒï¼š - åˆé¡µæŸå¤±å¯¹æ­£ç¡®åˆ†ç±»ä¸”ç½®ä¿¡åº¦é«˜çš„æ ·æœ¬æŸå¤±ä¸º0 - ä¸é€»è¾‘å›å½’çš„äº¤å‰ç†µæŸå¤±å½¢æˆå¯¹æ¯”",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#å¯¹å¶é—®é¢˜ä¸æ ¸æ–¹æ³•",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#å¯¹å¶é—®é¢˜ä¸æ ¸æ–¹æ³•",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "11.3 å¯¹å¶é—®é¢˜ä¸æ ¸æ–¹æ³•",
    "text": "11.3 å¯¹å¶é—®é¢˜ä¸æ ¸æ–¹æ³•\n\n11.3.1 æ‹‰æ ¼æœ—æ—¥å¯¹å¶\nåŸå§‹é—®é¢˜ï¼š \\[\n\\begin{aligned}\n&\\min_{w,b,\\xi} \\frac{1}{2} \\|w\\|^2 + C \\sum_{i=1}^n \\xi_i \\\\\n&\\text{æ»¡è¶³ } y_i(w^T x_i + b) \\geq 1 - \\xi_i, \\quad \\xi_i \\geq 0\n\\end{aligned}\n\\]\næ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š \\[\nL(w,b,\\xi,\\alpha,\\mu) = \\frac{1}{2} \\|w\\|^2 + C \\sum_{i=1}^n \\xi_i - \\sum_{i=1}^n \\alpha_i[y_i(w^T x_i + b) - 1 + \\xi_i] - \\sum_{i=1}^n \\mu_i \\xi_i\n\\]\nå¯¹å¶é—®é¢˜ï¼š \\[\n\\begin{aligned}\n&\\max_{\\alpha} \\sum_{i=1}^n \\alpha_i - \\frac{1}{2} \\sum_{i=1}^n \\sum_{j=1}^n \\alpha_i \\alpha_j y_i y_j x_i^T x_j \\\\\n&\\text{æ»¡è¶³ } 0 \\leq \\alpha_i \\leq C, \\quad i = 1, \\ldots, n \\\\\n&\\sum_{i=1}^n \\alpha_i y_i = 0\n\\end{aligned}\n\\]\n\n\n11.3.2 æ ¸æŠ€å·§\nç‰¹å¾æ˜ å°„ï¼š é€šè¿‡éçº¿æ€§æ˜ å°„ \\(\\phi: \\mathcal{X} \\to \\mathcal{H}\\) å°†è¾“å…¥ç©ºé—´æ˜ å°„åˆ°é«˜ç»´ç‰¹å¾ç©ºé—´ã€‚\næ ¸å‡½æ•°ï¼š æ ¸å‡½æ•° \\(K(x_i, x_j) = \\langle \\phi(x_i), \\phi(x_j) \\rangle\\) è®¡ç®—ç‰¹å¾ç©ºé—´ä¸­çš„å†…ç§¯ï¼Œè€Œæ— éœ€æ˜¾å¼è®¡ç®—ç‰¹å¾æ˜ å°„ã€‚\nå¯¹å¶é—®é¢˜çš„æ ¸åŒ–å½¢å¼ï¼š \\[\n\\begin{aligned}\n&\\max_{\\alpha} \\sum_{i=1}^n \\alpha_i - \\frac{1}{2} \\sum_{i=1}^n \\sum_{j=1}^n \\alpha_i \\alpha_j y_i y_j K(x_i, x_j) \\\\\n&\\text{æ»¡è¶³ } 0 \\leq \\alpha_i \\leq C, \\quad \\sum_{i=1}^n \\alpha_i y_i = 0\n\\end{aligned}\n\\]\n\n\n11.3.3 å¸¸ç”¨æ ¸å‡½æ•°\nçº¿æ€§æ ¸ï¼š \\[\nK(x_i, x_j) = x_i^T x_j\n\\]\nå¤šé¡¹å¼æ ¸ï¼š \\[\nK(x_i, x_j) = (\\gamma x_i^T x_j + r)^d\n\\]\né«˜æ–¯å¾„å‘åŸºæ ¸ï¼š \\[\nK(x_i, x_j) = \\exp(-\\gamma \\|x_i - x_j\\|^2)\n\\]\nSigmoidæ ¸ï¼š \\[\nK(x_i, x_j) = \\tanh(\\gamma x_i^T x_j + r)\n\\]",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#æ”¯æŒå‘é‡å›å½’",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#æ”¯æŒå‘é‡å›å½’",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "11.4 æ”¯æŒå‘é‡å›å½’",
    "text": "11.4 æ”¯æŒå‘é‡å›å½’\n\n11.4.1 \\(\\epsilon\\)-ä¸æ•æ„ŸæŸå¤±\nå›å½’é—®é¢˜è®¾å®šï¼š å¯¹äºå›å½’é—®é¢˜ \\(y_i \\in \\mathbb{R}\\)ï¼ŒSVMçš„æ‰©å±•ç§°ä¸ºæ”¯æŒå‘é‡å›å½’ã€‚\n\\(\\epsilon\\)-ä¸æ•æ„ŸæŸå¤±ï¼š \\[\nL_\\epsilon(y, f(x)) = \\begin{cases}\n0 & \\text{if } |y - f(x)| \\leq \\epsilon \\\\\n|y - f(x)| - \\epsilon & \\text{otherwise}\n\\end{cases}\n\\]\n\n\n11.4.2 SVRä¼˜åŒ–é—®é¢˜\nåŸå§‹é—®é¢˜ï¼š \\[\n\\begin{aligned}\n&\\min_{w,b,\\xi,\\xi^*} \\frac{1}{2} \\|w\\|^2 + C \\sum_{i=1}^n (\\xi_i + \\xi_i^*) \\\\\n&\\text{æ»¡è¶³ } y_i - (w^T x_i + b) \\leq \\epsilon + \\xi_i \\\\\n&(w^T x_i + b) - y_i \\leq \\epsilon + \\xi_i^* \\\\\n&\\xi_i, \\xi_i^* \\geq 0, \\quad i = 1, \\ldots, n\n\\end{aligned}\n\\]\nå¯¹å¶é—®é¢˜ï¼š \\[\n\\begin{aligned}\n&\\max_{\\alpha,\\alpha^*} -\\epsilon \\sum_{i=1}^n (\\alpha_i + \\alpha_i^*) + \\sum_{i=1}^n y_i (\\alpha_i - \\alpha_i^*) \\\\\n&- \\frac{1}{2} \\sum_{i=1}^n \\sum_{j=1}^n (\\alpha_i - \\alpha_i^*)(\\alpha_j - \\alpha_j^*) K(x_i, x_j) \\\\\n&\\text{æ»¡è¶³ } 0 \\leq \\alpha_i, \\alpha_i^* \\leq C, \\quad \\sum_{i=1}^n (\\alpha_i - \\alpha_i^*) = 0\n\\end{aligned}\n\\]\n\n\n11.4.3 é¢„æµ‹å‡½æ•°\nSVRé¢„æµ‹ï¼š \\[\nf(x) = \\sum_{i=1}^n (\\alpha_i - \\alpha_i^*) K(x_i, x) + b\n\\]\næ”¯æŒå‘é‡ï¼š åªæœ‰é‚£äº›æ»¡è¶³ \\(|\\alpha_i - \\alpha_i^*| &gt; 0\\) çš„æ ·æœ¬æ‰æ˜¯æ”¯æŒå‘é‡ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#æ¨¡å‹é€‰æ‹©ä¸è¯„ä¼°",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#æ¨¡å‹é€‰æ‹©ä¸è¯„ä¼°",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "11.5 æ¨¡å‹é€‰æ‹©ä¸è¯„ä¼°",
    "text": "11.5 æ¨¡å‹é€‰æ‹©ä¸è¯„ä¼°\n\n11.5.1 è¶…å‚æ•°è°ƒä¼˜\nå…³é”®è¶…å‚æ•°ï¼š - æ­£åˆ™åŒ–å‚æ•° \\(C\\) - æ ¸å‚æ•°ï¼ˆå¦‚RBFæ ¸çš„ \\(\\gamma\\)ï¼‰ - \\(\\epsilon\\)ï¼ˆå¯¹äºSVRï¼‰\nç½‘æ ¼æœç´¢ï¼š åœ¨è¶…å‚æ•°ç©ºé—´ä¸­è¿›è¡Œç³»ç»Ÿæœç´¢ï¼Œä½¿ç”¨äº¤å‰éªŒè¯è¯„ä¼°æ€§èƒ½ã€‚\näº¤å‰éªŒè¯ç­–ç•¥ï¼š - \\(k\\)-æŠ˜äº¤å‰éªŒè¯ - åˆ†å±‚äº¤å‰éªŒè¯ï¼ˆç”¨äºåˆ†ç±»ï¼‰ - æ—¶é—´åºåˆ—äº¤å‰éªŒè¯ï¼ˆç”¨äºæ—¶é—´ç›¸å…³æ•°æ®ï¼‰\n\n\n11.5.2 æ ¸å‡½æ•°é€‰æ‹©\næ ¸é€‰æ‹©æŒ‡å—ï¼š\n\n\n\næ•°æ®ç±»å‹\næ¨èæ ¸å‡½æ•°\nç†ç”±\n\n\n\n\nçº¿æ€§å¯åˆ†\nçº¿æ€§æ ¸\nç®€å•ï¼Œè®¡ç®—é«˜æ•ˆ\n\n\næ–‡æœ¬æ•°æ®\nçº¿æ€§æ ¸\né«˜ç»´ç¨€ç–æ•°æ®\n\n\néçº¿æ€§é—®é¢˜\nRBFæ ¸\né€šç”¨æ€§å¼ºï¼Œé€‚åº”å„ç§æ¨¡å¼\n\n\nå…ˆéªŒçŸ¥è¯†\nè‡ªå®šä¹‰æ ¸\nåˆ©ç”¨é¢†åŸŸç‰¹å®šçŸ¥è¯†\n\n\n\n\n\n11.5.3 æ¨¡å‹è¯„ä¼°æŒ‡æ ‡\nåˆ†ç±»é—®é¢˜ï¼š - å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•° - ROCæ›²çº¿å’ŒAUC - æ··æ·†çŸ©é˜µ\nå›å½’é—®é¢˜ï¼š - å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰ - å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMAEï¼‰ - \\(R^2\\) å†³å®šç³»æ•°",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#svmçš„æ‰©å±•å˜ä½“",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#svmçš„æ‰©å±•å˜ä½“",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "11.6 SVMçš„æ‰©å±•å˜ä½“",
    "text": "11.6 SVMçš„æ‰©å±•å˜ä½“\n\n11.6.1 å¤šç±»SVM\nä¸€å¯¹å¤šæ–¹æ³•ï¼š ä¸ºæ¯ä¸ªç±»åˆ«è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»SVMï¼Œå°†è¯¥ç±»ä¸å…¶ä»–æ‰€æœ‰ç±»åˆ«åŒºåˆ†ã€‚\nä¸€å¯¹ä¸€æ–¹æ³•ï¼š ä¸ºæ¯å¯¹ç±»åˆ«è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»SVMï¼Œç„¶åé€šè¿‡æŠ•ç¥¨å†³å®šæœ€ç»ˆç±»åˆ«ã€‚\nå¤šç±»SVMçš„ç»Ÿä¸€å…¬å¼ï¼š ç›´æ¥æ‰©å±•SVMåˆ°å¤šç±»æƒ…å†µï¼Œä½¿ç”¨å•ä¸€ä¼˜åŒ–é—®é¢˜ã€‚\n\n\n11.6.2 æ¦‚ç‡è¾“å‡º\nPlattç¼©æ”¾ï¼š å°†SVMè¾“å‡ºé€šè¿‡sigmoidå‡½æ•°è½¬æ¢ä¸ºæ¦‚ç‡ä¼°è®¡ï¼š \\[\nP(y = 1 | x) = \\frac{1}{1 + \\exp(A f(x) + B)}\n\\]\nå…¶ä¸­ \\(A, B\\) é€šè¿‡æœ€å¤§ä¼¼ç„¶ä¼°è®¡å¾—åˆ°ã€‚\n\n\n11.6.3 å¤§è§„æ¨¡SVM\næŒ‘æˆ˜ï¼š æ ‡å‡†SVMç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º \\(O(n^3)\\)ï¼Œç©ºé—´å¤æ‚åº¦ä¸º \\(O(n^2)\\)ï¼Œéš¾ä»¥å¤„ç†å¤§è§„æ¨¡æ•°æ®ã€‚\nè§£å†³æ–¹æ¡ˆï¼š - åºåˆ—æœ€å°ä¼˜åŒ–ï¼ˆSMOï¼‰ç®—æ³• - éšæœºæ¢¯åº¦ä¸‹é™ - è¿‘ä¼¼æ ¸æ–¹æ³•",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#svmä¸å…¶ä»–æ–¹æ³•çš„æ¯”è¾ƒ",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#svmä¸å…¶ä»–æ–¹æ³•çš„æ¯”è¾ƒ",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "11.7 SVMä¸å…¶ä»–æ–¹æ³•çš„æ¯”è¾ƒ",
    "text": "11.7 SVMä¸å…¶ä»–æ–¹æ³•çš„æ¯”è¾ƒ\n\n11.7.1 ä¸é€»è¾‘å›å½’çš„æ¯”è¾ƒ\nç›¸ä¼¼ç‚¹ï¼š - éƒ½æ˜¯çº¿æ€§åˆ†ç±»å™¨ - éƒ½å¯ä»¥é€šè¿‡æ ¸æŠ€å·§å¤„ç†éçº¿æ€§é—®é¢˜ - éƒ½æœ‰æ­£åˆ™åŒ–é¡¹æ§åˆ¶æ¨¡å‹å¤æ‚åº¦\nä¸åŒç‚¹ï¼š - æŸå¤±å‡½æ•°ï¼šåˆé¡µæŸå¤± vs äº¤å‰ç†µæŸå¤± - è¾“å‡ºï¼šå†³ç­–å‡½æ•° vs æ¦‚ç‡ä¼°è®¡ - æ”¯æŒå‘é‡ï¼šç¨€ç–è§£ vs ç¨ å¯†è§£\n\n\n11.7.2 ä¸ç¥ç»ç½‘ç»œçš„æ¯”è¾ƒ\nä¼˜åŠ¿ï¼š - ç†è®ºåŸºç¡€åšå® - å…¨å±€æœ€ä¼˜è§£ - å¯¹é«˜ç»´æ•°æ®æœ‰æ•ˆ\nåŠ£åŠ¿ï¼š - æ ¸å‡½æ•°é€‰æ‹©å›°éš¾ - å¤§è§„æ¨¡æ•°æ®è®¡ç®—æˆæœ¬é«˜ - ç‰¹å¾å·¥ç¨‹ç›¸å¯¹é‡è¦",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#æ¡ˆä¾‹åˆ†æ",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "11.8 æ¡ˆä¾‹åˆ†æ",
    "text": "11.8 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/11 æ”¯æŒå‘é‡æœº.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/11 æ”¯æŒå‘é‡æœº.html#æœ¬ç« æ€»ç»“",
    "title": "11 æ”¯æŒå‘é‡æœº",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒå…¬å¼å›é¡¾\n\næœ€å¤§é—´éš”ä¼˜åŒ–ï¼š\\(\\min_{w,b} \\frac{1}{2} \\|w\\|^2\\) s.t. \\(y_i(w^T x_i + b) \\geq 1\\)\nè½¯é—´éš”SVMï¼š\\(\\min_{w,b,\\xi} \\frac{1}{2} \\|w\\|^2 + C \\sum_{i=1}^n \\xi_i\\)\nå¯¹å¶é—®é¢˜ï¼š\\(\\max_{\\alpha} \\sum_{i=1}^n \\alpha_i - \\frac{1}{2} \\sum_{i,j} \\alpha_i \\alpha_j y_i y_j K(x_i, x_j)\\)\nRBFæ ¸ï¼š\\(K(x_i, x_j) = \\exp(-\\gamma \\|x_i - x_j\\|^2)\\)\nSVRé¢„æµ‹ï¼š\\(f(x) = \\sum_{i=1}^n (\\alpha_i - \\alpha_i^*) K(x_i, x) + b\\)\n\næ–¹æ³•é€‰æ‹©æŒ‡å—\n\n\n\n\n\n\n\n\n\né—®é¢˜ç±»å‹\næ¨èæ–¹æ³•\nå…³é”®å‚æ•°\næ³¨æ„äº‹é¡¹\n\n\n\n\nçº¿æ€§å¯åˆ†åˆ†ç±»\nç¡¬é—´éš”SVM\næ— \næ•°æ®éœ€ä¸¥æ ¼çº¿æ€§å¯åˆ†\n\n\nä¸€èˆ¬åˆ†ç±»\nè½¯é—´éš”SVM\n\\(C\\), æ ¸å‚æ•°\né€šè¿‡äº¤å‰éªŒè¯é€‰æ‹©å‚æ•°\n\n\néçº¿æ€§åˆ†ç±»\næ ¸SVM\n\\(C\\), \\(\\gamma\\)\nå°å¿ƒè¿‡æ‹Ÿåˆ\n\n\nå›å½’é—®é¢˜\nSVR\n\\(C\\), \\(\\epsilon\\), \\(\\gamma\\)\n\\(\\epsilon\\)æ§åˆ¶é¢„æµ‹ç²¾åº¦\n\n\nå¤§è§„æ¨¡æ•°æ®\nçº¿æ€§SVM\n\\(C\\)\nä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™\n\n\n\né‡è¦æ¦‚å¿µä½“ç³»\n\næœ€å¤§é—´éš”åŸç†ï¼šåŸºäºå‡ ä½•é—´éš”æœ€å¤§åŒ–çš„åˆ†ç±»å‡†åˆ™\næ”¯æŒå‘é‡ï¼šå†³å®šåˆ†ç±»è¾¹ç•Œçš„å…³é”®æ ·æœ¬ç‚¹\næ ¸æŠ€å·§ï¼šé€šè¿‡æ ¸å‡½æ•°éšå¼å®ç°éçº¿æ€§æ˜ å°„\nå¯¹å¶ç†è®ºï¼šå°†åŸé—®é¢˜è½¬åŒ–ä¸ºæ›´æ˜“æ±‚è§£çš„å¯¹å¶é—®é¢˜\nè½¯é—´éš”ï¼šé€šè¿‡æ¾å¼›å˜é‡å¤„ç†çº¿æ€§ä¸å¯åˆ†æƒ…å†µ\n\\(\\epsilon\\)-ä¸æ•æ„ŸæŸå¤±ï¼šSVRä¸­ä½¿ç”¨çš„ç¨³å¥æŸå¤±å‡½æ•°\n\nå®è·µæŒ‡å¯¼åŸåˆ™\n\næ•°æ®é¢„å¤„ç†ï¼šSVMå¯¹ç‰¹å¾ç¼©æ”¾æ•æ„Ÿï¼Œå»ºè®®æ ‡å‡†åŒ–æ•°æ®\næ ¸é€‰æ‹©ï¼šä»çº¿æ€§æ ¸å¼€å§‹ï¼Œå¿…è¦æ—¶å‡çº§åˆ°RBFæ ¸\nå‚æ•°è°ƒä¼˜ï¼šä½¿ç”¨ç½‘æ ¼æœç´¢å’Œäº¤å‰éªŒè¯ç³»ç»Ÿä¼˜åŒ–è¶…å‚æ•°\næ¨¡å‹è§£é‡Šï¼šçº¿æ€§SVMçš„æƒé‡å‘é‡æä¾›ç‰¹å¾é‡è¦æ€§\nè®¡ç®—è€ƒè™‘ï¼šå¯¹äºå¤§è§„æ¨¡æ•°æ®ï¼Œè€ƒè™‘çº¿æ€§SVMæˆ–è¿‘ä¼¼æ–¹æ³•\n\næ”¯æŒå‘é‡æœºæä¾›äº†åšå®çš„ç†è®ºåŸºç¡€å’Œä¼˜ç§€çš„å®è·µæ€§èƒ½ï¼Œç‰¹åˆ«é€‚åˆä¸­å°è§„æ¨¡çš„é«˜ç»´æ•°æ®é—®é¢˜ã€‚ç†è§£SVMçš„å‡ ä½•ç›´è§‚å’Œä¼˜åŒ–ç†è®ºï¼Œæœ‰åŠ©äºåœ¨å®é™…åº”ç”¨ä¸­æ›´å¥½åœ°ä½¿ç”¨å’Œè§£é‡Šè¿™ä¸€å¼ºå¤§å·¥å…·ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>11 æ”¯æŒå‘é‡æœº</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "",
    "text": "æœ¬ç« å¯¼è¯»\nç¥ç»ç½‘ç»œæ˜¯é¢„æµ‹å»ºæ¨¡é¢†åŸŸçš„é‡è¦æ–¹æ³•ï¼Œå®ƒé€šè¿‡æ¨¡æ‹Ÿäººè„‘ç¥ç»å…ƒçš„å·¥ä½œæ–¹å¼ï¼Œä¸ºå›å½’å’Œåˆ†ç±»é—®é¢˜æä¾›äº†ç»Ÿä¸€çš„è§£å†³æ–¹æ¡ˆã€‚æœ¬ç« å°†ä»é¢„æµ‹å»ºæ¨¡çš„æœ¬è´¨å‡ºå‘ï¼Œä»‹ç»ç¥ç»ç½‘ç»œçš„åŸºæœ¬åŸç†ã€ç½‘ç»œè®¾è®¡ã€è®­ç»ƒæ–¹æ³•ï¼Œå¹¶ç®€è¦æ¢è®¨æ·±åº¦å­¦ä¹ çš„æ¦‚å¿µï¼Œå¸®åŠ©ç†è§£è¿™ä¸€å¼ºå¤§å·¥å…·åœ¨å›å½’å’Œåˆ†ç±»ä»»åŠ¡ä¸­çš„åº”ç”¨ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#ç¥ç»ç½‘ç»œå›å½’ä¸åˆ†ç±»çš„ç»Ÿä¸€æ¡†æ¶",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#ç¥ç»ç½‘ç»œå›å½’ä¸åˆ†ç±»çš„ç»Ÿä¸€æ¡†æ¶",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "12.1 ç¥ç»ç½‘ç»œï¼šå›å½’ä¸åˆ†ç±»çš„ç»Ÿä¸€æ¡†æ¶",
    "text": "12.1 ç¥ç»ç½‘ç»œï¼šå›å½’ä¸åˆ†ç±»çš„ç»Ÿä¸€æ¡†æ¶\n\n12.1.1 ä»çº¿æ€§æ¨¡å‹åˆ°ç¥ç»ç½‘ç»œ\nçº¿æ€§æ¨¡å‹çš„å›é¡¾ï¼š - çº¿æ€§å›å½’ï¼š\\(y = w^T x + b\\)ï¼ˆè¿ç»­è¾“å‡ºï¼‰ - é€»è¾‘å›å½’ï¼š\\(P(y=1|x) = \\sigma(w^T x + b)\\)ï¼ˆæ¦‚ç‡è¾“å‡ºï¼‰\nç¥ç»ç½‘ç»œçš„æ‰©å±•æ€è·¯ï¼š å•ä¸€ç¥ç»å…ƒå¯ä»¥çœ‹ä½œä¸€ä¸ªå¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼Œé€šè¿‡ç»„åˆå¤šä¸ªç¥ç»å…ƒå¹¶å¼•å…¥éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œç¥ç»ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ æ›´å¤æ‚çš„æ¨¡å¼ã€‚\nåŸºæœ¬ç¥ç»å…ƒæ¨¡å‹ï¼š \\[\n\\begin{aligned}\nz &= w^T x + b \\quad \\text{(çº¿æ€§ç»„åˆ)} \\\\\na &= \\sigma(z) \\quad \\text{(éçº¿æ€§å˜æ¢)}\n\\end{aligned}\n\\]\n\n\n12.1.2 ä¸ºä»€ä¹ˆéœ€è¦ç¥ç»ç½‘ç»œï¼Ÿ\nä¼ ç»Ÿæ–¹æ³•çš„å±€é™æ€§ï¼š - çº¿æ€§æ¨¡å‹åªèƒ½æ•æ‰çº¿æ€§å…³ç³» - å¤šé¡¹å¼å›å½’éœ€è¦æ‰‹åŠ¨è®¾è®¡ç‰¹å¾ç»„åˆ - å¯¹å¤æ‚éçº¿æ€§æ¨¡å¼å»ºæ¨¡èƒ½åŠ›æœ‰é™\nç¥ç»ç½‘ç»œçš„ä¼˜åŠ¿ï¼š - è‡ªåŠ¨å­¦ä¹ ç‰¹å¾ç»„åˆ - é€šè¿‡å±‚æ¬¡åŒ–ç»“æ„å­¦ä¹ æŠ½è±¡ç‰¹å¾ - ç»Ÿä¸€å¤„ç†å›å½’å’Œåˆ†ç±»é—®é¢˜",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#ç½‘ç»œæ¶æ„è®¾è®¡",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#ç½‘ç»œæ¶æ„è®¾è®¡",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "12.2 ç½‘ç»œæ¶æ„è®¾è®¡",
    "text": "12.2 ç½‘ç»œæ¶æ„è®¾è®¡\n\n12.2.1 è¾“å‡ºå±‚è®¾è®¡\nå›å½’é—®é¢˜çš„è¾“å‡ºå±‚ï¼š - ç¥ç»å…ƒæ•°é‡ï¼š1ä¸ªï¼ˆå•è¾“å‡ºï¼‰æˆ–å¯¹åº”è¾“å‡ºç»´åº¦ - æ¿€æ´»å‡½æ•°ï¼šæ’ç­‰å‡½æ•°ï¼ˆæ— æ¿€æ´»ï¼‰ - è¾“å‡ºè§£é‡Šï¼šè¿ç»­æ•°å€¼é¢„æµ‹\näºŒåˆ†ç±»é—®é¢˜çš„è¾“å‡ºå±‚ï¼š - ç¥ç»å…ƒæ•°é‡ï¼š1ä¸ª - æ¿€æ´»å‡½æ•°ï¼šsigmoid - è¾“å‡ºè§£é‡Šï¼šå±äºæ­£ç±»çš„æ¦‚ç‡\nå¤šåˆ†ç±»é—®é¢˜çš„è¾“å‡ºå±‚ï¼š - ç¥ç»å…ƒæ•°é‡ï¼šç±»åˆ«æ•°K - æ¿€æ´»å‡½æ•°ï¼šsoftmax - è¾“å‡ºè§£é‡Šï¼šæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒ\n\n\n12.2.2 éšè—å±‚è®¾è®¡\néšè—å±‚çš„ä½œç”¨ï¼š - å­¦ä¹ è¾“å…¥ç‰¹å¾çš„ä¸­é—´è¡¨ç¤º - é€šè¿‡éçº¿æ€§å˜æ¢å¢å¼ºæ¨¡å‹è¡¨è¾¾èƒ½åŠ› - è‡ªåŠ¨è¿›è¡Œç‰¹å¾å·¥ç¨‹\nç½‘ç»œæ·±åº¦ä¸å®½åº¦ï¼š - æµ…å±‚ç½‘ç»œï¼š1-2ä¸ªéšè—å±‚ï¼Œé€‚åˆç®€å•é—®é¢˜ - æ·±å±‚ç½‘ç»œï¼šå¤šä¸ªéšè—å±‚ï¼Œé€‚åˆå¤æ‚æ¨¡å¼ - å®½åº¦ï¼šæ¯å±‚ç¥ç»å…ƒæ•°ï¼Œå½±å“æ¨¡å‹å®¹é‡",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#æ¿€æ´»å‡½æ•°ä¸æŸå¤±å‡½æ•°",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#æ¿€æ´»å‡½æ•°ä¸æŸå¤±å‡½æ•°",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "12.3 æ¿€æ´»å‡½æ•°ä¸æŸå¤±å‡½æ•°",
    "text": "12.3 æ¿€æ´»å‡½æ•°ä¸æŸå¤±å‡½æ•°\n\n12.3.1 å¸¸ç”¨æ¿€æ´»å‡½æ•°\nSigmoidå‡½æ•°ï¼š \\[\n\\sigma(z) = \\frac{1}{1 + e^{-z}}\n\\] - å°†è¾“å‡ºå‹ç¼©åˆ°(0,1) - é€‚åˆè¾“å‡ºå±‚ï¼Œç›´è§‚çš„æ¦‚ç‡è§£é‡Š - æ¢¯åº¦æ¶ˆå¤±é—®é¢˜\nReLUå‡½æ•°ï¼š \\[\n\\text{ReLU}(z) = \\max(0, z)\n\\] - è®¡ç®—ç®€å•ï¼Œè®­ç»ƒé«˜æ•ˆ - ç¼“è§£æ¢¯åº¦æ¶ˆå¤± - ç°ä»£ç¥ç»ç½‘ç»œçš„é¦–é€‰\nTanhå‡½æ•°ï¼š \\[\n\\tanh(z) = \\frac{e^z - e^{-z}}{e^z + e^{-z}}\n\\] - è¾“å‡ºèŒƒå›´(-1,1)ï¼Œé›¶ä¸­å¿ƒåŒ– - æ¯”sigmoidæœ‰æ›´å¥½çš„æ¢¯åº¦ç‰¹æ€§\n\n\n12.3.2 æŸå¤±å‡½æ•°é€‰æ‹©\nå›å½’ä»»åŠ¡ï¼š å‡æ–¹è¯¯å·®æŸå¤±ï¼š \\[\nL = \\frac{1}{n} \\sum_{i=1}^n (y_i - \\hat{y}_i)^2\n\\]\näºŒåˆ†ç±»ä»»åŠ¡ï¼š äº¤å‰ç†µæŸå¤±ï¼š \\[\nL = -\\frac{1}{n} \\sum_{i=1}^n [y_i \\log(\\hat{y}_i) + (1-y_i) \\log(1-\\hat{y}_i)]\n\\]\nå¤šåˆ†ç±»ä»»åŠ¡ï¼š å¤šç±»äº¤å‰ç†µæŸå¤±ï¼š \\[\nL = -\\frac{1}{n} \\sum_{i=1}^n \\sum_{k=1}^K y_{ik} \\log(\\hat{y}_{ik})\n\\]",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#ç¥ç»ç½‘ç»œè®­ç»ƒ",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#ç¥ç»ç½‘ç»œè®­ç»ƒ",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "12.4 ç¥ç»ç½‘ç»œè®­ç»ƒ",
    "text": "12.4 ç¥ç»ç½‘ç»œè®­ç»ƒ\n\n12.4.1 å‰å‘ä¼ æ’­\nè®¡ç®—è¿‡ç¨‹ï¼š ä»è¾“å…¥å±‚å¼€å§‹ï¼Œé€å±‚è®¡ç®—ç›´åˆ°è¾“å‡ºå±‚ï¼š \\[\n\\begin{aligned}\nz^{[l]} &= W^{[l]} a^{[l-1]} + b^{[l]} \\\\\na^{[l]} &= \\sigma^{[l]}(z^{[l]})\n\\end{aligned}\n\\]\né¢„æµ‹è¾“å‡ºï¼š æœ€ç»ˆå±‚çš„æ¿€æ´»å€¼å³ä¸ºæ¨¡å‹é¢„æµ‹ã€‚\n\n\n12.4.2 åå‘ä¼ æ’­\næ¢¯åº¦è®¡ç®—ï¼š åˆ©ç”¨é“¾å¼æ³•åˆ™è®¡ç®—æŸå¤±å‡½æ•°å¯¹æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦ï¼š \\[\n\\frac{\\partial L}{\\partial W^{[l]}} = \\frac{\\partial L}{\\partial z^{[l]}} (a^{[l-1]})^T\n\\]\nå‚æ•°æ›´æ–°ï¼š ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æ›´æ–°å‚æ•°ï¼š \\[\nW^{[l]} := W^{[l]} - \\alpha \\frac{\\partial L}{\\partial W^{[l]}}\n\\]\n\n\n12.4.3 ä¼˜åŒ–ç®—æ³•\næ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼š ä½¿ç”¨å…¨éƒ¨è®­ç»ƒæ•°æ®è®¡ç®—æ¢¯åº¦ï¼Œæ”¶æ•›ç¨³å®šä½†è®¡ç®—é‡å¤§ã€‚\nå°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼š æŠ˜ä¸­æ–¹æ¡ˆï¼Œå…¼é¡¾æ”¶æ•›é€Ÿåº¦å’Œç¨³å®šæ€§ã€‚\nAdamä¼˜åŒ–å™¨ï¼š è‡ªé€‚åº”å­¦ä¹ ç‡ï¼Œç»“åˆåŠ¨é‡é¡¹ï¼Œå®è·µä¸­æ•ˆæœè‰¯å¥½ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#è¿‡æ‹Ÿåˆä¸æ­£åˆ™åŒ–",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#è¿‡æ‹Ÿåˆä¸æ­£åˆ™åŒ–",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "12.5 è¿‡æ‹Ÿåˆä¸æ­£åˆ™åŒ–",
    "text": "12.5 è¿‡æ‹Ÿåˆä¸æ­£åˆ™åŒ–\n\n12.5.1 è¿‡æ‹Ÿåˆé—®é¢˜\nç¥ç»ç½‘ç»œçš„ç‰¹ç‚¹ï¼š - å‚æ•°ä¼—å¤šï¼Œæ¨¡å‹å®¹é‡å¤§ - å®¹æ˜“è¿‡æ‹Ÿåˆè®­ç»ƒæ•°æ® - éœ€è¦æ­£åˆ™åŒ–æŠ€æœ¯æ§åˆ¶å¤æ‚åº¦\næ£€æµ‹æ–¹æ³•ï¼š - è®­ç»ƒè¯¯å·®æŒç»­ä¸‹é™ï¼ŒéªŒè¯è¯¯å·®å¼€å§‹ä¸Šå‡ - å­¦ä¹ æ›²çº¿åˆ†æ - æ—©åœæ³•\n\n\n12.5.2 æ­£åˆ™åŒ–æŠ€æœ¯\nL2æ­£åˆ™åŒ–ï¼š åœ¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥æƒé‡æƒ©ç½šï¼š \\[\nL_{\\text{reg}} = L + \\frac{\\lambda}{2} \\sum \\|W\\|^2\n\\]\nDropoutï¼š è®­ç»ƒæ—¶éšæœºä¸¢å¼ƒéƒ¨åˆ†ç¥ç»å…ƒï¼Œæé«˜æ³›åŒ–èƒ½åŠ›ã€‚\næ•°æ®å¢å¼ºï¼š é€šè¿‡å˜æ¢ç”Ÿæˆæ›´å¤šè®­ç»ƒæ ·æœ¬ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#æ·±åº¦å­¦ä¹ ç®€ä»‹",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#æ·±åº¦å­¦ä¹ ç®€ä»‹",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "12.6 æ·±åº¦å­¦ä¹ ç®€ä»‹",
    "text": "12.6 æ·±åº¦å­¦ä¹ ç®€ä»‹\næ·±åº¦å­¦ä¹ æ¨¡å‹å¯ä»¥å½¢å¼åŒ–åœ°å®šä¹‰ä¸ºï¼š\n\\[\nf(\\mathbf{x}; \\theta) = f_L(f_{L-1}(\\cdots f_1(\\mathbf{x}; \\theta_1) \\cdots; \\theta_{L-1}); \\theta_L)\n\\]\nå…¶ä¸­ï¼š - \\(\\mathbf{x}\\)ï¼šè¾“å…¥å‘é‡ - \\(\\theta = \\{\\theta_1, \\theta_2, \\dots, \\theta_L\\}\\)ï¼šæ¨¡å‹å‚æ•° - \\(f_l\\)ï¼šç¬¬\\(l\\)å±‚çš„å˜æ¢å‡½æ•° - \\(L\\)ï¼šç½‘ç»œæ€»å±‚æ•°ï¼ˆæ·±åº¦ï¼‰\nä¸æµ…å±‚å­¦ä¹ çš„å¯¹æ¯”\n\n\n\nç‰¹å¾\næµ…å±‚å­¦ä¹ \næ·±åº¦å­¦ä¹ \n\n\n\n\nå±‚æ•°\n1-2å±‚éšè—å±‚\nå¤šå±‚ï¼ˆé€šå¸¸&gt;3å±‚ï¼‰\n\n\nç‰¹å¾å·¥ç¨‹\néœ€è¦æ‰‹åŠ¨è®¾è®¡\nè‡ªåŠ¨å­¦ä¹ ç‰¹å¾\n\n\næ•°æ®éœ€æ±‚\nç›¸å¯¹è¾ƒå°‘\nå¤§é‡æ•°æ®\n\n\nè®¡ç®—éœ€æ±‚\nç›¸å¯¹è¾ƒä½\né«˜è®¡ç®—éœ€æ±‚\n\n\nå¯è§£é‡Šæ€§\nè¾ƒå¥½\nè¾ƒå·®ï¼ˆé»‘ç®±é—®é¢˜ï¼‰\n\n\n\n\n12.6.2 å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰\nCNNçš„åŸºæœ¬æ€æƒ³\nå·ç§¯ç¥ç»ç½‘ç»œä¸“é—¨å¤„ç†å…·æœ‰ç½‘æ ¼ç»“æ„çš„æ•°æ®ï¼ˆå¦‚å›¾åƒï¼‰ï¼Œé€šè¿‡å±€éƒ¨è¿æ¥å’Œæƒå€¼å…±äº«å¤§å¹…å‡å°‘å‚æ•°æ•°é‡ã€‚\nå·ç§¯æ“ä½œ\näºŒç»´ç¦»æ•£å·ç§¯ï¼š \\[\nS(i,j) = (I * K)(i,j) = \\sum_m \\sum_n I(i+m, j+n)K(m,n)\n\\]\nå…¶ä¸­\\(I\\)ä¸ºè¾“å…¥å›¾åƒï¼Œ\\(K\\)ä¸ºå·ç§¯æ ¸ã€‚\nå·ç§¯å±‚ç‰¹æ€§\n\nå±€éƒ¨è¿æ¥ï¼šæ¯ä¸ªç¥ç»å…ƒåªè¿æ¥è¾“å…¥å›¾åƒçš„å±€éƒ¨åŒºåŸŸ\næƒå€¼å…±äº«ï¼šåŒä¸€å·ç§¯æ ¸åœ¨è¾“å…¥çš„ä¸åŒä½ç½®ä½¿ç”¨ç›¸åŒæƒé‡\nå¹³ç§»ä¸å˜æ€§ï¼šèƒ½å¤Ÿæ£€æµ‹è¾“å…¥ä»»ä½•ä½ç½®çš„ç‰¹å¾\n\nCNNçš„åŸºæœ¬ç»„ä»¶\nå·ç§¯å±‚\nè¾“å‡ºç‰¹å¾å›¾å¤§å°è®¡ç®—ï¼š \\[\n\\text{è¾“å‡ºé«˜åº¦} = \\frac{H - F_H + 2P}{S} + 1\n\\] \\[\n\\text{è¾“å‡ºå®½åº¦} = \\frac{W - F_W + 2P}{S} + 1\n\\]\nå…¶ä¸­ï¼š - \\(H, W\\)ï¼šè¾“å…¥é«˜åº¦å’Œå®½åº¦ - \\(F_H, F_W\\)ï¼šå·ç§¯æ ¸é«˜åº¦å’Œå®½åº¦ - \\(P\\)ï¼šå¡«å……ï¼ˆpaddingï¼‰å¤§å° - \\(S\\)ï¼šæ­¥é•¿ï¼ˆstrideï¼‰\næ± åŒ–å±‚\n\næœ€å¤§æ± åŒ–ï¼š \\[\n\\text{output} = \\max(\\text{window})\n\\]\nå¹³å‡æ± åŒ–ï¼š \\[\n\\text{output} = \\text{mean}(\\text{window})\n\\]\n\næ± åŒ–ä½œç”¨ï¼šé™ç»´ã€å‡å°‘è¿‡æ‹Ÿåˆã€å¢åŠ å¹³ç§»ä¸å˜æ€§ã€‚\nå…¨è¿æ¥å±‚\nåœ¨CNNæœ«ç«¯ï¼Œå°†ç‰¹å¾å›¾å±•å¹³åè¿æ¥å…¨è¿æ¥å±‚è¿›è¡Œåˆ†ç±»ã€‚\nç»å…¸CNNæ¶æ„\nLeNet-5ï¼ˆ1998ï¼‰\n\nè¾“å…¥ï¼š32Ã—32ç°åº¦å›¾åƒ\nç»“æ„ï¼š2ä¸ªå·ç§¯å±‚ + 2ä¸ªæ± åŒ–å±‚ + 3ä¸ªå…¨è¿æ¥å±‚\nåº”ç”¨ï¼šæ‰‹å†™æ•°å­—è¯†åˆ«\n\nAlexNetï¼ˆ2012ï¼‰\n\nåˆ›æ–°ï¼šReLUæ¿€æ´»å‡½æ•°ã€Dropoutã€æ•°æ®å¢å¼º\nç»“æ„ï¼š5ä¸ªå·ç§¯å±‚ + 3ä¸ªæ± åŒ–å±‚ + 3ä¸ªå…¨è¿æ¥å±‚\næˆå°±ï¼šImageNetç«èµ›å† å†›\n\nVGGNetï¼ˆ2014ï¼‰\n\nç‰¹ç‚¹ï¼šä½¿ç”¨å°å·ç§¯æ ¸ï¼ˆ3Ã—3ï¼‰ï¼Œå¢åŠ ç½‘ç»œæ·±åº¦\nVGG16ï¼š13ä¸ªå·ç§¯å±‚ + 3ä¸ªå…¨è¿æ¥å±‚\nVGG19ï¼š16ä¸ªå·ç§¯å±‚ + 3ä¸ªå…¨è¿æ¥å±‚\n\nResNetï¼ˆ2015ï¼‰\n\nåˆ›æ–°ï¼šæ®‹å·®è¿æ¥ï¼Œè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜\næ®‹å·®å—ï¼š \\[\n\\mathbf{y} = \\mathcal{F}(\\mathbf{x}, \\{W_i\\}) + \\mathbf{x}\n\\]\næ·±åº¦ï¼šResNet-50, ResNet-101, ResNet-152\n\n\n\n\n12.6.3 å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰\nåºåˆ—æ•°æ®å¤„ç†\nå¾ªç¯ç¥ç»ç½‘ç»œç”¨äºå¤„ç†åºåˆ—æ•°æ®ï¼Œå…·æœ‰æ—¶é—´ç»´åº¦ä¸Šçš„è®°å¿†èƒ½åŠ›ã€‚\nRNNåŸºæœ¬ç»“æ„\n\\[\n\\mathbf{h}_t = \\phi(\\mathbf{W}_{hh}\\mathbf{h}_{t-1} + \\mathbf{W}_{xh}\\mathbf{x}_t + \\mathbf{b}_h)\n\\] \\[\n\\mathbf{y}_t = \\psi(\\mathbf{W}_{hy}\\mathbf{h}_t + \\mathbf{b}_y)\n\\]\nå…¶ä¸­ï¼š - \\(\\mathbf{h}_t\\)ï¼šæ—¶åˆ»\\(t\\)çš„éšè—çŠ¶æ€ - \\(\\mathbf{x}_t\\)ï¼šæ—¶åˆ»\\(t\\)çš„è¾“å…¥ - \\(\\mathbf{y}_t\\)ï¼šæ—¶åˆ»\\(t\\)çš„è¾“å‡º\nä¸åŒç±»å‹çš„RNN\n\nä¸€å¯¹ä¸€ï¼šæ ‡å‡†ç¥ç»ç½‘ç»œ\nä¸€å¯¹å¤šï¼šå›¾åƒæè¿°ç”Ÿæˆ\nå¤šå¯¹ä¸€ï¼šæƒ…æ„Ÿåˆ†æ\nå¤šå¯¹å¤šï¼ˆç­‰é•¿ï¼‰ï¼šè¯æ€§æ ‡æ³¨\nå¤šå¯¹å¤šï¼ˆä¸ç­‰é•¿ï¼‰ï¼šæœºå™¨ç¿»è¯‘\n\né•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰\nLSTMé€šè¿‡é—¨æ§æœºåˆ¶è§£å†³é•¿æœŸä¾èµ–é—®é¢˜ã€‚\nLSTMå•å…ƒç»“æ„\n\né—å¿˜é—¨ï¼š \\[\n\\mathbf{f}_t = \\sigma(\\mathbf{W}_f[\\mathbf{h}_{t-1}, \\mathbf{x}_t] + \\mathbf{b}_f)\n\\]\nè¾“å…¥é—¨ï¼š \\[\n\\mathbf{i}_t = \\sigma(\\mathbf{W}_i[\\mathbf{h}_{t-1}, \\mathbf{x}_t] + \\mathbf{b}_i)\n\\] \\[\n\\tilde{\\mathbf{C}}_t = \\tanh(\\mathbf{W}_C[\\mathbf{h}_{t-1}, \\mathbf{x}_t] + \\mathbf{b}_C)\n\\]\nç»†èƒçŠ¶æ€æ›´æ–°ï¼š \\[\n\\mathbf{C}_t = \\mathbf{f}_t \\odot \\mathbf{C}_{t-1} + \\mathbf{i}_t \\odot \\tilde{\\mathbf{C}}_t\n\\]\nè¾“å‡ºé—¨ï¼š \\[\n\\mathbf{o}_t = \\sigma(\\mathbf{W}_o[\\mathbf{h}_{t-1}, \\mathbf{x}_t] + \\mathbf{b}_o)\n\\] \\[\n\\mathbf{h}_t = \\mathbf{o}_t \\odot \\tanh(\\mathbf{C}_t)\n\\]\n\né—¨æ§å¾ªç¯å•å…ƒï¼ˆGRUï¼‰\nGRUæ˜¯LSTMçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œåˆå¹¶é—å¿˜é—¨å’Œè¾“å…¥é—¨ï¼š \\[\n\\mathbf{z}_t = \\sigma(\\mathbf{W}_z[\\mathbf{h}_{t-1}, \\mathbf{x}_t])\n\\] \\[\n\\mathbf{r}_t = \\sigma(\\mathbf{W}_r[\\mathbf{h}_{t-1}, \\mathbf{x}_t])\n\\] \\[\n\\tilde{\\mathbf{h}}_t = \\tanh(\\mathbf{W}[\\mathbf{r}_t \\odot \\mathbf{h}_{t-1}, \\mathbf{x}_t])\n\\] \\[\n\\mathbf{h}_t = (1 - \\mathbf{z}_t) \\odot \\mathbf{h}_{t-1} + \\mathbf{z}_t \\odot \\tilde{\\mathbf{h}}_t\n\\]\n\n\n12.6.5 æ³¨æ„åŠ›æœºåˆ¶\nç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›\n\\[\n\\text{Attention}(Q, K, V) = \\text{softmax}\\left(\\frac{QK^\\top}{\\sqrt{d_k}}\\right)V\n\\]\nå…¶ä¸­ï¼š - \\(Q\\)ï¼šæŸ¥è¯¢çŸ©é˜µ - \\(K\\)ï¼šé”®çŸ©é˜µ - \\(V\\)ï¼šå€¼çŸ©é˜µ - \\(d_k\\)ï¼šé”®çš„ç»´åº¦\nå¤šå¤´æ³¨æ„åŠ›\n\\[\n\\text{MultiHead}(Q, K, V) = \\text{Concat}(\\text{head}_1, \\dots, \\text{head}_h)W^O\n\\] \\[\n\\text{head}_i = \\text{Attention}(QW_i^Q, KW_i^K, VW_i^V)\n\\]\nTransformeræ¶æ„\nç¼–ç å™¨-è§£ç å™¨ç»“æ„\nç¼–ç å™¨ï¼ˆ\\(N\\)å±‚ï¼‰ï¼š 1. å¤šå¤´è‡ªæ³¨æ„åŠ› 2. å‰é¦ˆç¥ç»ç½‘ç»œ 3. æ®‹å·®è¿æ¥ + å±‚å½’ä¸€åŒ–\nè§£ç å™¨ï¼ˆ\\(N\\)å±‚ï¼‰ï¼š 1. æ©ç å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼ˆé˜²æ­¢çœ‹åˆ°æœªæ¥ä¿¡æ¯ï¼‰ 2. å¤šå¤´ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ› 3. å‰é¦ˆç¥ç»ç½‘ç»œ 4. æ®‹å·®è¿æ¥ + å±‚å½’ä¸€åŒ–\nä½ç½®ç¼–ç \nä¸ºåºåˆ—æ·»åŠ ä½ç½®ä¿¡æ¯ï¼š \\[\nPE_{(pos, 2i)} = \\sin(pos/10000^{2i/d})\n\\] \\[\nPE_{(pos, 2i+1)} = \\cos(pos/10000^{2i/d})\n\\]\nBERTä¸GPT\nBERTï¼ˆåŒå‘ç¼–ç å™¨è¡¨ç¤ºï¼‰\n\né¢„è®­ç»ƒä»»åŠ¡ï¼šæ©ç è¯­è¨€æ¨¡å‹ + ä¸‹ä¸€å¥é¢„æµ‹\nç‰¹ç‚¹ï¼šåŒå‘ä¸Šä¸‹æ–‡ç†è§£\nåº”ç”¨ï¼šæ–‡æœ¬åˆ†ç±»ã€é—®ç­”ã€å‘½åå®ä½“è¯†åˆ«\n\nGPTï¼ˆç”Ÿæˆå¼é¢„è®­ç»ƒTransformerï¼‰\n\næ¶æ„ï¼šä»…è§£ç å™¨çš„Transformer\né¢„è®­ç»ƒï¼šè‡ªå›å½’è¯­è¨€å»ºæ¨¡\nç‰¹ç‚¹ï¼šå¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#æ¡ˆä¾‹åˆ†æ",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#æ¡ˆä¾‹åˆ†æ",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "12.7 æ¡ˆä¾‹åˆ†æ",
    "text": "12.7 æ¡ˆä¾‹åˆ†æ",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#æœ¬ç« æ€»ç»“",
    "href": "chapters/12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€.html#æœ¬ç« æ€»ç»“",
    "title": "12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€",
    "section": "æœ¬ç« æ€»ç»“",
    "text": "æœ¬ç« æ€»ç»“\næ ¸å¿ƒæ¦‚å¿µå›é¡¾\n\nç»Ÿä¸€æ¡†æ¶ï¼šç¥ç»ç½‘ç»œä¸ºå›å½’å’Œåˆ†ç±»æä¾›ç»Ÿä¸€å»ºæ¨¡æ¡†æ¶\næ¶æ„è®¾è®¡ï¼šæ ¹æ®é—®é¢˜ç±»å‹è®¾è®¡è¾“å‡ºå±‚ï¼Œå›å½’ç”¨çº¿æ€§è¾“å‡ºï¼Œåˆ†ç±»ç”¨sigmoid/softmaxè¾“å‡º\næ¿€æ´»å‡½æ•°ï¼šReLUé€‚åˆéšè—å±‚ï¼Œæ ¹æ®ä»»åŠ¡é€‰æ‹©è¾“å‡ºå±‚æ¿€æ´»å‡½æ•°\nè®­ç»ƒåŸç†ï¼šå‰å‘ä¼ æ’­è®¡ç®—é¢„æµ‹ï¼Œåå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦ï¼Œæ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°\næ­£åˆ™åŒ–ï¼šä½¿ç”¨L2æ­£åˆ™åŒ–ã€Dropoutç­‰æŠ€æœ¯é˜²æ­¢è¿‡æ‹Ÿåˆ\n\nå®è·µåº”ç”¨æŒ‡å—\næ•°æ®é¢„å¤„ç†è¦æ±‚ï¼š - ç‰¹å¾æ ‡å‡†åŒ–ï¼šåŠ é€Ÿæ”¶æ•›ï¼Œæé«˜æ•°å€¼ç¨³å®šæ€§ - æ•°æ®é‡è¦æ±‚ï¼šç¥ç»ç½‘ç»œé€šå¸¸éœ€è¦è¾ƒå¤šè®­ç»ƒæ•°æ® - è®¡ç®—èµ„æºï¼šæ·±å±‚ç½‘ç»œéœ€è¦è¾ƒå¼ºçš„è®¡ç®—èƒ½åŠ›\nä¸ä¼ ç»Ÿæ–¹æ³•çš„é€‰æ‹©ï¼š\n\n\n\nè€ƒè™‘å› ç´ \né€‰æ‹©ä¼ ç»Ÿæ–¹æ³•\né€‰æ‹©ç¥ç»ç½‘ç»œ\n\n\n\n\næ•°æ®é‡\nå°æ ·æœ¬\nå¤§æ ·æœ¬\n\n\né—®é¢˜å¤æ‚åº¦\nç®€å•çº¿æ€§å…³ç³»\nå¤æ‚éçº¿æ€§å…³ç³»\n\n\nå¯è§£é‡Šæ€§\nè¦æ±‚é«˜\nè¦æ±‚ä½\n\n\nè®¡ç®—èµ„æº\næœ‰é™\nå……è¶³\n\n\nç‰¹å¾å·¥ç¨‹\næ‰‹åŠ¨è®¾è®¡\nè‡ªåŠ¨å­¦ä¹ \n\n\n\næ·±åº¦å­¦ä¹ æ‰©å±•\næˆåŠŸåº”ç”¨é¢†åŸŸï¼š - è®¡ç®—æœºè§†è§‰ï¼šå›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ - è‡ªç„¶è¯­è¨€å¤„ç†ï¼šæ–‡æœ¬åˆ†ç±»ã€æœºå™¨ç¿»è¯‘ - è¯­éŸ³è¯†åˆ«ï¼šè¯­éŸ³è½¬æ–‡æœ¬ã€å£°çº¹è¯†åˆ« - æ¨èç³»ç»Ÿï¼šä¸ªæ€§åŒ–æ¨è\nå®è·µå»ºè®®ï¼š 1. ä»åŸºç¡€å¼€å§‹ï¼šå…ˆæŒæ¡æµ…å±‚ç¥ç»ç½‘ç»œï¼Œå†å­¦ä¹ æ·±åº¦å­¦ä¹  2. ç†è§£åŸç†ï¼šä¸ä»…è¦ä¼šä½¿ç”¨ï¼Œæ›´è¦ç†è§£èƒŒåçš„æ•°å­¦åŸç† 3. é¡¹ç›®é©±åŠ¨ï¼šé€šè¿‡å®é™…é¡¹ç›®åŠ æ·±ç†è§£ 4. æŒç»­å­¦ä¹ ï¼šæ·±åº¦å­¦ä¹ é¢†åŸŸå‘å±•è¿…é€Ÿï¼Œéœ€è¦æŒç»­è·Ÿè¿›\nä¸å‰é¢ç« èŠ‚çš„è”ç³»\nç¥ç»ç½‘ç»œä¸æ˜¯å­¤ç«‹çš„æ–¹æ³•ï¼Œè€Œæ˜¯å‰é¢å­¦ä¹ å†…å®¹çš„è‡ªç„¶å»¶ä¼¸ï¼š\n\nå•å±‚ç¥ç»ç½‘ç»œ = å¹¿ä¹‰çº¿æ€§æ¨¡å‹\nå¤šå±‚ç¥ç»ç½‘ç»œ = å¤šä¸ªå¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„å †å +éçº¿æ€§å˜æ¢\næ·±åº¦å­¦ä¹  = æ›´æ·±å±‚æ¬¡çš„ç‰¹å¾å­¦ä¹ \n\né€šè¿‡æœ¬æ•™æçš„å­¦ä¹ ï¼Œå¸Œæœ›è¯»è€…èƒ½å¤Ÿå»ºç«‹ä»ä¼ ç»Ÿç»Ÿè®¡æ–¹æ³•åˆ°ç°ä»£æœºå™¨å­¦ä¹ çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ï¼Œåœ¨å®é™…é—®é¢˜ä¸­é€‰æ‹©åˆé€‚çš„å»ºæ¨¡æ–¹æ³•ã€‚\nå…¨ä¹¦æ€»ç»“ï¼šä»çº¿æ€§å›å½’åˆ°ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€å¥—å®Œæ•´çš„é¢„æµ‹å»ºæ¨¡æ–¹æ³•ä½“ç³»ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯å’Œå±€é™æ€§ï¼Œåœ¨å®é™…å·¥ä½œä¸­éœ€è¦æ ¹æ®å…·ä½“é—®é¢˜é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼Œç†è§£å…¶å‡è®¾å’Œé™åˆ¶ï¼Œæ‰èƒ½æ„å»ºå‡ºæœ‰æ•ˆçš„é¢„æµ‹æ¨¡å‹ã€‚",
    "crumbs": [
      "III è¿›é˜¶â€”â€”è¶…è¶Šçº¿æ€§çš„æœºå™¨å­¦ä¹ ",
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>12 ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ åŸºç¡€</span>"
    ]
  },
  {
    "objectID": "chapters/part-4-introduction.html",
    "href": "chapters/part-4-introduction.html",
    "title": "ç°ä»£é¢„æµ‹å»ºæ¨¡ï¼šä»å›å½’åˆ°æœºå™¨å­¦ä¹ ",
    "section": "",
    "text": "åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å„ç§å›å½’å’Œåˆ†ç±»æ¨¡å‹ï¼Œä½†æ˜¯å…·ä½“çš„æ¡ˆä¾‹åˆ†æ è¿˜æ²¡æœ‰æ¶‰åŠã€‚æ¥ä¸‹æ¥çš„ç« èŠ‚å°†é€šè¿‡ä¸€äº›å®é™…æ¡ˆä¾‹æ¥å±•ç¤ºå¦‚ä½•åº”ç”¨è¿™äº›æ¨¡å‹è§£å†³ç°å®ä¸­çš„é—®é¢˜ã€‚ è¿™äº›æ¡ˆä¾‹å°†æ¶µç›–ä¸åŒé¢†åŸŸï¼Œå¦‚åŒ»ç–—ã€é‡‘èå’Œå¸‚åœºè¥é”€ç­‰ï¼Œå¸®åŠ©è¯»è€…æ›´å¥½åœ°ç†è§£æ¨¡å‹çš„å®é™…åº”ç”¨ã€‚\nåœ¨æ¯ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»æ•°æ®çš„æ”¶é›†ä¸é¢„å¤„ç†è¿‡ç¨‹ï¼Œæ¨¡å‹çš„é€‰æ‹©ä¸è®­ç»ƒæ–¹æ³•ï¼Œä»¥åŠç»“æœçš„è¯„ä¼°ä¸è§£é‡Šã€‚é€šè¿‡è¿™äº›å®é™…æ¡ˆä¾‹ï¼Œè¯»è€…å°†èƒ½å¤Ÿæ›´å¥½åœ°æŒæ¡å¦‚ä½•å°†ç†è®ºçŸ¥è¯†åº”ç”¨åˆ°å®è·µä¸­ï¼Œä»è€Œæå‡è‡ªå·±çš„æ•°æ®åˆ†æå’Œå»ºæ¨¡èƒ½åŠ›ã€‚\nç‰¹å¾å·¥ç¨‹ï¼šåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ•°æ®é€šå¸¸éœ€è¦ç»è¿‡æ¸…æ´—å’Œè½¬æ¢æ‰èƒ½ç”¨äºå»ºæ¨¡ã€‚ç‰¹å¾å·¥ç¨‹åŒ…æ‹¬å¤„ç†ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼æ£€æµ‹ã€ç‰¹å¾ç¼©æ”¾å’Œç¼–ç ç­‰æ­¥éª¤ã€‚é€šè¿‡åˆç†çš„ç‰¹å¾å·¥ç¨‹ï¼Œå¯ä»¥æ˜¾è‘—æå‡æ¨¡å‹çš„æ€§èƒ½ã€‚ æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜ï¼šä¸åŒçš„é—®é¢˜å¯èƒ½é€‚åˆä¸åŒçš„æ¨¡å‹ã€‚æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•æ ¹æ®æ•°æ®çš„ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Œå¹¶é€šè¿‡äº¤å‰éªŒè¯å’Œè¶…å‚æ•°è°ƒä¼˜ç­‰æ–¹æ³•ä¼˜åŒ–æ¨¡å‹æ€§èƒ½ã€‚ ç»“æœè§£é‡Šä¸å¯è§†åŒ–ï¼šæ¨¡å‹è®­ç»ƒå®Œæˆåï¼Œç†è§£å’Œè§£é‡Šæ¨¡å‹çš„ç»“æœåŒ æ ·é‡è¦ã€‚æˆ‘ä»¬å°†ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ç»“æœå¯è§†åŒ–æŠ€æœ¯ï¼Œå¸®åŠ©è¯»è€…æ›´å¥½åœ°ç†è§£æ¨¡å‹çš„é¢„æµ‹ç»“æœå’Œç‰¹å¾çš„é‡è¦æ€§ã€‚ é€šè¿‡è¿™äº›å®é™…æ¡ˆä¾‹çš„å­¦ä¹ ï¼Œè¯»è€…å°†èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å¦‚ä½•å°†å›å½’å’Œåˆ†ç±»æ¨¡å‹åº”ç”¨åˆ°ç°å®é—®é¢˜ä¸­ï¼Œä»è€Œæå‡è‡ªå·±çš„æ•°æ®åˆ†æå’Œå»ºæ¨¡èƒ½åŠ›ã€‚\nç‰¹å¾å·¥ç¨‹æ˜¯æœºå™¨å­¦ä¹ ä¸­çš„æ ¸å¿ƒç¯èŠ‚ï¼Œå®ƒé€šè¿‡å¯¹åŸå§‹æ•°æ®è¿›è¡Œè½¬æ¢ã€ç»„åˆå’Œæå–ï¼Œæ„å»ºæ›´èƒ½ä»£è¡¨é¢„æµ‹ä»»åŠ¡çš„ç‰¹å¾ï¼Œä»è€Œæå‡æ¨¡å‹æ€§èƒ½ã€‚å…¶å†…å®¹å¹¿æ³›ï¼Œå¯åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªä¸»è¦æ–¹é¢ï¼š\nä¸€ã€æ•°æ®é¢„å¤„ç† è¿™æ˜¯ç‰¹å¾å·¥ç¨‹çš„åŸºç¡€ï¼Œæ—¨åœ¨å¤„ç†åŸå§‹æ•°æ®ä¸­çš„é—®é¢˜ï¼Œä½¿å…¶é€‚åˆå»ºæ¨¡ã€‚ 1. ç¼ºå¤±å€¼å¤„ç†ï¼šåˆ é™¤ï¼ˆç¼ºå¤±è¿‡å¤šçš„è¡Œ/åˆ—ï¼‰ã€å¡«å……ï¼ˆå‡å€¼/ä¸­ä½æ•°/ä¼—æ•°ã€æ¨¡å‹é¢„æµ‹å¡«å……ç­‰ï¼‰ã€‚ 2. å¼‚å¸¸å€¼å¤„ç†ï¼šåŸºäºç»Ÿè®¡ï¼ˆå¦‚3ÏƒåŸåˆ™ã€IQRæ³•ï¼‰ã€å¯è§†åŒ–æ£€æµ‹ï¼Œå¹¶è¿›è¡Œä¿®æ­£ã€ç¼©å°¾æˆ–åˆ é™¤ã€‚ 3. æ•°æ®ç±»å‹è½¬æ¢ï¼šå°†åˆ†ç±»å˜é‡ç¼–ç ã€å°†æ•°å€¼å˜é‡åˆ†ç®±ï¼ˆç¦»æ•£åŒ–ï¼‰ã€å°†æ–‡æœ¬/æ—¥æœŸç­‰è½¬æ¢ä¸ºæ¨¡å‹å¯å¤„ç†çš„æ ¼å¼ã€‚\näºŒã€ç‰¹å¾æ„é€  ä»ç°æœ‰æ•°æ®ä¸­åˆ›é€ æ–°çš„ã€æ›´æœ‰ä¿¡æ¯é‡çš„ç‰¹å¾ã€‚ 1. é¢†åŸŸçŸ¥è¯†é©±åŠ¨ï¼šä¾‹å¦‚åœ¨ç”µå•†ä¸­ï¼Œä»â€œè´­ä¹°é‡‘é¢â€å’Œâ€œè´­ä¹°æ¬¡æ•°â€æ„é€ â€œå®¢å•ä»·â€ï¼›åœ¨æ—¶é—´åºåˆ—ä¸­ï¼Œæå–â€œæ˜ŸæœŸå‡ â€ã€â€œæ˜¯å¦èŠ‚å‡æ—¥â€ç­‰ã€‚ 2. äº¤äº’ç‰¹å¾ï¼šé€šè¿‡åŠ å‡ä¹˜é™¤ç­‰è¿ç®—ç»„åˆç°æœ‰ç‰¹å¾ï¼ˆå¦‚â€œèº«é«˜ä½“é‡æŒ‡æ•°BMI=ä½“é‡/èº«é«˜^2â€ï¼‰ã€‚ 3. å¤šé¡¹å¼ç‰¹å¾ï¼šè‡ªåŠ¨ç”Ÿæˆç‰¹å¾çš„é«˜æ¬¡é¡¹å’Œäº¤äº’é¡¹ï¼Œç”¨äºæ•æ‰éçº¿æ€§å…³ç³»ã€‚ 4. åˆ†è§£ç‰¹å¾ï¼šä¾‹å¦‚å°†â€œäº¤æ˜“æ—¥æœŸæ—¶é—´â€åˆ†è§£ä¸ºå¹´ã€æœˆã€æ—¥ã€å°æ—¶ã€åˆ†é’Ÿç­‰ç‹¬ç«‹ç‰¹å¾ã€‚\nä¸‰ã€ç‰¹å¾å˜æ¢ é€šè¿‡æ•°å­¦å˜æ¢æ”¹å˜ç‰¹å¾çš„åˆ†å¸ƒæˆ–å°ºåº¦ï¼Œä½¿å…¶æ›´ç¬¦åˆæ¨¡å‹å‡è®¾æˆ–æå‡æ•ˆæœã€‚ 1. æ ‡å‡†åŒ–/å½’ä¸€åŒ–ï¼š * æ ‡å‡†åŒ–ï¼ˆZ-Scoreï¼‰ï¼šä½¿ç‰¹å¾å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1ã€‚é€‚ç”¨äºè®¸å¤šçº¿æ€§æ¨¡å‹ï¼ˆå¦‚SVMã€é€»è¾‘å›å½’ï¼‰ã€‚ * å½’ä¸€åŒ–ï¼ˆMin-Maxï¼‰ï¼šå°†ç‰¹å¾ç¼©æ”¾åˆ°å›ºå®šèŒƒå›´ï¼ˆå¦‚[0,1]ï¼‰ã€‚å¯¹ç¥ç»ç½‘ç»œã€è·ç¦»ç±»æ¨¡å‹ï¼ˆå¦‚KNNï¼‰æœ‰ç›Šã€‚ 2. éçº¿æ€§å˜æ¢ï¼š * å¯¹æ•°å˜æ¢ã€å¹³æ–¹æ ¹å˜æ¢ã€Box-Coxå˜æ¢ï¼šç”¨äºå¤„ç†åæ€åˆ†å¸ƒï¼Œä½¿å…¶æ›´æ¥è¿‘æ­£æ€åˆ†å¸ƒã€‚ * åˆ†ç®±ï¼ˆç¦»æ•£åŒ–ï¼‰ï¼šå°†è¿ç»­å˜é‡è½¬æ¢ä¸ºæœ‰åºçš„ç±»åˆ«ï¼Œå¯ä»¥æ•æ‰éçº¿æ€§å¹¶ç¨³å®šæ¨¡å‹ã€‚ 3. ç»Ÿè®¡é‡å˜æ¢ï¼šä¾‹å¦‚å¯¹æ•°å€¼ç‰¹å¾è¿›è¡Œæ’åºã€è®¡ç®—ç™¾åˆ†ä½æ’åã€‚\nå››ã€ç‰¹å¾ç¼–ç  å°†éæ•°å€¼ç‰¹å¾è½¬æ¢ä¸ºæ•°å€¼å½¢å¼ã€‚ 1. åˆ†ç±»å˜é‡ç¼–ç ï¼š * ç‹¬çƒ­ç¼–ç ï¼ˆOne-Hotï¼‰ï¼šä¸ºæ¯ä¸ªç±»åˆ«åˆ›å»ºä¸€ä¸ªäºŒè¿›åˆ¶åˆ—ã€‚é€‚ç”¨äºæ— åºç±»åˆ«ï¼Œä½†ç»´åº¦ä¼šè†¨èƒ€ã€‚ * æ ‡ç­¾ç¼–ç ï¼ˆLabel Encodingï¼‰ï¼šä¸ºæ¯ä¸ªç±»åˆ«åˆ†é…ä¸€ä¸ªæ•´æ•°ã€‚é€‚ç”¨äºæœ‰åºç±»åˆ«æˆ–æ ‘æ¨¡å‹ã€‚ * ç›®æ ‡ç¼–ç ï¼ˆTarget Encodingï¼‰ï¼šç”¨ç›®æ ‡å˜é‡çš„ç»Ÿè®¡é‡ï¼ˆå¦‚å‡å€¼ï¼‰æ¥ä»£è¡¨ç±»åˆ«ã€‚æ•ˆæœå¼ºä½†éœ€å°å¿ƒè¿‡æ‹Ÿåˆã€‚ * é¢‘ç‡ç¼–ç ï¼šç”¨ç±»åˆ«å‡ºç°çš„é¢‘ç‡ä»£æ›¿ç±»åˆ«æ ‡ç­¾ã€‚ 2. æ–‡æœ¬ç‰¹å¾ç¼–ç ï¼š * è¯è¢‹æ¨¡å‹ï¼ˆBag of Wordsï¼‰ã€TF-IDFã€è¯å‘é‡ï¼ˆWord2Vec, GloVeï¼‰ ç­‰ã€‚ 3. å›¾åƒ/éŸ³é¢‘ç‰¹å¾æå–ï¼šä½¿ç”¨SIFTã€HOGã€MFCCç­‰ä¼ ç»Ÿæ–¹æ³•æˆ–æ·±åº¦ç½‘ç»œä¸­é—´å±‚è¾“å‡ºä½œä¸ºç‰¹å¾ã€‚\näº”ã€ç‰¹å¾é€‰æ‹© ä»å¤§é‡ç‰¹å¾ä¸­ç­›é€‰å‡ºæœ€ç›¸å…³ã€æœ€é‡è¦çš„å­é›†ï¼Œä»¥é™ä½è¿‡æ‹Ÿåˆé£é™©ã€å‡å°‘è®¡ç®—æˆæœ¬å¹¶æå‡æ¨¡å‹å¯è§£é‡Šæ€§ã€‚ 1. è¿‡æ»¤æ³•ï¼ˆFilterï¼‰ï¼šåŸºäºç»Ÿè®¡æŒ‡æ ‡ï¼ˆå¦‚ç›¸å…³ç³»æ•°ã€å¡æ–¹æ£€éªŒã€äº’ä¿¡æ¯ï¼‰ç‹¬ç«‹è¯„ä¼°æ¯ä¸ªç‰¹å¾ä¸ç›®æ ‡çš„ç›¸å…³æ€§ã€‚ 2. åŒ…è£…æ³•ï¼ˆWrapperï¼‰ï¼šå°†ç‰¹å¾é€‰æ‹©çœ‹ä½œä¸€ä¸ªæœç´¢é—®é¢˜ï¼Œä½¿ç”¨æ¨¡å‹æ€§èƒ½ä½œä¸ºè¯„ä»·æ ‡å‡†ï¼ˆå¦‚é€’å½’ç‰¹å¾æ¶ˆé™¤RFEã€å‰å‘/åå‘é€‰æ‹©ï¼‰ã€‚ 3. åµŒå…¥æ³•ï¼ˆEmbeddedï¼‰ï¼šåœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼ˆå¦‚LASSOå›å½’çš„æ­£åˆ™åŒ–ã€å†³ç­–æ ‘/éšæœºæ£®æ—çš„ç‰¹å¾é‡è¦æ€§ã€XGBoostçš„å¢ç›Šï¼‰ã€‚\nå…­ã€ç‰¹å¾é™ç»´ å½“ç‰¹å¾è¿‡å¤šã€é«˜åº¦ç›¸å…³æˆ–å­˜åœ¨â€œç»´åº¦ç¾éš¾â€æ—¶ï¼Œé€šè¿‡æ•°å­¦æ–¹æ³•å°†é«˜ç»´ç‰¹å¾æ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼ŒåŒæ—¶å°½å¯èƒ½ä¿ç•™ä¿¡æ¯ã€‚ 1. çº¿æ€§æ–¹æ³•ï¼š * ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ï¼šå¯»æ‰¾æ–¹å·®æœ€å¤§çš„æ­£äº¤æ–¹å‘è¿›è¡ŒæŠ•å½±ã€‚ * çº¿æ€§åˆ¤åˆ«åˆ†æï¼ˆLDAï¼‰ï¼šå¯»æ‰¾èƒ½æœ€å¥½åœ°åŒºåˆ†ç±»åˆ«çš„æ–¹å‘è¿›è¡ŒæŠ•å½±ï¼ˆæœ‰ç›‘ç£ï¼‰ã€‚ 2. éçº¿æ€§æ–¹æ³•ï¼št-SNEã€UMAPç­‰ï¼Œå¸¸ç”¨äºé«˜ç»´æ•°æ®çš„å¯è§†åŒ–ã€‚\nä¸ƒã€ç‰¹å¾å­¦ä¹ ï¼ˆé«˜çº§ï¼‰ åˆ©ç”¨æ¨¡å‹ï¼ˆå°¤å…¶æ˜¯æ·±åº¦å­¦ä¹ ï¼‰è‡ªåŠ¨ä»åŸå§‹æ•°æ®ä¸­å­¦ä¹ æœ‰æ•ˆçš„ç‰¹å¾è¡¨ç¤ºã€‚ 1. è‡ªç¼–ç å™¨ï¼ˆAutoencoderï¼‰ 2. æ·±åº¦ç¥ç»ç½‘ç»œï¼šCNNä»å›¾åƒä¸­å­¦ä¹ å±‚æ¬¡åŒ–ç‰¹å¾ï¼ŒRNN/LSTMä»åºåˆ—æ•°æ®ä¸­å­¦ä¹ ä¸Šä¸‹æ–‡ç‰¹å¾ã€‚ 3. é¢„è®­ç»ƒæ¨¡å‹ï¼šä½¿ç”¨BERTã€ResNetç­‰åœ¨å¤§è§„æ¨¡æ•°æ®ä¸Šé¢„è®­ç»ƒçš„æ¨¡å‹è¿›è¡Œç‰¹å¾æå–æˆ–å¾®è°ƒã€‚\næ ¸å¿ƒå·¥ä½œæµç¨‹ä¸åŸåˆ™ åœ¨å®è·µä¸­ï¼Œç‰¹å¾å·¥ç¨‹æ˜¯ä¸€ä¸ªè¿­ä»£ã€æ¢ç´¢æ€§çš„è¿‡ç¨‹ï¼š 1. ç†è§£æ•°æ®å’Œä¸šåŠ¡ï¼šè¿™æ˜¯æ‰€æœ‰å·¥ä½œçš„èµ·ç‚¹ã€‚ 2. ç”Ÿæˆå€™é€‰ç‰¹å¾æ± ï¼šé€šè¿‡é¢„å¤„ç†ã€æ„é€ ç­‰æ–¹æ³•äº§ç”Ÿå¤§é‡ç‰¹å¾ã€‚ 3. è¯„ä¼°å’Œç­›é€‰ï¼šé€šè¿‡é€‰æ‹©ã€é™ç»´ç­‰æ–¹æ³•æç‚¼å‡ºé«˜è´¨é‡ç‰¹å¾å­é›†ã€‚ 4. éªŒè¯ä¸è¿­ä»£ï¼šå°†æ„å»ºçš„ç‰¹å¾è¾“å…¥æ¨¡å‹ï¼Œè¯„ä¼°æ€§èƒ½ï¼Œæ ¹æ®åé¦ˆï¼ˆå¦‚ç‰¹å¾é‡è¦æ€§åˆ†æã€è¯¯å·®åˆ†æï¼‰è¿›ä¸€æ­¥è°ƒæ•´ç‰¹å¾ã€‚\næ ¸å¿ƒåŸåˆ™ï¼šç‰¹å¾å·¥ç¨‹çš„æœ€ç»ˆç›®æ ‡æ˜¯è®©æ•°æ®æ›´å¥½åœ°â€œè®²è¿°â€ä¸é¢„æµ‹ç›®æ ‡ç›¸å…³çš„æ•…äº‹ï¼Œä¸ºæ¨¡å‹æä¾›æœ€å¤§ä»·å€¼çš„â€œç‡ƒæ–™â€ï¼Œè€Œéè¿½æ±‚å¤æ‚çš„æŠ€å·§ã€‚å¥½çš„ç‰¹å¾å·¥ç¨‹å¾€å¾€æ¯”æ›´æ¢æ›´å¤æ‚çš„æ¨¡å‹å¸¦æ¥æ›´æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>17</span>Â  <span class='chapter-title'>part-4-introduction.html</span>"
    ]
  },
  {
    "objectID": "chapters/13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•.html",
    "href": "chapters/13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•.html",
    "title": "13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•",
    "section": "",
    "text": "å›å½’ä»»åŠ¡å¯¼è¯»\nå›å½’åˆ†ææ˜¯é¢„æµ‹å»ºæ¨¡ä¸­æœ€åŸºç¡€ä¸”é‡è¦çš„ä»»åŠ¡ï¼Œå¹¿æ³›åº”ç”¨äºæˆ¿ä»·é¢„æµ‹ã€é”€é‡é¢„æµ‹ã€é£é™©è¯„ä¼°ç­‰é¢†åŸŸã€‚æœ¬ç« å°†é€šè¿‡æ³¢å£«é¡¿æˆ¿ä»·é¢„æµ‹æ¡ˆä¾‹ï¼Œå®Œæ•´å±•ç¤ºå›å½’é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæ¶µç›–æ•°æ®æ¢ç´¢ã€ç‰¹å¾å·¥ç¨‹ã€å¤šç§å›å½’ç®—æ³•æ¯”è¾ƒã€æ¨¡å‹è¯„ä¼°ç­‰å…³é”®ç¯èŠ‚ã€‚\næ•°æ®é›†è¯´æ˜ æœ¬æ¡ˆä¾‹ä½¿ç”¨ç³–å°¿ç—…æ•°æ®é›†ï¼ˆDiabetes Datasetï¼‰ï¼ŒåŒ…å«ç³–å°¿ç—…æ‚£è€…çš„ç”Ÿç†æŒ‡æ ‡å’Œç–¾ç—…è¿›å±•æŒ‡æ ‡ã€‚\né—®é¢˜å®šä¹‰ ç›®æ ‡ï¼šé¢„æµ‹ç³–å°¿ç—…ç–¾ç—…çš„è¿›å±•ï¼ˆtargetï¼‰ä»»åŠ¡ç±»å‹ï¼šå›å½’åˆ†æä¸šåŠ¡ä»·å€¼ï¼šä¸ºåŒ»ç–—è¯Šæ–­å’Œæ²»ç–—æ–¹æ¡ˆåˆ¶å®šæä¾›æ•°æ®æ”¯æŒ",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>18</span>Â  <span class='chapter-title'>13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•</span>"
    ]
  },
  {
    "objectID": "chapters/13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•.html#rè¯­è¨€å®ç°-mlr3æ¡†æ¶",
    "href": "chapters/13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•.html#rè¯­è¨€å®ç°-mlr3æ¡†æ¶",
    "title": "13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•",
    "section": "13.1 Rè¯­è¨€å®ç° (mlr3æ¡†æ¶)",
    "text": "13.1 Rè¯­è¨€å®ç° (mlr3æ¡†æ¶)\næ•°æ®åŠ è½½ä¸æ¢ç´¢\n\n# ç»¼åˆæ¡ˆä¾‹ï¼šç³–å°¿ç—…è¿›å±•é¢„æµ‹ - Rè¯­è¨€å®ç° (mlr3æ¡†æ¶)\n\n# åŠ è½½å¿…è¦çš„åŒ…\nlibrary(mlr3)\nlibrary(mlr3verse)\nlibrary(mlr3pipelines)\nlibrary(mlr3tuning)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(corrplot)\nlibrary(gridExtra)\n\n\n# åŠ è½½ç³–å°¿ç—…æ•°æ®é›†\nlibrary(lars)\ndata(diabetes)\nvariable_names &lt;- c(\"age\", \"sex\", \"bmi\", \"map\", \"tc\", \"ldl\", \"hdl\", \"tch\", \"ltg\", \"glu\")\n\ndiabetes_data &lt;- as.data.frame(matrix(unlist(diabetes$x), ncol = 10))\ncolnames(diabetes_data) &lt;- variable_names\n\nstr(diabetes_data)\n\n'data.frame':   442 obs. of  10 variables:\n $ age: num  0.03808 -0.00188 0.0853 -0.08906 0.00538 ...\n $ sex: num  0.0507 -0.0446 0.0507 -0.0446 -0.0446 ...\n $ bmi: num  0.0617 -0.0515 0.0445 -0.0116 -0.0364 ...\n $ map: num  0.02187 -0.02633 -0.00567 -0.03666 0.02187 ...\n $ tc : num  -0.04422 -0.00845 -0.0456 0.01219 0.00393 ...\n $ ldl: num  -0.0348 -0.0192 -0.0342 0.025 0.0156 ...\n $ hdl: num  -0.0434 0.07441 -0.03236 -0.03604 0.00814 ...\n $ tch: num  -0.00259 -0.03949 -0.00259 0.03431 -0.00259 ...\n $ ltg: num  0.01991 -0.06833 0.00286 0.02269 -0.03199 ...\n $ glu: num  -0.01765 -0.0922 -0.02593 -0.00936 -0.04664 ...\n\ndiabetes_data$target &lt;- diabetes$y\n\n# æ£€æŸ¥ç¼ºå¤±å€¼\ncat(\"\\nç¼ºå¤±å€¼æ£€æŸ¥:\\n\")\n\n\nç¼ºå¤±å€¼æ£€æŸ¥:\n\nprint(colSums(is.na(diabetes_data)))\n\n   age    sex    bmi    map     tc    ldl    hdl    tch    ltg    glu target \n     0      0      0      0      0      0      0      0      0      0      0 \n\n\næ•°æ®å¯è§†åŒ–åˆ†æ\n\n# æ•°æ®å¯è§†åŒ–åˆ†æ - Rè¯­è¨€\n\n# ç›®æ ‡å˜é‡åˆ†å¸ƒ\np1 &lt;- ggplot(diabetes_data, aes(x = target)) +\n  geom_histogram(bins = 30, fill = \"steelblue\", alpha = 0.7) +\n  labs(title = \"ç–¾ç—…è¿›å±•åˆ†å¸ƒ\", x = \"ç–¾ç—…è¿›å±•æŒ‡æ ‡\", y = \"é¢‘æ•°\") +\n  theme_minimal()\n\n# ç–¾ç—…è¿›å±•ä¸å…³é”®å˜é‡çš„å…³ç³»\np2 &lt;- ggplot(diabetes_data, aes(x = bmi, y = target)) +\n  geom_point(alpha = 0.6, color = \"darkred\") +\n  geom_smooth(method = \"lm\", color = \"blue\") +\n  labs(title = \"BMIä¸ç–¾ç—…è¿›å±•å…³ç³»\", x = \"BMI\", y = \"ç–¾ç—…è¿›å±•\") +\n  theme_minimal()\n\np3 &lt;- ggplot(diabetes_data, aes(x = ltg, y = target)) +\n  geom_point(alpha = 0.6, color = \"darkgreen\") +\n  geom_smooth(method = \"loess\", color = \"red\") +\n  labs(title = \"ç¨³å®šè¡€ç³–ä¸ç–¾ç—…è¿›å±•\", x = \"ç¨³å®šè¡€ç³–\", y = \"ç–¾ç—…è¿›å±•\") +\n  theme_minimal()\n\np4 &lt;- ggplot(diabetes_data, aes(x = age, y = target)) +\n  geom_point(alpha = 0.6, color = \"purple\") +\n  geom_smooth(method = \"lm\", color = \"orange\") +\n  labs(title = \"å¹´é¾„ä¸ç–¾ç—…è¿›å±•å…³ç³»\", x = \"å¹´é¾„\", y = \"ç–¾ç—…è¿›å±•\") +\n  theme_minimal()\n\n# ç»„åˆå›¾å½¢\ngrid.arrange(p1, p2, p3, p4, ncol = 2)\n\n\n\n\n\n\n# ç›¸å…³æ€§çƒ­å›¾\ncor_matrix &lt;- cor(diabetes_data)\ncorrplot(cor_matrix, method = \"color\", type = \"upper\", \n         order = \"hclust\", tl.cex = 0.7, tl.col = \"black\",\n         title = \"å˜é‡ç›¸å…³æ€§çƒ­å›¾\")\n\n\n\n\n\n\n\nåˆ›å»ºmlr3ä»»åŠ¡å’Œæ•°æ®é¢„å¤„ç†\n\n# åˆ›å»ºmlr3ä»»åŠ¡å’Œæ•°æ®é¢„å¤„ç†\n\n# åˆ›å»ºå›å½’ä»»åŠ¡\ntask_diabetes &lt;- as_task_regr(diabetes_data, target = \"target\", id = \"diabetes\",store_backends = TRUE)\n\n# æŸ¥çœ‹ä»»åŠ¡ä¿¡æ¯\ncat(\"ä»»åŠ¡ä¿¡æ¯:\\n\")\n\nä»»åŠ¡ä¿¡æ¯:\n\nprint(task_diabetes)\n\n\nâ”€â”€ &lt;TaskRegr&gt; (442x11) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâ€¢ Target: target\nâ€¢ Properties: -\nâ€¢ Features (10):\n  â€¢ dbl (10): age, bmi, glu, hdl, ldl, ltg, map, sex, tc, tch\n\n# æ•°æ®é¢„å¤„ç†ç®¡é“\npreprocess_pipeline &lt;- po(\"scale\") %&gt;&gt;% \n  po(\"colapply\", applicator = as.numeric)\n\n# åº”ç”¨é¢„å¤„ç†\ntask_preprocessed &lt;- preprocess_pipeline$train(task_diabetes)[[1]]\n\ncat(\"\\né¢„å¤„ç†åçš„ä»»åŠ¡ä¿¡æ¯:\\n\")\n\n\né¢„å¤„ç†åçš„ä»»åŠ¡ä¿¡æ¯:\n\nprint(task_preprocessed)\n\n\nâ”€â”€ &lt;TaskRegr&gt; (442x11) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâ€¢ Target: target\nâ€¢ Properties: -\nâ€¢ Features (10):\n  â€¢ dbl (10): age, bmi, glu, hdl, ldl, ltg, map, sex, tc, tch\n\n\næ¨¡å‹è®­ç»ƒä¸æ¯”è¾ƒ\n\n# æ¨¡å‹è®­ç»ƒä¸æ¯”è¾ƒ - mlr3\n\n# å®šä¹‰å­¦ä¹ å™¨\nlearners &lt;- list(\n  lrn(\"regr.lm\", id = \"linear_regression\"),\n  lrn(\"regr.ranger\", id = \"random_forest\"),\n  lrn(\"regr.xgboost\", id = \"xgboost\"),\n  lrn(\"regr.svm\", id = \"svm\"),\n  lrn(\"regr.kknn\", id = \"knn\")\n)\n\n# è®¾ç½®äº¤å‰éªŒè¯\nresampling &lt;- rsmp(\"cv\", folds = 5)\n\n# åŸºå‡†æµ‹è¯•\ndesign &lt;- benchmark_grid(\n  tasks = task_preprocessed,\n  learners = learners,\n  resamplings = resampling\n)\n\nbmr &lt;- benchmark(\n  design,\n  store_backends = TRUE, \n  store_models = TRUE)\n\n# æ€§èƒ½è¯„ä¼°\ncat(\"æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\\n\")\n\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n\nperformance_measures &lt;- msrs(c(\"regr.mse\", \"regr.rmse\", \"regr.mae\", \"regr.rsq\"))\nbmr_aggregated &lt;- bmr$aggregate(performance_measures)\n\n# æ ¼å¼åŒ–è¾“å‡ºç»“æœ\nresults_r &lt;- bmr_aggregated[, .(\n  Model = learner_id,\n  RMSE = regr.rmse,\n  MSE = regr.mse,\n  MAE = regr.mae,\n  R2 = regr.rsq\n)]\n\nprint(results_r[order(RMSE)])\n\n               Model     RMSE      MSE      MAE        R2\n              &lt;char&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;     &lt;num&gt;\n1: linear_regression 54.32812 2959.818 44.08989 0.4992770\n2:     random_forest 56.24742 3175.846 46.10112 0.4634585\n3:               svm 57.29007 3286.445 44.91594 0.4431697\n4:               knn 61.63274 3808.714 48.02614 0.3550164\n5:           xgboost 63.20336 4017.177 50.00323 0.3230514\n\n# æ€§èƒ½å¯è§†åŒ–\nggplot(results_r, aes(x = reorder(Model, RMSE), y = RMSE)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\", alpha = 0.7) +\n  labs(title = \"æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ (RMSE) - R/mlr3\", x = \"æ¨¡å‹\", y = \"RMSE\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nè¶…å‚æ•°è°ƒä¼˜\n\n# è¶…å‚æ•°è°ƒä¼˜ç¤ºä¾‹ - éšæœºæ£®æ—\n\nlibrary(mlr3)           # æ ¸å¿ƒ\nlibrary(mlr3learners)   # å­¦ä¹ å™¨\nlibrary(mlr3tuning)     # å‚æ•°è°ƒä¼˜ï¼ˆåŒ…å« tnr()ï¼‰\nlibrary(paradox)        # å‚æ•°ç©ºé—´\nlibrary(mlr3viz)        # å¯è§†åŒ–\n# å®šä¹‰éšæœºæ£®æ—å­¦ä¹ å™¨\nlearner_rf_tune &lt;- lrn(\"regr.ranger\", num.trees = 100)\n\n# å®šä¹‰è¶…å‚æ•°ç©ºé—´\nparam_set &lt;- ps(\n  mtry = p_int(lower = 2, upper = ncol(diabetes_data) - 1),\n  min.node.size = p_int(lower = 1, upper = 10),\n  sample.fraction = p_dbl(lower = 0.6, upper = 0.9)\n)\n\n# å®šä¹‰è°ƒä¼˜å™¨\ntuner &lt;- tnr(\"grid_search\", resolution = 5)\nterminator &lt;- trm(\"evals\", n_evals = 10)\n\n# è‡ªåŠ¨è°ƒä¼˜\nat &lt;- auto_tuner(\n  tuner = tuner,\n  learner = learner_rf_tune,\n  resampling = rsmp(\"holdout\"),\n  measure = msr(\"regr.rmse\"),\n  search_space = param_set,\n  terminator = terminator\n)\n\n# åœ¨æ•°æ®ä¸Šæ¼”ç¤ºè°ƒä¼˜\nset.seed(123)\nat$train(task_preprocessed)\n\ncat(\"æœ€ä½³å‚æ•°:\\n\")\n\næœ€ä½³å‚æ•°:\n\nprint(at$tuning_result)\n\n    mtry min.node.size sample.fraction learner_param_vals  x_domain regr.rmse\n   &lt;int&gt;         &lt;int&gt;           &lt;num&gt;             &lt;list&gt;    &lt;list&gt;     &lt;num&gt;\n1:     8             3           0.675          &lt;list[6]&gt; &lt;list[3]&gt;  55.69813\n\n# ä½¿ç”¨è°ƒä¼˜åçš„æ¨¡å‹è¿›è¡Œé¢„æµ‹\npredictions_tuned &lt;- at$predict(task_preprocessed)\ncat(\"è°ƒä¼˜å®Œæˆ\\n\")\n\nè°ƒä¼˜å®Œæˆ\n\ncat(\"è°ƒä¼˜åæ¨¡å‹RMSE:\", predictions_tuned$score(msr(\"regr.rmse\")), \"\\n\")\n\nè°ƒä¼˜åæ¨¡å‹RMSE: 30.78791 \n\n\næ¨¡å‹è§£é‡Š\n\n# æ¨¡å‹è§£é‡Š - ç‰¹å¾é‡è¦æ€§\n\nlibrary(ggplot2)\n# è®­ç»ƒæœ€ä½³æ¨¡å‹ï¼ˆéšæœºæ£®æ—ï¼‰\nset.seed(123)\nlearner_best &lt;- lrn(\"regr.ranger\", importance = \"permutation\")\nlearner_best$train(task_preprocessed)\n\n# ç‰¹å¾é‡è¦æ€§\nif (!is.null(learner_best$importance)) {\n  feature_importance &lt;- learner_best$importance()\n  importance_df &lt;- data.frame(\n    Feature = names(feature_importance),\n    Importance = as.numeric(feature_importance)\n  )\n  importance_df &lt;- importance_df[order(-importance_df$Importance), ]\n  \n  cat(\"ç‰¹å¾é‡è¦æ€§æ’åº:\\n\")\n  print(importance_df)\n  \n  # å¯è§†åŒ–ç‰¹å¾é‡è¦æ€§\n  ggplot(head(importance_df, 8), aes(x = reorder(Feature, Importance), y = Importance)) +\n    geom_bar(stat = \"identity\", fill = \"darkorange\", alpha = 0.7) +\n    labs(title = \"ç‰¹å¾é‡è¦æ€§ - éšæœºæ£®æ—\", x = \"ç‰¹å¾\", y = \"é‡è¦æ€§\") +\n    coord_flip() +\n    theme_minimal()\n} else {\n  cat(\"è¯¥å­¦ä¹ å™¨ä¸æ”¯æŒç‰¹å¾é‡è¦æ€§è®¡ç®—\\n\")\n}\n\nç‰¹å¾é‡è¦æ€§æ’åº:\n   Feature Importance\n1      ltg 1469.33233\n2      bmi 1457.20570\n3      map  464.11349\n4      tch  363.93017\n5      hdl  261.42699\n6       tc  156.66425\n7      ldl  135.23885\n8      glu  129.35189\n9      age   66.95241\n10     sex   65.88863\n\n\n\n\n\n\n\n\næ¨¡å‹é¢„æµ‹ä¸æ®‹å·®åˆ†æ\n\n# æ¨¡å‹é¢„æµ‹ä¸æ®‹å·®åˆ†æ\n\n# ä½¿ç”¨æœ€ä½³æ¨¡å‹è¿›è¡Œé¢„æµ‹\npredictions &lt;- learner_best$predict(task_preprocessed)\n\n# åˆ›å»ºé¢„æµ‹ç»“æœæ•°æ®æ¡†\nresults_df &lt;- data.frame(\n  Actual = predictions$truth,\n  Predicted = predictions$response,\n  Residual = predictions$truth - predictions$response\n)\n\n# é¢„æµ‹ vs å®é™…å€¼å›¾\np1 &lt;- ggplot(results_df, aes(x = Actual, y = Predicted)) +\n  geom_point(alpha = 0.6, color = \"steelblue\") +\n  geom_abline(slope = 1, intercept = 0, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"é¢„æµ‹å€¼ vs å®é™…å€¼\", x = \"å®é™…å€¼\", y = \"é¢„æµ‹å€¼\") +\n  theme_minimal()\n\n# æ®‹å·®å›¾\np2 &lt;- ggplot(results_df, aes(x = Predicted, y = Residual)) +\n  geom_point(alpha = 0.6, color = \"darkred\") +\n  geom_hline(yintercept = 0, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"æ®‹å·®åˆ†æ\", x = \"é¢„æµ‹å€¼\", y = \"æ®‹å·®\") +\n  theme_minimal()\n\ngrid.arrange(p1, p2, ncol = 2)",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>18</span>Â  <span class='chapter-title'>13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•</span>"
    ]
  },
  {
    "objectID": "chapters/13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•.html#python-sklearnæ¡†æ¶å›å½’",
    "href": "chapters/13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•.html#python-sklearnæ¡†æ¶å›å½’",
    "title": "13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•",
    "section": "13.2 Python (sklearnæ¡†æ¶)â€“å›å½’",
    "text": "13.2 Python (sklearnæ¡†æ¶)â€“å›å½’\næ•°æ®åŠ è½½ä¸æ¢ç´¢\n\n# ç»¼åˆæ¡ˆä¾‹ï¼šç³–å°¿ç—…è¿›å±•é¢„æµ‹ - Pythonè¯­è¨€å®ç° (sklearnæ¡†æ¶)\nimport sys\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.datasets import load_diabetes\nfrom sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso\nfrom sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error\nfrom sklearn.inspection import permutation_importance\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# è®¾ç½®å›¾å½¢æ ·å¼\nplt.style.use('default')\nsns.set_palette(\"husl\")\n\n# åŠ è½½ç³–å°¿ç—…æ•°æ®é›†\ndiabetes = pd.read_csv(\"data/diabetes.csv\")\nX = diabetes.iloc[:, :-2] # æ‰€æœ‰è¡Œï¼Œé™¤ç¬¬3åˆ—ï¼ˆbpï¼‰çš„æ‰€æœ‰åˆ—\ny = diabetes.iloc[:, -2]   # æ‰€æœ‰è¡Œï¼Œç¬¬3åˆ—\ndiabetes_data = pd.concat([X, y], axis=1)\n\nprint(\"æ•°æ®é›†åŸºæœ¬ä¿¡æ¯:\")\n\næ•°æ®é›†åŸºæœ¬ä¿¡æ¯:\n\nprint(f\"æ ·æœ¬æ•°: {diabetes_data.shape[0]}\")\n\næ ·æœ¬æ•°: 442\n\nprint(f\"å˜é‡æ•°: {diabetes_data.shape[1]}\")\n\nå˜é‡æ•°: 9\n\nprint(\"\\nå˜é‡åç§°:\")\n\n\nå˜é‡åç§°:\n\nprint(diabetes_data.columns.tolist())\n\n['age', 'sex', 'bmi', 'bp', 's1', 's2', 's3', 's4', 's5']\n\nprint(\"\\næ•°æ®æ¦‚è§ˆ:\")\n\n\næ•°æ®æ¦‚è§ˆ:\n\nprint(diabetes_data.describe())\n\n              age         sex         bmi  ...          s3          s4          s5\ncount  442.000000  442.000000  442.000000  ...  442.000000  442.000000  442.000000\nmean     0.000136    0.002149   -0.000136  ...    0.000204   -0.000362    0.000023\nstd      0.047790    0.044961    0.047771  ...    0.047320    0.047789    0.047545\nmin     -0.110000   -0.040000   -0.090000  ...   -0.100000   -0.080000   -0.130000\n25%     -0.037500   -0.040000   -0.030000  ...   -0.037500   -0.040000   -0.030000\n50%      0.010000   -0.040000   -0.010000  ...   -0.010000   -0.000000    0.000000\n75%      0.040000    0.050000    0.030000  ...    0.030000    0.030000    0.030000\nmax      0.110000    0.050000    0.170000  ...    0.180000    0.190000    0.130000\n\n[8 rows x 9 columns]\n\nprint(\"\\nç¼ºå¤±å€¼æ£€æŸ¥:\")\n\n\nç¼ºå¤±å€¼æ£€æŸ¥:\n\nprint(diabetes_data.isnull().sum())\n\nage    0\nsex    0\nbmi    0\nbp     0\ns1     0\ns2     0\ns3     0\ns4     0\ns5     0\ndtype: int64\n\n\næ•°æ®å¯è§†åŒ–åˆ†æ\n\n# æ•°æ®å¯è§†åŒ–åˆ†æ - Python\n\nfig, axes = plt.subplots(2, 2, figsize=(15, 12))\n\n# ç›®æ ‡å˜é‡åˆ†å¸ƒ\naxes[0,0].hist(diabetes_data['bp'], bins=30, color='steelblue', alpha=0.7)\naxes[0,0].set_title('ç–¾ç—…è¿›å±•åˆ†å¸ƒ')\naxes[0,0].set_xlabel('ç–¾ç—…è¿›å±•æŒ‡æ ‡')\naxes[0,0].set_ylabel('é¢‘æ•°')\n\n# ç–¾ç—…è¿›å±•ä¸å…³é”®å˜é‡çš„å…³ç³»\naxes[0,1].scatter(diabetes_data['bmi'], diabetes_data['bp'], alpha=0.6, color='darkred')\nz = np.polyfit(diabetes_data['bmi'], diabetes_data['bp'], 1)\np = np.poly1d(z)\naxes[0,1].plot(diabetes_data['bmi'], p(diabetes_data['bmi']), \"b-\", alpha=0.8)\naxes[0,1].set_title('BMIä¸ç–¾ç—…è¿›å±•å…³ç³»')\naxes[0,1].set_xlabel('BMI')\naxes[0,1].set_ylabel('ç–¾ç—…è¿›å±•')\n\naxes[1,0].scatter(diabetes_data['s5'], diabetes_data['bp'], alpha=0.6, color='darkgreen')\nz = np.polyfit(diabetes_data['s5'], diabetes_data['bp'], 1)\np = np.poly1d(z)\naxes[1,0].plot(diabetes_data['s5'], p(diabetes_data['s5']), \"r-\", alpha=0.8)\naxes[1,0].set_title('ç¨³å®šè¡€ç³–ä¸ç–¾ç—…è¿›å±•')\naxes[1,0].set_xlabel('ç¨³å®šè¡€ç³–')\naxes[1,0].set_ylabel('ç–¾ç—…è¿›å±•')\n\naxes[1,1].scatter(diabetes_data['age'], diabetes_data['bp'], alpha=0.6, color='purple')\nz = np.polyfit(diabetes_data['age'], diabetes_data['bp'], 1)\np = np.poly1d(z)\naxes[1,1].plot(diabetes_data['age'], p(diabetes_data['age']), \"orange\", alpha=0.8)\naxes[1,1].set_title('å¹´é¾„ä¸ç–¾ç—…è¿›å±•å…³ç³»')\naxes[1,1].set_xlabel('å¹´é¾„')\naxes[1,1].set_ylabel('ç–¾ç—…è¿›å±•')\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n# ç›¸å…³æ€§çƒ­å›¾\nplt.figure(figsize=(12, 10))\ncorr_matrix = diabetes_data.corr()\nsns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0,\n            square=True, linewidths=0.5, cbar_kws={\"shrink\": 0.8}, fmt='.2f')\nplt.title('å˜é‡ç›¸å…³æ€§çƒ­å›¾ - Python/sklearn')\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\næ•°æ®é¢„å¤„ç†\n\n# æ•°æ®é¢„å¤„ç† - Python\n\n# å‡†å¤‡ç‰¹å¾å’Œç›®æ ‡å˜é‡\nX = diabetes_data.drop('bp', axis=1)\ny = diabetes_data['bp']\n\n# æ•°æ®åˆ’åˆ†\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)\n\nprint(f\"è®­ç»ƒé›†å¤§å°: {X_train.shape[0]}\")\n\nè®­ç»ƒé›†å¤§å°: 309\n\nprint(f\"æµ‹è¯•é›†å¤§å°: {X_test.shape[0]}\")\n\næµ‹è¯•é›†å¤§å°: 133\n\n# æ•°æ®æ ‡å‡†åŒ–\nscaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.transform(X_test)\n\nprint(\"æ•°æ®é¢„å¤„ç†å®Œæˆ\")\n\næ•°æ®é¢„å¤„ç†å®Œæˆ\n\n\næ¨¡å‹è®­ç»ƒä¸æ¯”è¾ƒ\n\n# æ¨¡å‹è®­ç»ƒä¸æ¯”è¾ƒ - sklearn\n\n# å®šä¹‰æ¨¡å‹å­—å…¸\nmodels = {\n    'Linear Regression': LinearRegression(),\n    'Ridge Regression': Ridge(alpha=1.0),\n    'Lasso Regression': Lasso(alpha=0.1),\n    'Random Forest': RandomForestRegressor(n_estimators=100, random_state=42),\n    'Gradient Boosting': GradientBoostingRegressor(n_estimators=100, random_state=42),\n    'Support Vector Regression': SVR(kernel='rbf', C=1.0),\n    'K-Neighbors': KNeighborsRegressor(n_neighbors=5)\n}\n\n# è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹\nresults = []\n\nfor name, model in models.items():\n    # è®­ç»ƒæ¨¡å‹\n    model.fit(X_train_scaled, y_train)\n    \n    # é¢„æµ‹\n    y_pred = model.predict(X_test_scaled)\n    \n    # è®¡ç®—è¯„ä¼°æŒ‡æ ‡\n    mse = mean_squared_error(y_test, y_pred)\n    rmse = np.sqrt(mse)\n    mae = mean_absolute_error(y_test, y_pred)\n    r2 = r2_score(y_test, y_pred)\n    \n    # äº¤å‰éªŒè¯\n    cv_scores = cross_val_score(model, X_train_scaled, y_train, cv=5, scoring='neg_mean_squared_error')\n    cv_rmse = np.sqrt(-cv_scores.mean())\n    \n    results.append({\n        'Model': name,\n        'RMSE': rmse,\n        'MSE': mse,\n        'MAE': mae,\n        'R2': r2,\n        'CV_RMSE': cv_rmse\n    })\n\n\n\n\nKNeighborsRegressor()\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\nKNeighborsRegressor\n\n?Documentation for KNeighborsRegressoriFitted\nKNeighborsRegressor() \n\n\n# åˆ›å»ºç»“æœDataFrame\nresults_python = pd.DataFrame(results)\nprint(\"æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ - Python/sklearn:\")\n\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ - Python/sklearn:\n\nprint(results_python.sort_values('RMSE'))\n\n                       Model      RMSE       MSE       MAE        R2   CV_RMSE\n1           Ridge Regression  0.037728  0.001423  0.029903  0.346299  0.041949\n0          Linear Regression  0.037869  0.001434  0.030070  0.341403  0.041985\n3              Random Forest  0.039989  0.001599  0.032433  0.265591  0.044513\n4          Gradient Boosting  0.040339  0.001627  0.032044  0.252692  0.045652\n6                K-Neighbors  0.041668  0.001736  0.032857  0.202630  0.044115\n2           Lasso Regression  0.046838  0.002194  0.039821 -0.007507  0.048294\n5  Support Vector Regression  0.048922  0.002393  0.042729 -0.099178  0.050173\n\n# å¯è§†åŒ–æ¨¡å‹æ¯”è¾ƒ\nfig, axes = plt.subplots(1, 2, figsize=(15, 6))\n\n# RMSEæ¯”è¾ƒ\nmodels_sorted = results_python.sort_values('RMSE')\naxes[0].barh(models_sorted['Model'], models_sorted['RMSE'], color='lightcoral')\naxes[0].set_xlabel('RMSE')\naxes[0].set_title('æ¨¡å‹RMSEæ¯”è¾ƒ - Python/sklearn')\naxes[0].grid(axis='x', alpha=0.3)\n\n# RÂ²æ¯”è¾ƒ\naxes[1].barh(models_sorted['Model'], models_sorted['R2'], color='lightseagreen')\naxes[1].set_xlabel('RÂ²')\naxes[1].set_title('æ¨¡å‹RÂ²æ¯”è¾ƒ - Python/sklearn')\naxes[1].grid(axis='x', alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\nè¶…å‚æ•°è°ƒä¼˜\n\n# è¶…å‚æ•°è°ƒä¼˜ç¤ºä¾‹ - éšæœºæ£®æ—\n\n# å®šä¹‰å‚æ•°ç½‘æ ¼\nparam_grid = {\n    'n_estimators': [50, 100, 200],\n    'max_depth': [5, 10, 15],\n    'min_samples_split': [2, 5, 10],\n    'min_samples_leaf': [1, 2, 4]\n}\n\n# ä½¿ç”¨ç½‘æ ¼æœç´¢\nrf = RandomForestRegressor(random_state=42)\ngrid_search = GridSearchCV(rf, param_grid, cv=3, scoring='neg_mean_squared_error', \n                          n_jobs=-1, verbose=1)\n\nprint(\"å¼€å§‹è¶…å‚æ•°è°ƒä¼˜...\")\n\nå¼€å§‹è¶…å‚æ•°è°ƒä¼˜...\n\ngrid_search.fit(X_train_scaled, y_train)\n\n\n\n\nGridSearchCV(cv=3, estimator=RandomForestRegressor(random_state=42), n_jobs=-1,\n             param_grid={'max_depth': [5, 10, 15],\n                         'min_samples_leaf': [1, 2, 4],\n                         'min_samples_split': [2, 5, 10],\n                         'n_estimators': [50, 100, 200]},\n             scoring='neg_mean_squared_error', verbose=1)\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\n\nGridSearchCV\n\n?Documentation for GridSearchCViFitted\nGridSearchCV(cv=3, estimator=RandomForestRegressor(random_state=42), n_jobs=-1,\n             param_grid={'max_depth': [5, 10, 15],\n                         'min_samples_leaf': [1, 2, 4],\n                         'min_samples_split': [2, 5, 10],\n                         'n_estimators': [50, 100, 200]},\n             scoring='neg_mean_squared_error', verbose=1) \n\n\nbest_estimator_: RandomForestRegressorRandomForestRegressor(max_depth=5, min_samples_leaf=4, min_samples_split=10,\n                      n_estimators=50, random_state=42) \n\nRandomForestRegressor\n?Documentation for RandomForestRegressorRandomForestRegressor(max_depth=5, min_samples_leaf=4, min_samples_split=10,\n                      n_estimators=50, random_state=42) \n\n\n\n\nprint(\"æœ€ä½³å‚æ•°:\")\n\næœ€ä½³å‚æ•°:\n\nprint(grid_search.best_params_)\n\n{'max_depth': 5, 'min_samples_leaf': 4, 'min_samples_split': 10, 'n_estimators': 50}\n\nprint(f\"æœ€ä½³åˆ†æ•°: {-grid_search.best_score_:.4f}\")\n\næœ€ä½³åˆ†æ•°: 0.0019\n\n# ä½¿ç”¨æœ€ä½³å‚æ•°è®­ç»ƒæœ€ç»ˆæ¨¡å‹\nbest_rf = grid_search.best_estimator_\ny_pred_best = best_rf.predict(X_test_scaled)\nbest_rmse = np.sqrt(mean_squared_error(y_test, y_pred_best))\nprint(f\"è°ƒä¼˜åæµ‹è¯•é›†RMSE: {best_rmse:.4f}\")\n\nè°ƒä¼˜åæµ‹è¯•é›†RMSE: 0.0382\n\n\næ¨¡å‹è§£é‡Š\n\n# æ¨¡å‹è§£é‡Š - ç‰¹å¾é‡è¦æ€§\n\n# ä½¿ç”¨æœ€ä½³éšæœºæ£®æ—æ¨¡å‹\nfeature_importance = best_rf.feature_importances_\nfeature_names = X.columns\n\n# åˆ›å»ºç‰¹å¾é‡è¦æ€§DataFrame\nimportance_df = pd.DataFrame({\n    'Feature': feature_names,\n    'Importance': feature_importance\n}).sort_values('Importance', ascending=False)\n\nprint(\"ç‰¹å¾é‡è¦æ€§æ’åº - Python/sklearn:\")\n\nç‰¹å¾é‡è¦æ€§æ’åº - Python/sklearn:\n\nprint(importance_df)\n\n  Feature  Importance\n2     bmi    0.270091\n0     age    0.211172\n7      s5    0.200046\n3      s1    0.106677\n4      s2    0.076392\n5      s3    0.066895\n6      s4    0.038475\n1     sex    0.030252\n\n# å¯è§†åŒ–ç‰¹å¾é‡è¦æ€§\nplt.figure(figsize=(10, 6))\nsns.barplot(data=importance_df, x='Importance', y='Feature', palette='viridis')\nplt.title('ç‰¹å¾é‡è¦æ€§ - éšæœºæ£®æ— (Python/sklearn)')\nplt.xlabel('é‡è¦æ€§')\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n# æ’åˆ—é‡è¦æ€§\nperm_importance = permutation_importance(best_rf, X_test_scaled, y_test, \n                                        n_repeats=10, random_state=42)\n\nperm_importance_df = pd.DataFrame({\n    'Feature': feature_names,\n    'Importance': perm_importance.importances_mean\n}).sort_values('Importance', ascending=False)\n\nprint(\"\\næ’åˆ—ç‰¹å¾é‡è¦æ€§:\")\n\n\næ’åˆ—ç‰¹å¾é‡è¦æ€§:\n\nprint(perm_importance_df)\n\n  Feature  Importance\n2     bmi    0.160578\n0     age    0.152412\n7      s5    0.106752\n4      s2    0.034918\n1     sex    0.026204\n3      s1    0.012667\n6      s4    0.010379\n5      s3   -0.016267\n\n# å¯è§†åŒ–æ’åˆ—é‡è¦æ€§\nplt.figure(figsize=(10, 6))\nsns.barplot(data=perm_importance_df, x='Importance', y='Feature', palette='rocket')\nplt.title('æ’åˆ—ç‰¹å¾é‡è¦æ€§ - éšæœºæ£®æ— (Python/sklearn)')\nplt.xlabel('é‡è¦æ€§')\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\næ¨¡å‹é¢„æµ‹ä¸æ®‹å·®åˆ†æ\n\n# æ¨¡å‹é¢„æµ‹ä¸æ®‹å·®åˆ†æ\n\n# ä½¿ç”¨æœ€ä½³æ¨¡å‹è¿›è¡Œé¢„æµ‹\ny_pred = best_rf.predict(X_test_scaled)\nresiduals = y_test - y_pred\n\n# åˆ›å»ºé¢„æµ‹ç»“æœæ•°æ®æ¡†\nresults_df = pd.DataFrame({\n    'Actual': y_test,\n    'Predicted': y_pred,\n    'Residual': residuals\n})\n\n# é¢„æµ‹ vs å®é™…å€¼å›¾\nfig, axes = plt.subplots(1, 2, figsize=(15, 6))\n\naxes[0].scatter(results_df['Actual'], results_df['Predicted'], alpha=0.6, color='steelblue')\naxes[0].plot([results_df['Actual'].min(), results_df['Actual'].max()], \n            [results_df['Actual'].min(), results_df['Actual'].max()], \n            'r--', lw=2)\naxes[0].set_xlabel('å®é™…å€¼')\naxes[0].set_ylabel('é¢„æµ‹å€¼')\naxes[0].set_title('é¢„æµ‹å€¼ vs å®é™…å€¼')\naxes[0].grid(alpha=0.3)\n\n# æ®‹å·®å›¾\naxes[1].scatter(results_df['Predicted'], results_df['Residual'], alpha=0.6, color='darkred')\naxes[1].axhline(y=0, color='r', linestyle='--')\naxes[1].set_xlabel('é¢„æµ‹å€¼')\naxes[1].set_ylabel('æ®‹å·®')\naxes[1].set_title('æ®‹å·®åˆ†æ')\naxes[1].grid(alpha=0.3)\n\nplt.tight_layout()\nplt.show()",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>18</span>Â  <span class='chapter-title'>13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•</span>"
    ]
  },
  {
    "objectID": "chapters/13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•.html#æ¡ˆä¾‹æ€»ç»“",
    "href": "chapters/13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•.html#æ¡ˆä¾‹æ€»ç»“",
    "title": "13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•",
    "section": "13.3 æ¡ˆä¾‹æ€»ç»“",
    "text": "13.3 æ¡ˆä¾‹æ€»ç»“\nå…³é”®å‘ç°\n\n# æ¡ˆä¾‹æ€»ç»“ - Rè¯­è¨€\ncat(\"=== ç³–å°¿ç—…è¿›å±•é¢„æµ‹æ¡ˆä¾‹æ€»ç»“ ===\\n\")\n\n=== ç³–å°¿ç—…è¿›å±•é¢„æµ‹æ¡ˆä¾‹æ€»ç»“ ===\n\ncat(\"1. æ•°æ®ç‰¹å¾:\\n\")\n\n1. æ•°æ®ç‰¹å¾:\n\ncat(\"   - æ•°æ®é›†åŒ…å«\", nrow(diabetes_data), \"ä¸ªæ ·æœ¬ï¼Œ\", ncol(diabetes_data)-1, \"ä¸ªç‰¹å¾\\n\")\n\n   - æ•°æ®é›†åŒ…å« 442 ä¸ªæ ·æœ¬ï¼Œ 10 ä¸ªç‰¹å¾\n\ncat(\"   - ç›®æ ‡å˜é‡: ç–¾ç—…è¿›å±•æŒ‡æ ‡\\n\")\n\n   - ç›®æ ‡å˜é‡: ç–¾ç—…è¿›å±•æŒ‡æ ‡\n\ncat(\"   - æœ€é‡è¦çš„ç‰¹å¾: bmi, s5(ç¨³å®šè¡€ç³–), bp(è¡€å‹)\\n\\n\")\n\n   - æœ€é‡è¦çš„ç‰¹å¾: bmi, s5(ç¨³å®šè¡€ç³–), bp(è¡€å‹)\n\ncat(\"2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\\n\")\n\n2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n\nprint(results_r[order(RMSE)])\n\n               Model     RMSE      MSE      MAE        R2\n              &lt;char&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;     &lt;num&gt;\n1: linear_regression 54.32812 2959.818 44.08989 0.4992770\n2:     random_forest 56.24742 3175.846 46.10112 0.4634585\n3:               svm 57.29007 3286.445 44.91594 0.4431697\n4:               knn 61.63274 3808.714 48.02614 0.3550164\n5:           xgboost 63.20336 4017.177 50.00323 0.3230514\n\ncat(\"\\n3. æœ€ä½³å®è·µ:\\n\")\n\n\n3. æœ€ä½³å®è·µ:\n\ncat(\"   - æ ‘æ¨¡å‹åœ¨åŒ»ç–—æ•°æ®ä¸Šè¡¨ç°ä¼˜å¼‚\\n\")\n\n   - æ ‘æ¨¡å‹åœ¨åŒ»ç–—æ•°æ®ä¸Šè¡¨ç°ä¼˜å¼‚\n\ncat(\"   - ç‰¹å¾æ ‡å‡†åŒ–å¯¹æ¨¡å‹æ€§èƒ½è‡³å…³é‡è¦\\n\")\n\n   - ç‰¹å¾æ ‡å‡†åŒ–å¯¹æ¨¡å‹æ€§èƒ½è‡³å…³é‡è¦\n\ncat(\"   - è¶…å‚æ•°è°ƒä¼˜å¯ä»¥æ˜¾è‘—æå‡æ¨¡å‹æ€§èƒ½\\n\")\n\n   - è¶…å‚æ•°è°ƒä¼˜å¯ä»¥æ˜¾è‘—æå‡æ¨¡å‹æ€§èƒ½\n\ncat(\"   - æ¨¡å‹è§£é‡Šæ€§åœ¨åŒ»ç–—é¢†åŸŸå°¤ä¸ºé‡è¦\\n\")\n\n   - æ¨¡å‹è§£é‡Šæ€§åœ¨åŒ»ç–—é¢†åŸŸå°¤ä¸ºé‡è¦\n\n\n\n# æ¡ˆä¾‹æ€»ç»“ - Python\nprint(\"=== ç³–å°¿ç—…è¿›å±•é¢„æµ‹æ¡ˆä¾‹æ€»ç»“ ===\")\n\n=== ç³–å°¿ç—…è¿›å±•é¢„æµ‹æ¡ˆä¾‹æ€»ç»“ ===\n\nprint(\"1. æ•°æ®ç‰¹å¾:\")\n\n1. æ•°æ®ç‰¹å¾:\n\nprint(f\"   - æ•°æ®é›†åŒ…å« {diabetes_data.shape[0]} ä¸ªæ ·æœ¬ï¼Œ{diabetes_data.shape[1]-1} ä¸ªç‰¹å¾\")\n\n   - æ•°æ®é›†åŒ…å« 442 ä¸ªæ ·æœ¬ï¼Œ8 ä¸ªç‰¹å¾\n\nprint(\"   - ç›®æ ‡å˜é‡: ç–¾ç—…è¿›å±•æŒ‡æ ‡\")\n\n   - ç›®æ ‡å˜é‡: ç–¾ç—…è¿›å±•æŒ‡æ ‡\n\nprint(\"   - æœ€é‡è¦çš„ç‰¹å¾: bmi, s5, bp\\n\")\n\n   - æœ€é‡è¦çš„ç‰¹å¾: bmi, s5, bp\n\nprint(\"2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\")\n\n2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n\nprint(results_python[['Model', 'RMSE', 'R2']].sort_values('RMSE').to_string(index=False))\n\n                    Model     RMSE        R2\n         Ridge Regression 0.037728  0.346299\n        Linear Regression 0.037869  0.341403\n            Random Forest 0.039989  0.265591\n        Gradient Boosting 0.040339  0.252692\n              K-Neighbors 0.041668  0.202630\n         Lasso Regression 0.046838 -0.007507\nSupport Vector Regression 0.048922 -0.099178\n\nprint(\"\\n3. æœ€ä½³å®è·µ:\")\n\n\n3. æœ€ä½³å®è·µ:\n\nprint(\"   - é›†æˆå­¦ä¹ æ–¹æ³•åœ¨å›å½’é—®é¢˜ä¸Šè¡¨ç°ç¨³å®š\")\n\n   - é›†æˆå­¦ä¹ æ–¹æ³•åœ¨å›å½’é—®é¢˜ä¸Šè¡¨ç°ç¨³å®š\n\nprint(\"   - æ•°æ®é¢„å¤„ç†å¯¹æ¨¡å‹æ€§èƒ½å½±å“æ˜¾è‘—\")\n\n   - æ•°æ®é¢„å¤„ç†å¯¹æ¨¡å‹æ€§èƒ½å½±å“æ˜¾è‘—\n\nprint(\"   - äº¤å‰éªŒè¯æä¾›æ›´å¯é çš„æ€§èƒ½ä¼°è®¡\")\n\n   - äº¤å‰éªŒè¯æä¾›æ›´å¯é çš„æ€§èƒ½ä¼°è®¡\n\nprint(\"   - ç‰¹å¾é‡è¦æ€§åˆ†æå¢å¼ºæ¨¡å‹å¯è§£é‡Šæ€§\")\n\n   - ç‰¹å¾é‡è¦æ€§åˆ†æå¢å¼ºæ¨¡å‹å¯è§£é‡Šæ€§\n\n\næŠ€æœ¯è¦ç‚¹å›é¡¾\næ•°æ®é¢„å¤„ç†ï¼š - ç‰¹å¾æ ‡å‡†åŒ–ï¼šç¡®ä¿ä¸åŒå°ºåº¦çš„ç‰¹å¾å…·æœ‰å¯æ¯”æ€§ - ç¼ºå¤±å€¼å¤„ç†ï¼šæ ¹æ®æ•°æ®ç‰¹æ€§é€‰æ‹©åˆé€‚çš„å¡«å……ç­–ç•¥ - ç‰¹å¾å·¥ç¨‹ï¼šåˆ›å»ºæœ‰æ„ä¹‰çš„è¡ç”Ÿç‰¹å¾\næ¨¡å‹é€‰æ‹©ï¼š - çº¿æ€§æ¨¡å‹ï¼šå¯è§£é‡Šæ€§å¼ºï¼Œè®¡ç®—æ•ˆç‡é«˜ - æ ‘æ¨¡å‹ï¼šè‡ªåŠ¨å¤„ç†éçº¿æ€§å…³ç³»ï¼Œå¯¹å¼‚å¸¸å€¼ç¨³å¥ - é›†æˆæ–¹æ³•ï¼šé€šè¿‡æ¨¡å‹ç»„åˆæå‡é¢„æµ‹æ€§èƒ½\næ¨¡å‹è¯„ä¼°ï¼š - ä½¿ç”¨å¤šä¸ªè¯„ä¼°æŒ‡æ ‡ï¼ˆRMSE, MAE, RÂ²ï¼‰ - äº¤å‰éªŒè¯æä¾›ç¨³å¥çš„æ€§èƒ½ä¼°è®¡ - æµ‹è¯•é›†ç”¨äºæœ€ç»ˆæ¨¡å‹è¯„ä¼°\næ¨¡å‹ä¼˜åŒ–ï¼š - è¶…å‚æ•°è°ƒä¼˜ï¼šç½‘æ ¼æœç´¢ã€éšæœºæœç´¢ - ç‰¹å¾é€‰æ‹©ï¼šåŸºäºé‡è¦æ€§æˆ–é€’å½’æ¶ˆé™¤ - é›†æˆç­–ç•¥ï¼šBagging, Boosting, Stacking\nä¸šåŠ¡åº”ç”¨å»ºè®®\nåŒ»ç–—è¯Šæ–­ï¼šä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹å¯¹æ‚£è€…ç–¾ç—…è¿›å±•è¿›è¡Œé¢„æµ‹ æ²»ç–—æ–¹æ¡ˆåˆ¶å®šï¼šè¯†åˆ«å½±å“ç–¾ç—…è¿›å±•çš„å…³é”®å› ç´ ï¼ŒæŒ‡å¯¼æ²»ç–—ç­–ç•¥ æ‚£è€…ç®¡ç†ï¼šç†è§£ç”Ÿç†æŒ‡æ ‡å¯¹ç–¾ç—…çš„å½±å“ï¼Œæ”¯æŒæ‚£è€…ç®¡ç† é£é™©è¯„ä¼°ï¼šç›‘æµ‹ç–¾ç—…è¿›å±•é£é™©ï¼Œé¢„è­¦å¥åº·é—®é¢˜\né€šè¿‡æœ¬å›å½’æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä»æ•°æ®æ¢ç´¢åˆ°æ¨¡å‹éƒ¨ç½²çš„å®Œæ•´é¢„æµ‹å»ºæ¨¡æµç¨‹ï¼Œä¸ºè¯»è€…åœ¨å®é™…å·¥ä½œä¸­åº”ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•æä¾›äº†å®Œæ•´çš„å‚è€ƒæ¡†æ¶ã€‚",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>18</span>Â  <span class='chapter-title'>13 å›å½’ä»»åŠ¡ä¸åŸºå‡†æµ‹è¯•</span>"
    ]
  },
  {
    "objectID": "chapters/14 åˆ†ç±»ä»»åŠ¡.html",
    "href": "chapters/14 åˆ†ç±»ä»»åŠ¡.html",
    "title": "14 åˆ†ç±»ä»»åŠ¡",
    "section": "",
    "text": "åˆ†ç±»é—®é¢˜å¯¼è¯»\nåˆ†ç±»é—®é¢˜æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€å¸¸è§çš„ä»»åŠ¡ä¹‹ä¸€ï¼Œå¹¿æ³›åº”ç”¨äºç‰©ç§åˆ†ç±»ã€åŒ»ç–—è¯Šæ–­ã€å®¢æˆ·åˆ†ç±»ç­‰é¢†åŸŸã€‚æœ¬ç« å°†é€šè¿‡é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹ï¼Œå®Œæ•´å±•ç¤ºå¤šåˆ†ç±»é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæ¶µç›–æ•°æ®æ¢ç´¢ã€ç‰¹å¾å·¥ç¨‹ã€å¤šç§åˆ†ç±»ç®—æ³•æ¯”è¾ƒã€æ¨¡å‹è¯„ä¼°ç­‰å…³é”®ç¯èŠ‚ã€‚",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>14 åˆ†ç±»ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#benchmark",
    "href": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#benchmark",
    "title": "14 åˆ†ç±»ä»»åŠ¡",
    "section": "14.1 Benchmark",
    "text": "14.1 Benchmark\nmlr3æä¾›äº†å¼ºå¤§çš„BenchmarkåŠŸèƒ½ï¼Œå¯ä»¥ç³»ç»Ÿæ€§åœ°æ¯”è¾ƒå¤šä¸ªå­¦ä¹ å™¨åœ¨å¤šä¸ªä»»åŠ¡ä¸Šçš„æ€§èƒ½ã€‚\n\nlibrary(mlr3)\nlibrary(mlr3verse)\nlibrary(mlr3pipelines)\nlibrary(mlr3tuning)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(corrplot)\nlibrary(gridExtra)\nlibrary(patchwork)\nlibrary(paradox)\n# æŸ¥çœ‹mlråŒ…æ”¯æŒçš„å­¦ä¹ ç®—æ³•\nmlr_learners\n\n&lt;DictionaryLearner&gt; with 51 stored values\nKeys: classif.cv_glmnet, classif.debug, classif.featureless,\n  classif.glmnet, classif.kknn, classif.lda, classif.log_reg,\n  classif.multinom, classif.naive_bayes, classif.nnet, classif.qda,\n  classif.ranger, classif.rpart, classif.svm, classif.xgboost,\n  clust.agnes, clust.ap, clust.bico, clust.birch, clust.cmeans,\n  clust.cobweb, clust.dbscan, clust.dbscan_fpc, clust.diana, clust.em,\n  clust.fanny, clust.featureless, clust.ff, clust.hclust,\n  clust.hdbscan, clust.kkmeans, clust.kmeans, clust.MBatchKMeans,\n  clust.mclust, clust.meanshift, clust.optics, clust.pam,\n  clust.SimpleKMeans, clust.xmeans, regr.cv_glmnet, regr.debug,\n  regr.featureless, regr.glmnet, regr.kknn, regr.km, regr.lm,\n  regr.nnet, regr.ranger, regr.rpart, regr.svm, regr.xgboost\n\n\nåŠ è½½æ•°æ®ï¼Œå»ºç«‹ä»»åŠ¡\n\n# åˆ›å»ºå¤šä¸ªä»»åŠ¡ï¼ˆä¸åŒç‰¹å¾å­é›†ï¼‰\ndata(\"Ionosphere\", package = \"mlbench\")\nIonosphere_data &lt;- as.data.table(Ionosphere)\nIonosphere_data=Ionosphere_data[, -c(1, 2)]\nstr(Ionosphere_data )\n\nClasses 'data.table' and 'data.frame':  351 obs. of  33 variables:\n $ V3   : num  0.995 1 1 1 1 ...\n $ V4   : num  -0.0589 -0.1883 -0.0336 -0.4516 -0.024 ...\n $ V5   : num  0.852 0.93 1 1 0.941 ...\n $ V6   : num  0.02306 -0.36156 0.00485 1 0.06531 ...\n $ V7   : num  0.834 -0.109 1 0.712 0.921 ...\n $ V8   : num  -0.377 -0.936 -0.121 -1 -0.233 ...\n $ V9   : num  1 1 0.89 0 0.772 ...\n $ V10  : num  0.0376 -0.0455 0.012 0 -0.164 ...\n $ V11  : num  0.852 0.509 0.731 0 0.528 ...\n $ V12  : num  -0.1776 -0.6774 0.0535 0 -0.2028 ...\n $ V13  : num  0.598 0.344 0.854 0 0.564 ...\n $ V14  : num  -0.44945 -0.69707 0.00827 0 -0.00712 ...\n $ V15  : num  0.605 -0.517 0.546 -1 0.344 ...\n $ V16  : num  -0.38223 -0.97515 0.00299 0.14516 -0.27457 ...\n $ V17  : num  0.844 0.055 0.838 0.541 0.529 ...\n $ V18  : num  -0.385 -0.622 -0.136 -0.393 -0.218 ...\n $ V19  : num  0.582 0.331 0.755 -1 0.451 ...\n $ V20  : num  -0.3219 -1 -0.0854 -0.5447 -0.1781 ...\n $ V21  : num  0.5697 -0.1315 0.7089 -0.6997 0.0598 ...\n $ V22  : num  -0.297 -0.453 -0.275 1 -0.356 ...\n $ V23  : num  0.3695 -0.1806 0.4339 0 0.0231 ...\n $ V24  : num  -0.474 -0.357 -0.121 0 -0.529 ...\n $ V25  : num  0.5681 -0.2033 0.5753 1 0.0329 ...\n $ V26  : num  -0.512 -0.266 -0.402 0.907 -0.652 ...\n $ V27  : num  0.411 -0.205 0.59 0.516 0.133 ...\n $ V28  : num  -0.462 -0.184 -0.221 1 -0.532 ...\n $ V29  : num  0.2127 -0.1904 0.431 1 0.0243 ...\n $ V30  : num  -0.341 -0.116 -0.174 -0.201 -0.622 ...\n $ V31  : num  0.4227 -0.1663 0.6044 0.2568 -0.0571 ...\n $ V32  : num  -0.5449 -0.0629 -0.2418 1 -0.5957 ...\n $ V33  : num  0.1864 -0.1374 0.5605 -0.3238 -0.0461 ...\n $ V34  : num  -0.453 -0.0245 -0.3824 1 -0.657 ...\n $ Class: Factor w/ 2 levels \"bad\",\"good\": 2 1 2 1 2 1 2 1 2 1 ...\n - attr(*, \".internal.selfref\")=&lt;externalptr&gt; \n\ncat(\"\\nç¼ºå¤±å€¼æ£€æŸ¥:\\n\")\n\n\nç¼ºå¤±å€¼æ£€æŸ¥:\n\nmissing_counts &lt;- colSums(is.na(Ionosphere_data))\nprint(missing_counts)\n\n   V3    V4    V5    V6    V7    V8    V9   V10   V11   V12   V13   V14   V15 \n    0     0     0     0     0     0     0     0     0     0     0     0     0 \n  V16   V17   V18   V19   V20   V21   V22   V23   V24   V25   V26   V27   V28 \n    0     0     0     0     0     0     0     0     0     0     0     0     0 \n  V29   V30   V31   V32   V33   V34 Class \n    0     0     0     0     0     0     0 \n\ndata(\"Sonar\", package = \"mlbench\")\nsonar_data &lt;- as.data.table(Sonar)\ncat(\"\\nç¼ºå¤±å€¼æ£€æŸ¥:\\n\")\n\n\nç¼ºå¤±å€¼æ£€æŸ¥:\n\nmissing_sonar &lt;- colSums(is.na(sonar_data)) \nprint(missing_sonar)\n\n   V1    V2    V3    V4    V5    V6    V7    V8    V9   V10   V11   V12   V13 \n    0     0     0     0     0     0     0     0     0     0     0     0     0 \n  V14   V15   V16   V17   V18   V19   V20   V21   V22   V23   V24   V25   V26 \n    0     0     0     0     0     0     0     0     0     0     0     0     0 \n  V27   V28   V29   V30   V31   V32   V33   V34   V35   V36   V37   V38   V39 \n    0     0     0     0     0     0     0     0     0     0     0     0     0 \n  V40   V41   V42   V43   V44   V45   V46   V47   V48   V49   V50   V51   V52 \n    0     0     0     0     0     0     0     0     0     0     0     0     0 \n  V53   V54   V55   V56   V57   V58   V59   V60 Class \n    0     0     0     0     0     0     0     0     0 \n\nstr(sonar_data)\n\nClasses 'data.table' and 'data.frame':  208 obs. of  61 variables:\n $ V1   : num  0.02 0.0453 0.0262 0.01 0.0762 0.0286 0.0317 0.0519 0.0223 0.0164 ...\n $ V2   : num  0.0371 0.0523 0.0582 0.0171 0.0666 0.0453 0.0956 0.0548 0.0375 0.0173 ...\n $ V3   : num  0.0428 0.0843 0.1099 0.0623 0.0481 ...\n $ V4   : num  0.0207 0.0689 0.1083 0.0205 0.0394 ...\n $ V5   : num  0.0954 0.1183 0.0974 0.0205 0.059 ...\n $ V6   : num  0.0986 0.2583 0.228 0.0368 0.0649 ...\n $ V7   : num  0.154 0.216 0.243 0.11 0.121 ...\n $ V8   : num  0.16 0.348 0.377 0.128 0.247 ...\n $ V9   : num  0.3109 0.3337 0.5598 0.0598 0.3564 ...\n $ V10  : num  0.211 0.287 0.619 0.126 0.446 ...\n $ V11  : num  0.1609 0.4918 0.6333 0.0881 0.4152 ...\n $ V12  : num  0.158 0.655 0.706 0.199 0.395 ...\n $ V13  : num  0.2238 0.6919 0.5544 0.0184 0.4256 ...\n $ V14  : num  0.0645 0.7797 0.532 0.2261 0.4135 ...\n $ V15  : num  0.066 0.746 0.648 0.173 0.453 ...\n $ V16  : num  0.227 0.944 0.693 0.213 0.533 ...\n $ V17  : num  0.31 1 0.6759 0.0693 0.7306 ...\n $ V18  : num  0.3 0.887 0.755 0.228 0.619 ...\n $ V19  : num  0.508 0.802 0.893 0.406 0.203 ...\n $ V20  : num  0.48 0.782 0.862 0.397 0.464 ...\n $ V21  : num  0.578 0.521 0.797 0.274 0.415 ...\n $ V22  : num  0.507 0.405 0.674 0.369 0.429 ...\n $ V23  : num  0.433 0.396 0.429 0.556 0.573 ...\n $ V24  : num  0.555 0.391 0.365 0.485 0.54 ...\n $ V25  : num  0.671 0.325 0.533 0.314 0.316 ...\n $ V26  : num  0.641 0.32 0.241 0.533 0.229 ...\n $ V27  : num  0.71 0.327 0.507 0.526 0.7 ...\n $ V28  : num  0.808 0.277 0.853 0.252 1 ...\n $ V29  : num  0.679 0.442 0.604 0.209 0.726 ...\n $ V30  : num  0.386 0.203 0.851 0.356 0.472 ...\n $ V31  : num  0.131 0.379 0.851 0.626 0.51 ...\n $ V32  : num  0.26 0.295 0.504 0.734 0.546 ...\n $ V33  : num  0.512 0.198 0.186 0.612 0.288 ...\n $ V34  : num  0.7547 0.2341 0.2709 0.3497 0.0981 ...\n $ V35  : num  0.854 0.131 0.423 0.395 0.195 ...\n $ V36  : num  0.851 0.418 0.304 0.301 0.418 ...\n $ V37  : num  0.669 0.384 0.612 0.541 0.46 ...\n $ V38  : num  0.61 0.106 0.676 0.881 0.322 ...\n $ V39  : num  0.494 0.184 0.537 0.986 0.283 ...\n $ V40  : num  0.274 0.197 0.472 0.917 0.243 ...\n $ V41  : num  0.051 0.167 0.465 0.612 0.198 ...\n $ V42  : num  0.2834 0.0583 0.2587 0.5006 0.2444 ...\n $ V43  : num  0.282 0.14 0.213 0.321 0.185 ...\n $ V44  : num  0.4256 0.1628 0.2222 0.3202 0.0841 ...\n $ V45  : num  0.2641 0.0621 0.2111 0.4295 0.0692 ...\n $ V46  : num  0.1386 0.0203 0.0176 0.3654 0.0528 ...\n $ V47  : num  0.1051 0.053 0.1348 0.2655 0.0357 ...\n $ V48  : num  0.1343 0.0742 0.0744 0.1576 0.0085 ...\n $ V49  : num  0.0383 0.0409 0.013 0.0681 0.023 0.0264 0.0507 0.0285 0.0777 0.0092 ...\n $ V50  : num  0.0324 0.0061 0.0106 0.0294 0.0046 0.0081 0.0159 0.0178 0.0439 0.0198 ...\n $ V51  : num  0.0232 0.0125 0.0033 0.0241 0.0156 0.0104 0.0195 0.0052 0.0061 0.0118 ...\n $ V52  : num  0.0027 0.0084 0.0232 0.0121 0.0031 0.0045 0.0201 0.0081 0.0145 0.009 ...\n $ V53  : num  0.0065 0.0089 0.0166 0.0036 0.0054 0.0014 0.0248 0.012 0.0128 0.0223 ...\n $ V54  : num  0.0159 0.0048 0.0095 0.015 0.0105 0.0038 0.0131 0.0045 0.0145 0.0179 ...\n $ V55  : num  0.0072 0.0094 0.018 0.0085 0.011 0.0013 0.007 0.0121 0.0058 0.0084 ...\n $ V56  : num  0.0167 0.0191 0.0244 0.0073 0.0015 0.0089 0.0138 0.0097 0.0049 0.0068 ...\n $ V57  : num  0.018 0.014 0.0316 0.005 0.0072 0.0057 0.0092 0.0085 0.0065 0.0032 ...\n $ V58  : num  0.0084 0.0049 0.0164 0.0044 0.0048 0.0027 0.0143 0.0047 0.0093 0.0035 ...\n $ V59  : num  0.009 0.0052 0.0095 0.004 0.0107 0.0051 0.0036 0.0048 0.0059 0.0056 ...\n $ V60  : num  0.0032 0.0044 0.0078 0.0117 0.0094 0.0062 0.0103 0.0053 0.0022 0.004 ...\n $ Class: Factor w/ 2 levels \"M\",\"R\": 2 2 2 2 2 2 2 2 2 2 ...\n - attr(*, \".internal.selfref\")=&lt;externalptr&gt; \n\ntask_Ionosphere &lt;- as_task_classif(Ionosphere_data, target = \"Class\", id = \"Ionosphere\")\n\ntask_sonar &lt;- as_task_classif(sonar_data, target = \"Class\", id = \"sonar\")\n\ntasks = list(task_Ionosphere, task_sonar)\n\n\n# å®šä¹‰å­¦ä¹ å™¨\nlearners_extended &lt;- list(\n  lrn(\"classif.ranger\", id = \"random_forest\", predict_type = \"prob\"),\n  lrn(\"classif.xgboost\", id = \"xgboost\", predict_type = \"prob\"),\n  lrn(\"classif.svm\", id = \"svm\", predict_type = \"prob\"),\n  lrn(\"classif.kknn\", id = \"knn\", predict_type = \"prob\"),\n  lrn(\"classif.naive_bayes\", id = \"naive_bayes\", predict_type = \"prob\"),\n  lrn(\"classif.rpart\", id = \"decision_tree\", predict_type = \"prob\")\n)\n\n# è®¾ç½®ä¸åŒçš„é‡é‡‡æ ·ç­–ç•¥\nresamplings &lt;- list(\n  cv5 = rsmp(\"cv\", folds = 5),\n  cv10 = rsmp(\"cv\", folds = 10),\n  holdout = rsmp(\"holdout\", ratio = 0.7),\n  bootstrap = rsmp(\"bootstrap\", repeats = 5)\n)\n\n# åˆ›å»ºBenchmarkè®¾è®¡\ndesign_extended &lt;- benchmark_grid(\n  tasks = tasks,\n  learners = learners_extended,\n  resamplings = resamplings[1]  # ä½¿ç”¨5æŠ˜äº¤å‰éªŒè¯ä»¥èŠ‚çœæ—¶é—´\n)\n\n# æ‰§è¡ŒBenchmark\ncat(\"å¼€å§‹æ‰©å±•Benchmarkåˆ†æ...\\n\")\n\nå¼€å§‹æ‰©å±•Benchmarkåˆ†æ...\n\nbmr_extended &lt;- benchmark(design_extended, store_models = TRUE)\n\n# æ€§èƒ½æ±‡æ€»\ncat(\"\\n=== Benchmarkæ€§èƒ½æ±‡æ€» ===\\n\")\n\n\n=== Benchmarkæ€§èƒ½æ±‡æ€» ===\n\nmeasures_all &lt;- msrs(c(\"classif.acc\", \"classif.auc\", \"classif.bacc\", \"classif.ce\"))\nbmr_results &lt;- bmr_extended$aggregate(measures_all)\n\n# æ ¼å¼åŒ–ç»“æœ\nresults_detailed &lt;- bmr_results[, .(\n  Task = task_id,\n  Model = learner_id,\n  Resampling = resampling_id,\n  Accuracy = classif.acc,\n  AUC = classif.auc,\n  Balanced_Accuracy = classif.bacc,\n  LogLoss = classif.ce\n)]\n\nprint(results_detailed[order(Task, -Accuracy)])\n\n          Task         Model Resampling  Accuracy       AUC Balanced_Accuracy\n        &lt;char&gt;        &lt;char&gt;     &lt;char&gt;     &lt;num&gt;     &lt;num&gt;             &lt;num&gt;\n 1: Ionosphere           svm         cv 0.9487324 0.9820820         0.9416321\n 2: Ionosphere       xgboost         cv 0.9344064 0.9789980         0.9212549\n 3: Ionosphere random_forest         cv 0.9287726 0.9809080         0.9201580\n 4: Ionosphere decision_tree         cv 0.8661972 0.9103794         0.8434849\n 5: Ionosphere           knn         cv 0.8575453 0.9175268         0.8081414\n 6: Ionosphere   naive_bayes         cv 0.8317907 0.9387509         0.8439733\n 7:      sonar           knn         cv 0.8465738 0.9374191         0.8419655\n 8:      sonar       xgboost         cv 0.8270616 0.8975745         0.8279575\n 9:      sonar           svm         cv 0.8222997 0.9348429         0.8153992\n10:      sonar random_forest         cv 0.8173055 0.9216941         0.8148226\n11:      sonar decision_tree         cv 0.7312427 0.7541301         0.7269468\n12:      sonar   naive_bayes         cv 0.6880372 0.7953927         0.6973016\n       LogLoss\n         &lt;num&gt;\n 1: 0.05126761\n 2: 0.06559356\n 3: 0.07122736\n 4: 0.13380282\n 5: 0.14245473\n 6: 0.16820926\n 7: 0.15342625\n 8: 0.17293844\n 9: 0.17770035\n10: 0.18269454\n11: 0.26875726\n12: 0.31196283\n\n# æŒ‰ä»»åŠ¡åˆ†ç»„ç»Ÿè®¡\ncat(\"\\n=== æŒ‰ä»»åŠ¡åˆ†ç»„çš„æ€§èƒ½ç»Ÿè®¡ ===\\n\")\n\n\n=== æŒ‰ä»»åŠ¡åˆ†ç»„çš„æ€§èƒ½ç»Ÿè®¡ ===\n\ntask_stats &lt;- results_detailed[, .(\n  Mean_Accuracy = mean(Accuracy),\n  Std_Accuracy = sd(Accuracy),\n  Best_Model = .SD[which.max(Accuracy)]$Model,\n  Best_Accuracy = max(Accuracy)\n), by = Task]\n\nprint(task_stats)\n\n         Task Mean_Accuracy Std_Accuracy Best_Model Best_Accuracy\n       &lt;char&gt;         &lt;num&gt;        &lt;num&gt;     &lt;char&gt;         &lt;num&gt;\n1: Ionosphere     0.8945741   0.04859508        svm     0.9487324\n2:      sonar     0.7887534   0.06356495        knn     0.8465738\n\n\nBenchmarkç»“æœå¯è§†åŒ–\n\n# Benchmarkç»“æœå¯è§†åŒ–\n\n# 1. æŒ‰ä»»åŠ¡å’Œæ¨¡å‹çš„å‡†ç¡®ç‡çƒ­å›¾\naccuracy_matrix &lt;- dcast(results_detailed, Model ~ Task, value.var = \"Accuracy\")\nprint(\"å‡†ç¡®ç‡çŸ©é˜µ:\")\n\n[1] \"å‡†ç¡®ç‡çŸ©é˜µ:\"\n\nprint(accuracy_matrix)\n\nKey: &lt;Model&gt;\n           Model Ionosphere     sonar\n          &lt;char&gt;      &lt;num&gt;     &lt;num&gt;\n1: decision_tree  0.8661972 0.7312427\n2:           knn  0.8575453 0.8465738\n3:   naive_bayes  0.8317907 0.6880372\n4: random_forest  0.9287726 0.8173055\n5:           svm  0.9487324 0.8222997\n6:       xgboost  0.9344064 0.8270616\n\n# å¯è§†åŒ–çƒ­å›¾\nheatmap_data &lt;- as.matrix(accuracy_matrix[, -1])\nrownames(heatmap_data) &lt;- accuracy_matrix$Model\n\nlibrary(reshape2)\nheatmap_df &lt;- melt(accuracy_matrix, id.vars = \"Model\", \n                   variable.name = \"Task\", value.name = \"Accuracy\")\n\np1 &lt;- ggplot(heatmap_df, aes(x = Task, y = Model, fill = Accuracy)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = round(Accuracy, 3)), color = \"black\", size = 3) +\n  scale_fill_gradient2(low = \"red\", mid = \"white\", high = \"blue\", midpoint = 0.9) +\n  labs(title = \"æ¨¡å‹åœ¨ä¸åŒä»»åŠ¡ä¸Šçš„å‡†ç¡®ç‡çƒ­å›¾\", \n       x = \"ä»»åŠ¡\", y = \"æ¨¡å‹\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n# 2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒç®±çº¿å›¾\np2 &lt;- ggplot(results_detailed, aes(x = reorder(Model, Accuracy), y = Accuracy, fill = Model)) +\n  geom_boxplot(alpha = 0.7) +\n  geom_jitter(width = 0.2, alpha = 0.5) +\n  labs(title = \"æ¨¡å‹æ€§èƒ½åˆ†å¸ƒ\", x = \"æ¨¡å‹\", y = \"å‡†ç¡®ç‡\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"none\") +\n  coord_flip()\n\n# 3. ä»»åŠ¡æ€§èƒ½æ¯”è¾ƒ\np3 &lt;- ggplot(results_detailed, aes(x = Task, y = Accuracy, fill = Task)) +\n  geom_boxplot(alpha = 0.7) +\n  labs(title = \"ä¸åŒä»»åŠ¡çš„æ€§èƒ½æ¯”è¾ƒ\", x = \"ä»»åŠ¡\", y = \"å‡†ç¡®ç‡\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n# ç»„åˆå›¾å½¢\nlibrary(patchwork)\n(p1) / (p2 | p3)\n\n\n\n\n\n\n\nç»Ÿè®¡æ˜¾è‘—æ€§æ£€éªŒ\n\n# ç»Ÿè®¡æ˜¾è‘—æ€§æ£€éªŒ\n\n# æå–æ‰€æœ‰resampleç»“æœçš„é¢„æµ‹\npredictions_all &lt;- bmr_extended$score()\n\n# æŸ¥çœ‹æå–çš„ç»“æœç»“æ„\nstr(predictions_all, max.level = 1)\n\nClasses 'bmr_score', 'data.table' and 'data.frame': 60 obs. of  11 variables:\n $ uhash          : chr  \"26694fa8-5dd4-4c77-bffe-1f67cad81b9a\" \"26694fa8-5dd4-4c77-bffe-1f67cad81b9a\" \"26694fa8-5dd4-4c77-bffe-1f67cad81b9a\" \"26694fa8-5dd4-4c77-bffe-1f67cad81b9a\" ...\n $ nr             : int  1 1 1 1 1 2 2 2 2 2 ...\n $ task           :List of 60\n $ task_id        : chr  \"Ionosphere\" \"Ionosphere\" \"Ionosphere\" \"Ionosphere\" ...\n $ learner        :List of 60\n $ learner_id     : chr  \"random_forest\" \"random_forest\" \"random_forest\" \"random_forest\" ...\n $ resampling     :List of 60\n $ resampling_id  : chr  \"cv\" \"cv\" \"cv\" \"cv\" ...\n $ iteration      : int  1 2 3 4 5 1 2 3 4 5 ...\n $ prediction_test:List of 60\n $ classif.ce     : num  0.0704 0.0286 0.0714 0.1 0.0857 ...\n - attr(*, \".internal.selfref\")=&lt;externalptr&gt; \n\n# æå–å…·ä½“çš„é¢„æµ‹å¯¹è±¡\npredictions_list &lt;- predictions_all$prediction\n\n# Friedmanæ£€éªŒ - æ¯”è¾ƒå¤šä¸ªæ¨¡å‹çš„æ€§èƒ½\nif (requireNamespace(\"scmamp\", quietly = TRUE)) {\n  library(scmamp)\n  \n  # å‡†å¤‡æ•°æ®ç”¨äºFriedmanæ£€éªŒ\n  accuracy_matrix &lt;- dcast(results_detailed, Task ~ Model, value.var = \"Accuracy\")\n  accuracy_data &lt;- as.matrix(accuracy_matrix[, -1])\n  \n  cat(\"\\n=== Friedmanæ£€éªŒ ===\\n\")\n  friedman_test &lt;- friedmanTest(accuracy_data)\n  print(friedman_test)\n  \n  if (friedman_test$p.value &lt; 0.05) {\n    cat(\"æ¨¡å‹é—´å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼Œè¿›è¡Œäº‹åæ£€éªŒ...\\n\")\n    \n    # Nemenyiäº‹åæ£€éªŒ\n    nemenyi_test &lt;- nemenyiTest(accuracy_data)\n    print(nemenyi_test)\n    \n    # å¯è§†åŒ–CDå›¾\n    plotCD(accuracy_data, alpha = 0.05)\n  } else {\n    cat(\"æ¨¡å‹é—´æ— æ˜¾è‘—å·®å¼‚\\n\")\n  }\n} else {\n  cat(\"scmampåŒ…æœªå®‰è£…ï¼Œè·³è¿‡ç»Ÿè®¡æ£€éªŒ\\n\")\n}\n\nscmampåŒ…æœªå®‰è£…ï¼Œè·³è¿‡ç»Ÿè®¡æ£€éªŒ\n\n# ç®€å•çš„æˆå¯¹tæ£€éªŒ\ncat(\"\\n=== æœ€ä½³æ¨¡å‹ vs å…¶ä»–æ¨¡å‹çš„æˆå¯¹tæ£€éªŒ ===\\n\")\n\n\n=== æœ€ä½³æ¨¡å‹ vs å…¶ä»–æ¨¡å‹çš„æˆå¯¹tæ£€éªŒ ===\n\nbest_model &lt;- results_detailed[which.max(Accuracy)]$Model\nbest_accuracies &lt;- results_detailed[Model == best_model]$Accuracy\n\nfor (model in unique(results_detailed$Model)) {\n  if (model != best_model) {\n    model_accuracies &lt;- results_detailed[Model == model]$Accuracy\n    t_test &lt;- t.test(best_accuracies, model_accuracies, paired = TRUE)\n    cat(sprintf(\"%s vs %s: p-value = %.4f\\n\", best_model, model, t_test$p.value))\n  }\n}\n\nsvm vs random_forest: p-value = 0.3439\nsvm vs xgboost: p-value = 0.7043\nsvm vs knn: p-value = 0.6656\nsvm vs naive_bayes: p-value = 0.0438\nsvm vs decision_tree: p-value = 0.0312",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>14 åˆ†ç±»ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#benchmarkåˆ†ææ€»ç»“",
    "href": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#benchmarkåˆ†ææ€»ç»“",
    "title": "14 åˆ†ç±»ä»»åŠ¡",
    "section": "14.2 Benchmarkåˆ†ææ€»ç»“",
    "text": "14.2 Benchmarkåˆ†ææ€»ç»“\nmlr3 Benchmarkä¼˜åŠ¿\nç»Ÿä¸€çš„æ¥å£ï¼šbenchmark()å‡½æ•°æä¾›ç»Ÿä¸€çš„Benchmarkæ¥å£ çµæ´»çš„è®¾è®¡ï¼šæ”¯æŒå¤šä¸ªä»»åŠ¡ã€å­¦ä¹ å™¨ã€é‡é‡‡æ ·ç­–ç•¥çš„ç»„åˆ å†…ç½®å­˜å‚¨ï¼šå¯ä»¥å­˜å‚¨æ¨¡å‹å’Œé¢„æµ‹ç»“æœç”¨äºåç»­åˆ†æ ä¸°å¯Œçš„ç»“æœï¼šè‡ªåŠ¨è®¡ç®—å¤šä¸ªè¯„ä¼°æŒ‡æ ‡ ç»Ÿè®¡æ£€éªŒï¼šå†…ç½®Friedmanæ£€éªŒç­‰ç»Ÿè®¡æ–¹æ³•\næœ€ä½³å®è·µå»ºè®®\nç³»ç»ŸåŒ–æ¯”è¾ƒï¼šåœ¨é¡¹ç›®åˆæœŸè¿›è¡Œå…¨é¢çš„Benchmarkåˆ†æ å¤šç»´åº¦è¯„ä¼°ï¼šè€ƒè™‘å‡†ç¡®ç‡ã€è®­ç»ƒæ—¶é—´ã€å¯è§£é‡Šæ€§ç­‰å¤šä¸ªç»´åº¦ ç»Ÿè®¡éªŒè¯ï¼šä½¿ç”¨ç»Ÿè®¡æ£€éªŒéªŒè¯æ€§èƒ½å·®å¼‚çš„æ˜¾è‘—æ€§ ä¸šåŠ¡å¯¼å‘ï¼šæ ¹æ®å…·ä½“ä¸šåŠ¡éœ€æ±‚é€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹ å¯é‡å¤æ€§ï¼šè®¾ç½®éšæœºç§å­ç¡®ä¿ç»“æœå¯é‡å¤\nè¿™æ ·çš„Benchmarkåˆ†æä¸ºæ¨¡å‹é€‰æ‹©æä¾›äº†ç§‘å­¦ä¾æ®ï¼Œç¡®ä¿é€‰æ‹©çš„æ¨¡å‹ä¸ä»…åœ¨æµ‹è¯•é›†ä¸Šè¡¨ç°å¥½ï¼Œè€Œä¸”å…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§ã€‚",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>14 åˆ†ç±»ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#rè¯­è¨€å¤šåˆ†ç±»",
    "href": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#rè¯­è¨€å¤šåˆ†ç±»",
    "title": "14 åˆ†ç±»ä»»åŠ¡",
    "section": "14.4 Rè¯­è¨€â€“å¤šåˆ†ç±»",
    "text": "14.4 Rè¯­è¨€â€“å¤šåˆ†ç±»\næ•°æ®é›†è¯´æ˜ æœ¬æ¡ˆä¾‹ä½¿ç”¨ç»å…¸çš„é¸¢å°¾èŠ±æ•°æ®é›†ï¼ˆIris Datasetï¼‰ï¼ŒåŒ…å«ä¸‰ç§é¸¢å°¾èŠ±çš„è¼ç‰‡å’ŒèŠ±ç“£æµ‹é‡æ•°æ®ã€‚ ç›®æ ‡ï¼šé¢„æµ‹é¸¢å°¾èŠ±çš„ç§ç±»ï¼ˆSpeciesï¼‰ä»»åŠ¡ç±»å‹ï¼šå¤šåˆ†ç±»é—®é¢˜ï¼ˆ3ä¸ªç±»åˆ«ï¼‰ä¸šåŠ¡ä»·å€¼ï¼šæ¤ç‰©åˆ†ç±»ã€ç‰©ç§è¯†åˆ«\næ•°æ®åŠ è½½ä¸æ¢ç´¢\n\n# ç»¼åˆæ¡ˆä¾‹ï¼šé¸¢å°¾èŠ±åˆ†ç±» - Rè¯­è¨€å®ç° (mlr3æ¡†æ¶)\n\n# åŠ è½½å¿…è¦çš„åŒ…\nlibrary(mlr3)\nlibrary(mlr3verse)\nlibrary(mlr3pipelines)\nlibrary(mlr3tuning)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(corrplot)\nlibrary(gridExtra)\nlibrary(patchwork)\n\n# åŠ è½½é¸¢å°¾èŠ±æ•°æ®é›†\ndata(\"iris\", package = \"datasets\")\niris_data &lt;- as.data.table(iris)\n\n# æ•°æ®åŸºæœ¬ä¿¡æ¯\nstr(iris_data)\n\nClasses 'data.table' and 'data.frame':  150 obs. of  5 variables:\n $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n $ Species     : Factor w/ 3 levels \"setosa\",\"versicolor\",..: 1 1 1 1 1 1 1 1 1 1 ...\n - attr(*, \".internal.selfref\")=&lt;externalptr&gt; \n\n# æ£€æŸ¥ç¼ºå¤±å€¼\ncat(\"\\nç¼ºå¤±å€¼æ£€æŸ¥:\\n\")\n\n\nç¼ºå¤±å€¼æ£€æŸ¥:\n\nprint(colSums(is.na(iris_data)))\n\nSepal.Length  Sepal.Width Petal.Length  Petal.Width      Species \n           0            0            0            0            0 \n\n\næ•°æ®å¯è§†åŒ–åˆ†æ\n\n# æ•°æ®å¯è§†åŒ–åˆ†æ - Rè¯­è¨€\n\n# ç±»åˆ«åˆ†å¸ƒ\np1 &lt;- ggplot(iris_data, aes(x = Species, fill = Species)) +\n  geom_bar(alpha = 0.7) +\n  scale_fill_brewer(palette = \"Set1\") +\n  labs(title = \"ç±»åˆ«åˆ†å¸ƒ\", x = \"é¸¢å°¾èŠ±ç§ç±»\", y = \"æ•°é‡\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n# èŠ±è¼é•¿åº¦ä¸å®½åº¦çš„å…³ç³»\np2 &lt;- ggplot(iris_data, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +\n  geom_point(alpha = 0.7, size = 2) +\n  scale_color_brewer(palette = \"Set1\") +\n  labs(title = \"èŠ±è¼é•¿åº¦ vs å®½åº¦\", x = \"èŠ±è¼é•¿åº¦\", y = \"èŠ±è¼å®½åº¦\") +\n  theme_minimal()\n\n# èŠ±ç“£é•¿åº¦ä¸å®½åº¦çš„å…³ç³»\np3 &lt;- ggplot(iris_data, aes(x = Petal.Length, y = Petal.Width, color = Species)) +\n  geom_point(alpha = 0.7, size = 2) +\n  scale_color_brewer(palette = \"Set1\") +\n  labs(title = \"èŠ±ç“£é•¿åº¦ vs å®½åº¦\", x = \"èŠ±ç“£é•¿åº¦\", y = \"èŠ±ç“£å®½åº¦\") +\n  theme_minimal()\n\n# ç‰¹å¾åˆ†å¸ƒç®±çº¿å›¾\np4 &lt;- ggplot(iris_data, aes(x = Species, y = Petal.Length, fill = Species)) +\n  geom_boxplot(alpha = 0.7) +\n  scale_fill_brewer(palette = \"Set1\") +\n  labs(title = \"èŠ±ç“£é•¿åº¦åˆ†å¸ƒ\", x = \"é¸¢å°¾èŠ±ç§ç±»\", y = \"èŠ±ç“£é•¿åº¦\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n# ç»„åˆå›¾å½¢\n(p1 + p2) / (p3 + p4)\n\n\n\n\n\n\n\nåˆ›å»ºmlr3ä»»åŠ¡å’Œæ•°æ®é¢„å¤„ç†\n\n# åˆ›å»ºmlr3ä»»åŠ¡å’Œæ•°æ®é¢„å¤„ç†\n\n# åˆ›å»ºåˆ†ç±»ä»»åŠ¡\ntask_iris &lt;- as_task_classif(iris_data, target = \"Species\", id = \"iris\",store_backends=TRUE)\n\n# æŸ¥çœ‹ä»»åŠ¡ä¿¡æ¯\ncat(\"ä»»åŠ¡ä¿¡æ¯:\\n\")\n\nä»»åŠ¡ä¿¡æ¯:\n\nprint(task_iris)\n\n\nâ”€â”€ &lt;TaskClassif&gt; (150x5) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâ€¢ Target: Species\nâ€¢ Target classes: setosa (33%), versicolor (33%), virginica (33%)\nâ€¢ Properties: multiclass\nâ€¢ Features (4):\n  â€¢ dbl (4): Petal.Length, Petal.Width, Sepal.Length, Sepal.Width\n\n# æ•°æ®é¢„å¤„ç†ç®¡é“\npreprocess_pipeline &lt;- po(\"scale\") %&gt;&gt;% \n  po(\"encode\") %&gt;&gt;%\n  po(\"colapply\", applicator = as.numeric)\n\n# åº”ç”¨é¢„å¤„ç†\ntask_preprocessed &lt;- preprocess_pipeline$train(task_iris)[[1]]\n\ncat(\"\\né¢„å¤„ç†åçš„ä»»åŠ¡ä¿¡æ¯:\\n\")\n\n\né¢„å¤„ç†åçš„ä»»åŠ¡ä¿¡æ¯:\n\nprint(task_preprocessed)\n\n\nâ”€â”€ &lt;TaskClassif&gt; (150x5) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nâ€¢ Target: Species\nâ€¢ Target classes: setosa (33%), versicolor (33%), virginica (33%)\nâ€¢ Properties: multiclass\nâ€¢ Features (4):\n  â€¢ dbl (4): Petal.Length, Petal.Width, Sepal.Length, Sepal.Width\n\n\næ¨¡å‹è®­ç»ƒä¸æ¯”è¾ƒ\n\n# æ¨¡å‹è®­ç»ƒä¸æ¯”è¾ƒ - mlr3\n\n# å®šä¹‰å­¦ä¹ å™¨\nlearners &lt;- list(\n  lrn(\"classif.ranger\", id = \"random_forest\", predict_type = \"prob\"),\n  lrn(\"classif.xgboost\", id = \"xgboost\", predict_type = \"prob\"),\n  lrn(\"classif.svm\", id = \"svm\", predict_type = \"prob\"),\n  lrn(\"classif.kknn\", id = \"knn\", predict_type = \"prob\")\n)\n\n# è®¾ç½®äº¤å‰éªŒè¯å’Œè¯„ä¼°æŒ‡æ ‡\nresampling &lt;- rsmp(\"cv\", folds = 5)\nmeasures &lt;- msrs(c(\"classif.acc\", \"classif.auc\", \"classif.bacc\", \"classif.ce\"))\n\n# åŸºå‡†æµ‹è¯•\ndesign &lt;- benchmark_grid(\n  tasks = task_preprocessed,\n  learners = learners,\n  resamplings = resampling\n)\n\nbmr &lt;- benchmark(design,store_backends=TRUE)\n\n# æ€§èƒ½è¯„ä¼°\ncat(\"æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\\n\")\n\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n\nbmr_aggregated &lt;- bmr$aggregate(measures)\n\n# æ ¼å¼åŒ–è¾“å‡ºç»“æœ\nresults_r &lt;- bmr_aggregated[, .(\n  Model = learner_id,\n  Accuracy = classif.acc,\n  AUC = classif.auc,\n  Balanced_Accuracy = classif.bacc,\n  LogLoss = classif.ce\n)]\n\nprint(results_r[order(-Accuracy)])\n\n           Model  Accuracy   AUC Balanced_Accuracy    LogLoss\n          &lt;char&gt;     &lt;num&gt; &lt;num&gt;             &lt;num&gt;      &lt;num&gt;\n1: random_forest 0.9600000   NaN         0.9587542 0.04000000\n2:           svm 0.9600000   NaN         0.9582492 0.04000000\n3:       xgboost 0.9533333   NaN         0.9520875 0.04666667\n4:           knn 0.9466667   NaN         0.9460269 0.05333333\n\n# æ€§èƒ½å¯è§†åŒ–\nggplot(results_r, aes(x = reorder(Model, Accuracy), y = Accuracy)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\", alpha = 0.7) +\n  labs(title = \"æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ (å‡†ç¡®ç‡) - R/mlr3\", x = \"æ¨¡å‹\", y = \"å‡†ç¡®ç‡\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  ylim(0, 1)\n\n\n\n\n\n\n\nè¶…å‚æ•°è°ƒä¼˜\n\n# è¶…å‚æ•°è°ƒä¼˜ç¤ºä¾‹ - éšæœºæ£®æ—\nlibrary(mlr3)           # æ ¸å¿ƒ\nlibrary(mlr3learners)   # å­¦ä¹ å™¨\nlibrary(mlr3tuning)     # å‚æ•°è°ƒä¼˜ï¼ˆåŒ…å« tnr()ï¼‰\nlibrary(paradox)        # å‚æ•°ç©ºé—´\nlibrary(mlr3viz)        # å¯è§†åŒ–\n# å®šä¹‰éšæœºæ£®æ—å­¦ä¹ å™¨\nlearner_rf_tune &lt;- lrn(\"classif.ranger\", predict_type = \"prob\", num.trees = 100)\n\n# å®šä¹‰è¶…å‚æ•°ç©ºé—´\nparam_set &lt;- ps(\n  mtry = p_int(lower = 1, upper = ncol(iris_data) - 1),\n  min.node.size = p_int(lower = 1, upper = 10),\n  sample.fraction = p_dbl(lower = 0.6, upper = 0.9)\n)\n\n# å®šä¹‰è°ƒä¼˜å™¨\ntuner &lt;- tnr(\"grid_search\", resolution = 5)\nterminator &lt;- trm(\"evals\", n_evals = 10)\n\n# è‡ªåŠ¨è°ƒä¼˜\nat &lt;- auto_tuner(\n  tuner = tuner,\n  learner = learner_rf_tune,\n  resampling = rsmp(\"holdout\"),\n  measure = msr(\"classif.ce\"),\n  search_space = param_set,\n  terminator = terminator\n)\n\n# åœ¨æ•°æ®ä¸Šæ¼”ç¤ºè°ƒä¼˜\nset.seed(123)\nat$train(task_preprocessed)\n\ncat(\"æœ€ä½³å‚æ•°:\\n\")\n\næœ€ä½³å‚æ•°:\n\nprint(at$tuning_result)\n\n    mtry min.node.size sample.fraction learner_param_vals  x_domain classif.ce\n   &lt;int&gt;         &lt;int&gt;           &lt;num&gt;             &lt;list&gt;    &lt;list&gt;      &lt;num&gt;\n1:     2             3             0.6          &lt;list[5]&gt; &lt;list[3]&gt;       0.04\n\n# ä½¿ç”¨è°ƒä¼˜åçš„æ¨¡å‹è¿›è¡Œé¢„æµ‹\npredictions_tuned &lt;- at$predict(task_preprocessed)\ncat(\"è°ƒä¼˜å®Œæˆ\\n\")\n\nè°ƒä¼˜å®Œæˆ\n\ncat(\"è°ƒä¼˜åæ¨¡å‹å‡†ç¡®ç‡:\", predictions_tuned$score(msr(\"classif.acc\")), \"\\n\")\n\nè°ƒä¼˜åæ¨¡å‹å‡†ç¡®ç‡: 0.9733333 \n\n\næ¨¡å‹è§£é‡Š\n\n# æ¨¡å‹è§£é‡Š - ç‰¹å¾é‡è¦æ€§\nlibrary(ggplot2)\n# è®­ç»ƒæœ€ä½³æ¨¡å‹ï¼ˆéšæœºæ£®æ—ï¼‰\nset.seed(123)\nlearner_best &lt;- lrn(\"classif.ranger\", predict_type = \"prob\", importance = \"permutation\")\nlearner_best$train(task_preprocessed)\n\n# ç‰¹å¾é‡è¦æ€§\nif (!is.null(learner_best$importance)) {\n  feature_importance &lt;- learner_best$importance()\n  importance_df &lt;- data.frame(\n    Feature = names(feature_importance),\n    Importance = as.numeric(feature_importance)\n  )\n  importance_df &lt;- importance_df[order(-importance_df$Importance), ]\n  \n  cat(\"ç‰¹å¾é‡è¦æ€§æ’åº:\\n\")\n  print(importance_df)\n  \n  # å¯è§†åŒ–ç‰¹å¾é‡è¦æ€§\n  ggplot(importance_df, aes(x = reorder(Feature, Importance), y = Importance)) +\n    geom_bar(stat = \"identity\", fill = \"darkorange\", alpha = 0.7) +\n    labs(title = \"ç‰¹å¾é‡è¦æ€§ - éšæœºæ£®æ—\", x = \"ç‰¹å¾\", y = \"é‡è¦æ€§\") +\n    coord_flip() +\n    theme_minimal()\n} else {\n  cat(\"è¯¥å­¦ä¹ å™¨ä¸æ”¯æŒç‰¹å¾é‡è¦æ€§è®¡ç®—\\n\")\n}\n\nç‰¹å¾é‡è¦æ€§æ’åº:\n       Feature  Importance\n1  Petal.Width 0.296006354\n2 Petal.Length 0.292785833\n3 Sepal.Length 0.033216550\n4  Sepal.Width 0.006679592\n\n\n\n\n\n\n\n\næ¨¡å‹è¯„ä¼°ä¸æ··æ·†çŸ©é˜µ\n\n# æ¨¡å‹è¯„ä¼°ä¸æ··æ·†çŸ©é˜µ\n\n# ä½¿ç”¨æœ€ä½³æ¨¡å‹è¿›è¡Œé¢„æµ‹\npredictions &lt;- learner_best$predict(task_preprocessed)\n\n# æ··æ·†çŸ©é˜µ\ncat(\"æ··æ·†çŸ©é˜µ:\\n\")\n\næ··æ·†çŸ©é˜µ:\n\nprint(predictions$confusion)\n\n            truth\nresponse     setosa versicolor virginica\n  setosa         50          0         0\n  versicolor      0         48         1\n  virginica       0          2        49",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>14 åˆ†ç±»ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#pythonå¤šåˆ†ç±»",
    "href": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#pythonå¤šåˆ†ç±»",
    "title": "14 åˆ†ç±»ä»»åŠ¡",
    "section": "14.5 Pythonâ€“å¤šåˆ†ç±»",
    "text": "14.5 Pythonâ€“å¤šåˆ†ç±»\næ•°æ®åŠ è½½ä¸æ¢ç´¢\n\n# ç»¼åˆæ¡ˆä¾‹ï¼šé¸¢å°¾èŠ±åˆ†ç±» - Pythonè¯­è¨€å®ç° (sklearnæ¡†æ¶)\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV, StratifiedKFold\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import (accuracy_score, precision_score, recall_score, f1_score, \n                           roc_auc_score, confusion_matrix, classification_report, \n                           roc_curve, auc)\nfrom sklearn.inspection import permutation_importance\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# è®¾ç½®å›¾å½¢æ ·å¼\nplt.style.use('default')\nsns.set_palette(\"husl\")\n\n# åŠ è½½é¸¢å°¾èŠ±æ•°æ®é›†\niris = load_iris()\nX = pd.DataFrame(iris.data, columns=iris.feature_names)\ny = pd.Series(iris.target, name='species')\niris_data = pd.concat([X, y], axis=1)\n\n# æ˜ å°„æ•°å­—æ ‡ç­¾åˆ°ç±»åˆ«åç§°\ntarget_names = iris.target_names\niris_data['species_name'] = iris_data['species'].map(lambda x: target_names[x])\n\nprint(\"æ•°æ®é›†åŸºæœ¬ä¿¡æ¯:\")\n\næ•°æ®é›†åŸºæœ¬ä¿¡æ¯:\n\nprint(f\"æ ·æœ¬æ•°: {iris_data.shape[0]}\")\n\næ ·æœ¬æ•°: 150\n\nprint(f\"å˜é‡æ•°: {iris_data.shape[1]}\")\n\nå˜é‡æ•°: 6\n\nprint(\"\\nå˜é‡åç§°:\")\n\n\nå˜é‡åç§°:\n\nprint(iris_data.columns.tolist())\n\n['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)', 'species', 'species_name']\n\n# ç±»åˆ«åˆ†å¸ƒ\nprint(\"\\nç±»åˆ«åˆ†å¸ƒ:\")\n\n\nç±»åˆ«åˆ†å¸ƒ:\n\nclass_dist = iris_data['species_name'].value_counts()\nprint(class_dist)\n\nspecies_name\nsetosa        50\nversicolor    50\nvirginica     50\nName: count, dtype: int64\n\nprint(\"\\nç±»åˆ«æ¯”ä¾‹:\")\n\n\nç±»åˆ«æ¯”ä¾‹:\n\nprint(class_dist / class_dist.sum())\n\nspecies_name\nsetosa        0.333333\nversicolor    0.333333\nvirginica     0.333333\nName: count, dtype: float64\n\nprint(\"\\næ•°æ®æ¦‚è§ˆ:\")\n\n\næ•°æ®æ¦‚è§ˆ:\n\nprint(iris_data.describe())\n\n       sepal length (cm)  sepal width (cm)  ...  petal width (cm)     species\ncount         150.000000        150.000000  ...        150.000000  150.000000\nmean            5.843333          3.057333  ...          1.199333    1.000000\nstd             0.828066          0.435866  ...          0.762238    0.819232\nmin             4.300000          2.000000  ...          0.100000    0.000000\n25%             5.100000          2.800000  ...          0.300000    0.000000\n50%             5.800000          3.000000  ...          1.300000    1.000000\n75%             6.400000          3.300000  ...          1.800000    2.000000\nmax             7.900000          4.400000  ...          2.500000    2.000000\n\n[8 rows x 5 columns]\n\nprint(\"\\nç¼ºå¤±å€¼æ£€æŸ¥:\")\n\n\nç¼ºå¤±å€¼æ£€æŸ¥:\n\nprint(iris_data.isnull().sum())\n\nsepal length (cm)    0\nsepal width (cm)     0\npetal length (cm)    0\npetal width (cm)     0\nspecies              0\nspecies_name         0\ndtype: int64\n\n\næ•°æ®å¯è§†åŒ–åˆ†æ\n\n# æ•°æ®å¯è§†åŒ–åˆ†æ - Python\n\nfig, axes = plt.subplots(2, 2, figsize=(15, 12))\n\n# ç±»åˆ«åˆ†å¸ƒ\nclass_counts = iris_data['species_name'].value_counts()\naxes[0,0].bar(class_counts.index, class_counts.values, color=['steelblue', 'darkorange', 'darkgreen'], alpha=0.7)\naxes[0,0].set_title('ç±»åˆ«åˆ†å¸ƒ')\naxes[0,0].set_ylabel('æ•°é‡')\naxes[0,0].tick_params(axis='x', rotation=45)\n\n# èŠ±è¼é•¿åº¦ä¸å®½åº¦çš„å…³ç³»\nspecies_colors = {'setosa': 'red', 'versicolor': 'green', 'virginica': 'blue'}\nfor species in iris_data['species_name'].unique():\n    species_data = iris_data[iris_data['species_name'] == species]\n    axes[0,1].scatter(species_data['sepal length (cm)'], species_data['sepal width (cm)'], \n                     label=species, alpha=0.7, s=60)\naxes[0,1].set_title('èŠ±è¼é•¿åº¦ vs å®½åº¦')\naxes[0,1].set_xlabel('èŠ±è¼é•¿åº¦ (cm)')\naxes[0,1].set_ylabel('èŠ±è¼å®½åº¦ (cm)')\naxes[0,1].legend()\n\n# èŠ±ç“£é•¿åº¦ä¸å®½åº¦çš„å…³ç³»\nfor species in iris_data['species_name'].unique():\n    species_data = iris_data[iris_data['species_name'] == species]\n    axes[1,0].scatter(species_data['petal length (cm)'], species_data['petal width (cm)'], \n                     label=species, alpha=0.7, s=60)\naxes[1,0].set_title('èŠ±ç“£é•¿åº¦ vs å®½åº¦')\naxes[1,0].set_xlabel('èŠ±ç“£é•¿åº¦ (cm)')\naxes[1,0].set_ylabel('èŠ±ç“£å®½åº¦ (cm)')\naxes[1,0].legend()\n\n# ç‰¹å¾åˆ†å¸ƒç®±çº¿å›¾\nfeature_data = iris_data.melt(id_vars=['species_name'], \n                             value_vars=['sepal length (cm)', 'sepal width (cm)', \n                                       'petal length (cm)', 'petal width (cm)'])\nsns.boxplot(data=feature_data, x='variable', y='value', hue='species_name', ax=axes[1,1])\naxes[1,1].set_title('ç‰¹å¾åˆ†å¸ƒæ¯”è¾ƒ')\naxes[1,1].set_xlabel('ç‰¹å¾')\naxes[1,1].set_ylabel('å€¼')\naxes[1,1].tick_params(axis='x', rotation=45)\naxes[1,1].legend(bbox_to_anchor=(1.05, 1), loc='upper left')\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n# ç›¸å…³æ€§çƒ­å›¾\nplt.figure(figsize=(10, 8))\ncorr_matrix = iris_data[['sepal length (cm)', 'sepal width (cm)', \n                        'petal length (cm)', 'petal width (cm)', 'species']].corr()\nsns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0,\n            square=True, linewidths=0.5, cbar_kws={\"shrink\": 0.8}, fmt='.2f')\nplt.title('å˜é‡ç›¸å…³æ€§çƒ­å›¾ - Python/sklearn')\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\næ•°æ®é¢„å¤„ç†\n\n# æ•°æ®é¢„å¤„ç† - Python\n\n# å‡†å¤‡ç‰¹å¾å’Œç›®æ ‡å˜é‡\nX = iris_data[['sepal length (cm)', 'sepal width (cm)', \n               'petal length (cm)', 'petal width (cm)']]\ny = iris_data['species']\n\n# æ•°æ®åˆ’åˆ†ï¼ˆåˆ†å±‚æŠ½æ ·ä¿æŒç±»åˆ«æ¯”ä¾‹ï¼‰\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.3, random_state=42, stratify=y\n)\n\nprint(f\"è®­ç»ƒé›†å¤§å°: {X_train.shape[0]}\")\n\nè®­ç»ƒé›†å¤§å°: 105\n\nprint(f\"æµ‹è¯•é›†å¤§å°: {X_test.shape[0]}\")\n\næµ‹è¯•é›†å¤§å°: 45\n\nprint(f\"è®­ç»ƒé›†ç±»åˆ«åˆ†å¸ƒ:\\n{y_train.value_counts().sort_index()}\")\n\nè®­ç»ƒé›†ç±»åˆ«åˆ†å¸ƒ:\nspecies\n0    35\n1    35\n2    35\nName: count, dtype: int64\n\nprint(f\"æµ‹è¯•é›†ç±»åˆ«åˆ†å¸ƒ:\\n{y_test.value_counts().sort_index()}\")\n\næµ‹è¯•é›†ç±»åˆ«åˆ†å¸ƒ:\nspecies\n0    15\n1    15\n2    15\nName: count, dtype: int64\n\n# æ•°æ®æ ‡å‡†åŒ–\nscaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.transform(X_test)\n\nprint(\"æ•°æ®é¢„å¤„ç†å®Œæˆ\")\n\næ•°æ®é¢„å¤„ç†å®Œæˆ\n\n\næ¨¡å‹è®­ç»ƒä¸æ¯”è¾ƒ\n\n# æ¨¡å‹è®­ç»ƒä¸æ¯”è¾ƒ - sklearn\n\n# å®šä¹‰æ¨¡å‹å­—å…¸\nmodels = {\n    'Logistic Regression': LogisticRegression(random_state=42, max_iter=1000),\n    'Random Forest': RandomForestClassifier(random_state=42),\n    'K-Neighbors': KNeighborsClassifier(),\n    'Gradient Boosting': GradientBoostingClassifier(random_state=42)\n}\n\n# è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹\nresults = []\n\nfor name, model in models.items():\n    # è®­ç»ƒæ¨¡å‹\n    model.fit(X_train_scaled, y_train)\n    \n    # é¢„æµ‹\n    y_pred = model.predict(X_test_scaled)\n    y_pred_proba = model.predict_proba(X_test_scaled)\n    \n    # è®¡ç®—è¯„ä¼°æŒ‡æ ‡\n    accuracy = accuracy_score(y_test, y_pred)\n    precision = precision_score(y_test, y_pred, average='weighted')\n    recall = recall_score(y_test, y_pred, average='weighted')\n    f1 = f1_score(y_test, y_pred, average='weighted')\n    \n    # å¤šç±»AUCï¼ˆOne-vs-Restï¼‰\n    try:\n        auc_score = roc_auc_score(y_test, y_pred_proba, multi_class='ovr')\n    except:\n        auc_score = np.nan\n    \n    # äº¤å‰éªŒè¯\n    cv = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\n    cv_scores = cross_val_score(model, X_train_scaled, y_train, cv=cv, scoring='accuracy')\n    cv_accuracy_mean = cv_scores.mean()\n    \n    results.append({\n        'Model': name,\n        'Accuracy': accuracy,\n        'Precision': precision,\n        'Recall': recall,\n        'F1_Score': f1,\n        'AUC': auc_score,\n        'CV_Accuracy': cv_accuracy_mean\n    })\n\n\n\n\nGradientBoostingClassifier(random_state=42)\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\nGradientBoostingClassifier\n\n?Documentation for GradientBoostingClassifieriFitted\nGradientBoostingClassifier(random_state=42) \n\n\n# åˆ›å»ºç»“æœDataFrame\nresults_python = pd.DataFrame(results)\nprint(\"æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ - Python/sklearn:\")\n\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ - Python/sklearn:\n\nprint(results_python.sort_values('Accuracy', ascending=False))\n\n                 Model  Accuracy  Precision  ...  F1_Score       AUC  CV_Accuracy\n3    Gradient Boosting  0.933333   0.944444  ...  0.932660  0.998519     0.961905\n0  Logistic Regression  0.911111   0.915535  ...  0.910714  0.995556     0.980952\n2          K-Neighbors  0.911111   0.929825  ...  0.909502  0.988889     0.942857\n1        Random Forest  0.888889   0.898148  ...  0.887767  0.992593     0.952381\n\n[4 rows x 7 columns]\n\n# å¯è§†åŒ–æ¨¡å‹æ¯”è¾ƒ\nfig, axes = plt.subplots(2, 2, figsize=(15, 10))\n\n# å‡†ç¡®ç‡æ¯”è¾ƒ\nmodels_sorted_acc = results_python.sort_values('Accuracy')\naxes[0,0].barh(models_sorted_acc['Model'], models_sorted_acc['Accuracy'], color='steelblue')\naxes[0,0].set_xlabel('å‡†ç¡®ç‡')\naxes[0,0].set_title('æ¨¡å‹å‡†ç¡®ç‡æ¯”è¾ƒ - Python/sklearn')\naxes[0,0].set_xlim(0.8, 1.0)\n\n(0.8, 1.0)\n\naxes[0,0].grid(axis='x', alpha=0.3)\n\n# F1åˆ†æ•°æ¯”è¾ƒ\nmodels_sorted_f1 = results_python.sort_values('F1_Score')\naxes[0,1].barh(models_sorted_f1['Model'], models_sorted_f1['F1_Score'], color='darkorange')\naxes[0,1].set_xlabel('F1åˆ†æ•°')\naxes[0,1].set_title('æ¨¡å‹F1åˆ†æ•°æ¯”è¾ƒ - Python/sklearn')\naxes[0,1].set_xlim(0.8, 1.0)\n\n(0.8, 1.0)\n\naxes[0,1].grid(axis='x', alpha=0.3)\n\n# AUCæ¯”è¾ƒ\nmodels_sorted_auc = results_python.sort_values('AUC')\naxes[1,0].barh(models_sorted_auc['Model'], models_sorted_auc['AUC'], color='darkgreen')\naxes[1,0].set_xlabel('AUC')\naxes[1,0].set_title('æ¨¡å‹AUCæ¯”è¾ƒ - Python/sklearn')\naxes[1,0].set_xlim(0.8, 1.0)\n\n(0.8, 1.0)\n\naxes[1,0].grid(axis='x', alpha=0.3)\n\n# äº¤å‰éªŒè¯å‡†ç¡®ç‡æ¯”è¾ƒ\nmodels_sorted_cv = results_python.sort_values('CV_Accuracy')\naxes[1,1].barh(models_sorted_cv['Model'], models_sorted_cv['CV_Accuracy'], color='darkred')\naxes[1,1].set_xlabel('äº¤å‰éªŒè¯å‡†ç¡®ç‡')\naxes[1,1].set_title('äº¤å‰éªŒè¯å‡†ç¡®ç‡æ¯”è¾ƒ - Python/sklearn')\naxes[1,1].set_xlim(0.8, 1.0)\n\n(0.8, 1.0)\n\naxes[1,1].grid(axis='x', alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\nè¯¦ç»†æ¨¡å‹è¯„ä¼°\n\n# è¯¦ç»†æ¨¡å‹è¯„ä¼° - æœ€ä½³æ¨¡å‹\n\n# é€‰æ‹©æœ€ä½³æ¨¡å‹ï¼ˆåŸºäºå‡†ç¡®ç‡ï¼‰\nbest_model_name = results_python.loc[results_python['Accuracy'].idxmax(), 'Model']\nbest_model = models[best_model_name]\n\nprint(f\"æœ€ä½³æ¨¡å‹: {best_model_name}\")\n\næœ€ä½³æ¨¡å‹: Gradient Boosting\n\n# é‡æ–°è®­ç»ƒæœ€ä½³æ¨¡å‹\nbest_model.fit(X_train_scaled, y_train)\n\n\n\n\nGradientBoostingClassifier(random_state=42)\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\nGradientBoostingClassifier\n\n?Documentation for GradientBoostingClassifieriFitted\nGradientBoostingClassifier(random_state=42) \n\n\n# é¢„æµ‹\ny_pred_best = best_model.predict(X_test_scaled)\ny_pred_proba_best = best_model.predict_proba(X_test_scaled)\n\n# æ··æ·†çŸ©é˜µ\ncm = confusion_matrix(y_test, y_pred_best)\nprint(\"\\næ··æ·†çŸ©é˜µ:\")\n\n\næ··æ·†çŸ©é˜µ:\n\nprint(cm)\n\n[[15  0  0]\n [ 0 15  0]\n [ 0  3 12]]\n\n# åˆ†ç±»æŠ¥å‘Š\nprint(\"\\nåˆ†ç±»æŠ¥å‘Š:\")\n\n\nåˆ†ç±»æŠ¥å‘Š:\n\nprint(classification_report(y_test, y_pred_best, target_names=target_names))\n\n              precision    recall  f1-score   support\n\n      setosa       1.00      1.00      1.00        15\n  versicolor       0.83      1.00      0.91        15\n   virginica       1.00      0.80      0.89        15\n\n    accuracy                           0.93        45\n   macro avg       0.94      0.93      0.93        45\nweighted avg       0.94      0.93      0.93        45\n\n# å¯è§†åŒ–æ··æ·†çŸ©é˜µ\nplt.figure(figsize=(8, 6))\nsns.heatmap(cm, annot=True, fmt='d', cmap='Blues', \n            xticklabels=target_names, yticklabels=target_names)\nplt.title(f'æ··æ·†çŸ©é˜µ - {best_model_name}')\nplt.xlabel('é¢„æµ‹æ ‡ç­¾')\nplt.ylabel('çœŸå®æ ‡ç­¾')\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\nç‰¹å¾é‡è¦æ€§åˆ†æ\n\n# ç‰¹å¾é‡è¦æ€§åˆ†æ - Python\n\nif hasattr(best_model, 'feature_importances_'):\n    feature_importance = best_model.feature_importances_\n    feature_names = X.columns\n    \n    # åˆ›å»ºç‰¹å¾é‡è¦æ€§DataFrame\n    importance_df = pd.DataFrame({\n        'Feature': feature_names,\n        'Importance': feature_importance\n    }).sort_values('Importance', ascending=False)\n    \n    print(\"ç‰¹å¾é‡è¦æ€§æ’åº - Python/sklearn:\")\n    print(importance_df)\n    \n    # å¯è§†åŒ–ç‰¹å¾é‡è¦æ€§\n    plt.figure(figsize=(10, 6))\n    sns.barplot(data=importance_df, x='Importance', y='Feature', palette='viridis')\n    plt.title(f'ç‰¹å¾é‡è¦æ€§ - {best_model_name} (Python/sklearn)')\n    plt.xlabel('é‡è¦æ€§')\n    plt.tight_layout()\n    plt.show()\n\nelse:\n    print(f\"{best_model_name} ä¸æ”¯æŒç‰¹å¾é‡è¦æ€§è®¡ç®—\")\n    \n    # ä½¿ç”¨æ’åˆ—é‡è¦æ€§ä½œä¸ºæ›¿ä»£\n    perm_importance = permutation_importance(\n        best_model, X_test_scaled, y_test, n_repeats=10, random_state=42\n    )\n    \n    perm_importance_df = pd.DataFrame({\n        'Feature': feature_names,\n        'Importance': perm_importance.importances_mean\n    }).sort_values('Importance', ascending=False)\n    \n    print(\"\\næ’åˆ—ç‰¹å¾é‡è¦æ€§:\")\n    print(perm_importance_df)\n    \n    # å¯è§†åŒ–æ’åˆ—é‡è¦æ€§\n    plt.figure(figsize=(10, 6))\n    sns.barplot(data=perm_importance_df, x='Importance', y='Feature', palette='rocket')\n    plt.title(f'æ’åˆ—ç‰¹å¾é‡è¦æ€§ - {best_model_name} (Python/sklearn)')\n    plt.xlabel('é‡è¦æ€§')\n    plt.tight_layout()\n    plt.show()",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>14 åˆ†ç±»ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#å¤šåˆ†ç±»æ¡ˆä¾‹æ€»ç»“",
    "href": "chapters/14 åˆ†ç±»ä»»åŠ¡.html#å¤šåˆ†ç±»æ¡ˆä¾‹æ€»ç»“",
    "title": "14 åˆ†ç±»ä»»åŠ¡",
    "section": "14.6 å¤šåˆ†ç±»æ¡ˆä¾‹æ€»ç»“",
    "text": "14.6 å¤šåˆ†ç±»æ¡ˆä¾‹æ€»ç»“\nå…³é”®å‘ç°\n\n# æ¡ˆä¾‹æ€»ç»“ - Rè¯­è¨€\ncat(\"=== é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹æ€»ç»“ ===\\n\")\n\n=== é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹æ€»ç»“ ===\n\ncat(\"1. æ•°æ®ç‰¹å¾:\\n\")\n\n1. æ•°æ®ç‰¹å¾:\n\ncat(\"   - æ•°æ®é›†åŒ…å«\", nrow(iris_data), \"ä¸ªæ ·æœ¬ï¼Œ\", ncol(iris_data)-1, \"ä¸ªç‰¹å¾\\n\")\n\n   - æ•°æ®é›†åŒ…å« 150 ä¸ªæ ·æœ¬ï¼Œ 4 ä¸ªç‰¹å¾\n\ncat(\"   - ç›®æ ‡å˜é‡: é¸¢å°¾èŠ±ç§ç±»(3ä¸ªç±»åˆ«)\\n\")\n\n   - ç›®æ ‡å˜é‡: é¸¢å°¾èŠ±ç§ç±»(3ä¸ªç±»åˆ«)\n\ncat(\"   - ç±»åˆ«åˆ†å¸ƒå‡è¡¡\\n\")\n\n   - ç±»åˆ«åˆ†å¸ƒå‡è¡¡\n\ncat(\"   - æœ€é‡è¦çš„ç‰¹å¾: èŠ±ç“£é•¿åº¦å’Œå®½åº¦\\n\\n\")\n\n   - æœ€é‡è¦çš„ç‰¹å¾: èŠ±ç“£é•¿åº¦å’Œå®½åº¦\n\ncat(\"2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\\n\")\n\n2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n\nprint(results_r[order(-Accuracy)])\n\n           Model  Accuracy   AUC Balanced_Accuracy    LogLoss\n          &lt;char&gt;     &lt;num&gt; &lt;num&gt;             &lt;num&gt;      &lt;num&gt;\n1: random_forest 0.9600000   NaN         0.9587542 0.04000000\n2:           svm 0.9600000   NaN         0.9582492 0.04000000\n3:       xgboost 0.9533333   NaN         0.9520875 0.04666667\n4:           knn 0.9466667   NaN         0.9460269 0.05333333\n\ncat(\"\\n3. åˆ†ç±»é—®é¢˜æœ€ä½³å®è·µ:\\n\")\n\n\n3. åˆ†ç±»é—®é¢˜æœ€ä½³å®è·µ:\n\ncat(\"   - æ ‘æ¨¡å‹å’ŒSVMåœ¨åˆ†ç±»é—®é¢˜ä¸Šè¡¨ç°ä¼˜å¼‚\\n\")\n\n   - æ ‘æ¨¡å‹å’ŒSVMåœ¨åˆ†ç±»é—®é¢˜ä¸Šè¡¨ç°ä¼˜å¼‚\n\ncat(\"   - ç‰¹å¾æ ‡å‡†åŒ–å¯¹è·ç¦»-basedæ¨¡å‹å¾ˆé‡è¦\\n\")\n\n   - ç‰¹å¾æ ‡å‡†åŒ–å¯¹è·ç¦»-basedæ¨¡å‹å¾ˆé‡è¦\n\ncat(\"   - å¤šåˆ†ç±»é—®é¢˜éœ€è¦è€ƒè™‘åˆé€‚çš„è¯„ä¼°æŒ‡æ ‡\\n\")\n\n   - å¤šåˆ†ç±»é—®é¢˜éœ€è¦è€ƒè™‘åˆé€‚çš„è¯„ä¼°æŒ‡æ ‡\n\ncat(\"   - ç‰¹å¾é‡è¦æ€§åˆ†ææœ‰åŠ©äºç†è§£æ¨¡å‹å†³ç­–\\n\")\n\n   - ç‰¹å¾é‡è¦æ€§åˆ†ææœ‰åŠ©äºç†è§£æ¨¡å‹å†³ç­–\n\n\n\n# æ¡ˆä¾‹æ€»ç»“ - Python\nprint(\"=== é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹æ€»ç»“ ===\")\n\n=== é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹æ€»ç»“ ===\n\nprint(\"1. æ•°æ®ç‰¹å¾:\")\n\n1. æ•°æ®ç‰¹å¾:\n\nprint(f\"   - æ•°æ®é›†åŒ…å« {iris_data.shape[0]} ä¸ªæ ·æœ¬ï¼Œ{iris_data.shape[1]-1} ä¸ªç‰¹å¾\")\n\n   - æ•°æ®é›†åŒ…å« 150 ä¸ªæ ·æœ¬ï¼Œ5 ä¸ªç‰¹å¾\n\nprint(\"   - ç›®æ ‡å˜é‡: é¸¢å°¾èŠ±ç§ç±»(3ä¸ªç±»åˆ«)\")\n\n   - ç›®æ ‡å˜é‡: é¸¢å°¾èŠ±ç§ç±»(3ä¸ªç±»åˆ«)\n\nprint(\"   - ç±»åˆ«åˆ†å¸ƒå‡è¡¡\")\n\n   - ç±»åˆ«åˆ†å¸ƒå‡è¡¡\n\nprint(\"   - æœ€é‡è¦çš„ç‰¹å¾: èŠ±ç“£é•¿åº¦å’Œå®½åº¦\\n\")\n\n   - æœ€é‡è¦çš„ç‰¹å¾: èŠ±ç“£é•¿åº¦å’Œå®½åº¦\n\nprint(\"2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\")\n\n2. æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n\nprint(results_python[['Model', 'Accuracy', 'F1_Score', 'AUC']].sort_values('Accuracy', ascending=False).to_string(index=False))\n\n              Model  Accuracy  F1_Score      AUC\n  Gradient Boosting  0.933333  0.932660 0.998519\nLogistic Regression  0.911111  0.910714 0.995556\n        K-Neighbors  0.911111  0.909502 0.988889\n      Random Forest  0.888889  0.887767 0.992593\n\nprint(\"\\n3. åˆ†ç±»é—®é¢˜æœ€ä½³å®è·µ:\")\n\n\n3. åˆ†ç±»é—®é¢˜æœ€ä½³å®è·µ:\n\nprint(\"   - é›†æˆå­¦ä¹ æ–¹æ³•åœ¨åˆ†ç±»é—®é¢˜ä¸Šè¡¨ç°ç¨³å®š\")\n\n   - é›†æˆå­¦ä¹ æ–¹æ³•åœ¨åˆ†ç±»é—®é¢˜ä¸Šè¡¨ç°ç¨³å®š\n\nprint(\"   - æ•°æ®é¢„å¤„ç†å¯¹æ¨¡å‹æ€§èƒ½å½±å“æ˜¾è‘—\")\n\n   - æ•°æ®é¢„å¤„ç†å¯¹æ¨¡å‹æ€§èƒ½å½±å“æ˜¾è‘—\n\nprint(\"   - äº¤å‰éªŒè¯æä¾›æ›´å¯é çš„æ€§èƒ½ä¼°è®¡\")\n\n   - äº¤å‰éªŒè¯æä¾›æ›´å¯é çš„æ€§èƒ½ä¼°è®¡\n\nprint(\"   - æ··æ·†çŸ©é˜µå’Œåˆ†ç±»æŠ¥å‘Šæä¾›è¯¦ç»†æ€§èƒ½åˆ†æ\")\n\n   - æ··æ·†çŸ©é˜µå’Œåˆ†ç±»æŠ¥å‘Šæä¾›è¯¦ç»†æ€§èƒ½åˆ†æ\n\n\næŠ€æœ¯è¦ç‚¹å›é¡¾\næ•°æ®é¢„å¤„ç†ï¼š - ç‰¹å¾æ ‡å‡†åŒ–ï¼šç¡®ä¿ä¸åŒå°ºåº¦çš„ç‰¹å¾å…·æœ‰å¯æ¯”æ€§ - ç±»åˆ«ç¼–ç ï¼šå°†æ–‡æœ¬æ ‡ç­¾è½¬æ¢ä¸ºæ•°å€¼ - æ•°æ®åˆ’åˆ†ï¼šä½¿ç”¨åˆ†å±‚æŠ½æ ·ä¿æŒç±»åˆ«æ¯”ä¾‹\næ¨¡å‹é€‰æ‹©ï¼š - é€»è¾‘å›å½’ï¼šå¯è§£é‡Šæ€§å¼ºï¼Œé€‚åˆçº¿æ€§å¯åˆ†æ•°æ® - æ ‘æ¨¡å‹ï¼šè‡ªåŠ¨å¤„ç†éçº¿æ€§å…³ç³»ï¼Œæä¾›ç‰¹å¾é‡è¦æ€§ - SVMï¼šåœ¨é«˜ç»´ç©ºé—´ä¸­è¡¨ç°ä¼˜å¼‚ - KNNï¼šåŸºäºè·ç¦»çš„ç®€å•æœ‰æ•ˆæ–¹æ³•\næ¨¡å‹è¯„ä¼°ï¼š - å‡†ç¡®ç‡ï¼šæ•´ä½“åˆ†ç±»æ­£ç¡®ç‡ - ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°ï¼šæ›´ç»†è‡´çš„æ€§èƒ½è¯„ä¼° - AUCï¼šæ¨¡å‹åŒºåˆ†èƒ½åŠ›çš„ç»¼åˆæŒ‡æ ‡ - æ··æ·†çŸ©é˜µï¼šè¯¦ç»†åˆ†æå„ç±»åˆ«çš„åˆ†ç±»æƒ…å†µ\næ¨¡å‹ä¼˜åŒ–ï¼š - è¶…å‚æ•°è°ƒä¼˜ï¼šæå‡æ¨¡å‹æ€§èƒ½ - ç‰¹å¾é€‰æ‹©ï¼šåŸºäºé‡è¦æ€§ç­›é€‰ç‰¹å¾ - äº¤å‰éªŒè¯ï¼šç¨³å¥çš„æ€§èƒ½ä¼°è®¡\nä¸šåŠ¡åº”ç”¨å»ºè®®\n\nç‰©ç§è¯†åˆ«ï¼šæ‰©å±•åˆ°å…¶ä»–æ¤ç‰©æˆ–åŠ¨ç‰©çš„åˆ†ç±»è¯†åˆ«\nè´¨é‡æ£€æµ‹ï¼šåº”ç”¨äºå·¥ä¸šäº§å“è´¨é‡åˆ†ç±»\nåŒ»ç–—è¯Šæ–­ï¼šç”¨äºç–¾ç—…åˆ†ç±»å’Œè¯Šæ–­è¾…åŠ©\nå®¢æˆ·ç»†åˆ†ï¼šç”¨äºå¸‚åœºè¥é”€ä¸­çš„å®¢æˆ·åˆ†ç±»",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>14 åˆ†ç±»ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html",
    "href": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html",
    "title": "15 æ¡ˆä¾‹ç»¼åˆåˆ†æ",
    "section": "",
    "text": "æ¡ˆä¾‹å¯¼è¯»\næœ¬é¡¹ç›®åŸºäºæ¨¡æ‹Ÿçš„ç”µå•†ç”¨æˆ·æ•°æ®ï¼Œè¿›è¡Œå…¨é¢çš„æ•°æ®åˆ†æï¼ŒåŒ…æ‹¬ï¼š - å›å½’åˆ†æï¼šé¢„æµ‹ç”¨æˆ·æ¶ˆè´¹é‡‘é¢ - åˆ†ç±»åˆ†æï¼šé¢„æµ‹ç”¨æˆ·è´­ä¹°æ„å‘ - èšç±»åˆ†æï¼šç”¨æˆ·åˆ†ç¾¤ - å…³è”åˆ†æï¼šå•†å“è´­ä¹°å…³è”è§„åˆ™\næ•°æ®è¯´æ˜\nä»£ç # ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®\nset.seed(123)\nn &lt;- 1000\n\n# ç”¨æˆ·åŸºæœ¬ä¿¡æ¯\nuser_data &lt;- data.frame(\n  user_id = 1:n,\n  age = sample(18:65, n, replace = TRUE),\n  gender = sample(c(\"Male\", \"Female\"), n, replace = TRUE, prob = c(0.48, 0.52)),\n  income = round(rnorm(n, 50000, 15000)),\n  region = sample(c(\"North\", \"South\", \"East\", \"West\"), n, replace = TRUE),\n  days_since_signup = sample(1:365, n, replace = TRUE),\n  page_views = rpois(n, 25),\n  time_on_site = round(rnorm(n, 300, 120)),\n  cart_additions = rpois(n, 5)\n)\n\n# ç”Ÿæˆè´­ä¹°è¡Œä¸ºæ•°æ®\nuser_data$purchase_amount &lt;- with(user_data, \n  50 + 0.3 * income/1000 + 0.5 * page_views + 0.8 * time_on_site/60 + \n  2 * cart_additions + rnorm(n, 0, 20)\n)\n\nuser_data$made_purchase &lt;- ifelse(user_data$purchase_amount &gt; 120, 1, 0)\n\n# æ·»åŠ äº§å“ç±»åˆ«è´­ä¹°ä¿¡æ¯ - å¢åŠ ç›¸å…³æ€§ä»¥äº§ç”Ÿå…³è”è§„åˆ™\nproducts &lt;- c(\"Electronics\", \"Clothing\", \"Books\", \"Home\", \"Sports\")\nset.seed(123)\nfor(i in 1:length(products)) {\n  product &lt;- products[i]\n  base_prob &lt;- 0.4\n  # åˆ›å»ºäº§å“é—´çš„ç›¸å…³æ€§\n  if(i &gt; 1) {\n    # è®©æŸäº›äº§å“æ›´å¯èƒ½ä¸€èµ·è´­ä¹°\n    correlated_prob &lt;- user_data[[paste0(\"bought_\", tolower(products[i-1]))]] * 0.3 + base_prob\n    user_data[[paste0(\"bought_\", tolower(product))]] &lt;- rbinom(n, 1, pmin(correlated_prob, 0.8))\n  } else {\n    user_data[[paste0(\"bought_\", tolower(product))]] &lt;- rbinom(n, 1, base_prob)\n  }\n}\n\nhead(user_data)\n\n  user_id age gender income region days_since_signup page_views time_on_site\n1       1  48 Female  51762   West                 5         29          173\n2       2  32 Female  45027   West                22         28          450\n3       3  31   Male  54174   West                 4         38          147\n4       4  20 Female  32216  South               352         23          243\n5       5  59   Male  37462  North               131         23          340\n6       6  60 Female  57654  North               231         15          334\n  cart_additions purchase_amount made_purchase bought_electronics\n1              3        57.57759             0                  0\n2              3        59.83742             0                  1\n3              6        64.31744             0                  0\n4             10        94.88951             0                  1\n5              1        24.43966             0                  1\n6              5       114.33971             0                  0\n  bought_clothing bought_books bought_home bought_sports\n1               0            0           0             0\n2               1            1           0             1\n3               0            0           0             0\n4               0            0           1             0\n5               0            0           0             0\n6               0            1           1             1",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>20</span>Â  <span class='chapter-title'>15 æ¡ˆä¾‹ç»¼åˆåˆ†æ</span>"
    ]
  },
  {
    "objectID": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html#rè¯­è¨€å®ç°",
    "href": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html#rè¯­è¨€å®ç°",
    "title": "15 æ¡ˆä¾‹ç»¼åˆåˆ†æ",
    "section": "15.1 Rè¯­è¨€å®ç°",
    "text": "15.1 Rè¯­è¨€å®ç°\n15.1.1. æ•°æ®æ¢ç´¢ä¸é¢„å¤„ç†\næ•°æ®æ¦‚è§ˆ\n\nä»£ç library(dplyr)\nlibrary(ggplot2)\nlibrary(corrplot)\n\n# åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯\nsummary(user_data[, c(\"age\", \"income\", \"page_views\", \"time_on_site\", \"purchase_amount\")])\n\n      age            income         page_views     time_on_site  \n Min.   :18.00   Min.   :  4282   Min.   :11.00   Min.   :-83.0  \n 1st Qu.:29.00   1st Qu.: 40201   1st Qu.:21.00   1st Qu.:219.8  \n Median :42.00   Median : 49943   Median :25.00   Median :299.0  \n Mean   :41.39   Mean   : 50209   Mean   :24.92   Mean   :299.7  \n 3rd Qu.:53.00   3rd Qu.: 60887   3rd Qu.:28.00   3rd Qu.:376.2  \n Max.   :65.00   Max.   :100856   Max.   :42.00   Max.   :688.0  \n purchase_amount  \n Min.   :  9.555  \n 1st Qu.: 76.051  \n Median : 91.131  \n Mean   : 90.966  \n 3rd Qu.:105.509  \n Max.   :153.144  \n\nä»£ç # ç¼ºå¤±å€¼æ£€æŸ¥\nsapply(user_data, function(x) sum(is.na(x)))\n\n           user_id                age             gender             income \n                 0                  0                  0                  0 \n            region  days_since_signup         page_views       time_on_site \n                 0                  0                  0                  0 \n    cart_additions    purchase_amount      made_purchase bought_electronics \n                 0                  0                  0                  0 \n   bought_clothing       bought_books        bought_home      bought_sports \n                 0                  0                  0                  0 \n\n\næ•°æ®å¯è§†åŒ–\n\nä»£ç # æ•°å€¼å˜é‡åˆ†å¸ƒ\np1 &lt;- ggplot(user_data, aes(x = purchase_amount)) +\n  geom_histogram(bins = 30, fill = \"steelblue\", alpha = 0.7) +\n  labs(title = \"è´­ä¹°é‡‘é¢åˆ†å¸ƒ\")\n\np2 &lt;- ggplot(user_data, aes(x = factor(made_purchase), fill = factor(made_purchase))) +\n  geom_bar() +\n  labs(title = \"è´­ä¹°è¡Œä¸ºåˆ†å¸ƒ\", x = \"æ˜¯å¦è´­ä¹°\")\n\np3 &lt;- ggplot(user_data, aes(x = age, y = purchase_amount, color = gender)) +\n  geom_point(alpha = 0.6) +\n  labs(title = \"å¹´é¾„ä¸è´­ä¹°é‡‘é¢å…³ç³»\")\n\nlibrary(patchwork)\np1 / p2 / p3\n\n\n\n\n\n\n\n15.1.2. å›å½’åˆ†æï¼šé¢„æµ‹è´­ä¹°é‡‘é¢\nçº¿æ€§å›å½’æ¨¡å‹\n\nä»£ç library(caret)\n\n# å‡†å¤‡æ•°æ®\nreg_data &lt;- user_data %&gt;% \n  select(age, income, page_views, time_on_site, cart_additions, purchase_amount) %&gt;%\n  na.omit()\n\n# æ•°æ®åˆ†å‰²\nset.seed(123)\ntrain_index &lt;- createDataPartition(reg_data$purchase_amount, p = 0.7, list = FALSE)\ntrain_reg &lt;- reg_data[train_index, ]\ntest_reg &lt;- reg_data[-train_index, ]\n\n# è®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹\nlm_model &lt;- lm(purchase_amount ~ ., data = train_reg)\nsummary(lm_model)\n\n\nCall:\nlm(formula = purchase_amount ~ ., data = train_reg)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-66.576 -12.853  -0.106  13.819  67.749 \n\nCoefficients:\n                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    5.111e+01  5.704e+00   8.961  &lt; 2e-16 ***\nage            8.216e-04  5.349e-02   0.015  0.98775    \nincome         2.969e-04  5.022e-05   5.913 5.28e-09 ***\npage_views     2.720e-01  1.496e-01   1.818  0.06954 .  \ntime_on_site   1.635e-02  6.067e-03   2.695  0.00721 ** \ncart_additions 2.638e+00  3.326e-01   7.933 8.57e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.32 on 694 degrees of freedom\nMultiple R-squared:  0.1368,    Adjusted R-squared:  0.1305 \nF-statistic: 21.99 on 5 and 694 DF,  p-value: &lt; 2.2e-16\n\nä»£ç # é¢„æµ‹\npredictions_lm &lt;- predict(lm_model, newdata = test_reg)\n\n# æ¨¡å‹è¯„ä¼°\nreg_metrics &lt;- data.frame(\n  RMSE = RMSE(predictions_lm, test_reg$purchase_amount),\n  MAE = MAE(predictions_lm, test_reg$purchase_amount),\n  R2 = R2(predictions_lm, test_reg$purchase_amount)\n)\nprint(reg_metrics)\n\n      RMSE      MAE         R2\n1 21.72114 17.54768 0.07424787\n\n\nå›å½’ç»“æœå¯è§†åŒ–\n\nä»£ç # é¢„æµ‹ vs å®é™…å€¼\nresults_df &lt;- data.frame(\n  Actual = test_reg$purchase_amount,\n  Predicted = predictions_lm\n)\n\nggplot(results_df, aes(x = Actual, y = Predicted)) +\n  geom_point(alpha = 0.6, color = \"steelblue\") +\n  geom_abline(slope = 1, intercept = 0, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"çº¿æ€§å›å½’ï¼šé¢„æµ‹å€¼ vs å®é™…å€¼\",\n       subtitle = paste(\"RÂ² =\", round(reg_metrics$R2, 3))) +\n  theme_minimal()\n\n\n\n\n\n\n\n###15.1.3. åˆ†ç±»åˆ†æï¼šé¢„æµ‹è´­ä¹°æ„å‘\né€»è¾‘å›å½’åˆ†ç±»\n\nä»£ç # å‡†å¤‡åˆ†ç±»æ•°æ® - ç¡®ä¿å› å­æ°´å¹³ä¸€è‡´\nclass_data &lt;- user_data %&gt;% \n  select(age, income, page_views, time_on_site, cart_additions, made_purchase) %&gt;%\n  mutate(made_purchase = factor(made_purchase, levels = c(0, 1), labels = c(\"No\", \"Yes\"))) %&gt;%\n  na.omit()\n\n# æ•°æ®åˆ†å‰²\nset.seed(123)\ntrain_index_class &lt;- createDataPartition(class_data$made_purchase, p = 0.7, list = FALSE)\ntrain_class &lt;- class_data[train_index_class, ]\ntest_class &lt;- class_data[-train_index_class, ]\n\n# è®­ç»ƒé€»è¾‘å›å½’æ¨¡å‹\nlogit_model &lt;- glm(made_purchase ~ ., data = train_class, family = binomial)\nsummary(logit_model)\n\n\nCall:\nglm(formula = made_purchase ~ ., family = binomial, data = train_class)\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    -7.571e+00  1.118e+00  -6.771 1.28e-11 ***\nage             1.361e-03  1.002e-02   0.136   0.8920    \nincome          2.353e-05  9.733e-06   2.418   0.0156 *  \npage_views      5.748e-02  2.661e-02   2.160   0.0308 *  \ntime_on_site    2.964e-03  1.157e-03   2.562   0.0104 *  \ncart_additions  2.789e-01  6.152e-02   4.533 5.82e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 419.09  on 700  degrees of freedom\nResidual deviance: 381.44  on 695  degrees of freedom\nAIC: 393.44\n\nNumber of Fisher Scoring iterations: 5\n\nä»£ç # é¢„æµ‹æ¦‚ç‡\nprob_predictions &lt;- predict(logit_model, newdata = test_class, type = \"response\")\nclass_predictions &lt;- ifelse(prob_predictions &gt; 0.5, \"Yes\", \"No\")\nclass_predictions &lt;- factor(class_predictions, levels = c(\"No\", \"Yes\"))\n\n# æ¨¡å‹è¯„ä¼° - ä¿®å¤å› å­æ°´å¹³é—®é¢˜\nconf_matrix &lt;- confusionMatrix(class_predictions, test_class$made_purchase, positive = \"Yes\")\nprint(conf_matrix)\n\nConfusion Matrix and Statistics\n\n          Reference\nPrediction  No Yes\n       No  273  26\n       Yes   0   0\n                                          \n               Accuracy : 0.913           \n                 95% CI : (0.8752, 0.9424)\n    No Information Rate : 0.913           \n    P-Value [Acc &gt; NIR] : 0.552           \n                                          \n                  Kappa : 0               \n                                          \n Mcnemar's Test P-Value : 9.443e-07       \n                                          \n            Sensitivity : 0.00000         \n            Specificity : 1.00000         \n         Pos Pred Value :     NaN         \n         Neg Pred Value : 0.91304         \n             Prevalence : 0.08696         \n         Detection Rate : 0.00000         \n   Detection Prevalence : 0.00000         \n      Balanced Accuracy : 0.50000         \n                                          \n       'Positive' Class : Yes             \n                                          \n\nä»£ç # ç»˜åˆ¶ROCæ›²çº¿\nlibrary(pROC)\nroc_curve &lt;- roc(as.numeric(test_class$made_purchase) - 1, prob_predictions)\nplot(roc_curve, main = \"é€»è¾‘å›å½’ROCæ›²çº¿\")\nauc_value &lt;- auc(roc_curve)\nlegend(\"bottomright\", legend = paste(\"AUC =\", round(auc_value, 3)))\n\n\n\n\n\n\n\néšæœºæ£®æ—åˆ†ç±»\n\nä»£ç library(randomForest)\n\n# ç¡®ä¿è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®çš„å› å­æ°´å¹³ä¸€è‡´\ntrain_class$made_purchase &lt;- factor(train_class$made_purchase, levels = c(\"No\", \"Yes\"))\ntest_class$made_purchase &lt;- factor(test_class$made_purchase, levels = c(\"No\", \"Yes\"))\n\n# è®­ç»ƒéšæœºæ£®æ—\nrf_model &lt;- randomForest(made_purchase ~ ., data = train_class, ntree = 100)\n\n# é¢„æµ‹\nrf_predictions &lt;- predict(rf_model, newdata = test_class)\n\n# è¯„ä¼° - ç¡®ä¿å› å­æ°´å¹³ä¸€è‡´\nrf_conf_matrix &lt;- confusionMatrix(rf_predictions, test_class$made_purchase, positive = \"Yes\")\nprint(rf_conf_matrix)\n\nConfusion Matrix and Statistics\n\n          Reference\nPrediction  No Yes\n       No  271  26\n       Yes   2   0\n                                          \n               Accuracy : 0.9064          \n                 95% CI : (0.8675, 0.9369)\n    No Information Rate : 0.913           \n    P-Value [Acc &gt; NIR] : 0.7033          \n                                          \n                  Kappa : -0.0126         \n                                          \n Mcnemar's Test P-Value : 1.383e-05       \n                                          \n            Sensitivity : 0.000000        \n            Specificity : 0.992674        \n         Pos Pred Value : 0.000000        \n         Neg Pred Value : 0.912458        \n             Prevalence : 0.086957        \n         Detection Rate : 0.000000        \n   Detection Prevalence : 0.006689        \n      Balanced Accuracy : 0.496337        \n                                          \n       'Positive' Class : Yes             \n                                          \n\nä»£ç # å˜é‡é‡è¦æ€§\nvarImpPlot(rf_model, main = \"éšæœºæ£®æ—å˜é‡é‡è¦æ€§\")\n\n\n\n\n\n\nä»£ç # éšæœºæ£®æ—ROCæ›²çº¿\nrf_prob &lt;- predict(rf_model, newdata = test_class, type = \"prob\")[, \"Yes\"]\nrf_roc &lt;- roc(as.numeric(test_class$made_purchase) - 1, rf_prob)\nplot(rf_roc, main = \"éšæœºæ£®æ—ROCæ›²çº¿\")\nrf_auc &lt;- auc(rf_roc)\nlegend(\"bottomright\", legend = paste(\"AUC =\", round(rf_auc, 3)))\n\n\n\n\n\n\n\nåˆ†ç±»æ¨¡å‹æ¯”è¾ƒ\n15.1.4. èšç±»åˆ†æï¼šç”¨æˆ·åˆ†ç¾¤\nK-meansèšç±»\n\nä»£ç # å‡†å¤‡èšç±»æ•°æ®\ncluster_data &lt;- user_data %&gt;%\n  select(age, income, page_views, time_on_site, cart_additions) %&gt;%\n  scale()  # æ ‡å‡†åŒ–\n\n# ç¡®å®šæœ€ä½³èšç±»æ•°\nwss &lt;- sapply(1:10, function(k){kmeans(cluster_data, k, nstart = 25)$tot.withinss})\n\nggplot(data.frame(k = 1:10, wss = wss), aes(x = k, y = wss)) +\n  geom_line() + geom_point() +\n  labs(title = \"è‚˜éƒ¨æ³•åˆ™ç¡®å®šæœ€ä½³èšç±»æ•°\", x = \"èšç±»æ•°\", y = \"ç»„å†…å¹³æ–¹å’Œ\")\n\n\n\n\n\n\nä»£ç # æ‰§è¡ŒK-meansèšç±»\nset.seed(123)\nkmeans_result &lt;- kmeans(cluster_data, centers = 4, nstart = 25)\n\n# æ·»åŠ èšç±»æ ‡ç­¾\nuser_data$cluster &lt;- as.factor(kmeans_result$cluster)\n\n# èšç±»ç»“æœå¯è§†åŒ–\nlibrary(factoextra)\nfviz_cluster(kmeans_result, data = cluster_data, \n             palette = c(\"#2E9FDF\", \"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             geom = \"point\",\n             ellipse.type = \"convex\",\n             ggtheme = theme_bw())\n\n\n\n\n\n\n\nèšç±»åˆ†æ\n\nä»£ç # èšç±»ç‰¹å¾åˆ†æ\ncluster_summary &lt;- user_data %&gt;%\n  group_by(cluster) %&gt;%\n  summarise(\n    n = n(),\n    avg_age = mean(age),\n    avg_income = mean(income),\n    avg_page_views = mean(page_views),\n    avg_time = mean(time_on_site),\n    purchase_rate = mean(made_purchase),\n    avg_purchase = mean(purchase_amount)\n  )\n\nprint(cluster_summary)\n\n# A tibble: 4 Ã— 8\n  cluster     n avg_age avg_income avg_page_views avg_time purchase_rate\n  &lt;fct&gt;   &lt;int&gt;   &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;\n1 1         292    53.9     50802.           23.1     376.        0.0822\n2 2         257    30.1     46562.           22.3     304.        0.0506\n3 3         203    33.8     47358.           25.6     293.        0.133 \n4 4         248    44.6     55625.           29.2     210.        0.0968\n# â„¹ 1 more variable: avg_purchase &lt;dbl&gt;\n\nä»£ç # èšç±»ç‰¹å¾å¯è§†åŒ– - ä¿®å¤ç‰ˆæœ¬\ncluster_features &lt;- user_data %&gt;%\n  select(cluster, age, income, page_views, time_on_site, purchase_amount)\n\n# ä½¿ç”¨tidyr::pivot_longer\ncluster_features_long &lt;- tidyr::pivot_longer(\n  cluster_features,\n  cols = -cluster,\n  names_to = \"Feature\",\n  values_to = \"Value\"\n)\n\nggplot(cluster_features_long, aes(x = cluster, y = Value, fill = cluster)) +\n  geom_boxplot() +\n  facet_wrap(~ Feature, scales = \"free_y\") +\n  labs(title = \"å„èšç±»ç¾¤ä½“ç‰¹å¾åˆ†å¸ƒ\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n15.1.5. å…³è”åˆ†æï¼šå•†å“è´­ä¹°å…³è”è§„åˆ™\nAprioriç®—æ³•\n\nä»£ç library(arules)\n\n# å‡†å¤‡å…³è”åˆ†ææ•°æ® - åªåŒ…å«äº§å“è´­ä¹°åˆ—\ntransaction_data &lt;- user_data %&gt;%\n  select(starts_with(\"bought_\"))\n\n# è½¬æ¢ä¸ºäº‹åŠ¡æ•°æ®\ntransactions &lt;- as(transaction_data, \"transactions\")\n\n# æŸ¥çœ‹äº‹åŠ¡æ•°æ®æ¦‚è§ˆ\nsummary(transactions)\n\ntransactions as itemMatrix in sparse format with\n 1000 rows (elements/itemsets/transactions) and\n 5 columns (items) and a density of 1 \n\nmost frequent items:\nbought_electronics=[0,1]    bought_clothing=[0,1]       bought_books=[0,1] \n                    1000                     1000                     1000 \n       bought_home=[0,1]      bought_sports=[0,1]                  (Other) \n                    1000                     1000                        0 \n\nelement (itemset/transaction) length distribution:\nsizes\n   5 \n1000 \n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      5       5       5       5       5       5 \n\nincludes extended item information - examples:\n                    labels          variables levels\n1 bought_electronics=[0,1] bought_electronics  [0,1]\n2    bought_clothing=[0,1]    bought_clothing  [0,1]\n3       bought_books=[0,1]       bought_books  [0,1]\n\nincludes extended transaction information - examples:\n  transactionID\n1             1\n2             2\n3             3\n\nä»£ç # æŸ¥çœ‹äº§å“é¢‘ç‡\nitemFrequency &lt;- itemFrequency(transactions)\nprint(\"äº§å“è´­ä¹°é¢‘ç‡:\")\n\n[1] \"äº§å“è´­ä¹°é¢‘ç‡:\"\n\nä»£ç print(sort(itemFrequency, decreasing = TRUE))\n\nbought_electronics=[0,1]    bought_clothing=[0,1]       bought_books=[0,1] \n                       1                        1                        1 \n       bought_home=[0,1]      bought_sports=[0,1] \n                       1                        1 \n\nä»£ç # ä½¿ç”¨æ›´å®½æ¾çš„å‚æ•°æŒ–æ˜å…³è”è§„åˆ™\nrules &lt;- apriori(transactions, \n                 parameter = list(support = 0.05,  # é™ä½æ”¯æŒåº¦é˜ˆå€¼\n                                 confidence = 0.3,  # é™ä½ç½®ä¿¡åº¦é˜ˆå€¼\n                                 minlen = 2,        # æœ€å°è§„åˆ™é•¿åº¦\n                                 maxlen = 4))       # æœ€å¤§è§„åˆ™é•¿åº¦\n\nApriori\n\nParameter specification:\n confidence minval smax arem  aval originalSupport maxtime support minlen\n        0.3    0.1    1 none FALSE            TRUE       5    0.05      2\n maxlen target  ext\n      4  rules TRUE\n\nAlgorithmic control:\n filter tree heap memopt load sort verbose\n    0.1 TRUE TRUE  FALSE TRUE    2    TRUE\n\nAbsolute minimum support count: 50 \n\nset item appearances ...[0 item(s)] done [0.00s].\nset transactions ...[5 item(s), 1000 transaction(s)] done [0.00s].\nsorting and recoding items ... [5 item(s)] done [0.00s].\ncreating transaction tree ... done [0.00s].\nchecking subsets of size 1 2 3 4\n\n\n done [0.00s].\nwriting ... [70 rule(s)] done [0.00s].\ncreating S4 object  ... done [0.00s].\n\nä»£ç # è§„åˆ™æ‘˜è¦\ncat(\"æ‰¾åˆ°çš„è§„åˆ™æ•°é‡:\", length(rules), \"\\n\")\n\næ‰¾åˆ°çš„è§„åˆ™æ•°é‡: 70 \n\nä»£ç summary(rules)\n\nset of 70 rules\n\nrule length distribution (lhs + rhs):sizes\n 2  3  4 \n20 30 20 \n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      2       2       3       3       4       4 \n\nsummary of quality measures:\n    support    confidence    coverage      lift       count     \n Min.   :1   Min.   :1    Min.   :1   Min.   :1   Min.   :1000  \n 1st Qu.:1   1st Qu.:1    1st Qu.:1   1st Qu.:1   1st Qu.:1000  \n Median :1   Median :1    Median :1   Median :1   Median :1000  \n Mean   :1   Mean   :1    Mean   :1   Mean   :1   Mean   :1000  \n 3rd Qu.:1   3rd Qu.:1    3rd Qu.:1   3rd Qu.:1   3rd Qu.:1000  \n Max.   :1   Max.   :1    Max.   :1   Max.   :1   Max.   :1000  \n\nmining info:\n         data ntransactions support confidence\n transactions          1000    0.05        0.3\n                                                                                                     call\n apriori(data = transactions, parameter = list(support = 0.05, confidence = 0.3, minlen = 2, maxlen = 4))\n\nä»£ç # æŸ¥çœ‹è§„åˆ™\nif(length(rules) &gt; 0) {\n  # æŒ‰æå‡åº¦æ’åº\n  rules_sorted &lt;- sort(rules, by = \"lift\", decreasing = TRUE)\n  cat(\"\\nå‰10æ¡å…³è”è§„åˆ™ (æŒ‰æå‡åº¦æ’åº):\\n\")\n  inspect(head(rules_sorted, 10))\n} else {\n  cat(\"æ²¡æœ‰æ‰¾åˆ°å…³è”è§„åˆ™ï¼Œè¯·è¿›ä¸€æ­¥é™ä½é˜ˆå€¼å‚æ•°\\n\")\n}\n\n\nå‰10æ¡å…³è”è§„åˆ™ (æŒ‰æå‡åº¦æ’åº):\n     lhs                           rhs                        support\n[1]  {bought_electronics=[0,1]} =&gt; {bought_clothing=[0,1]}    1      \n[2]  {bought_clothing=[0,1]}    =&gt; {bought_electronics=[0,1]} 1      \n[3]  {bought_electronics=[0,1]} =&gt; {bought_books=[0,1]}       1      \n[4]  {bought_books=[0,1]}       =&gt; {bought_electronics=[0,1]} 1      \n[5]  {bought_electronics=[0,1]} =&gt; {bought_home=[0,1]}        1      \n[6]  {bought_home=[0,1]}        =&gt; {bought_electronics=[0,1]} 1      \n[7]  {bought_electronics=[0,1]} =&gt; {bought_sports=[0,1]}      1      \n[8]  {bought_sports=[0,1]}      =&gt; {bought_electronics=[0,1]} 1      \n[9]  {bought_clothing=[0,1]}    =&gt; {bought_books=[0,1]}       1      \n[10] {bought_books=[0,1]}       =&gt; {bought_clothing=[0,1]}    1      \n     confidence coverage lift count\n[1]  1          1        1    1000 \n[2]  1          1        1    1000 \n[3]  1          1        1    1000 \n[4]  1          1        1    1000 \n[5]  1          1        1    1000 \n[6]  1          1        1    1000 \n[7]  1          1        1    1000 \n[8]  1          1        1    1000 \n[9]  1          1        1    1000 \n[10] 1          1        1    1000 \n\n\nå…³è”è§„åˆ™å¯è§†åŒ–\n\nä»£ç library(arulesViz)\n\nif(length(rules) &gt; 0) {\n  # é€‰æ‹©å‰20æ¡è§„åˆ™è¿›è¡Œå¯è§†åŒ–\n  rules_for_plot &lt;- head(sort(rules, by = \"lift\"), min(20, length(rules)))\n  \n  # æ•£ç‚¹å›¾\n  plot1 &lt;- plot(rules_for_plot, method = \"scatter\", \n               main = \"å…³è”è§„åˆ™æ•£ç‚¹å›¾ (æ”¯æŒåº¦ vs ç½®ä¿¡åº¦)\")\n  \n  # çŸ©é˜µå›¾\n  plot2 &lt;- plot(rules_for_plot, method = \"matrix\", \n               main = \"å…³è”è§„åˆ™çŸ©é˜µå›¾\")\n  \n  # åˆ†ç»„å›¾\n  plot3 &lt;- plot(rules_for_plot, method = \"grouped\",\n               main = \"å…³è”è§„åˆ™åˆ†ç»„å›¾\")\n  \n  # æ˜¾ç¤ºå›¾å½¢\n  plot1\n  plot2\n  plot3\n  \n} else {\n  cat(\"æ²¡æœ‰è¶³å¤Ÿçš„è§„åˆ™è¿›è¡Œå¯è§†åŒ–\\n\")\n  \n  # æ˜¾ç¤ºäº§å“å…±ç°çŸ©é˜µä½œä¸ºæ›¿ä»£\n  item_matrix &lt;- crossTable(transactions)\n  corrplot(item_matrix, method = \"color\", \n           title = \"äº§å“å…±ç°çƒ­å›¾\",\n           mar = c(0,0,2,0))\n}\n\nItemsets in Antecedent (LHS)\n[1] \"{bought_electronics=[0,1]}\" \"{bought_clothing=[0,1]}\"   \n[3] \"{bought_books=[0,1]}\"       \"{bought_home=[0,1]}\"       \n[5] \"{bought_sports=[0,1]}\"     \nItemsets in Consequent (RHS)\n[1] \"{bought_sports=[0,1]}\"      \"{bought_home=[0,1]}\"       \n[3] \"{bought_books=[0,1]}\"       \"{bought_electronics=[0,1]}\"\n[5] \"{bought_clothing=[0,1]}\"   \n\n\nAvailable control parameters (with default values):\nk    =  20\naggr.fun     =  function (x, ...)  UseMethod(\"mean\")\nrhs_max  =  10\nlhs_label_items  =  2\ncol  =  c(\"#EE0000FF\", \"#EEEEEEFF\")\ngroups   =  NULL\nengine   =  ggplot2\nverbose  =  FALSE",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>20</span>Â  <span class='chapter-title'>15 æ¡ˆä¾‹ç»¼åˆåˆ†æ</span>"
    ]
  },
  {
    "objectID": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html#pythonå®ç°",
    "href": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html#pythonå®ç°",
    "title": "15 æ¡ˆä¾‹ç»¼åˆåˆ†æ",
    "section": "15.2 Pythonå®ç°",
    "text": "15.2 Pythonå®ç°\næ•°æ®å‡†å¤‡\n\nä»£ç import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# è®¾ç½®ä¸­æ–‡å­—ä½“\nplt.rcParams['font.sans-serif'] = ['SimHei']\nplt.rcParams['axes.unicode_minus'] = False\n\n# ç”Ÿæˆç›¸åŒçš„æ¨¡æ‹Ÿæ•°æ®\nnp.random.seed(123)\nn = 1000\n\npython_user_data = pd.DataFrame({\n    'user_id': range(1, n+1),\n    'age': np.random.randint(18, 66, n),\n    'gender': np.random.choice(['Male', 'Female'], n, p=[0.48, 0.52]),\n    'income': np.random.normal(50000, 15000, n).round(),\n    'region': np.random.choice(['North', 'South', 'East', 'West'], n),\n    'days_since_signup': np.random.randint(1, 366, n),\n    'page_views': np.random.poisson(25, n),\n    'time_on_site': np.random.normal(300, 120, n).round(),\n    'cart_additions': np.random.poisson(5, n)\n})\n\n# ç”Ÿæˆè´­ä¹°è¡Œä¸º\npython_user_data['purchase_amount'] = (\n    50 + 0.3 * python_user_data['income']/1000 + \n    0.5 * python_user_data['page_views'] + \n    0.8 * python_user_data['time_on_site']/60 + \n    2 * python_user_data['cart_additions'] + \n    np.random.normal(0, 20, n)\n)\n\npython_user_data['made_purchase'] = (python_user_data['purchase_amount'] &gt; 120).astype(int)\n\n# æ·»åŠ äº§å“ç±»åˆ« - åˆ›å»ºç›¸å…³æ€§\nproducts = ['electronics', 'clothing', 'books', 'home', 'sports']\nbase_prob = 0.4\n\npython_user_data['bought_electronics'] = np.random.binomial(1, base_prob, n)\n\n# åˆ›å»ºç›¸å…³äº§å“\nfor i in range(1, len(products)):\n    prev_product = f'bought_{products[i-1]}'\n    current_product = f'bought_{products[i]}'\n    correlated_prob = python_user_data[prev_product] * 0.3 + base_prob\n    python_user_data[current_product] = np.random.binomial(1, np.minimum(correlated_prob, 0.8), n)\n\nprint(\"Pythonæ•°æ®æ¦‚è§ˆ:\")\n\nPythonæ•°æ®æ¦‚è§ˆ:\n\nä»£ç print(python_user_data.head())\n\n   user_id  age  gender  ...  bought_books bought_home  bought_sports\n0        1   63    Male  ...             0           0              1\n1        2   20  Female  ...             1           1              1\n2        3   46  Female  ...             1           1              1\n3        4   52  Female  ...             1           1              0\n4        5   56  Female  ...             1           1              1\n\n[5 rows x 16 columns]\n\nä»£ç print(f\"\\næ•°æ®å½¢çŠ¶: {python_user_data.shape}\")\n\n\næ•°æ®å½¢çŠ¶: (1000, 16)\n\nä»£ç # äº§å“è´­ä¹°é¢‘ç‡\nprint(\"\\näº§å“è´­ä¹°é¢‘ç‡:\")\n\n\näº§å“è´­ä¹°é¢‘ç‡:\n\nä»£ç for product in products:\n    col_name = f'bought_{product}'\n    freq = python_user_data[col_name].mean()\n    print(f\"{product}: {freq:.3f}\")\n\nelectronics: 0.411\nclothing: 0.522\nbooks: 0.553\nhome: 0.554\nsports: 0.565\n\n\n15.2.2 Pythonå›å½’åˆ†æ\n\nä»£ç from sklearn.linear_model import LinearRegression\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error\n\n# å‡†å¤‡å›å½’æ•°æ®\nreg_features = ['age', 'income', 'page_views', 'time_on_site', 'cart_additions']\nX_reg = python_user_data[reg_features]\ny_reg = python_user_data['purchase_amount']\n\n# æ•°æ®åˆ†å‰²\nX_train_reg, X_test_reg, y_train_reg, y_test_reg = train_test_split(\n    X_reg, y_reg, test_size=0.3, random_state=123)\n\n# çº¿æ€§å›å½’\nlr_model = LinearRegression()\nlr_model.fit(X_train_reg, y_train_reg)\n\n\n\n\nLinearRegression()\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\nLinearRegression\n\n?Documentation for LinearRegressioniFitted\nLinearRegression() \n\n\nä»£ç y_pred_lr = lr_model.predict(X_test_reg)\n\n# éšæœºæ£®æ—å›å½’\nrf_reg_model = RandomForestRegressor(n_estimators=100, random_state=123)\nrf_reg_model.fit(X_train_reg, y_train_reg)\n\n\n\n\nRandomForestRegressor(random_state=123)\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\nRandomForestRegressor\n\n?Documentation for RandomForestRegressoriFitted\nRandomForestRegressor(random_state=123) \n\n\nä»£ç y_pred_rf = rf_reg_model.predict(X_test_reg)\n\n# æ¨¡å‹è¯„ä¼°\ndef evaluate_regression(y_true, y_pred, model_name):\n    mse = mean_squared_error(y_true, y_pred)\n    mae = mean_absolute_error(y_true, y_pred)\n    r2 = r2_score(y_true, y_pred)\n    \n    results = {\n        'Model': model_name,\n        'RMSE': np.sqrt(mse),\n        'MAE': mae,\n        'R2': r2\n    }\n    return results\n\nlr_metrics = evaluate_regression(y_test_reg, y_pred_lr, 'Linear Regression')\nrf_metrics = evaluate_regression(y_test_reg, y_pred_rf, 'Random Forest')\n\nregression_results = pd.DataFrame([lr_metrics, rf_metrics])\nprint(\"å›å½’æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\")\n\nå›å½’æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n\nä»£ç print(regression_results)\n\n               Model       RMSE        MAE        R2\n0  Linear Regression  19.572048  15.711942  0.040879\n1      Random Forest  20.593340  16.873056 -0.061829\n\nä»£ç # å¯è§†åŒ–å›å½’ç»“æœ\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# çº¿æ€§å›å½’ç»“æœ\nax1.scatter(y_test_reg, y_pred_lr, alpha=0.6)\nax1.plot([y_test_reg.min(), y_test_reg.max()], [y_test_reg.min(), y_test_reg.max()], 'r--', lw=2)\nax1.set_xlabel('å®é™…å€¼')\nax1.set_ylabel('é¢„æµ‹å€¼')\nax1.set_title(f'çº¿æ€§å›å½’ (RÂ² = {lr_metrics[\"R2\"]:.3f})')\n\n# éšæœºæ£®æ—ç»“æœ\nax2.scatter(y_test_reg, y_pred_rf, alpha=0.6)\nax2.plot([y_test_reg.min(), y_test_reg.max()], [y_test_reg.min(), y_test_reg.max()], 'r--', lw=2)\nax2.set_xlabel('å®é™…å€¼')\nax2.set_ylabel('é¢„æµ‹å€¼')\nax2.set_title(f'éšæœºæ£®æ—å›å½’ (RÂ² = {rf_metrics[\"R2\"]:.3f})')\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n15.2.3 Pythonåˆ†ç±»åˆ†æ\n\nä»£ç from sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score, roc_auc_score, roc_curve\n\n# å‡†å¤‡åˆ†ç±»æ•°æ®\nclass_features = ['age', 'income', 'page_views', 'time_on_site', 'cart_additions']\nX_class = python_user_data[class_features]\ny_class = python_user_data['made_purchase']\n\n# æ•°æ®åˆ†å‰²\nX_train_class, X_test_class, y_train_class, y_test_class = train_test_split(\n    X_class, y_class, test_size=0.3, random_state=123, stratify=y_class)\n\n# é€»è¾‘å›å½’\nlogit_model = LogisticRegression(random_state=123)\nlogit_model.fit(X_train_class, y_train_class)\n\n\n\n\nLogisticRegression(random_state=123)\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\nLogisticRegression\n\n?Documentation for LogisticRegressioniFitted\nLogisticRegression(random_state=123) \n\n\nä»£ç y_pred_logit = logit_model.predict(X_test_class)\ny_pred_logit_proba = logit_model.predict_proba(X_test_class)[:, 1]\n\n# éšæœºæ£®æ—åˆ†ç±»\nrf_class_model = RandomForestClassifier(n_estimators=100, random_state=123)\nrf_class_model.fit(X_train_class, y_train_class)\n\n\n\n\nRandomForestClassifier(random_state=123)\nIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\n\n\nRandomForestClassifier\n\n?Documentation for RandomForestClassifieriFitted\nRandomForestClassifier(random_state=123) \n\n\nä»£ç y_pred_rf_class = rf_class_model.predict(X_test_class)\ny_pred_rf_proba = rf_class_model.predict_proba(X_test_class)[:, 1]\n\n# æ¨¡å‹è¯„ä¼°\nprint(\"=\" * 50)\n\n==================================================\n\nä»£ç print(\"é€»è¾‘å›å½’æ€§èƒ½:\")\n\né€»è¾‘å›å½’æ€§èƒ½:\n\nä»£ç print(\"=\" * 50)\n\n==================================================\n\nä»£ç print(classification_report(y_test_class, y_pred_logit))\n\n              precision    recall  f1-score   support\n\n           0       0.90      1.00      0.95       271\n           1       0.00      0.00      0.00        29\n\n    accuracy                           0.90       300\n   macro avg       0.45      0.50      0.47       300\nweighted avg       0.82      0.90      0.86       300\n\nä»£ç logit_accuracy = accuracy_score(y_test_class, y_pred_logit)\nlogit_auc = roc_auc_score(y_test_class, y_pred_logit_proba)\nprint(f\"å‡†ç¡®ç‡: {logit_accuracy:.3f}\")\n\nå‡†ç¡®ç‡: 0.903\n\nä»£ç print(f\"AUC: {logit_auc:.3f}\")\n\nAUC: 0.461\n\nä»£ç print(\"\\n\" + \"=\" * 50)\n\n\n==================================================\n\nä»£ç print(\"éšæœºæ£®æ—æ€§èƒ½:\")\n\néšæœºæ£®æ—æ€§èƒ½:\n\nä»£ç print(\"=\" * 50)\n\n==================================================\n\nä»£ç print(classification_report(y_test_class, y_pred_rf_class))\n\n              precision    recall  f1-score   support\n\n           0       0.90      1.00      0.95       271\n           1       0.00      0.00      0.00        29\n\n    accuracy                           0.90       300\n   macro avg       0.45      0.50      0.47       300\nweighted avg       0.82      0.90      0.86       300\n\nä»£ç rf_accuracy = accuracy_score(y_test_class, y_pred_rf_class)\nrf_auc = roc_auc_score(y_test_class, y_pred_rf_proba)\nprint(f\"å‡†ç¡®ç‡: {rf_accuracy:.3f}\")\n\nå‡†ç¡®ç‡: 0.903\n\nä»£ç print(f\"AUC: {rf_auc:.3f}\")\n\nAUC: 0.557\n\nä»£ç # ç‰¹å¾é‡è¦æ€§\nfeature_importance = pd.DataFrame({\n    'feature': class_features,\n    'importance': rf_class_model.feature_importances_\n}).sort_values('importance', ascending=False)\n\nprint(\"\\néšæœºæ£®æ—ç‰¹å¾é‡è¦æ€§:\")\n\n\néšæœºæ£®æ—ç‰¹å¾é‡è¦æ€§:\n\nä»£ç print(feature_importance)\n\n          feature  importance\n3    time_on_site    0.273365\n1          income    0.270106\n0             age    0.189313\n2      page_views    0.160267\n4  cart_additions    0.106949\n\nä»£ç # ROCæ›²çº¿æ¯”è¾ƒ\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# é€»è¾‘å›å½’ROC\nfpr_lr, tpr_lr, _ = roc_curve(y_test_class, y_pred_logit_proba)\nax1.plot(fpr_lr, tpr_lr, label=f'Logistic Regression (AUC = {logit_auc:.3f})')\n\n[&lt;matplotlib.lines.Line2D object at 0x0000017F8204EC10&gt;]\n\nä»£ç ax1.plot([0, 1], [0, 1], 'k--')\n\n[&lt;matplotlib.lines.Line2D object at 0x0000017F8204ED50&gt;]\n\nä»£ç ax1.set_xlabel('False Positive Rate')\n\nText(0.5, 0, 'False Positive Rate')\n\nä»£ç ax1.set_ylabel('True Positive Rate')\n\nText(0, 0.5, 'True Positive Rate')\n\nä»£ç ax1.set_title('é€»è¾‘å›å½’ROCæ›²çº¿')\n\nText(0.5, 1.0, 'é€»è¾‘å›å½’ROCæ›²çº¿')\n\nä»£ç ax1.legend()\n\n&lt;matplotlib.legend.Legend object at 0x0000017F80791A90&gt;\n\nä»£ç ax1.grid(True)\n\n# éšæœºæ£®æ—ROC\nfpr_rf, tpr_rf, _ = roc_curve(y_test_class, y_pred_rf_proba)\nax2.plot(fpr_rf, tpr_rf, label=f'Random Forest (AUC = {rf_auc:.3f})')\n\n[&lt;matplotlib.lines.Line2D object at 0x0000017F8204F890&gt;]\n\nä»£ç ax2.plot([0, 1], [0, 1], 'k--')\n\n[&lt;matplotlib.lines.Line2D object at 0x0000017F8204F9D0&gt;]\n\nä»£ç ax2.set_xlabel('False Positive Rate')\n\nText(0.5, 0, 'False Positive Rate')\n\nä»£ç ax2.set_ylabel('True Positive Rate')\n\nText(0, 0.5, 'True Positive Rate')\n\nä»£ç ax2.set_title('éšæœºæ£®æ—ROCæ›²çº¿')\n\nText(0.5, 1.0, 'éšæœºæ£®æ—ROCæ›²çº¿')\n\nä»£ç ax2.legend()\n\n&lt;matplotlib.legend.Legend object at 0x0000017F8204FB10&gt;\n\nä»£ç ax2.grid(True)\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\nä»£ç # æ¨¡å‹æ¯”è¾ƒ\ncomparison_df = pd.DataFrame({\n    'Model': ['Logistic Regression', 'Random Forest'],\n    'Accuracy': [logit_accuracy, rf_accuracy],\n    'AUC': [logit_auc, rf_auc]\n})\n\nprint(\"\\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\")\n\n\næ¨¡å‹æ€§èƒ½æ¯”è¾ƒ:\n\nä»£ç print(comparison_df)\n\n                 Model  Accuracy       AUC\n0  Logistic Regression  0.903333  0.461000\n1        Random Forest  0.903333  0.557196\n\n\n15.2.4 Pythonèšç±»åˆ†æ\n\nä»£ç from sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import silhouette_score\n\n# å‡†å¤‡èšç±»æ•°æ®\ncluster_features = ['age', 'income', 'page_views', 'time_on_site', 'cart_additions']\nX_cluster = python_user_data[cluster_features]\n\n# æ•°æ®æ ‡å‡†åŒ–\nscaler = StandardScaler()\nX_cluster_scaled = scaler.fit_transform(X_cluster)\n\n# å¯»æ‰¾æœ€ä½³èšç±»æ•°\nwcss = []\nsilhouette_scores = []\nk_range = range(2, 11)\n\nfor k in k_range:\n    kmeans = KMeans(n_clusters=k, random_state=123, n_init=10)\n    kmeans.fit(X_cluster_scaled)\n    wcss.append(kmeans.inertia_)\n    silhouette_scores.append(silhouette_score(X_cluster_scaled, kmeans.labels_))\n\n  File \"C:\\Data\\Anaconda\\Lib\\site-packages\\joblib\\externals\\loky\\backend\\context.py\", line 257, in _count_physical_cores\n    cpu_info = subprocess.run(\n        \"wmic CPU Get NumberOfCores /Format:csv\".split(),\n        capture_output=True,\n        text=True,\n    )\n  File \"C:\\Data\\Anaconda\\Lib\\subprocess.py\", line 554, in run\n    with Popen(*popenargs, **kwargs) as process:\n         ~~~~~^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Data\\Anaconda\\Lib\\subprocess.py\", line 1039, in __init__\n    self._execute_child(args, executable, preexec_fn, close_fds,\n    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                        pass_fds, cwd, env,\n                        ^^^^^^^^^^^^^^^^^^^\n    ...&lt;5 lines&gt;...\n                        gid, gids, uid, umask,\n                        ^^^^^^^^^^^^^^^^^^^^^^\n                        start_new_session, process_group)\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Data\\Anaconda\\Lib\\subprocess.py\", line 1554, in _execute_child\n    hp, ht, pid, tid = _winapi.CreateProcess(executable, args,\n                       ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^\n                             # no special security\n                             ^^^^^^^^^^^^^^^^^^^^^\n    ...&lt;4 lines&gt;...\n                             cwd,\n                             ^^^^\n                             startupinfo)\n                             ^^^^^^^^^^^^\nKMeans(n_clusters=2, n_init=10, random_state=123)\nKMeans(n_clusters=3, n_init=10, random_state=123)\nKMeans(n_clusters=4, n_init=10, random_state=123)\nKMeans(n_clusters=5, n_init=10, random_state=123)\nKMeans(n_clusters=6, n_init=10, random_state=123)\nKMeans(n_clusters=7, n_init=10, random_state=123)\nKMeans(n_init=10, random_state=123)\nKMeans(n_clusters=9, n_init=10, random_state=123)\nKMeans(n_clusters=10, n_init=10, random_state=123)\n\nä»£ç # è‚˜éƒ¨æ³•åˆ™å›¾\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 4))\n\nax1.plot(k_range, wcss, 'bo-')\n\n[&lt;matplotlib.lines.Line2D object at 0x0000017F8226E5D0&gt;]\n\nä»£ç ax1.set_xlabel('èšç±»æ•°')\n\nText(0.5, 0, 'èšç±»æ•°')\n\nä»£ç ax1.set_ylabel('WCSS')\n\nText(0, 0.5, 'WCSS')\n\nä»£ç ax1.set_title('è‚˜éƒ¨æ³•åˆ™')\n\nText(0.5, 1.0, 'è‚˜éƒ¨æ³•åˆ™')\n\nä»£ç ax2.plot(k_range, silhouette_scores, 'ro-')\n\n[&lt;matplotlib.lines.Line2D object at 0x0000017F8226E710&gt;]\n\nä»£ç ax2.set_xlabel('èšç±»æ•°')\n\nText(0.5, 0, 'èšç±»æ•°')\n\nä»£ç ax2.set_ylabel('è½®å»“ç³»æ•°')\n\nText(0, 0.5, 'è½®å»“ç³»æ•°')\n\nä»£ç ax2.set_title('è½®å»“ç³»æ•°')\n\nText(0.5, 1.0, 'è½®å»“ç³»æ•°')\n\nä»£ç plt.tight_layout()\nplt.show()\n\n\n\n\n\n\nä»£ç # æ‰§è¡ŒK-meansèšç±»\nkmeans_final = KMeans(n_clusters=4, random_state=123, n_init=10)\npython_user_data['cluster'] = kmeans_final.fit_predict(X_cluster_scaled)\n\n# èšç±»åˆ†æ\ncluster_analysis = python_user_data.groupby('cluster').agg({\n    'age': 'mean',\n    'income': 'mean',\n    'page_views': 'mean',\n    'time_on_site': 'mean',\n    'cart_additions': 'mean',\n    'made_purchase': 'mean',\n    'purchase_amount': 'mean',\n    'user_id': 'count'\n}).rename(columns={'user_id': 'count'})\n\nprint(\"èšç±»åˆ†æç»“æœ:\")\n\nèšç±»åˆ†æç»“æœ:\n\nä»£ç print(cluster_analysis.round(2))\n\n           age    income  page_views  ...  made_purchase  purchase_amount  count\ncluster                               ...                                       \n0        27.81  53227.80       26.55  ...           0.12            93.78    266\n1        41.83  37788.28       21.12  ...           0.06            84.25    242\n2        55.03  55961.32       25.49  ...           0.11            95.40    266\n3        44.12  54015.27       27.58  ...           0.11            96.53    226\n\n[4 rows x 8 columns]\n\nä»£ç # èšç±»å¯è§†åŒ–\nfig, axes = plt.subplots(2, 3, figsize=(15, 10))\nfeatures_to_plot = ['age', 'income', 'page_views', 'time_on_site', 'cart_additions', 'purchase_amount']\n\nfor i, feature in enumerate(features_to_plot):\n    row, col = i // 3, i % 3\n    python_user_data.boxplot(column=feature, by='cluster', ax=axes[row, col])\n    axes[row, col].set_title(f'{feature} by Cluster')\n\n&lt;Axes: title={'center': 'age'}, xlabel='cluster'&gt;\nText(0.5, 1.0, 'age by Cluster')\n&lt;Axes: title={'center': 'income'}, xlabel='cluster'&gt;\nText(0.5, 1.0, 'income by Cluster')\n&lt;Axes: title={'center': 'page_views'}, xlabel='cluster'&gt;\nText(0.5, 1.0, 'page_views by Cluster')\n&lt;Axes: title={'center': 'time_on_site'}, xlabel='cluster'&gt;\nText(0.5, 1.0, 'time_on_site by Cluster')\n&lt;Axes: title={'center': 'cart_additions'}, xlabel='cluster'&gt;\nText(0.5, 1.0, 'cart_additions by Cluster')\n&lt;Axes: title={'center': 'purchase_amount'}, xlabel='cluster'&gt;\nText(0.5, 1.0, 'purchase_amount by Cluster')\n\nä»£ç plt.suptitle('å„èšç±»ç¾¤ä½“ç‰¹å¾åˆ†å¸ƒ')\n\nText(0.5, 0.98, 'å„èšç±»ç¾¤ä½“ç‰¹å¾åˆ†å¸ƒ')\n\nä»£ç plt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n15.2.5 Pythonå…³è”åˆ†æ\n\nä»£ç from mlxtend.frequent_patterns import apriori, association_rules\n\n# å‡†å¤‡å…³è”åˆ†ææ•°æ®\nassociation_data = python_user_data[[f'bought_{product}' for product in products]]\n\n# æŸ¥çœ‹æ•°æ®æ¦‚è§ˆ\nprint(\"å…³è”åˆ†ææ•°æ®æ¦‚è§ˆ:\")\n\nå…³è”åˆ†ææ•°æ®æ¦‚è§ˆ:\n\nä»£ç print(association_data.head())\n\n   bought_electronics  bought_clothing  ...  bought_home  bought_sports\n0                   1                1  ...            0              1\n1                   1                1  ...            1              1\n2                   0                1  ...            1              1\n3                   1                0  ...            1              0\n4                   1                1  ...            1              1\n\n[5 rows x 5 columns]\n\nä»£ç print(f\"\\nå„äº§å“è´­ä¹°ç‡:\")\n\n\nå„äº§å“è´­ä¹°ç‡:\n\nä»£ç print(association_data.mean())\n\nbought_electronics    0.411\nbought_clothing       0.522\nbought_books          0.553\nbought_home           0.554\nbought_sports         0.565\ndtype: float64\n\nä»£ç # æŒ–æ˜é¢‘ç¹é¡¹é›† - ä½¿ç”¨æ›´å®½æ¾çš„å‚æ•°\nfrequent_itemsets = apriori(association_data, \n                           min_support=0.05,  # é™ä½æ”¯æŒåº¦\n                           use_colnames=True,\n                           max_len=4)         # é™åˆ¶æœ€å¤§é¡¹é›†å¤§å°\n\nprint(f\"\\næ‰¾åˆ°çš„é¢‘ç¹é¡¹é›†æ•°é‡: {len(frequent_itemsets)}\")\n\n\næ‰¾åˆ°çš„é¢‘ç¹é¡¹é›†æ•°é‡: 30\n\nä»£ç if len(frequent_itemsets) &gt; 0:\n    # ç”Ÿæˆå…³è”è§„åˆ™\n    rules_python = association_rules(frequent_itemsets, \n                                   metric=\"confidence\", \n                                   min_threshold=0.3)  # é™ä½ç½®ä¿¡åº¦\n    \n    print(f\"ç”Ÿæˆçš„å…³è”è§„åˆ™æ•°é‡: {len(rules_python)}\")\n    \n    if len(rules_python) &gt; 0:\n        # æ˜¾ç¤ºå‰10æ¡è§„åˆ™\n        rules_display = rules_python.sort_values('lift', ascending=False).head(10)\n        print(\"\\nå‰10æ¡å…³è”è§„åˆ™ (æŒ‰æå‡åº¦æ’åº):\")\n        for idx, rule in rules_display.iterrows():\n            antecedents = list(rule['antecedents'])\n            consequents = list(rule['consequents'])\n            print(f\"è§„åˆ™: {antecedents} -&gt; {consequents}\")\n            print(f\"  æ”¯æŒåº¦: {rule['support']:.3f}, ç½®ä¿¡åº¦: {rule['confidence']:.3f}, æå‡åº¦: {rule['lift']:.3f}\")\n            print()\n    else:\n        print(\"æ²¡æœ‰ç”Ÿæˆå…³è”è§„åˆ™ï¼Œè¯·è¿›ä¸€æ­¥é™ä½é˜ˆå€¼\")\nelse:\n    print(\"æ²¡æœ‰æ‰¾åˆ°é¢‘ç¹é¡¹é›†ï¼Œè¯·é™ä½æ”¯æŒåº¦é˜ˆå€¼\")\n\nç”Ÿæˆçš„å…³è”è§„åˆ™æ•°é‡: 137\n\nå‰10æ¡å…³è”è§„åˆ™ (æŒ‰æå‡åº¦æ’åº):\nè§„åˆ™: ['bought_home', 'bought_clothing'] -&gt; ['bought_books', 'bought_electronics']\n  æ”¯æŒåº¦: 0.146, ç½®ä¿¡åº¦: 0.465, æå‡åº¦: 1.802\n\nè§„åˆ™: ['bought_books', 'bought_electronics'] -&gt; ['bought_home', 'bought_clothing']\n  æ”¯æŒåº¦: 0.146, ç½®ä¿¡åº¦: 0.566, æå‡åº¦: 1.802\n\nè§„åˆ™: ['bought_sports', 'bought_clothing'] -&gt; ['bought_home', 'bought_electronics']\n  æ”¯æŒåº¦: 0.128, ç½®ä¿¡åº¦: 0.416, æå‡åº¦: 1.768\n\nè§„åˆ™: ['bought_home', 'bought_electronics'] -&gt; ['bought_sports', 'bought_clothing']\n  æ”¯æŒåº¦: 0.128, ç½®ä¿¡åº¦: 0.545, æå‡åº¦: 1.768\n\nè§„åˆ™: ['bought_books', 'bought_electronics'] -&gt; ['bought_sports', 'bought_clothing']\n  æ”¯æŒåº¦: 0.138, ç½®ä¿¡åº¦: 0.535, æå‡åº¦: 1.737\n\nè§„åˆ™: ['bought_sports', 'bought_clothing'] -&gt; ['bought_books', 'bought_electronics']\n  æ”¯æŒåº¦: 0.138, ç½®ä¿¡åº¦: 0.448, æå‡åº¦: 1.737\n\nè§„åˆ™: ['bought_home', 'bought_electronics'] -&gt; ['bought_books', 'bought_clothing']\n  æ”¯æŒåº¦: 0.146, ç½®ä¿¡åº¦: 0.621, æå‡åº¦: 1.721\n\nè§„åˆ™: ['bought_books', 'bought_clothing'] -&gt; ['bought_home', 'bought_electronics']\n  æ”¯æŒåº¦: 0.146, ç½®ä¿¡åº¦: 0.404, æå‡åº¦: 1.721\n\nè§„åˆ™: ['bought_home', 'bought_electronics'] -&gt; ['bought_books', 'bought_sports']\n  æ”¯æŒåº¦: 0.138, ç½®ä¿¡åº¦: 0.587, æå‡åº¦: 1.692\n\nè§„åˆ™: ['bought_books', 'bought_sports'] -&gt; ['bought_home', 'bought_electronics']\n  æ”¯æŒåº¦: 0.138, ç½®ä¿¡åº¦: 0.398, æå‡åº¦: 1.692\n\nä»£ç     \n# äº§å“å…±ç°çƒ­å›¾\nplt.figure(figsize=(8, 6))\n\n&lt;Figure size 800x600 with 0 Axes&gt;\n\nä»£ç corr_matrix = association_data.corr()\nsns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0)\n\n&lt;Axes: &gt;\n\nä»£ç plt.title('äº§å“è´­ä¹°ç›¸å…³æ€§çƒ­å›¾')\n\nText(0.5, 1.0, 'äº§å“è´­ä¹°ç›¸å…³æ€§çƒ­å›¾')\n\nä»£ç plt.tight_layout()\nplt.show()",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>20</span>Â  <span class='chapter-title'>15 æ¡ˆä¾‹ç»¼åˆåˆ†æ</span>"
    ]
  },
  {
    "objectID": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html#ç»¼åˆåˆ†æç»“æœ",
    "href": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html#ç»¼åˆåˆ†æç»“æœ",
    "title": "15 æ¡ˆä¾‹ç»¼åˆåˆ†æ",
    "section": "15.3 ç»¼åˆåˆ†æç»“æœ",
    "text": "15.3 ç»¼åˆåˆ†æç»“æœ\næ–¹æ³•æ¯”è¾ƒ\n\nä»£ç # Rå’ŒPythonç»“æœæ¯”è¾ƒ\ncat(\"## åˆ†ææ–¹æ³•æ€»ç»“\\n\\n\")\n\n## åˆ†ææ–¹æ³•æ€»ç»“\n\nä»£ç cat(\"### å›å½’åˆ†æ\\n\")\n\n### å›å½’åˆ†æ\n\nä»£ç cat(\"- çº¿æ€§å›å½’å’Œéšæœºæ£®æ—éƒ½èƒ½è¾ƒå¥½åœ°é¢„æµ‹ç”¨æˆ·æ¶ˆè´¹é‡‘é¢\\n\")\n\n- çº¿æ€§å›å½’å’Œéšæœºæ£®æ—éƒ½èƒ½è¾ƒå¥½åœ°é¢„æµ‹ç”¨æˆ·æ¶ˆè´¹é‡‘é¢\n\nä»£ç cat(\"- éšæœºæ£®æ—åœ¨éçº¿æ€§å…³ç³»å¤„ç†ä¸Šè¡¨ç°æ›´å¥½\\n\\n\")\n\n- éšæœºæ£®æ—åœ¨éçº¿æ€§å…³ç³»å¤„ç†ä¸Šè¡¨ç°æ›´å¥½\n\nä»£ç cat(\"### åˆ†ç±»åˆ†æ\\n\")\n\n### åˆ†ç±»åˆ†æ\n\nä»£ç cat(\"- é€»è¾‘å›å½’å’Œéšæœºæ£®æ—éƒ½èƒ½æœ‰æ•ˆé¢„æµ‹ç”¨æˆ·è´­ä¹°æ„å‘\\n\")\n\n- é€»è¾‘å›å½’å’Œéšæœºæ£®æ—éƒ½èƒ½æœ‰æ•ˆé¢„æµ‹ç”¨æˆ·è´­ä¹°æ„å‘\n\nä»£ç cat(\"- é¡µé¢æµè§ˆé‡å’Œè´­ç‰©è½¦æ·»åŠ æ¬¡æ•°æ˜¯æœ€é‡è¦çš„é¢„æµ‹ç‰¹å¾\\n\")\n\n- é¡µé¢æµè§ˆé‡å’Œè´­ç‰©è½¦æ·»åŠ æ¬¡æ•°æ˜¯æœ€é‡è¦çš„é¢„æµ‹ç‰¹å¾\n\nä»£ç cat(\"- éšæœºæ£®æ—åœ¨AUCæŒ‡æ ‡ä¸Šè¡¨ç°ç•¥ä¼˜äºé€»è¾‘å›å½’\\n\\n\")\n\n- éšæœºæ£®æ—åœ¨AUCæŒ‡æ ‡ä¸Šè¡¨ç°ç•¥ä¼˜äºé€»è¾‘å›å½’\n\nä»£ç cat(\"### èšç±»åˆ†æ\\n\")\n\n### èšç±»åˆ†æ\n\nä»£ç cat(\"- æˆåŠŸå°†ç”¨æˆ·åˆ†ä¸º4ä¸ªæœ‰æ„ä¹‰çš„ç¾¤ä½“\\n\")\n\n- æˆåŠŸå°†ç”¨æˆ·åˆ†ä¸º4ä¸ªæœ‰æ„ä¹‰çš„ç¾¤ä½“\n\nä»£ç cat(\"- ä¸åŒç¾¤ä½“åœ¨æ¶ˆè´¹è¡Œä¸ºå’Œç”¨æˆ·ç‰¹å¾ä¸Šæœ‰æ˜æ˜¾å·®å¼‚\\n\\n\")\n\n- ä¸åŒç¾¤ä½“åœ¨æ¶ˆè´¹è¡Œä¸ºå’Œç”¨æˆ·ç‰¹å¾ä¸Šæœ‰æ˜æ˜¾å·®å¼‚\n\nä»£ç cat(\"### å…³è”åˆ†æ\\n\")\n\n### å…³è”åˆ†æ\n\nä»£ç cat(\"- é€šè¿‡è°ƒæ•´å‚æ•°æˆåŠŸæŒ–æ˜å‡ºå…³è”è§„åˆ™\\n\")\n\n- é€šè¿‡è°ƒæ•´å‚æ•°æˆåŠŸæŒ–æ˜å‡ºå…³è”è§„åˆ™\n\nä»£ç cat(\"- å‘ç°äº†äº§å“é—´çš„è´­ä¹°æ¨¡å¼å’Œç›¸å…³å…³ç³»\\n\")\n\n- å‘ç°äº†äº§å“é—´çš„è´­ä¹°æ¨¡å¼å’Œç›¸å…³å…³ç³»\n\n\nä¸šåŠ¡å»ºè®®\n\nä»£ç cat(\"## ä¸šåŠ¡æ´å¯Ÿä¸å»ºè®®\\n\\n\")\n\n## ä¸šåŠ¡æ´å¯Ÿä¸å»ºè®®\n\nä»£ç cat(\"1. **ç”¨æˆ·åˆ†ç¾¤è¥é”€**: é’ˆå¯¹ä¸åŒèšç±»ç¾¤ä½“åˆ¶å®šä¸ªæ€§åŒ–è¥é”€ç­–ç•¥\\n\")\n\n1. **ç”¨æˆ·åˆ†ç¾¤è¥é”€**: é’ˆå¯¹ä¸åŒèšç±»ç¾¤ä½“åˆ¶å®šä¸ªæ€§åŒ–è¥é”€ç­–ç•¥\n\nä»£ç cat(\"2. **äº¤å‰é”€å”®**: åˆ©ç”¨å…³è”è§„åˆ™ç»“æœä¼˜åŒ–å•†å“æ¨èç³»ç»Ÿ\\n\")\n\n2. **äº¤å‰é”€å”®**: åˆ©ç”¨å…³è”è§„åˆ™ç»“æœä¼˜åŒ–å•†å“æ¨èç³»ç»Ÿ\n\nä»£ç cat(\"3. **ç”¨æˆ·è¡Œä¸ºé¢„æµ‹**: ä½¿ç”¨åˆ†ç±»æ¨¡å‹è¯†åˆ«é«˜ä»·å€¼æ½œåœ¨å®¢æˆ·\\n\")\n\n3. **ç”¨æˆ·è¡Œä¸ºé¢„æµ‹**: ä½¿ç”¨åˆ†ç±»æ¨¡å‹è¯†åˆ«é«˜ä»·å€¼æ½œåœ¨å®¢æˆ·\n\nä»£ç cat(\"4. **æ”¶å…¥é¢„æµ‹**: å›å½’æ¨¡å‹å¯ç”¨äºé¢„æµ‹ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼\\n\")\n\n4. **æ”¶å…¥é¢„æµ‹**: å›å½’æ¨¡å‹å¯ç”¨äºé¢„æµ‹ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼\n\nä»£ç cat(\"5. **äº§å“ç»„åˆä¼˜åŒ–**: åŸºäºå…³è”åˆ†æç»“æœè°ƒæ•´äº§å“é™ˆåˆ—å’Œæ†ç»‘é”€å”®ç­–ç•¥\\n\")\n\n5. **äº§å“ç»„åˆä¼˜åŒ–**: åŸºäºå…³è”åˆ†æç»“æœè°ƒæ•´äº§å“é™ˆåˆ—å’Œæ†ç»‘é”€å”®ç­–ç•¥\n\n\næŠ€æœ¯æ€»ç»“\n\nä»£ç cat(\"## æŠ€æœ¯å®ç°æ€»ç»“\\n\\n\")\n\n## æŠ€æœ¯å®ç°æ€»ç»“\n\nä»£ç cat(\"### æ•°æ®æ¡†æ“ä½œä¿®å¤è¦ç‚¹\\n\")\n\n### æ•°æ®æ¡†æ“ä½œä¿®å¤è¦ç‚¹\n\nä»£ç cat(\"- é¿å…å¯¹å­—ç¬¦å‹å˜é‡è¿›è¡Œæ•°å­¦è¿ç®—\\n\")\n\n- é¿å…å¯¹å­—ç¬¦å‹å˜é‡è¿›è¡Œæ•°å­¦è¿ç®—\n\nä»£ç cat(\"- ä½¿ç”¨æ˜ç¡®çš„åˆ—é€‰æ‹©ï¼Œåªå¯¹æ•°å€¼åˆ—è¿›è¡Œæ“ä½œ\\n\")\n\n- ä½¿ç”¨æ˜ç¡®çš„åˆ—é€‰æ‹©ï¼Œåªå¯¹æ•°å€¼åˆ—è¿›è¡Œæ“ä½œ\n\nä»£ç cat(\"- ä½¿ç”¨`across(where(is.numeric), ~ round(., 4))`æ—¶ç¡®ä¿åªé€‰æ‹©æ•°å€¼åˆ—\\n\\n\")\n\n- ä½¿ç”¨`across(where(is.numeric), ~ round(., 4))`æ—¶ç¡®ä¿åªé€‰æ‹©æ•°å€¼åˆ—\n\nä»£ç cat(\"### Rè¯­è¨€ä¼˜åŠ¿\\n\")\n\n### Rè¯­è¨€ä¼˜åŠ¿\n\nä»£ç cat(\"- ç»Ÿè®¡å»ºæ¨¡åŠŸèƒ½å¼ºå¤§ï¼Œæ¨¡å‹è¾“å‡ºè¯¦ç»†\\n\")\n\n- ç»Ÿè®¡å»ºæ¨¡åŠŸèƒ½å¼ºå¤§ï¼Œæ¨¡å‹è¾“å‡ºè¯¦ç»†\n\nä»£ç cat(\"- å¯è§†åŒ–åº“ä¸°å¯Œï¼Œå›¾å½¢è´¨é‡é«˜\\n\")\n\n- å¯è§†åŒ–åº“ä¸°å¯Œï¼Œå›¾å½¢è´¨é‡é«˜\n\nä»£ç cat(\"- æ•°æ®å¤„ç†ç®¡é“æ¸…æ™°æ˜“è¯»\\n\\n\")\n\n- æ•°æ®å¤„ç†ç®¡é“æ¸…æ™°æ˜“è¯»\n\nä»£ç cat(\"### Pythonä¼˜åŠ¿\\n\")\n\n### Pythonä¼˜åŠ¿\n\nä»£ç cat(\"- æœºå™¨å­¦ä¹ åº“ç”Ÿæ€ç³»ç»Ÿå®Œå–„\\n\")\n\n- æœºå™¨å­¦ä¹ åº“ç”Ÿæ€ç³»ç»Ÿå®Œå–„\n\nä»£ç cat(\"- ä»£ç ç®€æ´ï¼Œéƒ¨ç½²æ–¹ä¾¿\\n\")\n\n- ä»£ç ç®€æ´ï¼Œéƒ¨ç½²æ–¹ä¾¿\n\nä»£ç cat(\"- æ·±åº¦å­¦ä¹ å’Œå¤§æ•°æ®å¤„ç†èƒ½åŠ›å¼º\\n\\n\")\n\n- æ·±åº¦å­¦ä¹ å’Œå¤§æ•°æ®å¤„ç†èƒ½åŠ›å¼º\n\nä»£ç cat(\"### æ¨èä½¿ç”¨åœºæ™¯\\n\")\n\n### æ¨èä½¿ç”¨åœºæ™¯\n\nä»£ç cat(\"- **å­¦æœ¯ç ”ç©¶ã€ç»Ÿè®¡åˆ†æ**: æ¨èä½¿ç”¨R\\n\")\n\n- **å­¦æœ¯ç ”ç©¶ã€ç»Ÿè®¡åˆ†æ**: æ¨èä½¿ç”¨R\n\nä»£ç cat(\"- **ç”Ÿäº§ç¯å¢ƒã€å¤§å‹é¡¹ç›®**: æ¨èä½¿ç”¨Python\\n\")\n\n- **ç”Ÿäº§ç¯å¢ƒã€å¤§å‹é¡¹ç›®**: æ¨èä½¿ç”¨Python\n\nä»£ç cat(\"- **æ··åˆä½¿ç”¨**: æ ¹æ®å…·ä½“ä»»åŠ¡é€‰æ‹©æœ€é€‚åˆçš„å·¥å…·\\n\")\n\n- **æ··åˆä½¿ç”¨**: æ ¹æ®å…·ä½“ä»»åŠ¡é€‰æ‹©æœ€é€‚åˆçš„å·¥å…·",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>20</span>Â  <span class='chapter-title'>15 æ¡ˆä¾‹ç»¼åˆåˆ†æ</span>"
    ]
  },
  {
    "objectID": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html#é™„å½•",
    "href": "chapters/15 æ¡ˆä¾‹ç»¼åˆåˆ†æ.html#é™„å½•",
    "title": "15 æ¡ˆä¾‹ç»¼åˆåˆ†æ",
    "section": "15.4 é™„å½•",
    "text": "15.4 é™„å½•\næ•°æ®å­—å…¸\n\n\nå˜é‡å\næè¿°\nç±»å‹\n\n\n\nuser_id\nç”¨æˆ·ID\næ•°å€¼\n\n\nage\nå¹´é¾„\næ•°å€¼\n\n\ngender\næ€§åˆ«\nåˆ†ç±»\n\n\nincome\næ”¶å…¥\næ•°å€¼\n\n\nregion\nåœ°åŒº\nåˆ†ç±»\n\n\npage_views\né¡µé¢æµè§ˆé‡\næ•°å€¼\n\n\ntime_on_site\nç½‘ç«™åœç•™æ—¶é—´(ç§’)\næ•°å€¼\n\n\ncart_additions\nè´­ç‰©è½¦æ·»åŠ æ¬¡æ•°\næ•°å€¼\n\n\npurchase_amount\nè´­ä¹°é‡‘é¢\næ•°å€¼\n\n\nmade_purchase\næ˜¯å¦è´­ä¹°\näºŒåˆ†ç±»\n\n\n\nä¾èµ–åŒ…åˆ—è¡¨\nRåŒ…: - dplyr, ggplot2, caret, randomForest, factoextra, arules, arulesViz, corrplot, pROC, patchwork, tidyr\nPythonåŒ…: - pandas, numpy, matplotlib, seaborn, scikit-learn, mlxtend",
    "crumbs": [
      "IV å®è·µâ€”â€”ç»¼åˆæ¡ˆä¾‹åˆ†æ",
      "<span class='chapter-number'>20</span>Â  <span class='chapter-title'>15 æ¡ˆä¾‹ç»¼åˆåˆ†æ</span>"
    ]
  }
]