{
  "hash": "06c6a7982a4ddabd256f811ceb97533a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"13 回归任务与基准测试\"\nformat: html\neditor: visual\n---\n\n\n\n## 回归任务导读\n\n回归分析是预测建模中最基础且重要的任务，广泛应用于房价预测、销量预测、风险评估等领域。本章将通过波士顿房价预测案例，完整展示回归问题的解决方案，涵盖数据探索、特征工程、多种回归算法比较、模型评估等关键环节。\n\n数据集说明 本案例使用糖尿病数据集（Diabetes Dataset），包含糖尿病患者的生理指标和疾病进展指标。\n\n问题定义 **目标**：预测糖尿病疾病的进展（target）\\\n**任务类型**：回归分析\\\n**业务价值**：为医疗诊断和治疗方案制定提供数据支持\n\n## 13.1 R语言实现 (mlr3框架)\n\n数据加载与探索\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 综合案例：糖尿病进展预测 - R语言实现 (mlr3框架)\n\n# 加载必要的包\nlibrary(mlr3)\nlibrary(mlr3verse)\nlibrary(mlr3pipelines)\nlibrary(mlr3tuning)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(corrplot)\nlibrary(gridExtra)\n\n\n# 加载糖尿病数据集\nlibrary(lars)\ndata(diabetes)\nvariable_names <- c(\"age\", \"sex\", \"bmi\", \"map\", \"tc\", \"ldl\", \"hdl\", \"tch\", \"ltg\", \"glu\")\n\ndiabetes_data <- as.data.frame(matrix(unlist(diabetes$x), ncol = 10))\ncolnames(diabetes_data) <- variable_names\n\nstr(diabetes_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t442 obs. of  10 variables:\n $ age: num  0.03808 -0.00188 0.0853 -0.08906 0.00538 ...\n $ sex: num  0.0507 -0.0446 0.0507 -0.0446 -0.0446 ...\n $ bmi: num  0.0617 -0.0515 0.0445 -0.0116 -0.0364 ...\n $ map: num  0.02187 -0.02633 -0.00567 -0.03666 0.02187 ...\n $ tc : num  -0.04422 -0.00845 -0.0456 0.01219 0.00393 ...\n $ ldl: num  -0.0348 -0.0192 -0.0342 0.025 0.0156 ...\n $ hdl: num  -0.0434 0.07441 -0.03236 -0.03604 0.00814 ...\n $ tch: num  -0.00259 -0.03949 -0.00259 0.03431 -0.00259 ...\n $ ltg: num  0.01991 -0.06833 0.00286 0.02269 -0.03199 ...\n $ glu: num  -0.01765 -0.0922 -0.02593 -0.00936 -0.04664 ...\n```\n\n\n:::\n\n```{.r .cell-code}\ndiabetes_data$target <- diabetes$y\n\n# 检查缺失值\ncat(\"\\n缺失值检查:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n缺失值检查:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(colSums(is.na(diabetes_data)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   age    sex    bmi    map     tc    ldl    hdl    tch    ltg    glu target \n     0      0      0      0      0      0      0      0      0      0      0 \n```\n\n\n:::\n:::\n\n\n数据可视化分析\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 数据可视化分析 - R语言\n\n# 目标变量分布\np1 <- ggplot(diabetes_data, aes(x = target)) +\n  geom_histogram(bins = 30, fill = \"steelblue\", alpha = 0.7) +\n  labs(title = \"疾病进展分布\", x = \"疾病进展指标\", y = \"频数\") +\n  theme_minimal()\n\n# 疾病进展与关键变量的关系\np2 <- ggplot(diabetes_data, aes(x = bmi, y = target)) +\n  geom_point(alpha = 0.6, color = \"darkred\") +\n  geom_smooth(method = \"lm\", color = \"blue\") +\n  labs(title = \"BMI与疾病进展关系\", x = \"BMI\", y = \"疾病进展\") +\n  theme_minimal()\n\np3 <- ggplot(diabetes_data, aes(x = ltg, y = target)) +\n  geom_point(alpha = 0.6, color = \"darkgreen\") +\n  geom_smooth(method = \"loess\", color = \"red\") +\n  labs(title = \"稳定血糖与疾病进展\", x = \"稳定血糖\", y = \"疾病进展\") +\n  theme_minimal()\n\np4 <- ggplot(diabetes_data, aes(x = age, y = target)) +\n  geom_point(alpha = 0.6, color = \"purple\") +\n  geom_smooth(method = \"lm\", color = \"orange\") +\n  labs(title = \"年龄与疾病进展关系\", x = \"年龄\", y = \"疾病进展\") +\n  theme_minimal()\n\n# 组合图形\ngrid.arrange(p1, p2, p3, p4, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 相关性热图\ncor_matrix <- cor(diabetes_data)\ncorrplot(cor_matrix, method = \"color\", type = \"upper\", \n         order = \"hclust\", tl.cex = 0.7, tl.col = \"black\",\n         title = \"变量相关性热图\")\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n创建mlr3任务和数据预处理\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 创建mlr3任务和数据预处理\n\n# 创建回归任务\ntask_diabetes <- as_task_regr(diabetes_data, target = \"target\", id = \"diabetes\",store_backends = TRUE)\n\n# 查看任务信息\ncat(\"任务信息:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n任务信息:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(task_diabetes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n── <TaskRegr> (442x11) ─────────────────────────────────────────────────────────\n• Target: target\n• Properties: -\n• Features (10):\n  • dbl (10): age, bmi, glu, hdl, ldl, ltg, map, sex, tc, tch\n```\n\n\n:::\n\n```{.r .cell-code}\n# 数据预处理管道\npreprocess_pipeline <- po(\"scale\") %>>% \n  po(\"colapply\", applicator = as.numeric)\n\n# 应用预处理\ntask_preprocessed <- preprocess_pipeline$train(task_diabetes)[[1]]\n\ncat(\"\\n预处理后的任务信息:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n预处理后的任务信息:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(task_preprocessed)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n── <TaskRegr> (442x11) ─────────────────────────────────────────────────────────\n• Target: target\n• Properties: -\n• Features (10):\n  • dbl (10): age, bmi, glu, hdl, ldl, ltg, map, sex, tc, tch\n```\n\n\n:::\n:::\n\n\n模型训练与比较\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 模型训练与比较 - mlr3\n\n# 定义学习器\nlearners <- list(\n  lrn(\"regr.lm\", id = \"linear_regression\"),\n  lrn(\"regr.ranger\", id = \"random_forest\"),\n  lrn(\"regr.xgboost\", id = \"xgboost\"),\n  lrn(\"regr.svm\", id = \"svm\"),\n  lrn(\"regr.kknn\", id = \"knn\")\n)\n\n# 设置交叉验证\nresampling <- rsmp(\"cv\", folds = 5)\n\n# 基准测试\ndesign <- benchmark_grid(\n  tasks = task_preprocessed,\n  learners = learners,\n  resamplings = resampling\n)\n\nbmr <- benchmark(\n  design,\n  store_backends = TRUE, \n  store_models = TRUE)\n\n# 性能评估\ncat(\"模型性能比较:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n模型性能比较:\n```\n\n\n:::\n\n```{.r .cell-code}\nperformance_measures <- msrs(c(\"regr.mse\", \"regr.rmse\", \"regr.mae\", \"regr.rsq\"))\nbmr_aggregated <- bmr$aggregate(performance_measures)\n\n# 格式化输出结果\nresults_r <- bmr_aggregated[, .(\n  Model = learner_id,\n  RMSE = regr.rmse,\n  MSE = regr.mse,\n  MAE = regr.mae,\n  R2 = regr.rsq\n)]\n\nprint(results_r[order(RMSE)])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Model     RMSE      MSE      MAE        R2\n              <char>    <num>    <num>    <num>     <num>\n1: linear_regression 54.32812 2959.818 44.08989 0.4992770\n2:     random_forest 56.24742 3175.846 46.10112 0.4634585\n3:               svm 57.29007 3286.445 44.91594 0.4431697\n4:               knn 61.63274 3808.714 48.02614 0.3550164\n5:           xgboost 63.20336 4017.177 50.00323 0.3230514\n```\n\n\n:::\n\n```{.r .cell-code}\n# 性能可视化\nggplot(results_r, aes(x = reorder(Model, RMSE), y = RMSE)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\", alpha = 0.7) +\n  labs(title = \"模型性能比较 (RMSE) - R/mlr3\", x = \"模型\", y = \"RMSE\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n超参数调优\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 超参数调优示例 - 随机森林\n\nlibrary(mlr3)           # 核心\nlibrary(mlr3learners)   # 学习器\nlibrary(mlr3tuning)     # 参数调优（包含 tnr()）\nlibrary(paradox)        # 参数空间\nlibrary(mlr3viz)        # 可视化\n# 定义随机森林学习器\nlearner_rf_tune <- lrn(\"regr.ranger\", num.trees = 100)\n\n# 定义超参数空间\nparam_set <- ps(\n  mtry = p_int(lower = 2, upper = ncol(diabetes_data) - 1),\n  min.node.size = p_int(lower = 1, upper = 10),\n  sample.fraction = p_dbl(lower = 0.6, upper = 0.9)\n)\n\n# 定义调优器\ntuner <- tnr(\"grid_search\", resolution = 5)\nterminator <- trm(\"evals\", n_evals = 10)\n\n# 自动调优\nat <- auto_tuner(\n  tuner = tuner,\n  learner = learner_rf_tune,\n  resampling = rsmp(\"holdout\"),\n  measure = msr(\"regr.rmse\"),\n  search_space = param_set,\n  terminator = terminator\n)\n\n# 在数据上演示调优\nset.seed(123)\nat$train(task_preprocessed)\n\ncat(\"最佳参数:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n最佳参数:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(at$tuning_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    mtry min.node.size sample.fraction learner_param_vals  x_domain regr.rmse\n   <int>         <int>           <num>             <list>    <list>     <num>\n1:     8             3           0.675          <list[6]> <list[3]>  55.69813\n```\n\n\n:::\n\n```{.r .cell-code}\n# 使用调优后的模型进行预测\npredictions_tuned <- at$predict(task_preprocessed)\ncat(\"调优完成\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n调优完成\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"调优后模型RMSE:\", predictions_tuned$score(msr(\"regr.rmse\")), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n调优后模型RMSE: 30.78791 \n```\n\n\n:::\n:::\n\n\n模型解释\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 模型解释 - 特征重要性\n\nlibrary(ggplot2)\n# 训练最佳模型（随机森林）\nset.seed(123)\nlearner_best <- lrn(\"regr.ranger\", importance = \"permutation\")\nlearner_best$train(task_preprocessed)\n\n# 特征重要性\nif (!is.null(learner_best$importance)) {\n  feature_importance <- learner_best$importance()\n  importance_df <- data.frame(\n    Feature = names(feature_importance),\n    Importance = as.numeric(feature_importance)\n  )\n  importance_df <- importance_df[order(-importance_df$Importance), ]\n  \n  cat(\"特征重要性排序:\\n\")\n  print(importance_df)\n  \n  # 可视化特征重要性\n  ggplot(head(importance_df, 8), aes(x = reorder(Feature, Importance), y = Importance)) +\n    geom_bar(stat = \"identity\", fill = \"darkorange\", alpha = 0.7) +\n    labs(title = \"特征重要性 - 随机森林\", x = \"特征\", y = \"重要性\") +\n    coord_flip() +\n    theme_minimal()\n} else {\n  cat(\"该学习器不支持特征重要性计算\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n特征重要性排序:\n   Feature Importance\n1      ltg 1469.33233\n2      bmi 1457.20570\n3      map  464.11349\n4      tch  363.93017\n5      hdl  261.42699\n6       tc  156.66425\n7      ldl  135.23885\n8      glu  129.35189\n9      age   66.95241\n10     sex   65.88863\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n模型预测与残差分析\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 模型预测与残差分析\n\n# 使用最佳模型进行预测\npredictions <- learner_best$predict(task_preprocessed)\n\n# 创建预测结果数据框\nresults_df <- data.frame(\n  Actual = predictions$truth,\n  Predicted = predictions$response,\n  Residual = predictions$truth - predictions$response\n)\n\n# 预测 vs 实际值图\np1 <- ggplot(results_df, aes(x = Actual, y = Predicted)) +\n  geom_point(alpha = 0.6, color = \"steelblue\") +\n  geom_abline(slope = 1, intercept = 0, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"预测值 vs 实际值\", x = \"实际值\", y = \"预测值\") +\n  theme_minimal()\n\n# 残差图\np2 <- ggplot(results_df, aes(x = Predicted, y = Residual)) +\n  geom_point(alpha = 0.6, color = \"darkred\") +\n  geom_hline(yintercept = 0, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"残差分析\", x = \"预测值\", y = \"残差\") +\n  theme_minimal()\n\ngrid.arrange(p1, p2, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## 13.2 Python (sklearn框架)--回归\n\n数据加载与探索\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 综合案例：糖尿病进展预测 - Python语言实现 (sklearn框架)\nimport sys\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.datasets import load_diabetes\nfrom sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso\nfrom sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error\nfrom sklearn.inspection import permutation_importance\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# 设置图形样式\nplt.style.use('default')\nsns.set_palette(\"husl\")\n\n# 加载糖尿病数据集\ndiabetes = pd.read_csv(\"data/diabetes.csv\")\nX = diabetes.iloc[:, :-2] # 所有行，除第3列（bp）的所有列\ny = diabetes.iloc[:, -2]   # 所有行，第3列\ndiabetes_data = pd.concat([X, y], axis=1)\n\nprint(\"数据集基本信息:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n数据集基本信息:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(f\"样本数: {diabetes_data.shape[0]}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n样本数: 442\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(f\"变量数: {diabetes_data.shape[1]}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n变量数: 9\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"\\n变量名称:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n变量名称:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(diabetes_data.columns.tolist())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n['age', 'sex', 'bmi', 'bp', 's1', 's2', 's3', 's4', 's5']\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"\\n数据概览:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n数据概览:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(diabetes_data.describe())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              age         sex         bmi  ...          s3          s4          s5\ncount  442.000000  442.000000  442.000000  ...  442.000000  442.000000  442.000000\nmean     0.000136    0.002149   -0.000136  ...    0.000204   -0.000362    0.000023\nstd      0.047790    0.044961    0.047771  ...    0.047320    0.047789    0.047545\nmin     -0.110000   -0.040000   -0.090000  ...   -0.100000   -0.080000   -0.130000\n25%     -0.037500   -0.040000   -0.030000  ...   -0.037500   -0.040000   -0.030000\n50%      0.010000   -0.040000   -0.010000  ...   -0.010000   -0.000000    0.000000\n75%      0.040000    0.050000    0.030000  ...    0.030000    0.030000    0.030000\nmax      0.110000    0.050000    0.170000  ...    0.180000    0.190000    0.130000\n\n[8 rows x 9 columns]\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"\\n缺失值检查:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n缺失值检查:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(diabetes_data.isnull().sum())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nage    0\nsex    0\nbmi    0\nbp     0\ns1     0\ns2     0\ns3     0\ns4     0\ns5     0\ndtype: int64\n```\n\n\n:::\n:::\n\n\n数据可视化分析\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 数据可视化分析 - Python\n\nfig, axes = plt.subplots(2, 2, figsize=(15, 12))\n\n# 目标变量分布\naxes[0,0].hist(diabetes_data['bp'], bins=30, color='steelblue', alpha=0.7)\naxes[0,0].set_title('疾病进展分布')\naxes[0,0].set_xlabel('疾病进展指标')\naxes[0,0].set_ylabel('频数')\n\n# 疾病进展与关键变量的关系\naxes[0,1].scatter(diabetes_data['bmi'], diabetes_data['bp'], alpha=0.6, color='darkred')\nz = np.polyfit(diabetes_data['bmi'], diabetes_data['bp'], 1)\np = np.poly1d(z)\naxes[0,1].plot(diabetes_data['bmi'], p(diabetes_data['bmi']), \"b-\", alpha=0.8)\naxes[0,1].set_title('BMI与疾病进展关系')\naxes[0,1].set_xlabel('BMI')\naxes[0,1].set_ylabel('疾病进展')\n\naxes[1,0].scatter(diabetes_data['s5'], diabetes_data['bp'], alpha=0.6, color='darkgreen')\nz = np.polyfit(diabetes_data['s5'], diabetes_data['bp'], 1)\np = np.poly1d(z)\naxes[1,0].plot(diabetes_data['s5'], p(diabetes_data['s5']), \"r-\", alpha=0.8)\naxes[1,0].set_title('稳定血糖与疾病进展')\naxes[1,0].set_xlabel('稳定血糖')\naxes[1,0].set_ylabel('疾病进展')\n\naxes[1,1].scatter(diabetes_data['age'], diabetes_data['bp'], alpha=0.6, color='purple')\nz = np.polyfit(diabetes_data['age'], diabetes_data['bp'], 1)\np = np.poly1d(z)\naxes[1,1].plot(diabetes_data['age'], p(diabetes_data['age']), \"orange\", alpha=0.8)\naxes[1,1].set_title('年龄与疾病进展关系')\naxes[1,1].set_xlabel('年龄')\naxes[1,1].set_ylabel('疾病进展')\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-10-1.png)\n:::\n\n```{.python .cell-code}\n# 相关性热图\nplt.figure(figsize=(12, 10))\ncorr_matrix = diabetes_data.corr()\nsns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0,\n            square=True, linewidths=0.5, cbar_kws={\"shrink\": 0.8}, fmt='.2f')\nplt.title('变量相关性热图 - Python/sklearn')\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-10-2.png)\n:::\n:::\n\n\n数据预处理\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 数据预处理 - Python\n\n# 准备特征和目标变量\nX = diabetes_data.drop('bp', axis=1)\ny = diabetes_data['bp']\n\n# 数据划分\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)\n\nprint(f\"训练集大小: {X_train.shape[0]}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n训练集大小: 309\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(f\"测试集大小: {X_test.shape[0]}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n测试集大小: 133\n```\n\n\n:::\n\n```{.python .cell-code}\n# 数据标准化\nscaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.transform(X_test)\n\nprint(\"数据预处理完成\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n数据预处理完成\n```\n\n\n:::\n:::\n\n\n模型训练与比较\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 模型训练与比较 - sklearn\n\n# 定义模型字典\nmodels = {\n    'Linear Regression': LinearRegression(),\n    'Ridge Regression': Ridge(alpha=1.0),\n    'Lasso Regression': Lasso(alpha=0.1),\n    'Random Forest': RandomForestRegressor(n_estimators=100, random_state=42),\n    'Gradient Boosting': GradientBoostingRegressor(n_estimators=100, random_state=42),\n    'Support Vector Regression': SVR(kernel='rbf', C=1.0),\n    'K-Neighbors': KNeighborsRegressor(n_neighbors=5)\n}\n\n# 训练和评估模型\nresults = []\n\nfor name, model in models.items():\n    # 训练模型\n    model.fit(X_train_scaled, y_train)\n    \n    # 预测\n    y_pred = model.predict(X_test_scaled)\n    \n    # 计算评估指标\n    mse = mean_squared_error(y_test, y_pred)\n    rmse = np.sqrt(mse)\n    mae = mean_absolute_error(y_test, y_pred)\n    r2 = r2_score(y_test, y_pred)\n    \n    # 交叉验证\n    cv_scores = cross_val_score(model, X_train_scaled, y_train, cv=5, scoring='neg_mean_squared_error')\n    cv_rmse = np.sqrt(-cv_scores.mean())\n    \n    results.append({\n        'Model': name,\n        'RMSE': rmse,\n        'MSE': mse,\n        'MAE': mae,\n        'R2': r2,\n        'CV_RMSE': cv_rmse\n    })\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<style>#sk-container-id-1 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-1 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-1 pre {\n  padding: 0;\n}\n\n#sk-container-id-1 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-1 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-1 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-1 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-1 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-1 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-1 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-1 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-1 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-1 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"▸\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-1 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"▾\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n#sk-container-id-1 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-1 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-1 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-1 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-1 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-1 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-1 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsRegressor()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>KNeighborsRegressor</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.neighbors.KNeighborsRegressor.html\">?<span>Documentation for KNeighborsRegressor</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>KNeighborsRegressor()</pre></div> </div></div></div></div>\n```\n\n:::\n\n```{.python .cell-code}\n# 创建结果DataFrame\nresults_python = pd.DataFrame(results)\nprint(\"模型性能比较 - Python/sklearn:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n模型性能比较 - Python/sklearn:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(results_python.sort_values('RMSE'))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                       Model      RMSE       MSE       MAE        R2   CV_RMSE\n1           Ridge Regression  0.037728  0.001423  0.029903  0.346299  0.041949\n0          Linear Regression  0.037869  0.001434  0.030070  0.341403  0.041985\n3              Random Forest  0.039989  0.001599  0.032433  0.265591  0.044513\n4          Gradient Boosting  0.040339  0.001627  0.032044  0.252692  0.045652\n6                K-Neighbors  0.041668  0.001736  0.032857  0.202630  0.044115\n2           Lasso Regression  0.046838  0.002194  0.039821 -0.007507  0.048294\n5  Support Vector Regression  0.048922  0.002393  0.042729 -0.099178  0.050173\n```\n\n\n:::\n\n```{.python .cell-code}\n# 可视化模型比较\nfig, axes = plt.subplots(1, 2, figsize=(15, 6))\n\n# RMSE比较\nmodels_sorted = results_python.sort_values('RMSE')\naxes[0].barh(models_sorted['Model'], models_sorted['RMSE'], color='lightcoral')\naxes[0].set_xlabel('RMSE')\naxes[0].set_title('模型RMSE比较 - Python/sklearn')\naxes[0].grid(axis='x', alpha=0.3)\n\n# R²比较\naxes[1].barh(models_sorted['Model'], models_sorted['R2'], color='lightseagreen')\naxes[1].set_xlabel('R²')\naxes[1].set_title('模型R²比较 - Python/sklearn')\naxes[1].grid(axis='x', alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-12-5.png)\n:::\n:::\n\n\n超参数调优\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 超参数调优示例 - 随机森林\n\n# 定义参数网格\nparam_grid = {\n    'n_estimators': [50, 100, 200],\n    'max_depth': [5, 10, 15],\n    'min_samples_split': [2, 5, 10],\n    'min_samples_leaf': [1, 2, 4]\n}\n\n# 使用网格搜索\nrf = RandomForestRegressor(random_state=42)\ngrid_search = GridSearchCV(rf, param_grid, cv=3, scoring='neg_mean_squared_error', \n                          n_jobs=-1, verbose=1)\n\nprint(\"开始超参数调优...\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n开始超参数调优...\n```\n\n\n:::\n\n```{.python .cell-code}\ngrid_search.fit(X_train_scaled, y_train)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<style>#sk-container-id-2 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: #000;\n  --sklearn-color-text-muted: #666;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-2 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-2 pre {\n  padding: 0;\n}\n\n#sk-container-id-2 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-2 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-2 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-2 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-2 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-2 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-2 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-2 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-2 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-2 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-2 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-2 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-2 label.sk-toggleable__label {\n  cursor: pointer;\n  display: flex;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n  align-items: start;\n  justify-content: space-between;\n  gap: 0.5em;\n}\n\n#sk-container-id-2 label.sk-toggleable__label .caption {\n  font-size: 0.6rem;\n  font-weight: lighter;\n  color: var(--sklearn-color-text-muted);\n}\n\n#sk-container-id-2 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"▸\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-2 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-2 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-2 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-2 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"▾\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-2 div.sk-label label.sk-toggleable__label,\n#sk-container-id-2 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-2 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-2 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-2 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-2 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-2 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-2 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 0.5em;\n  text-align: center;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-2 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-2 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-2 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-2 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-2\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(cv=3, estimator=RandomForestRegressor(random_state=42), n_jobs=-1,\n             param_grid={&#x27;max_depth&#x27;: [5, 10, 15],\n                         &#x27;min_samples_leaf&#x27;: [1, 2, 4],\n                         &#x27;min_samples_split&#x27;: [2, 5, 10],\n                         &#x27;n_estimators&#x27;: [50, 100, 200]},\n             scoring=&#x27;neg_mean_squared_error&#x27;, verbose=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>GridSearchCV</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.model_selection.GridSearchCV.html\">?<span>Documentation for GridSearchCV</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>GridSearchCV(cv=3, estimator=RandomForestRegressor(random_state=42), n_jobs=-1,\n             param_grid={&#x27;max_depth&#x27;: [5, 10, 15],\n                         &#x27;min_samples_leaf&#x27;: [1, 2, 4],\n                         &#x27;min_samples_split&#x27;: [2, 5, 10],\n                         &#x27;n_estimators&#x27;: [50, 100, 200]},\n             scoring=&#x27;neg_mean_squared_error&#x27;, verbose=1)</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>best_estimator_: RandomForestRegressor</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>RandomForestRegressor(max_depth=5, min_samples_leaf=4, min_samples_split=10,\n                      n_estimators=50, random_state=42)</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>RandomForestRegressor</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.ensemble.RandomForestRegressor.html\">?<span>Documentation for RandomForestRegressor</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>RandomForestRegressor(max_depth=5, min_samples_leaf=4, min_samples_split=10,\n                      n_estimators=50, random_state=42)</pre></div> </div></div></div></div></div></div></div></div></div>\n```\n\n:::\n\n```{.python .cell-code}\nprint(\"最佳参数:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n最佳参数:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(grid_search.best_params_)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n{'max_depth': 5, 'min_samples_leaf': 4, 'min_samples_split': 10, 'n_estimators': 50}\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(f\"最佳分数: {-grid_search.best_score_:.4f}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n最佳分数: 0.0019\n```\n\n\n:::\n\n```{.python .cell-code}\n# 使用最佳参数训练最终模型\nbest_rf = grid_search.best_estimator_\ny_pred_best = best_rf.predict(X_test_scaled)\nbest_rmse = np.sqrt(mean_squared_error(y_test, y_pred_best))\nprint(f\"调优后测试集RMSE: {best_rmse:.4f}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n调优后测试集RMSE: 0.0382\n```\n\n\n:::\n:::\n\n\n模型解释\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 模型解释 - 特征重要性\n\n# 使用最佳随机森林模型\nfeature_importance = best_rf.feature_importances_\nfeature_names = X.columns\n\n# 创建特征重要性DataFrame\nimportance_df = pd.DataFrame({\n    'Feature': feature_names,\n    'Importance': feature_importance\n}).sort_values('Importance', ascending=False)\n\nprint(\"特征重要性排序 - Python/sklearn:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n特征重要性排序 - Python/sklearn:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(importance_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Feature  Importance\n2     bmi    0.270091\n0     age    0.211172\n7      s5    0.200046\n3      s1    0.106677\n4      s2    0.076392\n5      s3    0.066895\n6      s4    0.038475\n1     sex    0.030252\n```\n\n\n:::\n\n```{.python .cell-code}\n# 可视化特征重要性\nplt.figure(figsize=(10, 6))\nsns.barplot(data=importance_df, x='Importance', y='Feature', palette='viridis')\nplt.title('特征重要性 - 随机森林 (Python/sklearn)')\nplt.xlabel('重要性')\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-14-7.png)\n:::\n\n```{.python .cell-code}\n# 排列重要性\nperm_importance = permutation_importance(best_rf, X_test_scaled, y_test, \n                                        n_repeats=10, random_state=42)\n\nperm_importance_df = pd.DataFrame({\n    'Feature': feature_names,\n    'Importance': perm_importance.importances_mean\n}).sort_values('Importance', ascending=False)\n\nprint(\"\\n排列特征重要性:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n排列特征重要性:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(perm_importance_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Feature  Importance\n2     bmi    0.160578\n0     age    0.152412\n7      s5    0.106752\n4      s2    0.034918\n1     sex    0.026204\n3      s1    0.012667\n6      s4    0.010379\n5      s3   -0.016267\n```\n\n\n:::\n\n```{.python .cell-code}\n# 可视化排列重要性\nplt.figure(figsize=(10, 6))\nsns.barplot(data=perm_importance_df, x='Importance', y='Feature', palette='rocket')\nplt.title('排列特征重要性 - 随机森林 (Python/sklearn)')\nplt.xlabel('重要性')\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-14-8.png)\n:::\n:::\n\n\n模型预测与残差分析\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 模型预测与残差分析\n\n# 使用最佳模型进行预测\ny_pred = best_rf.predict(X_test_scaled)\nresiduals = y_test - y_pred\n\n# 创建预测结果数据框\nresults_df = pd.DataFrame({\n    'Actual': y_test,\n    'Predicted': y_pred,\n    'Residual': residuals\n})\n\n# 预测 vs 实际值图\nfig, axes = plt.subplots(1, 2, figsize=(15, 6))\n\naxes[0].scatter(results_df['Actual'], results_df['Predicted'], alpha=0.6, color='steelblue')\naxes[0].plot([results_df['Actual'].min(), results_df['Actual'].max()], \n            [results_df['Actual'].min(), results_df['Actual'].max()], \n            'r--', lw=2)\naxes[0].set_xlabel('实际值')\naxes[0].set_ylabel('预测值')\naxes[0].set_title('预测值 vs 实际值')\naxes[0].grid(alpha=0.3)\n\n# 残差图\naxes[1].scatter(results_df['Predicted'], results_df['Residual'], alpha=0.6, color='darkred')\naxes[1].axhline(y=0, color='r', linestyle='--')\naxes[1].set_xlabel('预测值')\naxes[1].set_ylabel('残差')\naxes[1].set_title('残差分析')\naxes[1].grid(alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](13-回归任务与基准测试_files/figure-html/unnamed-chunk-15-11.png)\n:::\n:::\n\n\n## 13.3 案例总结\n\n关键发现\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 案例总结 - R语言\ncat(\"=== 糖尿病进展预测案例总结 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== 糖尿病进展预测案例总结 ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"1. 数据特征:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1. 数据特征:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   - 数据集包含\", nrow(diabetes_data), \"个样本，\", ncol(diabetes_data)-1, \"个特征\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 数据集包含 442 个样本， 10 个特征\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   - 目标变量: 疾病进展指标\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 目标变量: 疾病进展指标\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   - 最重要的特征: bmi, s5(稳定血糖), bp(血压)\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 最重要的特征: bmi, s5(稳定血糖), bp(血压)\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"2. 模型性能比较:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2. 模型性能比较:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(results_r[order(RMSE)])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Model     RMSE      MSE      MAE        R2\n              <char>    <num>    <num>    <num>     <num>\n1: linear_regression 54.32812 2959.818 44.08989 0.4992770\n2:     random_forest 56.24742 3175.846 46.10112 0.4634585\n3:               svm 57.29007 3286.445 44.91594 0.4431697\n4:               knn 61.63274 3808.714 48.02614 0.3550164\n5:           xgboost 63.20336 4017.177 50.00323 0.3230514\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n3. 最佳实践:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n3. 最佳实践:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   - 树模型在医疗数据上表现优异\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 树模型在医疗数据上表现优异\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   - 特征标准化对模型性能至关重要\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 特征标准化对模型性能至关重要\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   - 超参数调优可以显著提升模型性能\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 超参数调优可以显著提升模型性能\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"   - 模型解释性在医疗领域尤为重要\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 模型解释性在医疗领域尤为重要\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# 案例总结 - Python\nprint(\"=== 糖尿病进展预测案例总结 ===\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== 糖尿病进展预测案例总结 ===\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"1. 数据特征:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1. 数据特征:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(f\"   - 数据集包含 {diabetes_data.shape[0]} 个样本，{diabetes_data.shape[1]-1} 个特征\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 数据集包含 442 个样本，8 个特征\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"   - 目标变量: 疾病进展指标\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 目标变量: 疾病进展指标\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"   - 最重要的特征: bmi, s5, bp\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 最重要的特征: bmi, s5, bp\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"2. 模型性能比较:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2. 模型性能比较:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(results_python[['Model', 'RMSE', 'R2']].sort_values('RMSE').to_string(index=False))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Model     RMSE        R2\n         Ridge Regression 0.037728  0.346299\n        Linear Regression 0.037869  0.341403\n            Random Forest 0.039989  0.265591\n        Gradient Boosting 0.040339  0.252692\n              K-Neighbors 0.041668  0.202630\n         Lasso Regression 0.046838 -0.007507\nSupport Vector Regression 0.048922 -0.099178\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"\\n3. 最佳实践:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n3. 最佳实践:\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"   - 集成学习方法在回归问题上表现稳定\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 集成学习方法在回归问题上表现稳定\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"   - 数据预处理对模型性能影响显著\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 数据预处理对模型性能影响显著\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"   - 交叉验证提供更可靠的性能估计\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 交叉验证提供更可靠的性能估计\n```\n\n\n:::\n\n```{.python .cell-code}\nprint(\"   - 特征重要性分析增强模型可解释性\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   - 特征重要性分析增强模型可解释性\n```\n\n\n:::\n:::\n\n\n技术要点回顾\n\n**数据预处理**： - 特征标准化：确保不同尺度的特征具有可比性 - 缺失值处理：根据数据特性选择合适的填充策略 - 特征工程：创建有意义的衍生特征\n\n**模型选择**： - 线性模型：可解释性强，计算效率高 - 树模型：自动处理非线性关系，对异常值稳健 - 集成方法：通过模型组合提升预测性能\n\n**模型评估**： - 使用多个评估指标（RMSE, MAE, R²） - 交叉验证提供稳健的性能估计 - 测试集用于最终模型评估\n\n**模型优化**： - 超参数调优：网格搜索、随机搜索 - 特征选择：基于重要性或递归消除 - 集成策略：Bagging, Boosting, Stacking\n\n业务应用建议\n\n医疗诊断：使用训练好的模型对患者疾病进展进行预测 治疗方案制定：识别影响疾病进展的关键因素，指导治疗策略 患者管理：理解生理指标对疾病的影响，支持患者管理 风险评估：监测疾病进展风险，预警健康问题\n\n通过本回归案例，我们展示了从数据探索到模型部署的完整预测建模流程，为读者在实际工作中应用机器学习方法提供了完整的参考框架。",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}